{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"workspaceName": {
			"type": "string",
			"metadata": "Workspace name",
			"defaultValue": "prod-synapse-uks-001"
		},
		"AzureDataLakeStorage1_accountKey": {
			"type": "secureString",
			"metadata": "Secure string for 'accountKey' of 'AzureDataLakeStorage1'"
		},
		"AzureDataLakeStorage2_accountKey": {
			"type": "secureString",
			"metadata": "Secure string for 'accountKey' of 'AzureDataLakeStorage2'"
		},
		"AzureSQLEnrichedServerless_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'AzureSQLEnrichedServerless'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=prod-synapse-uks-001-ondemand.sql.azuresynapse.net;Initial Catalog=DataverseEnrichedv4"
		},
		"AzureSynapseAnalytics1_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'AzureSynapseAnalytics1'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=synapseworksparcev4.sql.azuresynapse.net;Initial Catalog=testsadpool"
		},
		"ChoiceDB DataverseEnriched_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'ChoiceDB DataverseEnriched'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=prod-synapse-uks-001-ondemand.sql.azuresynapse.net;Initial Catalog=DataverseEnriched"
		},
		"Dataverserondemand_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'Dataverserondemand'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=test-ws-synapse-uks-01-ondemand.sql.azuresynapse.net;Initial Catalog=dataverse_testb_unqd627dc8d885044ee87837a5345b30"
		},
		"DedicatedPoolInsight_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'DedicatedPoolInsight'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=prod-synapse-uks-001.sql.azuresynapse.net;Initial Catalog=Insights"
		},
		"EnrichedDatabase_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'EnrichedDatabase'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=prod-synapse-uks-001-ondemand.sql.azuresynapse.net;Initial Catalog=DataverseEnriched"
		},
		"EnrichmentDB_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'EnrichmentDB'"
		},
		"InsightsAzureSynapseAnalytics_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'InsightsAzureSynapseAnalytics'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=prod-synapse-uks-001.sql.azuresynapse.net;Initial Catalog=DedicatedSQLPool"
		},
		"LB_DBX_EngineeringSml_accessToken": {
			"type": "secureString",
			"metadata": "Secure string for 'accessToken' of 'LB_DBX_EngineeringSml'"
		},
		"LS_ADLS_PRIVATE_DYN_accountKey": {
			"type": "secureString",
			"metadata": "Secure string for 'accountKey' of 'LS_ADLS_PRIVATE_DYN'"
		},
		"LS_BLOB_PRIVATE_DYN_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'LS_BLOB_PRIVATE_DYN'"
		},
		"LS_FIVERR_SQL_AnalyticsHub_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'LS_FIVERR_SQL_AnalyticsHub'"
		},
		"LS_Metadata_SQL_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'LS_Metadata_SQL'"
		},
		"LS_SQL_AnalyticsHub_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'LS_SQL_AnalyticsHub'"
		},
		"LS_SQL_PretBIReference_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'LS_SQL_PretBIReference'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=test-ws-synapse-uks-01-ondemand.sql.azuresynapse.net;Initial Catalog=dataverse_testb_unqd627dc8d885044ee87837a5345b30"
		},
		"MyOrigination_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'MyOrigination'"
		},
		"ReportsAnalytics_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'ReportsAnalytics'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=prod-synapse-uks-001.sql.azuresynapse.net;Initial Catalog=DedicatedSQLPool"
		},
		"ReportsSLLinkedSVC_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'ReportsSLLinkedSVC'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=prod-synapse-uks-001-ondemand.sql.azuresynapse.net;Initial Catalog=ReportsSL"
		},
		"ReportsSql_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'ReportsSql'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=prod-synapse-uks-001.sql.azuresynapse.net;Initial Catalog=ReportsDW"
		},
		"ServerLessSQL2_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'ServerLessSQL2'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=prod-synapse-uks-001-ondemand.sql.azuresynapse.net;Initial Catalog=dataverse_montagu_org5a2bcccf"
		},
		"SharePointOnlineList1_servicePrincipalKey": {
			"type": "secureString",
			"metadata": "Secure string for 'servicePrincipalKey' of 'SharePointOnlineList1'"
		},
		"SharePointSinkLS_accountKey": {
			"type": "secureString",
			"metadata": "Secure string for 'accountKey' of 'SharePointSinkLS'"
		},
		"dataverseprod_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'dataverseprod'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=prod-synapse-uks-001-ondemand.sql.azuresynapse.net;Initial Catalog=dataverse_montagu_org5a2bcccf"
		},
		"dynamoBlobLink_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'dynamoBlobLink'"
		},
		"mssfttestworkspace-WorkspaceDefaultSqlServer_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'mssfttestworkspace-WorkspaceDefaultSqlServer'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=tcp:mssfttestworkspace.sql.azuresynapse.net,1433;Initial Catalog=@{linkedService().DBName}"
		},
		"placeholder_accountKey": {
			"type": "secureString",
			"metadata": "Secure string for 'accountKey' of 'placeholder'"
		},
		"prod-synapse-uks-001-WorkspaceDefaultSqlServer_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'prod-synapse-uks-001-WorkspaceDefaultSqlServer'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=tcp:prod-synapse-uks-001.sql.azuresynapse.net,1433;Initial Catalog=@{linkedService().DBName}"
		},
		"synapseworksparcev4-WorkspaceDefaultSqlServer_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'synapseworksparcev4-WorkspaceDefaultSqlServer'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=tcp:synapseworksparcev4.sql.azuresynapse.net,1433;Initial Catalog=@{linkedService().DBName}"
		},
		"test-ws-synapse-uks-01-WorkspaceDefaultSqlServer_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'test-ws-synapse-uks-01-WorkspaceDefaultSqlServer'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=tcp:test-ws-synapse-uks-01.sql.azuresynapse.net,1433;Initial Catalog=@{linkedService().DBName}"
		},
		"ADLSLinkedService_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://prodlakeaccuks01.dfs.core.windows.net"
		},
		"AzureDataLakeStorage1_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://testdatalakeuks01.dfs.core.windows.net"
		},
		"AzureDataLakeStorage2_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://prodlakeaccuks01.dfs.core.windows.net"
		},
		"AzureKeyVaultClientsecretSynapse_properties_typeProperties_baseUrl": {
			"type": "string",
			"defaultValue": "https://MontaguKeyVault.vault.azure.net/"
		},
		"CrunchRESTService_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://api.crunchbase.com/"
		},
		"DueDil_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://duedil.io/v4/company/gb/companyId"
		},
		"DuedilCompanies_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://duedil.io/v4/company/gb/"
		},
		"LS_ADLS_PRIVATE_DYN_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://prodlakeaccuks01.dfs.core.windows.net/"
		},
		"LinkedServiceCDM_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://prodlakeaccuks01.dfs.core.windows.net"
		},
		"REST Companies API_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://restcountries.com/v3.1/name/"
		},
		"SharePointOnlineList1_properties_typeProperties_servicePrincipalId": {
			"type": "string",
			"defaultValue": "42fed13b-1d1c-429a-8e71-46f7cf889242"
		},
		"SharePointSinkLS_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://prodlakeaccuks01.dfs.core.windows.net/"
		},
		"SynapseDataAzureKeyVault_properties_typeProperties_baseUrl": {
			"type": "string",
			"defaultValue": "https://MontaguKeyVault.vault.azure.net/"
		},
		"crunchbasehttpsource_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://api.crunchbase.com/bulk/v4/bulk_export.tar.gz?user_key=6314d4f23ebc30598895f49a15cdd1ef"
		},
		"duedilHTTPLinkService_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://duedil.io/v4/search/companies.json"
		},
		"duedilRESTLink_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://duedil.io/v4/company/gb/"
		},
		"dynamoDirectRESTLINK_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://pm2.preqinsolutions.com/apiCore/api/"
		},
		"dynamoMetricLINK_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://pm2.preqinsolutions.com/apiCore/api/Metrics/"
		},
		"dynamoMetricLinkV4_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://pm2.preqinsolutions.com/apiCore/"
		},
		"dynamoMetricValueLink_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://pm2.preqinsolutions.com/"
		},
		"dynamoPMVHttpLink_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://pm2.preqinsolutions.com"
		},
		"dynamoREST_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://pm2.preqinsolutions.com/apiCore/api/countries"
		},
		"mssfttestworkspace-WorkspaceDefaultStorage_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://testdatalakeuks01.dfs.core.windows.net"
		},
		"placeholder_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://prodlakeaccuks01.dfs.core.windows.net/"
		},
		"prod-synapse-uks-001-WorkspaceDefaultStorage_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://prodlakeaccuks01.dfs.core.windows.net"
		},
		"synapseworksparcev4-WorkspaceDefaultStorage_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://synapsworkspacev2.dfs.core.windows.net"
		},
		"test-ws-synapse-uks-01-WorkspaceDefaultStorage_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://testdatalakeuks01.dfs.core.windows.net"
		},
		"CRM Daily Extract_properties_Execute Montagu Load_parameters_Area": {
			"type": "string",
			"defaultValue": "origination"
		},
		"CRM Daily Extract_properties_Execute Montagu Load_parameters_Domain": {
			"type": "string",
			"defaultValue": "dbo"
		},
		"CRM Daily Extract_properties_Execute Montagu Load_parameters_Region": {
			"type": "string",
			"defaultValue": "-1"
		},
		"Duedil_RelationshipReview_properties_EX_SourceToRaw_Parent_parameters_Area": {
			"type": "string",
			"defaultValue": "crmreport"
		},
		"Duedil_RelationshipReview_properties_EX_SourceToRaw_Parent_parameters_Domain": {
			"type": "string",
			"defaultValue": "dbo"
		},
		"OC Weeekly_properties_Execute Montagu Load_parameters_SliceDate": {
			"type": "string",
			"defaultValue": "YYYYMMdd"
		},
		"OC Weeekly_properties_Execute Montagu Load_parameters_Area": {
			"type": "string",
			"defaultValue": "origination"
		},
		"OC Weeekly_properties_Execute Montagu Load_parameters_Domain": {
			"type": "string",
			"defaultValue": "dbo"
		},
		"OC Weeekly_properties_Execute Montagu Load_parameters_Region": {
			"type": "string",
			"defaultValue": "-2"
		},
		"Pause_Server_ReportsDW_properties_PauseSQL_parameters_ResourceGroup": {
			"type": "string",
			"defaultValue": "MontaguData"
		},
		"Pause_Server_ReportsDW_properties_PauseSQL_parameters_SubscriptionID": {
			"type": "string",
			"defaultValue": "5c1bc415-b561-4700-9cbe-71f1079bb536"
		},
		"Pause_Server_ReportsDW_properties_PauseSQL_parameters_WorkspaceName": {
			"type": "string",
			"defaultValue": "prod-synapse-uks-001"
		},
		"Pause_Server_ReportsDW_properties_PauseSQL_parameters_PauseorResume": {
			"type": "string",
			"defaultValue": "Pause"
		},
		"cabreport_properties_Execute Montagu Load_parameters_SliceDate": {
			"type": "string",
			"defaultValue": "YYYYMMDD"
		},
		"cabreport_properties_Execute Montagu Load_parameters_Area": {
			"type": "string",
			"defaultValue": "cabreport"
		},
		"cabreport_properties_Execute Montagu Load_parameters_Domain": {
			"type": "string",
			"defaultValue": "dbo"
		},
		"cabreport_properties_Execute Montagu Load_parameters_Region": {
			"type": "string",
			"defaultValue": "-2"
		}
	},
	"variables": {
		"workspaceId": "[concat('Microsoft.Synapse/workspaces/', parameters('workspaceName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('workspaceName'), '/1 PH 1 Enrich Data for RAW')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Data flow1",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "PH 1 FullEnrich Only",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"AccountIn": {},
									"OriginationOpportunityIn": {},
									"MeetingsAppointmentsIn": {},
									"ContactsIn": {},
									"EnrichedAccount": {},
									"EnrichedOriginationOpportunities": {},
									"EnrichedMeetingAppointments": {},
									"EnrichedContacts": {},
									"SystemUserIn": {},
									"EnrichedSystemUser": {},
									"AccountCleanSink": {},
									"MeetingStageCleanSink": {},
									"ContactsStageCleanSink": {},
									"OriginationCleanSink": {},
									"SinkEnrichedOrigination": {},
									"SinkEnrichedAccount": {},
									"SinkEnrichedMeeting": {},
									"SinkEnrichedContacts": {},
									"SystemUserSink": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "prod-synapse-uks-001-WorkspaceDefaultStorage",
									"type": "LinkedServiceReference"
								},
								"folderPath": "users/stage"
							},
							"compute": {
								"coreCount": 8,
								"computeType": "MemoryOptimized"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:39:42Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/dataflows/PH 1 FullEnrich Only')]",
				"[concat(variables('workspaceId'), '/linkedServices/prod-synapse-uks-001-WorkspaceDefaultStorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/1 PH 1A Enriched Dataset Seperate Tables')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "PrimaryEnrichment",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "PH Full InputDataflow_Split Table",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"AccountIn": {},
									"OriginationOpportunityIn": {},
									"MeetingsAppointmentsIn": {},
									"ContactsIn": {},
									"SystemuserSource": {},
									"EnrichedAccount": {},
									"EnrichedOriginationOpportunities": {},
									"EnrichedMeetingAppointments": {},
									"EnrichedContacts": {},
									"EnrichedSystemuser": {},
									"AccountCleanSink": {},
									"MeetingStageCleanSink": {},
									"ContactsStageCleanSink": {},
									"OriginationCleanSink": {},
									"SystemUserCleanSink": {},
									"SinkEnrichedOrigination": {},
									"SinkEnrichedAccount": {},
									"SinkEnrichedMeeting": {},
									"SinkEnrichedContacts": {},
									"SinkEnrichedSystemUser": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "ADLSLinkedService",
									"type": "LinkedServiceReference"
								},
								"folderPath": "users/stage"
							},
							"compute": {
								"coreCount": 16,
								"computeType": "MemoryOptimized"
							},
							"traceLevel": "Coarse"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:44:07Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/dataflows/PH Full InputDataflow_Split Table')]",
				"[concat(variables('workspaceId'), '/linkedServices/ADLSLinkedService')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/1 PH 1B Enrich Data for RAW NO Cache')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Data flow No Cache",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "PH 1 FullEnrich No Cache",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"AccountIn": {},
									"OriginationOpportunityIn": {},
									"MeetingsAppointmentsIn": {},
									"ContactsIn": {},
									"EnrichedAccount": {},
									"EnrichedOriginationOpportunities": {},
									"EnrichedMeetingAppointments": {},
									"EnrichedContacts": {},
									"SystemUserIn": {},
									"EnrichedSystemUser": {},
									"AccountCleanSink": {},
									"MeetingStageCleanSink": {},
									"ContactsStageCleanSink": {},
									"OriginationCleanSink": {},
									"SystemUserSink": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "prod-synapse-uks-001-WorkspaceDefaultStorage",
									"type": "LinkedServiceReference"
								},
								"folderPath": "users/stage"
							},
							"compute": {
								"coreCount": 8,
								"computeType": "MemoryOptimized"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:39:46Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/dataflows/PH 1 FullEnrich No Cache')]",
				"[concat(variables('workspaceId'), '/linkedServices/prod-synapse-uks-001-WorkspaceDefaultStorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/B2E_Parent')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Initiate Parent Process",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[Process].[InitiateParentLoad]",
								"storedProcedureParameters": {
									"ADFExecution": {
										"type": "String",
										"value": {
											"value": "@pipeline().RunId",
											"type": "Expression"
										}
									},
									"Area": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.Area",
											"type": "Expression"
										}
									},
									"EntityStageID": {
										"type": "Int32",
										"value": null
									},
									"ParentProcessID": {
										"type": "Int32",
										"value": null
									},
									"ProcessFilter": {
										"type": "String",
										"value": "%"
									},
									"Stage": {
										"type": "String",
										"value": "ENR"
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_AnalyticsHub_DYN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Get Jobs to Run",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Initiate Parent Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[Process].[GetChildProcesses]",
								"storedProcedureParameters": {
									"ParentProcessID": {
										"type": "Int32",
										"value": {
											"value": "@activity('Initiate Parent Process').output.firstRow.ParentProcessID",
											"type": "Expression"
										}
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_AnalyticsHub_DYN",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Run Child Processes",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Get Jobs to Run",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get Jobs to Run').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "Run Enrichment Pipeline",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "B2E_Single",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"StageName": {
												"value": "@item().StageName",
												"type": "Expression"
											},
											"EntityStageID": {
												"value": "@item().EntityStageID",
												"type": "Expression"
											},
											"ProcessID": {
												"value": "@item().ProcessID",
												"type": "Expression"
											},
											"ProcessSubType": {
												"value": "@item().ProcessSubType",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					},
					{
						"name": "Finalise Parent Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Run Child Processes",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FinaliseProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@activity('Initiate Parent Process').output.firstRow.ParentProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail Parent Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Run Child Processes",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FailProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@activity('Initiate Parent Process').output.firstRow.ParentProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Area": {
						"type": "string"
					},
					"Domain": {
						"type": "string"
					}
				},
				"folder": {
					"name": "2 - BaseToEnrich"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:39:54Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/DS_AnalyticsHub_DYN')]",
				"[concat(variables('workspaceId'), '/linkedServices/LS_SQL_AnalyticsHub')]",
				"[concat(variables('workspaceId'), '/pipelines/B2E_Single')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/B2E_Single')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Start Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[StartProcess]",
							"storedProcedureParameters": {
								"ADFExecution": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Finalise Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Run Enrichment Notebook",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FinaliseProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Run Enrichment Notebook",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FailProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Log Process Throughput",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Finalise Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[LogThroughput]",
							"storedProcedureParameters": {
								"CountName": {
									"value": "rowsUpserted",
									"type": "String"
								},
								"CountValue": {
									"value": {
										"value": "@activity('Run Enrichment Notebook').Output.runOutput.rowCount",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Run Enrichment Notebook",
						"type": "DatabricksNotebook",
						"dependsOn": [
							{
								"activity": "Start Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebookPath": {
								"value": "/Hydr8 Framework/Enrichment/@{pipeline().parameters.ProcessSubType}",
								"type": "Expression"
							},
							"baseParameters": {
								"entityStageId": {
									"value": "@string(pipeline().parameters.EntityStageID)",
									"type": "Expression"
								},
								"stageName": {
									"value": "@pipeline().parameters.StageName",
									"type": "Expression"
								},
								"processSubType": {
									"value": "@pipeline().parameters.ProcessSubType",
									"type": "Expression"
								},
								"processId": {
									"value": "@string(pipeline().parameters.ProcessID)",
									"type": "Expression"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LB_DBX_EngineeringSml",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Add Dependencies to Queue",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Finalise Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[InitiateDependency]",
							"storedProcedureParameters": {
								"EntityStageID": {
									"value": {
										"value": "@pipeline().parameters.EntityStageID",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"SlicePath": {
									"value": "",
									"type": "String"
								},
								"MultiLine": {
									"value": "False",
									"type": "Boolean"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"StageName": {
						"type": "string"
					},
					"EntityStageID": {
						"type": "int"
					},
					"ProcessID": {
						"type": "int"
					},
					"ProcessSubType": {
						"type": "string"
					}
				},
				"folder": {
					"name": "2 - BaseToEnrich"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:35:07Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_SQL_AnalyticsHub')]",
				"[concat(variables('workspaceId'), '/linkedServices/LB_DBX_EngineeringSml')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Choices Join')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Data flow1",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "Join Choices",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"RawSource": {},
									"ChoiceAnswer": {},
									"FullEnriched": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "prod-synapse-uks-001-WorkspaceDefaultStorage",
									"type": "LinkedServiceReference"
								},
								"folderPath": "users/stage"
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine",
							"sourceStagingConcurrency": 1
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:39:58Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/dataflows/Join Choices')]",
				"[concat(variables('workspaceId'), '/linkedServices/prod-synapse-uks-001-WorkspaceDefaultStorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Clone_B2E_Single')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Start Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[StartProcess]",
							"storedProcedureParameters": {
								"ADFExecution": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Run Enrichment Notebook",
						"type": "DatabricksNotebook",
						"dependsOn": [
							{
								"activity": "Start Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebookPath": {
								"value": "/Hydr8 Framework/Enrichment/@{pipeline().parameters.ProcessSubType}",
								"type": "Expression"
							},
							"baseParameters": {
								"entityStageId": {
									"value": "@string(pipeline().parameters.EntityStageID)",
									"type": "Expression"
								},
								"stageName": {
									"value": "@pipeline().parameters.StageName",
									"type": "Expression"
								},
								"processSubType": {
									"value": "@pipeline().parameters.ProcessSubType",
									"type": "Expression"
								},
								"processId": {
									"value": "@string(pipeline().parameters.ProcessID)",
									"type": "Expression"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LB_DBX_EngineeringSml",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Finalise Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Run Enrichment Notebook",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FinaliseProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Run Enrichment Notebook",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FailProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Log Process Throughput",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Finalise Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[LogThroughput]",
							"storedProcedureParameters": {
								"CountName": {
									"value": "rowsUpserted",
									"type": "String"
								},
								"CountValue": {
									"value": {
										"value": "@activity('Run Enrichment Notebook').Output.runOutput.rowCount",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"StageName": {
						"type": "string"
					},
					"EntityStageID": {
						"type": "int"
					},
					"ProcessID": {
						"type": "int"
					},
					"ProcessSubType": {
						"type": "string"
					}
				},
				"folder": {
					"name": "2 - BaseToEnrich"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:35:13Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_SQL_AnalyticsHub')]",
				"[concat(variables('workspaceId'), '/linkedServices/LB_DBX_EngineeringSml')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Clone_DBX_EnrichToCurated_Single')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Start Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[StartProcess]",
							"storedProcedureParameters": {
								"ADFExecution": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Run Curation Notebook",
						"type": "DatabricksNotebook",
						"dependsOn": [
							{
								"activity": "Start Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebookPath": {
								"value": "/Hydr8 Framework/Curation/@{pipeline().parameters.ProcessSubType}",
								"type": "Expression"
							}
						},
						"linkedServiceName": {
							"referenceName": "LB_DBX_EngineeringSml",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Finalise Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Run Curation Notebook",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FinaliseProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Run Curation Notebook",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FailProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Log Process Throughput",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Finalise Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[LogThroughput]",
							"storedProcedureParameters": {
								" CountName": {
									"value": "rowsInserted",
									"type": "String"
								},
								"CountValue": {
									"value": {
										"value": "@activity('Run Curation Notebook').Output.runOutput.rowCount",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Add Dependencies to Queue",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Finalise Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[InitiateDependency]",
							"storedProcedureParameters": {
								" EntityStageID": {
									"value": {
										"value": "@pipeline().parameters.EntityStageID",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"MultiLine": {
									"value": "False",
									"type": "Boolean"
								},
								"SlicePath": {
									"value": "",
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"StageName": {
						"type": "string"
					},
					"EntityStageID": {
						"type": "int"
					},
					"ProcessID": {
						"type": "int"
					},
					"ProcessSubType": {
						"type": "string"
					},
					"Region": {
						"type": "string"
					}
				},
				"folder": {
					"name": "EnrichToCurated"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:35:17Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_SQL_AnalyticsHub')]",
				"[concat(variables('workspaceId'), '/linkedServices/LB_DBX_EngineeringSml')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CombinedTestPipeline')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"wildcardFileName": "*.json",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings",
									"copyBehavior": "MergeFiles"
								},
								"formatSettings": {
									"type": "JsonWriteSettings",
									"filePattern": "setOfObjects"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "['id']"
										},
										"sink": {
											"path": "['id']"
										}
									},
									{
										"source": {
											"path": "['companyId']"
										},
										"sink": {
											"path": "['companyId']"
										}
									},
									{
										"source": {
											"path": "['name']"
										},
										"sink": {
											"path": "['name']"
										}
									},
									{
										"source": {
											"path": "['shortName']"
										},
										"sink": {
											"path": "['shortName']"
										}
									},
									{
										"source": {
											"path": "['number']"
										},
										"sink": {
											"path": "['number']"
										}
									},
									{
										"source": {
											"path": "['symbol']"
										},
										"sink": {
											"path": "['symbol']"
										}
									},
									{
										"source": {
											"path": "['sign']"
										},
										"sink": {
											"path": "['sign']"
										}
									},
									{
										"source": {
											"path": "['decimals']"
										},
										"sink": {
											"path": "['decimals']"
										}
									},
									{
										"source": {
											"path": "['description']"
										},
										"sink": {
											"path": "['description']"
										}
									},
									{
										"source": {
											"path": "['performanceOwner']"
										},
										"sink": {
											"path": "['performanceOwner']"
										}
									},
									{
										"source": {
											"path": "['polarity']"
										},
										"sink": {
											"path": "['polarity']"
										}
									},
									{
										"source": {
											"path": "['weight']"
										},
										"sink": {
											"path": "['weight']"
										}
									},
									{
										"source": {
											"path": "['isMonetary']"
										},
										"sink": {
											"path": "['isMonetary']"
										}
									}
								],
								"collectionReference": "$['data']"
							}
						},
						"inputs": [
							{
								"referenceName": "Json1Merge",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Json1TheMerged",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"set": {
						"type": "String"
					},
					"Index": {
						"type": "String"
					}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:35:21Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/Json1Merge')]",
				"[concat(variables('workspaceId'), '/datasets/Json1TheMerged')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Copy Dataverse data from Azure Data Lake to Azure SQL')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "After using Azure Synapse Link for Dataverse, use this template to copy the Dataverse data from Azure Data Lake to Azure SQL.",
				"activities": [
					{
						"name": "Dataverse mapping to Azure SQL",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DataverseToAzureSQL",
								"type": "DataFlowReference",
								"parameters": {
									"ContainerName": "\"Dataverse Container Name\"",
									"TableName": "\"Dataverse Table Name\""
								},
								"datasetParameters": {
									"ADLS": {},
									"SQL": {},
									"sink1": {},
									"sink2": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "prod-synapse-uks-001-WorkspaceDefaultStorage",
									"type": "LinkedServiceReference"
								},
								"folderPath": "users"
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:44:11Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/dataflows/DataverseToAzureSQL')]",
				"[concat(variables('workspaceId'), '/linkedServices/prod-synapse-uks-001-WorkspaceDefaultStorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Create Dataset')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "CreateStaged",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "InputDataflow",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"AccountIn": {},
									"OriginationOpportunityIn": {},
									"MeetingsAppointmentsIn": {},
									"ContactsIn": {},
									"Systemusersource": {},
									"AccountStage": {},
									"MeetingStageClean": {},
									"ContactsStageClean": {},
									"OriginationSINK": {},
									"sink1": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "ADLSLinkedService",
									"type": "LinkedServiceReference"
								},
								"folderPath": "users/stage/"
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:44:16Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/dataflows/InputDataflow')]",
				"[concat(variables('workspaceId'), '/linkedServices/ADLSLinkedService')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Create Dataset_Seperatetables')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Data flow1",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "PH Full InputDataflow_Split Table",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"AccountIn": {},
									"OriginationOpportunityIn": {},
									"MeetingsAppointmentsIn": {},
									"ContactsIn": {},
									"SystemuserSource": {},
									"EnrichedAccount": {},
									"EnrichedOriginationOpportunities": {},
									"EnrichedMeetingAppointments": {},
									"EnrichedContacts": {},
									"EnrichedSystemuser": {},
									"AccountCleanSink": {},
									"MeetingStageCleanSink": {},
									"ContactsStageCleanSink": {},
									"OriginationCleanSink": {},
									"SystemUserCleanSink": {},
									"SinkEnrichedOrigination": {},
									"SinkEnrichedAccount": {},
									"SinkEnrichedMeeting": {},
									"SinkEnrichedContacts": {},
									"SinkEnrichedSystemUser": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "ADLSLinkedService",
									"type": "LinkedServiceReference"
								},
								"folderPath": "users/stage"
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:44:24Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/dataflows/PH Full InputDataflow_Split Table')]",
				"[concat(variables('workspaceId'), '/linkedServices/ADLSLinkedService')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DBX_EnrichToCurated_Single')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Start Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[StartProcess]",
							"storedProcedureParameters": {
								"ADFExecution": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Finalise Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Run Curation Notebook",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FinaliseProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Run Curation Notebook",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FailProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Log Process Throughput",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Finalise Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[LogThroughput]",
							"storedProcedureParameters": {
								"CountName": {
									"value": "rowsInserted",
									"type": "String"
								},
								"CountValue": {
									"value": {
										"value": "@activity('Run Curation Notebook').Output.runOutput.rowCount",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Run Curation Notebook",
						"type": "DatabricksNotebook",
						"dependsOn": [
							{
								"activity": "Start Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebookPath": {
								"value": "/Hydr8 Framework/Curation/@{pipeline().parameters.ProcessSubType}",
								"type": "Expression"
							},
							"baseParameters": {
								"entityStageId": {
									"value": "@string(pipeline().parameters.EntityStageID)",
									"type": "Expression"
								},
								"processId": {
									"value": "@string(pipeline().parameters.ProcessID)",
									"type": "Expression"
								},
								"processSubType": {
									"value": "@pipeline().parameters.ProcessSubType",
									"type": "Expression"
								},
								"stageName": {
									"value": "@pipeline().parameters.StageName",
									"type": "Expression"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LB_DBX_EngineeringSml",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Add Dependencies to Queue",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Finalise Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[InitiateDependency]",
							"storedProcedureParameters": {
								"EntityStageID": {
									"value": {
										"value": "@pipeline().parameters.EntityStageID",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"MultiLine": {
									"value": "False",
									"type": "Boolean"
								},
								"SlicePath": {
									"value": "",
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"StageName": {
						"type": "string"
					},
					"EntityStageID": {
						"type": "int"
					},
					"ProcessID": {
						"type": "int"
					},
					"ProcessSubType": {
						"type": "string"
					},
					"Region": {
						"type": "string"
					}
				},
				"folder": {
					"name": "EnrichToCurated"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:35:26Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_SQL_AnalyticsHub')]",
				"[concat(variables('workspaceId'), '/linkedServices/LB_DBX_EngineeringSml')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DYN_EnrToCurated_Parent')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Initiate Parent Process",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[Process].[InitiateParentLoad]",
								"storedProcedureParameters": {
									"ADFExecution": {
										"type": "String",
										"value": {
											"value": "@pipeline().RunId",
											"type": "Expression"
										}
									},
									"Area": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.Area",
											"type": "Expression"
										}
									},
									"EntityStageID": {
										"type": "Int32",
										"value": null
									},
									"ParentProcessID": {
										"type": "Int32",
										"value": null
									},
									"ProcessFilter": {
										"type": "String",
										"value": "%"
									},
									"Stage": {
										"type": "String",
										"value": "CUR"
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_AnalyticsHub_DYN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Get Jobs to Run",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Initiate Parent Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[Process].[GetChildProcesses]",
								"storedProcedureParameters": {
									"ParentProcessID": {
										"type": "Int32",
										"value": {
											"value": "@activity('Initiate Parent Process').output.firstRow.ParentProcessID",
											"type": "Expression"
										}
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_AnalyticsHub_DYN",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Run Child Processes",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Get Jobs to Run",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get Jobs to Run').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "Run Curation Pipeline",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "DBX_EnrichToCurated_Single",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"StageName": {
												"value": "@item().StageName",
												"type": "Expression"
											},
											"EntityStageID": {
												"value": "@item().EntityStageID",
												"type": "Expression"
											},
											"ProcessID": {
												"value": "@item().ProcessID",
												"type": "Expression"
											},
											"ProcessSubType": {
												"value": "@item().ProcessSubType",
												"type": "Expression"
											},
											"Region": {
												"value": "@pipeline().parameters.Region",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					},
					{
						"name": "Finalise Parent Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Run Child Processes",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FinaliseProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@activity('Initiate Parent Process').output.firstRow.ParentProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail Parent Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Run Child Processes",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FailProcess]",
							"storedProcedureParameters": {
								" ProcessID": {
									"value": {
										"value": "@activity('Initiate Parent Process').output.firstRow.ParentProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Region": {
						"type": "string"
					},
					"Area": {
						"type": "string"
					},
					"Domain": {
						"type": "string"
					}
				},
				"folder": {
					"name": "EnrichToCurated"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:40:04Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/DS_AnalyticsHub_DYN')]",
				"[concat(variables('workspaceId'), '/linkedServices/LS_SQL_AnalyticsHub')]",
				"[concat(variables('workspaceId'), '/pipelines/DBX_EnrichToCurated_Single')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DueDill')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Data flow1",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DueDil",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {},
									"source2": {},
									"sink2": {},
									"sink3": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "prod-synapse-uks-001-WorkspaceDefaultStorage",
									"type": "LinkedServiceReference"
								},
								"folderPath": "users/stage"
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:40:06Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/dataflows/DueDil')]",
				"[concat(variables('workspaceId'), '/linkedServices/prod-synapse-uks-001-WorkspaceDefaultStorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Duedil FinancialsTest')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Copy To EnrichmentDB",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"companyId"
									]
								},
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "$['companyId']"
										},
										"sink": {
											"name": "companyId",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['financials'][0]['accountsDate']"
										},
										"sink": {
											"name": "accountsDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['financials'][0]['turnover']['value']"
										},
										"sink": {
											"name": "financials_0_turnover_value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['financials'][0]['turnover']['threeYearCAGR']"
										},
										"sink": {
											"name": "financials_0_turnover_threeYearCAGR",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['financials'][0]['turnover']['fiveYearCAGR']"
										},
										"sink": {
											"name": "financials_0_turnover_fiveYearCAGR",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['financials'][0]['ebitda']['value']"
										},
										"sink": {
											"name": "financials_0_ebitda_value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['financials'][0]['ebitda']['threeYearCAGR']"
										},
										"sink": {
											"name": "financials_0_ebitda_threeYearCAGR",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['financials'][0]['ebitda']['fiveYearCAGR']"
										},
										"sink": {
											"name": "financials_0_ebitda_fiveYearCAGR",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['financials'][1]['turnover']['value']"
										},
										"sink": {
											"name": "financials_1_turnover_value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['financials'][1]['ebitda']['value']"
										},
										"sink": {
											"name": "financials_1_ebitda_value",
											"type": "Double"
										}
									}
								],
								"collectionReference": "",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "Json12SQLDS",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "AzureSqlTable2",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:40:11Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/Json12SQLDS')]",
				"[concat(variables('workspaceId'), '/datasets/AzureSqlTable2')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Duedil json2SQLTableFinancials')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Copy To EnrichDBFinTest",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"companyId"
									]
								},
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "$['companyId']"
										},
										"sink": {
											"name": "companyId",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['financials'][0]['accountsDate']"
										},
										"sink": {
											"name": "accountsDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['financials'][0]['turnover']['value']"
										},
										"sink": {
											"name": "financials_0_turnover_value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['financials'][0]['turnover']['threeYearCAGR']"
										},
										"sink": {
											"name": "financials_0_turnover_threeYearCAGR",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['financials'][0]['turnover']['fiveYearCAGR']"
										},
										"sink": {
											"name": "financials_0_turnover_fiveYearCAGR",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['financials'][0]['ebitda']['value']"
										},
										"sink": {
											"name": "financials_0_ebitda_value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['financials'][0]['ebitda']['threeYearCAGR']"
										},
										"sink": {
											"name": "financials_0_ebitda_threeYearCAGR",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['financials'][0]['ebitda']['fiveYearCAGR']"
										},
										"sink": {
											"name": "financials_0_ebitda_fiveYearCAGR",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['financials'][1]['turnover']['value']"
										},
										"sink": {
											"name": "financials_1_turnover_value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['financials'][1]['ebitda']['value']"
										},
										"sink": {
											"name": "financials_1_ebitda_value",
											"type": "Double"
										}
									}
								],
								"collectionReference": "",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "Json12SQLDS",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "AzureSqlTable2",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:40:15Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/Json12SQLDS')]",
				"[concat(variables('workspaceId'), '/datasets/AzureSqlTable2')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/E2C_Parent')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Initiate Parent Process",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[Process].[InitiateParentLoad]",
								"storedProcedureParameters": {
									"ADFExecution": {
										"type": "String",
										"value": {
											"value": "@pipeline().RunId",
											"type": "Expression"
										}
									},
									"Area": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.Area",
											"type": "Expression"
										}
									},
									"EntityStageID": {
										"type": "Int32",
										"value": null
									},
									"ParentProcessID": {
										"type": "Int32",
										"value": null
									},
									"ProcessFilter": {
										"type": "String",
										"value": "%"
									},
									"Stage": {
										"type": "String",
										"value": "ENR"
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_AnalyticsHub_DYN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Get Jobs to Run",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Initiate Parent Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[Process].[GetChildProcesses]",
								"storedProcedureParameters": {
									"ParentProcessID": {
										"type": "Int32",
										"value": {
											"value": "@activity('Initiate Parent Process').output.firstRow.ParentProcessID",
											"type": "Expression"
										}
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_AnalyticsHub_DYN",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Run Child Processes",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Get Jobs to Run",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get Jobs to Run').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "Run Enrichment Pipeline",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Clone_B2E_Single",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"StageName": {
												"value": "@item().StageName",
												"type": "Expression"
											},
											"EntityStageID": {
												"value": "@item().EntityStageID",
												"type": "Expression"
											},
											"ProcessID": {
												"value": "@item().ProcessID",
												"type": "Expression"
											},
											"ProcessSubType": {
												"value": "@item().ProcessSubType",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					},
					{
						"name": "Finalise Parent Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Run Child Processes",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FinaliseProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@activity('Initiate Parent Process').output.firstRow.ParentProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail Parent Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Run Child Processes",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FailProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@activity('Initiate Parent Process').output.firstRow.ParentProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Area": {
						"type": "string"
					},
					"Domain": {
						"type": "string"
					}
				},
				"folder": {
					"name": "3 - NewEnrichToCurated"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:40:20Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/DS_AnalyticsHub_DYN')]",
				"[concat(variables('workspaceId'), '/linkedServices/LS_SQL_AnalyticsHub')]",
				"[concat(variables('workspaceId'), '/pipelines/Clone_B2E_Single')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/E2C_Single')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Start Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[StartProcess]",
							"storedProcedureParameters": {
								"ADFExecution": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Finalise Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Run Enrichment Notebook",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FinaliseProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Run Enrichment Notebook",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FailProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Log Process Throughput",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Finalise Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[LogThroughput]",
							"storedProcedureParameters": {
								"CountName": {
									"value": "rowsUpserted",
									"type": "String"
								},
								"CountValue": {
									"value": {
										"value": "@activity('Run Enrichment Notebook').Output.runOutput.rowCount",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Run Enrichment Notebook",
						"type": "DatabricksNotebook",
						"dependsOn": [
							{
								"activity": "Start Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebookPath": {
								"value": "/Hydr8 Framework/Enrichment/@{pipeline().parameters.ProcessSubType}",
								"type": "Expression"
							},
							"baseParameters": {
								"entityStageId": {
									"value": "@string(pipeline().parameters.EntityStageID)",
									"type": "Expression"
								},
								"stageName": {
									"value": "@pipeline().parameters.StageName",
									"type": "Expression"
								},
								"processSubType": {
									"value": "@pipeline().parameters.ProcessSubType",
									"type": "Expression"
								},
								"processId": {
									"value": "@string(pipeline().parameters.ProcessID)",
									"type": "Expression"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LB_DBX_EngineeringSml",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Add Dependencies to Queue",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Finalise Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[InitiateDependency]",
							"storedProcedureParameters": {
								"EntityStageID": {
									"value": {
										"value": "@pipeline().parameters.EntityStageID",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"MultiLine": {
									"value": "False",
									"type": "Boolean"
								},
								"SlicePath": {
									"value": "",
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"StageName": {
						"type": "string"
					},
					"EntityStageID": {
						"type": "int"
					},
					"ProcessID": {
						"type": "int"
					},
					"ProcessSubType": {
						"type": "string"
					}
				},
				"folder": {
					"name": "3 - NewEnrichToCurated"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:35:30Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_SQL_AnalyticsHub')]",
				"[concat(variables('workspaceId'), '/linkedServices/LB_DBX_EngineeringSml')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/EX_SourceToRaw_Parent')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Initiate Parent Process",
						"description": "description Monday",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[Process].[InitiateParentLoad]",
								"storedProcedureParameters": {
									"ADFExecution": {
										"type": "String",
										"value": {
											"value": "@pipeline().RunId",
											"type": "Expression"
										}
									},
									"EntityStageID": {
										"type": "Int32",
										"value": null
									},
									"ParentProcessID": {
										"type": "Int32",
										"value": null
									},
									"ProcessFilter": {
										"type": "String",
										"value": "%"
									},
									"Stage": {
										"type": "String",
										"value": "Raw"
									},
									"Area": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.Area",
											"type": "Expression"
										}
									}
								},
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_AnalyticsHub_DYN",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Get Entities to Copy",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Initiate Parent Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[Process].[GetChildProcesses]",
								"storedProcedureParameters": {
									"ParentProcessID": {
										"type": "Int32",
										"value": {
											"value": "@activity('Initiate Parent Process').output.firstRow.ParentProcessID",
											"type": "Expression"
										}
									}
								},
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_AnalyticsHub_DYN",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Run Child Processes",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Get Entities to Copy",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get Entities to Copy').output.value",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Choose Pipeline Based on Source",
									"type": "Switch",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"on": {
											"value": "@item().FileFormat",
											"type": "Expression"
										},
										"cases": [
											{
												"value": "CSV",
												"activities": [
													{
														"name": "Run Copy Pipeline CSV",
														"type": "ExecutePipeline",
														"dependsOn": [],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "EX_SourceToRaw_Single_Table_BKUP",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"TableName": {
																	"value": "@item().EntityName",
																	"type": "Expression"
																},
																"Zone": {
																	"value": "@item().StageName",
																	"type": "Expression"
																},
																"Year": {
																	"value": "@item().Year",
																	"type": "Expression"
																},
																"Month": {
																	"value": "@item().Month",
																	"type": "Expression"
																},
																"Day": {
																	"value": "@item().Day",
																	"type": "Expression"
																},
																"Domain": {
																	"value": "@item().Domain",
																	"type": "Expression"
																},
																"Classification": {
																	"value": "@item().Classification",
																	"type": "Expression"
																},
																"EntityStageID": {
																	"value": "@item().EntityStageID",
																	"type": "Expression"
																},
																"ProcessID": {
																	"value": "@item().ProcessID",
																	"type": "Expression"
																},
																"Version": {
																	"value": "@item().Version",
																	"type": "Expression"
																},
																"SlicePath": {
																	"value": "@item().SlicePath",
																	"type": "Expression"
																},
																"Time": {
																	"value": "@item().Time",
																	"type": "Expression"
																},
																"FileFormat": {
																	"value": "@item().FileFormat",
																	"type": "Expression"
																},
																"Area": {
																	"value": "@item().Area",
																	"type": "Expression"
																}
															}
														}
													}
												]
											},
											{
												"value": "CB",
												"activities": [
													{
														"name": "Run Copy Pipeline 4 Bulk CB",
														"type": "ExecutePipeline",
														"dependsOn": [],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "EX_SourceToRaw_Single_CB",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"TableName": {
																	"value": "@item().EntityName",
																	"type": "Expression"
																},
																"Zone": {
																	"value": "@item().StageName",
																	"type": "Expression"
																},
																"Year": {
																	"value": "@item().Year",
																	"type": "Expression"
																},
																"Month": {
																	"value": "@item().Month",
																	"type": "Expression"
																},
																"Day": {
																	"value": "@item().Day",
																	"type": "Expression"
																},
																"Area": {
																	"value": "@item().Area",
																	"type": "Expression"
																},
																"Domain": {
																	"value": "@item().Domain",
																	"type": "Expression"
																},
																"Classification": {
																	"value": "@item().Classification",
																	"type": "Expression"
																},
																"EntityStageID": {
																	"value": "@item().EntityStageID",
																	"type": "Expression"
																},
																"ProcessID": {
																	"value": "@item().ProcessID",
																	"type": "Expression"
																},
																"Version": {
																	"value": "@item().Version",
																	"type": "Expression"
																},
																"SlicePath": {
																	"value": "@item().SlicePath",
																	"type": "Expression"
																},
																"Time": {
																	"value": "@item().Time",
																	"type": "Expression"
																},
																"Path": {
																	"value": "@item().Path",
																	"type": "Expression"
																},
																"Config": {
																	"value": "@json(item().Config)",
																	"type": "Expression"
																},
																"PathRoute": {
																	"value": "@item().PathRoute",
																	"type": "Expression"
																}
															}
														}
													}
												]
											},
											{
												"value": "DD",
												"activities": [
													{
														"name": "Run Copy Pipeline Duedilv1",
														"type": "ExecutePipeline",
														"dependsOn": [],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "EX_SourceToRaw_Single_CB_DueDilv1",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"TableName": {
																	"value": "@item().EntityName",
																	"type": "Expression"
																},
																"Zone": {
																	"value": "@item().StageName",
																	"type": "Expression"
																},
																"Year": {
																	"value": "@item().Year",
																	"type": "Expression"
																},
																"Month": {
																	"value": "@item().Month",
																	"type": "Expression"
																},
																"Day": {
																	"value": "@item().Day",
																	"type": "Expression"
																},
																"Area": {
																	"value": "@item().Area",
																	"type": "Expression"
																},
																"Domain": {
																	"value": "@item().Domain",
																	"type": "Expression"
																},
																"Classification": {
																	"value": "@item().Classification",
																	"type": "Expression"
																},
																"EntityStageID": {
																	"value": "@item().EntityStageID",
																	"type": "Expression"
																},
																"ProcessID": {
																	"value": "@item().ProcessID",
																	"type": "Expression"
																},
																"Version": {
																	"value": "@item().Version",
																	"type": "Expression"
																},
																"SlicePath": {
																	"value": "@item().SlicePath",
																	"type": "Expression"
																},
																"Time": {
																	"value": "@item().Time",
																	"type": "Expression"
																},
																"Path": {
																	"value": "@item().Path",
																	"type": "Expression"
																},
																"Config": {
																	"value": "@json(item().Config)",
																	"type": "Expression"
																},
																"PathRoute": {
																	"value": "@item().PathRoute",
																	"type": "Expression"
																}
															}
														}
													}
												]
											},
											{
												"value": "JSON",
												"activities": [
													{
														"name": "Run Copy Pipeline JSON",
														"type": "ExecutePipeline",
														"dependsOn": [],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "EX_SourceToRaw_Single_JSON",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"TableName": {
																	"value": "@item().EntityName",
																	"type": "Expression"
																},
																"Zone": {
																	"value": "@item().StageName",
																	"type": "Expression"
																},
																"Year": {
																	"value": "@item().Year",
																	"type": "Expression"
																},
																"Month": {
																	"value": "@item().Month",
																	"type": "Expression"
																},
																"Day": {
																	"value": "@item().Day",
																	"type": "Expression"
																},
																"Area": {
																	"value": "@item().Area",
																	"type": "Expression"
																},
																"Domain": {
																	"value": "@item().Domain",
																	"type": "Expression"
																},
																"Classification": {
																	"value": "@item().Classification",
																	"type": "Expression"
																},
																"EntityStageID": {
																	"value": "@item().EntityStageID",
																	"type": "Expression"
																},
																"ProcessID": {
																	"value": "@item().ProcessID",
																	"type": "Expression"
																},
																"Version": {
																	"value": "@item().Version",
																	"type": "Expression"
																},
																"SlicePath": {
																	"value": "@item().SlicePath",
																	"type": "Expression"
																},
																"Time": {
																	"value": "@item().Time",
																	"type": "Expression"
																},
																"FileFormat": {
																	"value": "@item().FileFormat",
																	"type": "Expression"
																},
																"Path": {
																	"value": "@item().Path",
																	"type": "Expression"
																},
																"Config": {
																	"value": "@json(item().Config)",
																	"type": "Expression"
																},
																"PathRoute": {
																	"value": "@item().PathRoute",
																	"type": "Expression"
																}
															}
														}
													}
												]
											},
											{
												"value": "SQL",
												"activities": [
													{
														"name": "Run Copy Pipeline CSV_Tablev1",
														"type": "ExecutePipeline",
														"dependsOn": [],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "EX_SourceToRaw_Single_Table_OCW",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"TableName": {
																	"value": "@item().EntityName",
																	"type": "Expression"
																},
																"Zone": {
																	"value": "@item().StageName",
																	"type": "Expression"
																},
																"Year": {
																	"value": "@item().Year",
																	"type": "Expression"
																},
																"Month": {
																	"value": "@item().Month",
																	"type": "Expression"
																},
																"Day": {
																	"value": "@item().Day",
																	"type": "Expression"
																},
																"Domain": {
																	"value": "@item().Domain",
																	"type": "Expression"
																},
																"Classification": {
																	"value": "@item().Classification",
																	"type": "Expression"
																},
																"EntityStageID": {
																	"value": "@item().EntityStageID",
																	"type": "Expression"
																},
																"ProcessID": {
																	"value": "@item().ProcessID",
																	"type": "Expression"
																},
																"Version": {
																	"value": "@item().Version",
																	"type": "Expression"
																},
																"SlicePath": {
																	"value": "@item().SlicePath",
																	"type": "Expression"
																},
																"Time": {
																	"value": "@item().Time",
																	"type": "Expression"
																},
																"FileFormat": {
																	"value": "@item().FileFormat",
																	"type": "Expression"
																},
																"Area": {
																	"value": "@item().Area",
																	"type": "Expression"
																}
															}
														}
													}
												]
											},
											{
												"value": "SPO",
												"activities": [
													{
														"name": "Run Copy Pipeline CSV_Table_SPOV4",
														"type": "ExecutePipeline",
														"dependsOn": [],
														"userProperties": [],
														"typeProperties": {
															"pipeline": {
																"referenceName": "EX_SourceToRaw_Single_Table_SPA",
																"type": "PipelineReference"
															},
															"waitOnCompletion": true,
															"parameters": {
																"TableName": {
																	"value": "@item().EntityName",
																	"type": "Expression"
																},
																"Zone": {
																	"value": "@item().StageName",
																	"type": "Expression"
																},
																"Year": {
																	"value": "@item().Year",
																	"type": "Expression"
																},
																"Month": {
																	"value": "@item().Month",
																	"type": "Expression"
																},
																"Day": {
																	"value": "@item().Day",
																	"type": "Expression"
																},
																"Domain": {
																	"value": "@item().Domain",
																	"type": "Expression"
																},
																"Classification": {
																	"value": "@item().Classification",
																	"type": "Expression"
																},
																"EntityStageID": {
																	"value": "@item().EntityStageID",
																	"type": "Expression"
																},
																"ProcessID": {
																	"value": "@item().ProcessID",
																	"type": "Expression"
																},
																"Version": {
																	"value": "@item().Version",
																	"type": "Expression"
																},
																"SlicePath": {
																	"value": "@item().SlicePath",
																	"type": "Expression"
																},
																"Time": {
																	"value": "@item().Time",
																	"type": "Expression"
																},
																"FileFormat": {
																	"value": "@item().FileFormat",
																	"type": "Expression"
																},
																"Area": {
																	"value": "@item().Area",
																	"type": "Expression"
																}
															}
														}
													}
												]
											}
										],
										"defaultActivities": [
											{
												"name": "Run Copy Pipeline File",
												"type": "ExecutePipeline",
												"dependsOn": [],
												"userProperties": [],
												"typeProperties": {
													"pipeline": {
														"referenceName": "EX_SourceToRaw_Single_CSV",
														"type": "PipelineReference"
													},
													"waitOnCompletion": true,
													"parameters": {
														"TableName": {
															"value": "@item().EntityName",
															"type": "Expression"
														},
														"Zone": {
															"value": "@item().StageName",
															"type": "Expression"
														},
														"Year": {
															"value": "@item().Year",
															"type": "Expression"
														},
														"Month": {
															"value": "@item().Month",
															"type": "Expression"
														},
														"Day": {
															"value": "@item().Day",
															"type": "Expression"
														},
														"Area": {
															"value": "@item().Area",
															"type": "Expression"
														},
														"Domain": {
															"value": "@item().Domain",
															"type": "Expression"
														},
														"Classification": {
															"value": "@item().Classification",
															"type": "Expression"
														},
														"EntityStageID": {
															"value": "@item().EntityStageID",
															"type": "Expression"
														},
														"ProcessID": {
															"value": "@item().ProcessID",
															"type": "Expression"
														},
														"Version": {
															"value": "@item().Version",
															"type": "Expression"
														},
														"SlicePath": {
															"value": "@item().SlicePath",
															"type": "Expression"
														},
														"Time": {
															"value": "@item().Time",
															"type": "Expression"
														},
														"FileFormat": {
															"value": "@item().FileFormat",
															"type": "Expression"
														},
														"Path": {
															"value": "@item().Path",
															"type": "Expression"
														},
														"Config": {
															"value": "@json(item().Config)",
															"type": "Expression"
														},
														"PathRoute": {
															"value": "@item().PathRoute",
															"type": "Expression"
														}
													}
												}
											}
										]
									}
								}
							]
						}
					},
					{
						"name": "Finalise Parent Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Run Child Processes",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FinaliseProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@activity('Initiate Parent Process').output.firstRow.ParentProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail Parent Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Run Child Processes",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FailProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@activity('Initiate Parent Process').output.firstRow.ParentProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"SliceDate": {
						"type": "string"
					},
					"Area": {
						"type": "string"
					},
					"Domain": {
						"type": "string"
					}
				},
				"folder": {
					"name": "0 - Source2Raw/Montagu"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:44:30Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/DS_AnalyticsHub_DYN')]",
				"[concat(variables('workspaceId'), '/linkedServices/LS_SQL_AnalyticsHub')]",
				"[concat(variables('workspaceId'), '/pipelines/EX_SourceToRaw_Single_CSV')]",
				"[concat(variables('workspaceId'), '/pipelines/EX_SourceToRaw_Single_Table_BKUP')]",
				"[concat(variables('workspaceId'), '/pipelines/EX_SourceToRaw_Single_CB')]",
				"[concat(variables('workspaceId'), '/pipelines/EX_SourceToRaw_Single_CB_DueDilv1')]",
				"[concat(variables('workspaceId'), '/pipelines/EX_SourceToRaw_Single_JSON')]",
				"[concat(variables('workspaceId'), '/pipelines/EX_SourceToRaw_Single_Table_OCW')]",
				"[concat(variables('workspaceId'), '/pipelines/EX_SourceToRaw_Single_Table_SPA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/EX_SourceToRaw_Single_CB')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Start Process",
						"description": "test",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[StartProcess]",
							"storedProcedureParameters": {
								"ADFExecution": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set vSetFileMask",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Start Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "FilenameMask",
							"value": {
								"value": "@if(greater(indexof(string(pipeline().parameters.Config),'FilenameMask'),0),pipeline().parameters.Config.FilenameMask,'')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SetRecursiveFlag",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Start Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "RecursiveFlag",
							"value": {
								"value": "@if(greater(indexof(string(pipeline().parameters.Config),'RecursiveFlag'),0),pipeline().parameters.Config.RecursiveFlag,'')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "GET Crunchbase Bulk Import",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set vSetFileMask",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "SetRecursiveFlag",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "BinarySource",
								"storeSettings": {
									"type": "HttpReadSettings",
									"requestMethod": "GET"
								},
								"formatSettings": {
									"type": "BinaryReadSettings",
									"compressionProperties": {
										"type": "TarGZipReadSettings",
										"preserveCompressionFileNameAsFolder": false
									}
								}
							},
							"sink": {
								"type": "BinarySink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings",
									"copyBehavior": "PreserveHierarchy"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "crunchbasesourceDS",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_BLOB_Landing_DYN_BINARY",
								"type": "DatasetReference",
								"parameters": {
									"Path": {
										"value": "@pipeline().parameters.Path",
										"type": "Expression"
									},
									"Container": {
										"value": "@pipeline().parameters.PathRoute",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy File to Lake",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "GET Crunchbase Bulk Import",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "BinarySource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": {
										"value": "@if(equals(variables('RecursiveFlag'),'1'), 1, 0)",
										"type": "Expression"
									},
									"wildcardFileName": {
										"value": "@if(empty(variables('FilenameMask')), concat('*.',pipeline().parameters.FileFormat), concat(variables('FilenameMask'),toLower(pipeline().parameters.FileFormat)))",
										"type": "Expression"
									},
									"deleteFilesAfterCompletion": false
								},
								"formatSettings": {
									"type": "BinaryReadSettings"
								}
							},
							"sink": {
								"type": "BinarySink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "DS_BLOB_Landing_DYN_BINARY",
								"type": "DatasetReference",
								"parameters": {
									"Path": {
										"value": "@pipeline().parameters.Path",
										"type": "Expression"
									},
									"Container": {
										"value": "@pipeline().parameters.PathRoute",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_ALDS_RAW_BINARY",
								"type": "DatasetReference",
								"parameters": {
									"Directory": {
										"value": "@{pipeline().parameters.Zone}/@{pipeline().parameters.Classification}/@{pipeline().parameters.Area}/@{pipeline().parameters.Domain}/@{pipeline().parameters.TableName}/@{pipeline().parameters.Version}/Year=@{pipeline().parameters.Year}/Month=@{pipeline().parameters.Month}/Day=@{pipeline().parameters.Day}/Time=@{pipeline().parameters.Time}",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Log Process Throughput",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy File to Lake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[LogThroughput]",
							"storedProcedureParameters": {
								"CountName": {
									"value": "rowsCopied",
									"type": "String"
								},
								"CountValue": {
									"value": {
										"value": "@activity('Copy File to Lake').output.filesRead",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy File to Lake",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FailProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Finalise Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Log Process Throughput",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FinaliseProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail Process From Log Failure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Log Process Throughput",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FailProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Add Dependencies to Queue",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Finalise Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[InitiateDependency]",
							"storedProcedureParameters": {
								"EntityStageID": {
									"value": {
										"value": "@pipeline().parameters.EntityStageID",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"SlicePath": {
									"value": {
										"value": "@concat('Year=',pipeline().parameters.Year,'/Month=',pipeline().parameters.Month,'/Day=',pipeline().parameters.Day,'/Time=',pipeline().parameters.Time)",
										"type": "Expression"
									},
									"type": "String"
								},
								"MultiLine": {
									"value": "0"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"TableName": {
						"type": "string"
					},
					"Zone": {
						"type": "string"
					},
					"Year": {
						"type": "string"
					},
					"Month": {
						"type": "string"
					},
					"Day": {
						"type": "string"
					},
					"Area": {
						"type": "string"
					},
					"Domain": {
						"type": "string"
					},
					"Classification": {
						"type": "string"
					},
					"EntityStageID": {
						"type": "int"
					},
					"ProcessID": {
						"type": "int"
					},
					"Version": {
						"type": "string"
					},
					"SlicePath": {
						"type": "string"
					},
					"Time": {
						"type": "string"
					},
					"FileFormat": {
						"type": "string",
						"defaultValue": "csv"
					},
					"Path": {
						"type": "string"
					},
					"Config": {
						"type": "object"
					},
					"PathRoute": {
						"type": "string"
					}
				},
				"variables": {
					"FilenameMask": {
						"type": "String"
					},
					"RecursiveFlag": {
						"type": "String"
					},
					"UnzipFlag": {
						"type": "String"
					}
				},
				"folder": {
					"name": "0 - Source2Raw/Montagu"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:40:24Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_SQL_AnalyticsHub')]",
				"[concat(variables('workspaceId'), '/datasets/crunchbasesourceDS')]",
				"[concat(variables('workspaceId'), '/datasets/DS_BLOB_Landing_DYN_BINARY')]",
				"[concat(variables('workspaceId'), '/datasets/DS_ALDS_RAW_BINARY')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/EX_SourceToRaw_Single_CB_DueDilv1')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Start Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[StartProcess]",
							"storedProcedureParameters": {
								"ADFExecution": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set vSetFileMask",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Start Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "FilenameMask",
							"value": {
								"value": "@if(greater(indexof(string(pipeline().parameters.Config),'FilenameMask'),0),pipeline().parameters.Config.FilenameMask,'')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SetRecursiveFlag",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Start Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "RecursiveFlag",
							"value": {
								"value": "@if(greater(indexof(string(pipeline().parameters.Config),'RecursiveFlag'),0),pipeline().parameters.Config.RecursiveFlag,'')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy File to Lake",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "BinarySource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": {
										"value": "@if(equals(variables('RecursiveFlag'),'1'), 1, 0)",
										"type": "Expression"
									},
									"wildcardFileName": {
										"value": "@if(empty(variables('FilenameMask')), concat('*.',pipeline().parameters.FileFormat), concat(variables('FilenameMask'),toLower(pipeline().parameters.FileFormat)))",
										"type": "Expression"
									},
									"deleteFilesAfterCompletion": false
								},
								"formatSettings": {
									"type": "BinaryReadSettings"
								}
							},
							"sink": {
								"type": "BinarySink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "DS_BLOB_Landing_DYN_BINARY",
								"type": "DatasetReference",
								"parameters": {
									"Path": {
										"value": "@pipeline().parameters.Path",
										"type": "Expression"
									},
									"Container": {
										"value": "@pipeline().parameters.PathRoute",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_ALDS_RAW_BINARY",
								"type": "DatasetReference",
								"parameters": {
									"Directory": {
										"value": "@{pipeline().parameters.Zone}/@{pipeline().parameters.Classification}/@{pipeline().parameters.Area}/@{pipeline().parameters.Domain}/@{pipeline().parameters.TableName}/@{pipeline().parameters.Version}/Year=@{pipeline().parameters.Year}/Month=@{pipeline().parameters.Month}/Day=@{pipeline().parameters.Day}/Time=@{pipeline().parameters.Time}",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Log Process Throughput",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy File to Lake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[LogThroughput]",
							"storedProcedureParameters": {
								"CountName": {
									"value": "rowsCopied",
									"type": "String"
								},
								"CountValue": {
									"value": {
										"value": "@activity('Copy File to Lake').output.filesRead",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy File to Lake",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FailProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Finalise Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Log Process Throughput",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FinaliseProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail Process From Log Failure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Log Process Throughput",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FailProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Add Dependencies to Queue",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Finalise Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[InitiateDependency]",
							"storedProcedureParameters": {
								"EntityStageID": {
									"value": {
										"value": "@pipeline().parameters.EntityStageID",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"SlicePath": {
									"value": {
										"value": "@concat('Year=',pipeline().parameters.Year,'/Month=',pipeline().parameters.Month,'/Day=',pipeline().parameters.Day,'/Time=',pipeline().parameters.Time)",
										"type": "Expression"
									},
									"type": "String"
								},
								"MultiLine": {
									"value": "0"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "CompanyId Lookup",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set vSetFileMask",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "SetRecursiveFlag",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"dataset": {
								"referenceName": "CompanyConfigCSV",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "CompanyId Lookup",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('CompanyId Lookup').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Copy dueREST to ADLS",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "RestSource",
											"httpRequestTimeout": "00:01:40",
											"requestInterval": "00.00:00:00.010",
											"requestMethod": "GET",
											"paginationRules": {
												"supportRFC5988": "true"
											}
										},
										"sink": {
											"type": "JsonSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "JsonWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "CompanyIdsRest",
											"type": "DatasetReference",
											"parameters": {
												"companyId": {
													"value": "@item().companyId",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "jsonCompanyId",
											"type": "DatasetReference",
											"parameters": {
												"companyId": {
													"value": "@item().companyId",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"TableName": {
						"type": "string"
					},
					"Zone": {
						"type": "string"
					},
					"Year": {
						"type": "string"
					},
					"Month": {
						"type": "string"
					},
					"Day": {
						"type": "string"
					},
					"Area": {
						"type": "string"
					},
					"Domain": {
						"type": "string"
					},
					"Classification": {
						"type": "string"
					},
					"EntityStageID": {
						"type": "int"
					},
					"ProcessID": {
						"type": "int"
					},
					"Version": {
						"type": "string"
					},
					"SlicePath": {
						"type": "string"
					},
					"Time": {
						"type": "string"
					},
					"FileFormat": {
						"type": "string",
						"defaultValue": "json"
					},
					"Path": {
						"type": "string"
					},
					"Config": {
						"type": "object"
					},
					"PathRoute": {
						"type": "string"
					}
				},
				"variables": {
					"FilenameMask": {
						"type": "String"
					},
					"RecursiveFlag": {
						"type": "String"
					},
					"UnzipFlag": {
						"type": "String"
					}
				},
				"folder": {
					"name": "0 - Source2Raw/Montagu"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:40:29Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_SQL_AnalyticsHub')]",
				"[concat(variables('workspaceId'), '/datasets/DS_BLOB_Landing_DYN_BINARY')]",
				"[concat(variables('workspaceId'), '/datasets/DS_ALDS_RAW_BINARY')]",
				"[concat(variables('workspaceId'), '/datasets/CompanyConfigCSV')]",
				"[concat(variables('workspaceId'), '/datasets/CompanyIdsRest')]",
				"[concat(variables('workspaceId'), '/datasets/jsonCompanyId')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/EX_SourceToRaw_Single_CSV')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Start Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[StartProcess]",
							"storedProcedureParameters": {
								"ADFExecution": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set vSetFileMask",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Start Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "FilenameMask",
							"value": {
								"value": "@if(greater(indexof(string(pipeline().parameters.Config),'FilenameMask'),0),pipeline().parameters.Config.FilenameMask,'')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SetRecursiveFlag",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Start Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "RecursiveFlag",
							"value": {
								"value": "@if(greater(indexof(string(pipeline().parameters.Config),'RecursiveFlag'),0),pipeline().parameters.Config.RecursiveFlag,'')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy File to Archive BLOB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set vSetFileMask",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "SetRecursiveFlag",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "BinarySource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"wildcardFileName": {
										"value": "@if(empty(variables('FilenameMask')),\nconcat('*.',pipeline().parameters.FileFormat),\nconcat(variables('FilenameMask'),toLower(pipeline().parameters.FileFormat)))",
										"type": "Expression"
									},
									"deleteFilesAfterCompletion": false
								},
								"formatSettings": {
									"type": "BinaryReadSettings"
								}
							},
							"sink": {
								"type": "BinarySink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "DS_BLOB_Landing_DYN_BINARY",
								"type": "DatasetReference",
								"parameters": {
									"Path": {
										"value": "@pipeline().parameters.Path",
										"type": "Expression"
									},
									"Container": {
										"value": "@pipeline().parameters.PathRoute",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_BLOB_Landing_DYN_BINARY",
								"type": "DatasetReference",
								"parameters": {
									"Path": {
										"value": "@concat(pipeline().parameters.Path,'/Archive')",
										"type": "Expression"
									},
									"Container": {
										"value": "@pipeline().parameters.PathRoute",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy File to Lake",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy File to Archive BLOB",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "BinarySource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": {
										"value": "@if(equals(variables('RecursiveFlag'),'1'), 1, 0)",
										"type": "Expression"
									},
									"wildcardFileName": {
										"value": "@if(empty(variables('FilenameMask')), concat('*.',pipeline().parameters.FileFormat), concat(variables('FilenameMask'),toLower(pipeline().parameters.FileFormat)))",
										"type": "Expression"
									},
									"deleteFilesAfterCompletion": false
								},
								"formatSettings": {
									"type": "BinaryReadSettings"
								}
							},
							"sink": {
								"type": "BinarySink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "DS_BLOB_Landing_DYN_BINARY",
								"type": "DatasetReference",
								"parameters": {
									"Path": {
										"value": "@pipeline().parameters.Path",
										"type": "Expression"
									},
									"Container": {
										"value": "@pipeline().parameters.PathRoute",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_ALDS_RAW_BINARY",
								"type": "DatasetReference",
								"parameters": {
									"Directory": {
										"value": "@{pipeline().parameters.Zone}/@{pipeline().parameters.Classification}/@{pipeline().parameters.Area}/@{pipeline().parameters.Domain}/@{pipeline().parameters.TableName}/@{pipeline().parameters.Version}/Year=@{pipeline().parameters.Year}/Month=@{pipeline().parameters.Month}/Day=@{pipeline().parameters.Day}/Time=@{pipeline().parameters.Time}",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Log Process Throughput",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy File to Lake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[LogThroughput]",
							"storedProcedureParameters": {
								"CountName": {
									"value": "rowsCopied",
									"type": "String"
								},
								"CountValue": {
									"value": {
										"value": "@activity('Copy File to Lake').output.filesRead",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy File to Lake",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FailProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Finalise Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Log Process Throughput",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FinaliseProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail Process From Log Failure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Log Process Throughput",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FailProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Add Dependencies to Queue",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Finalise Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[InitiateDependency]",
							"storedProcedureParameters": {
								"EntityStageID": {
									"value": {
										"value": "@pipeline().parameters.EntityStageID",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"SlicePath": {
									"value": {
										"value": "@concat('Year=',pipeline().parameters.Year,'/Month=',pipeline().parameters.Month,'/Day=',pipeline().parameters.Day,'/Time=',pipeline().parameters.Time)",
										"type": "Expression"
									},
									"type": "String"
								},
								"MultiLine": {
									"value": "0"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"TableName": {
						"type": "string"
					},
					"Zone": {
						"type": "string"
					},
					"Year": {
						"type": "string"
					},
					"Month": {
						"type": "string"
					},
					"Day": {
						"type": "string"
					},
					"Area": {
						"type": "string"
					},
					"Domain": {
						"type": "string"
					},
					"Classification": {
						"type": "string"
					},
					"EntityStageID": {
						"type": "int"
					},
					"ProcessID": {
						"type": "int"
					},
					"Version": {
						"type": "string"
					},
					"SlicePath": {
						"type": "string"
					},
					"Time": {
						"type": "string"
					},
					"FileFormat": {
						"type": "string"
					},
					"Path": {
						"type": "string"
					},
					"Config": {
						"type": "object"
					},
					"PathRoute": {
						"type": "string"
					}
				},
				"variables": {
					"FilenameMask": {
						"type": "String"
					},
					"RecursiveFlag": {
						"type": "String"
					},
					"UnzipFlag": {
						"type": "String"
					}
				},
				"folder": {
					"name": "0 - Source2Raw/Montagu"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:40:33Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_SQL_AnalyticsHub')]",
				"[concat(variables('workspaceId'), '/datasets/DS_BLOB_Landing_DYN_BINARY')]",
				"[concat(variables('workspaceId'), '/datasets/DS_ALDS_RAW_BINARY')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/EX_SourceToRaw_Single_Delta')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Start Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[StartProcess]",
							"storedProcedureParameters": {
								"ADFExecution": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Finalise Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Start Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FinaliseProcess]",
							"storedProcedureParameters": {
								" ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Add Dependencies to Queue",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Finalise Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[InitiateDependency]",
							"storedProcedureParameters": {
								"EntityStageID": {
									"value": {
										"value": "@pipeline().parameters.EntityStageID",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"SlicePath": {
									"value": {
										"value": "@concat('Year=',pipeline().parameters.Year,'/Month=',pipeline().parameters.Month,'/Day=',pipeline().parameters.Day,'/Time=',pipeline().parameters.Time)",
										"type": "Expression"
									},
									"type": "String"
								},
								"MultiLine": {
									"value": "0"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"TableName": {
						"type": "string",
						"defaultValue": "CashSales"
					},
					"Zone": {
						"type": "string",
						"defaultValue": "RAW"
					},
					"Year": {
						"type": "string",
						"defaultValue": "2020"
					},
					"Month": {
						"type": "string",
						"defaultValue": "11"
					},
					"Day": {
						"type": "string",
						"defaultValue": "02"
					},
					"Area": {
						"type": "string",
						"defaultValue": "MuleSoft"
					},
					"Domain": {
						"type": "string",
						"defaultValue": "StarKis"
					},
					"Classification": {
						"type": "string",
						"defaultValue": "Internal"
					},
					"EntityStageID": {
						"type": "string",
						"defaultValue": "51"
					},
					"ProcessID": {
						"type": "string",
						"defaultValue": "999"
					},
					"Version": {
						"type": "string",
						"defaultValue": "1"
					},
					"SlicePath": {
						"type": "string"
					},
					"Time": {
						"type": "string",
						"defaultValue": "00:00"
					},
					"FileFormat": {
						"type": "string",
						"defaultValue": "CSV"
					},
					"Path": {
						"type": "string",
						"defaultValue": "import/starkis/UK"
					},
					"Config": {
						"type": "object"
					},
					"PathRoute": {
						"type": "string"
					}
				},
				"folder": {
					"name": "0 - Source2Raw/Montagu"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:25:35Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_SQL_AnalyticsHub')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/EX_SourceToRaw_Single_File_copy1')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Start Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[StartProcess]",
							"storedProcedureParameters": {
								"ADFExecution": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set vSetFileMask",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Start Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "FilenameMask",
							"value": {
								"value": "@if(greater(indexof(string(pipeline().parameters.Config),'FilenameMask'),0),pipeline().parameters.Config.FilenameMask,'')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SetRecursiveFlag",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Start Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "RecursiveFlag",
							"value": {
								"value": "@if(greater(indexof(string(pipeline().parameters.Config),'RecursiveFlag'),0),pipeline().parameters.Config.RecursiveFlag,'')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy File to Archive BLOB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set vSetFileMask",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "SetRecursiveFlag",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "BinarySource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"wildcardFileName": {
										"value": "@if(empty(variables('FilenameMask')),\nconcat('*.',pipeline().parameters.FileFormat),\nconcat(variables('FilenameMask'),toLower(pipeline().parameters.FileFormat)))",
										"type": "Expression"
									},
									"deleteFilesAfterCompletion": false
								},
								"formatSettings": {
									"type": "BinaryReadSettings"
								}
							},
							"sink": {
								"type": "BinarySink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "DS_BLOB_Landing_DYN_BINARY",
								"type": "DatasetReference",
								"parameters": {
									"Path": {
										"value": "@pipeline().parameters.Path",
										"type": "Expression"
									},
									"Container": {
										"value": "@pipeline().parameters.PathRoute",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_BLOB_Landing_DYN_BINARY",
								"type": "DatasetReference",
								"parameters": {
									"Path": {
										"value": "@pipeline().parameters.Path",
										"type": "Expression"
									},
									"Container": {
										"value": "@pipeline().parameters.PathRoute",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy File to Lake",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy File to Archive BLOB",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "BinarySource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": {
										"value": "@if(equals(variables('RecursiveFlag'),'1'), 1, 0)",
										"type": "Expression"
									},
									"wildcardFileName": {
										"value": "@if(empty(variables('FilenameMask')), concat('*.',pipeline().parameters.FileFormat), concat(variables('FilenameMask'),toLower(pipeline().parameters.FileFormat)))",
										"type": "Expression"
									},
									"deleteFilesAfterCompletion": false
								},
								"formatSettings": {
									"type": "BinaryReadSettings"
								}
							},
							"sink": {
								"type": "BinarySink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "DS_BLOB_Landing_DYN_BINARY",
								"type": "DatasetReference",
								"parameters": {
									"Path": {
										"value": "@pipeline().parameters.Path",
										"type": "Expression"
									},
									"Container": {
										"value": "@pipeline().parameters.PathRoute",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_ALDS_RAW_BINARY",
								"type": "DatasetReference",
								"parameters": {
									"Directory": {
										"value": "@{pipeline().parameters.Zone}/@{pipeline().parameters.Classification}/@{pipeline().parameters.Area}/@{pipeline().parameters.Domain}/@{pipeline().parameters.TableName}/@{pipeline().parameters.Version}/Year=@{pipeline().parameters.Year}/Month=@{pipeline().parameters.Month}/Day=@{pipeline().parameters.Day}/Time=@{pipeline().parameters.Time}",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Log Process Throughput",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy File to Lake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[LogThroughput]",
							"storedProcedureParameters": {
								"CountName": {
									"value": "rowsCopied",
									"type": "String"
								},
								"CountValue": {
									"value": {
										"value": "@activity('Copy File to Lake').output.filesRead",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy File to Lake",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FailProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Finalise Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Log Process Throughput",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FinaliseProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail Process From Log Failure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Log Process Throughput",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FailProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Add Dependencies to Queue",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Finalise Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[InitiateDependency]",
							"storedProcedureParameters": {
								"EntityStageID": {
									"value": {
										"value": "@pipeline().parameters.EntityStageID",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"SlicePath": {
									"value": {
										"value": "@concat('Year=',pipeline().parameters.Year,'/Month=',pipeline().parameters.Month,'/Day=',pipeline().parameters.Day,'/Time=',pipeline().parameters.Time)",
										"type": "Expression"
									},
									"type": "String"
								},
								"MultiLine": {
									"value": "0"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"TableName": {
						"type": "string"
					},
					"Zone": {
						"type": "string"
					},
					"Year": {
						"type": "string"
					},
					"Month": {
						"type": "string"
					},
					"Day": {
						"type": "string"
					},
					"Area": {
						"type": "string"
					},
					"Domain": {
						"type": "string"
					},
					"Classification": {
						"type": "string"
					},
					"EntityStageID": {
						"type": "int"
					},
					"ProcessID": {
						"type": "int"
					},
					"Version": {
						"type": "string"
					},
					"SlicePath": {
						"type": "string"
					},
					"Time": {
						"type": "string"
					},
					"FileFormat": {
						"type": "string"
					},
					"Path": {
						"type": "string"
					},
					"Config": {
						"type": "object"
					},
					"PathRoute": {
						"type": "string"
					}
				},
				"variables": {
					"FilenameMask": {
						"type": "String"
					},
					"RecursiveFlag": {
						"type": "String"
					},
					"UnzipFlag": {
						"type": "String"
					}
				},
				"folder": {
					"name": "0 - Source2Raw/Montagu"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:40:36Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_SQL_AnalyticsHub')]",
				"[concat(variables('workspaceId'), '/datasets/DS_BLOB_Landing_DYN_BINARY')]",
				"[concat(variables('workspaceId'), '/datasets/DS_ALDS_RAW_BINARY')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/EX_SourceToRaw_Single_JSON')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Start Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[StartProcess]",
							"storedProcedureParameters": {
								"ADFExecution": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set vSetFileMask",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Start Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "FilenameMask",
							"value": {
								"value": "@if(greater(indexof(string(pipeline().parameters.Config),'FilenameMask'),0),pipeline().parameters.Config.FilenameMask,'')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SetRecursiveFlag",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Start Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "RecursiveFlag",
							"value": {
								"value": "@if(greater(indexof(string(pipeline().parameters.Config),'RecursiveFlag'),0),pipeline().parameters.Config.RecursiveFlag,'')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy File to Archive BLOB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set vSetFileMask",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "SetRecursiveFlag",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "BinarySource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"wildcardFileName": {
										"value": "@if(empty(variables('FilenameMask')),\nconcat('*.',pipeline().parameters.FileFormat),\nconcat(variables('FilenameMask'),toLower(pipeline().parameters.FileFormat)))",
										"type": "Expression"
									},
									"deleteFilesAfterCompletion": false
								},
								"formatSettings": {
									"type": "BinaryReadSettings"
								}
							},
							"sink": {
								"type": "BinarySink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "DS_BLOB_Landing_DYN_BINARY",
								"type": "DatasetReference",
								"parameters": {
									"Path": {
										"value": "@pipeline().parameters.Path",
										"type": "Expression"
									},
									"Container": {
										"value": "@pipeline().parameters.PathRoute",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_BLOB_Landing_DYN_BINARY",
								"type": "DatasetReference",
								"parameters": {
									"Path": {
										"value": "@concat(pipeline().parameters.Path,'/Archive')",
										"type": "Expression"
									},
									"Container": {
										"value": "@pipeline().parameters.PathRoute",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy File to Lake",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy File to Archive BLOB",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "BinarySource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": {
										"value": "@if(equals(variables('RecursiveFlag'),'1'), 1, 0)",
										"type": "Expression"
									},
									"wildcardFileName": {
										"value": "@if(empty(variables('FilenameMask')), concat('*.',pipeline().parameters.FileFormat), concat(variables('FilenameMask'),toLower(pipeline().parameters.FileFormat)))",
										"type": "Expression"
									},
									"deleteFilesAfterCompletion": false
								},
								"formatSettings": {
									"type": "BinaryReadSettings"
								}
							},
							"sink": {
								"type": "BinarySink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "DS_BLOB_Landing_DYN_BINARY",
								"type": "DatasetReference",
								"parameters": {
									"Path": {
										"value": "@pipeline().parameters.Path",
										"type": "Expression"
									},
									"Container": {
										"value": "@pipeline().parameters.PathRoute",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_ALDS_RAW_BINARY",
								"type": "DatasetReference",
								"parameters": {
									"Directory": {
										"value": "@{pipeline().parameters.Zone}/@{pipeline().parameters.Classification}/@{pipeline().parameters.Area}/@{pipeline().parameters.Domain}/@{pipeline().parameters.TableName}/@{pipeline().parameters.Version}/Year=@{pipeline().parameters.Year}/Month=@{pipeline().parameters.Month}/Day=@{pipeline().parameters.Day}/Time=@{pipeline().parameters.Time}",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Log Process Throughput",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy File to Lake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[LogThroughput]",
							"storedProcedureParameters": {
								"CountName": {
									"value": "rowsCopied",
									"type": "String"
								},
								"CountValue": {
									"value": {
										"value": "@activity('Copy File to Lake').output.filesRead",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy File to Lake",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FailProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Finalise Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Log Process Throughput",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FinaliseProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail Process From Log Failure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Log Process Throughput",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FailProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Add Dependencies to Queue",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Finalise Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[InitiateDependency]",
							"storedProcedureParameters": {
								"EntityStageID": {
									"value": {
										"value": "@pipeline().parameters.EntityStageID",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"SlicePath": {
									"value": {
										"value": "@concat('Year=',pipeline().parameters.Year,'/Month=',pipeline().parameters.Month,'/Day=',pipeline().parameters.Day,'/Time=',pipeline().parameters.Time)",
										"type": "Expression"
									},
									"type": "String"
								},
								"MultiLine": {
									"value": "0"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"TableName": {
						"type": "string"
					},
					"Zone": {
						"type": "string"
					},
					"Year": {
						"type": "string"
					},
					"Month": {
						"type": "string"
					},
					"Day": {
						"type": "string"
					},
					"Area": {
						"type": "string"
					},
					"Domain": {
						"type": "string"
					},
					"Classification": {
						"type": "string"
					},
					"EntityStageID": {
						"type": "int"
					},
					"ProcessID": {
						"type": "int"
					},
					"Version": {
						"type": "string"
					},
					"SlicePath": {
						"type": "string"
					},
					"Time": {
						"type": "string"
					},
					"FileFormat": {
						"type": "string"
					},
					"Path": {
						"type": "string"
					},
					"Config": {
						"type": "object"
					},
					"PathRoute": {
						"type": "string"
					}
				},
				"variables": {
					"FilenameMask": {
						"type": "String"
					},
					"RecursiveFlag": {
						"type": "String"
					},
					"UnzipFlag": {
						"type": "String"
					}
				},
				"folder": {
					"name": "0 - Source2Raw/Montagu"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:40:41Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_SQL_AnalyticsHub')]",
				"[concat(variables('workspaceId'), '/datasets/DS_BLOB_Landing_DYN_BINARY')]",
				"[concat(variables('workspaceId'), '/datasets/DS_ALDS_RAW_BINARY')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/EX_SourceToRaw_Single_Table_BKUP')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Copy Table to EnrDB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SQL_OptionSet_Script",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "@concat('SELECT * FROM ',pipeline().parameters.Domain,'.',pipeline().parameters.TableName)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"Id"
									]
								},
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_SQL_DYN",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "AzureSqlTable3",
								"type": "DatasetReference",
								"parameters": {
									"targettable": {
										"value": "@pipeline().parameters.TableName",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Start Process",
						"description": "Hello Today",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[StartProcess]",
							"storedProcedureParameters": {
								"ADFExecution": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SQL_OptionSet_Script",
						"type": "Script",
						"dependsOn": [
							{
								"activity": "Start Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "ServerLessSQL2",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "-- No duplicates\nUSE [dataverse_montagu_org5a2bcccf] --Specify the name of the database corresponding to your Synapse Link for Dataverse\n\n--=================================================================================================\n--PROVIDE INPUT PARAMETERS:\n--=================================================================================================\nDECLARE\n\t@EnrichedViewDatabase sysname, \n\t@EnrichedViewSchema sysname, \n\t@EnrichedColumnSuffix varchar(50), \t\n\t@LanguageCode varchar(10), \n\t@BaseTableSuffix varchar(50),\n\t@PreviewOnly bit, --Indicate whether to preview the SQL Script (without creating the views) = 1 ; Create views = 0;\n\t@CurrentDatabase sysname,\n\t@CurrentDatabaseSchema sysname\n\nSET @EnrichedViewDatabase = 'DataverseEnriched'\nSET @EnrichedViewSchema = 'dbo'\nSET @EnrichedColumnSuffix = 'code'\nSET @LanguageCode = 1033\nSET @BaseTableSuffix = ''\nSET @PreviewOnly = 0 \nSET @CurrentDatabase = 'dataverse_montagu_org5a2bcccf'\nSET @CurrentDatabaseSchema = 'dbo'\n\n--=================================================================================================\n-- Do not edit the script below this point\n--=================================================================================================\n\n\n\nDECLARE @ColumnMetadata nvarchar(MAX), @ColumnMetadataSQL nvarchar(MAX)\n\n--Define the SQL statement to retrieve column metadata from the Lake Database managed by Synapse Link for Dataverse\n--Results will be stored as a JSON document in a variable\nSET @ColumnMetadataSQL = 'SET @ColumnMetadataOUT = (\nSELECT TABLE_SCHEMA, \n\tTABLE_NAME, \n\tCOLUMN_NAME, \n\tORDINAL_POSITION, \n\tDATA_TYPE\nFROM INFORMATION_SCHEMA.COLUMNS \nWHERE TABLE_SCHEMA = ''dbo''\n\tAND TABLE_NAME NOT IN (''OptionsetMetadata'', ''GlobalOptionsetMetadata'',''StateMetadata'',''StatusMetadata'', ''TargetMetadata'')\n\tAND TABLE_NAME LIKE ''%' + @BaseTableSuffix + '''\nFOR JSON AUTO)'\nDECLARE @ParmDefinition NVARCHAR(MAX);  \nSET @ParmDefinition = N'@ColumnMetadataOUT NVARCHAR(MAX) OUTPUT';  \nEXECUTE sp_executesql @ColumnMetadataSQL, @ParmDefinition, @ColumnMetadataOUT=@ColumnMetadata OUTPUT;  \n\n--Declare a variable to store a SQL statement for creating enriched views\nDECLARE @SQL nvarchar(MAX) = ''\n\n; WITH CM AS (\n--Parse column metadata variable and construct a table based on its content\nSELECT JSON_VALUE(CM.value, '$.TABLE_SCHEMA') AS TableSchema,\n\t JSON_VALUE(CM.value, '$.TABLE_NAME') AS TableName,\n\t LEFT(JSON_VALUE(CM.value, '$.TABLE_NAME'), LEN(JSON_VALUE(CM.value, '$.TABLE_NAME'))-LEN(@BaseTableSuffix)) AS EntityName,\n\t JSON_VALUE(CM.value, '$.COLUMN_NAME') AS ColumnName,\n\t CAST(JSON_VALUE(CM.value, '$.ORDINAL_POSITION') AS INT) AS OrdinalPosition,\n\t JSON_VALUE(CM.value, '$.DATA_TYPE') AS DataType\nFROM OPENJSON (@ColumnMetadata) AS CM\n)\n\n, OSM AS (\n--Get Option Set Metadata\nSELECT DISTINCT \n\tEntityName, \n\tOptionSetName, \n\tQUOTENAME(EntityName + '_' + OptionSetName) AS Alias\nFROM dbo.[OptionsetMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, GOSM AS (\n--Get Global Option Set Metadata\nSELECT DISTINCT \n\tOptionSetName, \n\tQUOTENAME('Global_' + OptionSetName) AS Alias\nFROM dbo.[GlobalOptionsetMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, GOSMM AS (\n--Get Global Option Set Metadata\nSELECT DISTINCT \n\tOptionSetName, \n\tQUOTENAME('Global_Multiselect_' + OptionSetName) AS Alias\nFROM dbo.[GlobalOptionsetMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, StateM AS (\n--Get State Metadata\nSELECT DISTINCT \n\tEntityName, \n\tQUOTENAME(EntityName + '_State') AS Alias\nFROM dbo.[StateMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, StatusM AS (\n--Get Status Metadata\nSELECT DISTINCT \n\tEntityName,\n\tQUOTENAME(EntityName + '_Status') AS Alias\nFROM dbo.[StatusMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, SQLStatement AS (\n--Enumerate all lines in the source table and replace codes with labels where applicable\nSELECT CM.EntityName,\n\t--Before the first column of each table, construct a CREATE OR ALTER VIEW statement\n\tCASE WHEN CM.OrdinalPosition = 1\n\t\tTHEN 'CREATE OR ALTER VIEW ' + QUOTENAME(@EnrichedViewSchema) + '.' + CM.EntityName + '\n\t\tAS\n\t\tSELECT DISTINCT '\n\t\tELSE '\t,'\n\t\tEND\n\t--For each column, check if it needs to be replaced with a suitable localized label\n\t+ CASE \n\t\tWHEN OSM.OptionSetName IS NOT NULL THEN OSM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tWHEN GOSM.OptionSetName IS NOT NULL THEN GOSM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tWHEN GOSMM.OptionSetName IS NOT NULL THEN \n\t\t'isnull(\n\t\tcast((\n\t\tselect string_agg(Value, '';'')\n\t\tfrom\n\t\t(\n\t\tselect distinct [Option], Value\n\t\tfrom (\n\t\tselect cast(gosm.[Option] as varchar(max)) [Option], gosm.LocalizedLabel Value\n\t\tfrom '+@CurrentDatabase+'.'+@CurrentDatabaseSchema+'.GlobalOptionsetMetadata gosm\n\t\twhere gosm.OptionSetName = ''' + CM.ColumnName + '''\n\t\tand gosm.LocalizedLabelLanguageCode = ' + (cast(@LanguageCode as varchar(4))) +\n\t\t'and cast(gosm.[Option] as nvarchar(max)) in (\n\t\tSELECT [Value] FROM (\n\t\tSELECT cast(value as nvarchar(max)) as [Value] \n\t\tFROM STRING_SPLIT(' + '[Base].' + QUOTENAME(CM.ColumnName) + ', '';'')\n\t\t) t\n\t\tUNION\n\t\tSELECT ''Not-Valid-Value''\n\t\t)\n\t\t) t\n\t\t) t\n\t\t) as nvarchar(max)),\n\t\t' + '[Base].' + QUOTENAME(CM.ColumnName) + ') as ' + CM.ColumnName\n\t\tWHEN EOSM.OptionSetName IS NOT NULL THEN\n\t\t'isnull(\n\t\tcast((\n\t\tselect string_agg(Value, '';'')\n\t\tfrom\n\t\t(\n\t\tselect distinct [Option], Value\n\t\tfrom (\n\t\tselect cast(osm.[Option] as varchar(max)) [Option], osm.LocalizedLabel Value\n\t\tfrom '+@CurrentDatabase+'.'+@CurrentDatabaseSchema+'.OptionsetMetadata osm\n\t\twhere osm.OptionSetName = ''' + CM.ColumnName + '''\n\t\tand osm.EntityName = ''' + CM.EntityName + '''\n\t\tand osm.LocalizedLabelLanguageCode = ' + (cast(@LanguageCode as varchar(4))) +\n\t\t'and cast(osm.[Option] as nvarchar(max)) in (\n\t\tSELECT [Value] FROM (\n\t\tSELECT cast(value as nvarchar(max)) as [Value] \n\t\tFROM STRING_SPLIT(' + '[Base].' + QUOTENAME(CM.ColumnName) + ', '';'')\n\t\t) t\n\t\tUNION\n\t\tSELECT ''Not-Valid-Value''\n\t\t)\n\t\t) t\n\t\t) t\n\t\t) as nvarchar(max)),\n\t\t' + '[Base].' + QUOTENAME(CM.ColumnName) + ') as ' + CM.ColumnName\n\t\tWHEN StateM.EntityName IS NOT NULL THEN StateM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tWHEN StatusM.EntityName IS NOT NULL THEN StatusM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tELSE '[Base].' + QUOTENAME(CM.ColumnName)\n\t\tEND AS [SQLLine],\n\tCM.OrdinalPosition\nFROM CM \n\tLEFT JOIN OSM\n\t\tON CM.EntityName = OSM.EntityName\n\t\tAND CM.ColumnName = OSM.OptionSetName\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\tLEFT JOIN GOSM\n\t\tON CM.ColumnName = GOSM.OptionSetName\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\tLEFT JOIN GOSMM\n\t\tON CM.ColumnName = GOSMM.OptionSetName\n\t\tAND CM.DataType LIKE '%varchar%' --Only include columns with varchar data type that can potentially have multiselect values\n\tLEFT JOIN OSM EOSM\n\t\tON CM.ColumnName = EOSM.OptionSetName\n\t\tAND CM.EntityName = EOSM.EntityName\n\t\tAND CM.DataType LIKE '%varchar%' --Only include columns with varchar data type that can potentially have multiselect values\n\tLEFT JOIN StateM\n\t\tON CM.EntityName = StateM.EntityName\n\t\tAND CM.ColumnName = 'statecode'\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\tLEFT JOIN StatusM\n\t\tON CM.EntityName = StatusM.EntityName\n\t\tAND CM.ColumnName = 'statuscode'\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\nUNION ALL\n--Construct the first line of the FROM clause, referencing external tables created by Synapse Link for Dataverse\nSELECT DISTINCT\nCM.EntityName,\n'FROM ' + QUOTENAME(DB_NAME()) + '.' + QUOTENAME(CM.TableSchema) + '.' + QUOTENAME(CM.TableName) + ' AS Base' AS SQLLine,\n10000 AS OrdinalPosition\nFROM CM\n\nUNION ALL \n--Construct LEFT JOIN statements for each relevant OptionSetMetadata field\nSELECT DISTINCT OSM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[OptionSetMetadata] AS ' + OSM.Alias + ' \n\t\tON ' + OSM.Alias + '.EntityName = ''' + OSM.EntityName + ''' \n\t\tAND ' + OSM.Alias + '.OptionSetName = ''' +  OSM.OptionSetName + '''\n\t\tAND [Base].' + QUOTENAME(OSM.OptionSetName) + ' = ' + OSM.Alias + '.[Option]\n\t\tAND ' + OSM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n20000 AS OrdinalPosition\nFROM OSM\n\tJOIN CM\n\t\tON CM.EntityName = OSM.EntityName\n\t\tAND CM.ColumnName = OSM.OptionSetName\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL \n--Construct LEFT JOIN statements for each relevant GlobalOptionSetMetadata field\nSELECT DISTINCT CM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[GlobalOptionSetMetadata] AS ' + Alias + ' \n\t\tON ' + Alias + '.OptionSetName = ''' +  OptionSetName + '''\n\t\tAND [Base].' + QUOTENAME(OptionSetName) + ' = ' + Alias + '.[Option]\n\t\tAND ' + Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n30000 AS OrdinalPosition\nFROM GOSM\n\tJOIN CM\n\t\tON CM.ColumnName = GOSM.OptionSetName\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL \n--Construct LEFT JOIN statements for each relevant State Metadata field\nSELECT DISTINCT CM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[StateMetadata] AS ' + StateM.Alias + ' \n\t\tON ' + StateM.Alias + '.EntityName = ''' + StateM.EntityName + ''' \n\t\tAND [Base].statecode' + ' = ' + StateM.Alias + '.[State]\n\t\tAND ' + StateM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n40000 AS OrdinalPosition\nFROM StateM\n\tJOIN CM\n\t\tON CM.EntityName = StateM.EntityName\n\t\tAND CM.ColumnName = 'statecode'\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL\n--Construct LEFT JOIN statements for each relevant Status Metadata field\nSELECT DISTINCT CM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[StatusMetadata] AS ' + StatusM.Alias + ' \n\t\tON ' + StatusM.Alias + '.EntityName = ''' + StatusM.EntityName + ''' \n\t\tAND [Base].statuscode' + ' = ' + StatusM.Alias + '.[Status]\n\t\tAND ' + StatusM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n40000 AS OrdinalPosition\nFROM StatusM\n\tJOIN CM\n\t\tON CM.EntityName = StatusM.EntityName\n\t\tAND CM.ColumnName = 'statuscode'\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL\n--Add statement terminator\nSELECT DISTINCT\nEntityName,\n'; ' + CHAR(10) AS SQLLine,\n100000 AS OrdinalPosition\nFROM CM\n)\n\n--Construct individual statements to create views (1 view per row)\n--Since CREATE VIEW statement must be the first statement in a batch, assign each view definition to a variable \n--and use the EXEC(@variable) command to create view as part of its own, separate batch.\n, ViewDefinitions AS (\nSELECT 'DECLARE @' + EntityName + ' NVARCHAR(MAX) = ''\n\t' + REPLACE(STRING_AGG(CAST(SQLLine as varchar(MAX)), CHAR(10)) WITHIN GROUP (ORDER BY EntityName, OrdinalPosition, SQLLine), '''', '''''') + ''' ' + CHAR(10) + 'EXEC [' + @EnrichedViewDatabase + '].dbo.sp_executesql @' + EntityName + CHAR(10) AS ViewDefinition\nFROM SQLStatement\nGROUP BY EntityName\n)\n\n--Construct a comprehensive SQL statement to create all views\nSELECT @SQL = STRING_AGG(ViewDefinition, ';' + CHAR(10) + CHAR(10))\nFROM ViewDefinitions\n\n--Return a preview of the SQL Script to be generated or go ahead and create the views.\nIF @PreviewOnly = 1\nBEGIN\n\t--Return the final SQL statement\n\tSELECT '--================================================================================================='+ CHAR(10) +' ' + CHAR(10) AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '-- A preview of the script to generate enriched views is provided below.'  AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '-- No database objects have been created.' AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '-- Re-run this script with the @PreviewOnly parameter set to 0 to actually create the views.' AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '--================================================================================================='+ CHAR(10) +' ' + CHAR(10) AS [--SQL Statement]\n\tUNION ALL \n\tSELECT VALUE AS [--SQL Statement] FROM STRING_SPLIT(@SQL, CHAR(10))\nEND\nELSE\nBEGIN\n\t--Execute the SQL statement\n\tPRINT 'Beginning view creation'\n\t--PRINT @SQL\n\tEXEC sp_executesql @SQL\n\tPRINT 'Completed view creation'\nEND"
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"TableName": {
						"type": "string"
					},
					"Zone": {
						"type": "string",
						"defaultValue": "RAW"
					},
					"Year": {
						"type": "string"
					},
					"Month": {
						"type": "string"
					},
					"Day": {
						"type": "string"
					},
					"Domain": {
						"type": "string"
					},
					"Classification": {
						"type": "string"
					},
					"EntityStageID": {
						"type": "int"
					},
					"ProcessID": {
						"type": "int"
					},
					"Version": {
						"type": "string"
					},
					"SlicePath": {
						"type": "string"
					},
					"Time": {
						"type": "string"
					},
					"FileFormat": {
						"type": "string"
					},
					"Area": {
						"type": "string"
					}
				},
				"folder": {
					"name": "0 - Source2Raw/Montagu"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:40:46Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/DS_SQL_DYN')]",
				"[concat(variables('workspaceId'), '/datasets/AzureSqlTable3')]",
				"[concat(variables('workspaceId'), '/linkedServices/LS_SQL_AnalyticsHub')]",
				"[concat(variables('workspaceId'), '/linkedServices/ServerLessSQL2')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/EX_SourceToRaw_Single_Table_OCW')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Start Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[StartProcess]",
							"storedProcedureParameters": {
								"ADFExecution": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Copy Tables to RAW",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SQL_OptionSet_Script",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "@concat('SELECT * FROM ',pipeline().parameters.Domain,'.',pipeline().parameters.TableName)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_SQL_DYN",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_ADLS_RAW1",
								"type": "DatasetReference",
								"parameters": {
									"Directory": {
										"value": "@{pipeline().parameters.Zone}/@{pipeline().parameters.Classification}/@{pipeline().parameters.Area}/@{pipeline().parameters.Domain}/@{pipeline().parameters.TableName}/@{pipeline().parameters.Version}/Year=@{pipeline().parameters.Year}/Month=@{pipeline().parameters.Month}/Day=@{pipeline().parameters.Day}/Time=@{pipeline().parameters.Time}",
										"type": "Expression"
									},
									"Entity": {
										"value": "@pipeline().parameters.TableName",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Log Process Throughput",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy Tables to RAW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[LogThroughput]",
							"storedProcedureParameters": {
								"CountName": {
									"value": "rowsCopied",
									"type": "String"
								},
								"CountValue": {
									"value": {
										"value": "@activity('Copy Tables to RAW').output.rowsCopied",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy Tables to RAW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FailProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Finalise Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Log Process Throughput",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FinaliseProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail Process From Log Failure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Log Process Throughput",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FailProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Add Dependencies to Queue",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Finalise Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[InitiateDependency]",
							"storedProcedureParameters": {
								"EntityStageID": {
									"value": {
										"value": "@pipeline().parameters.EntityStageID",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"SlicePath": {
									"value": {
										"value": "@concat('Year=',pipeline().parameters.Year,'/Month=',pipeline().parameters.Month,'/Day=',pipeline().parameters.Day,'/Time=',pipeline().parameters.Time)",
										"type": "Expression"
									},
									"type": "String"
								},
								"MultiLine": {
									"value": "0"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SQL_OptionSet_Script",
						"type": "Script",
						"dependsOn": [
							{
								"activity": "Start Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "ServerLessSQL2",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "-- No duplicates\nUSE [dataverse_montagu_org5a2bcccf] --Specify the name of the database corresponding to your Synapse Link for Dataverse\n\n--=================================================================================================\n--PROVIDE INPUT PARAMETERS:\n--=================================================================================================\nDECLARE\n\t@EnrichedViewDatabase sysname, \n\t@EnrichedViewSchema sysname, \n\t@EnrichedColumnSuffix varchar(50), \t\n\t@LanguageCode varchar(10), \n\t@BaseTableSuffix varchar(50),\n\t@PreviewOnly bit, --Indicate whether to preview the SQL Script (without creating the views) = 1 ; Create views = 0;\n\t@CurrentDatabase sysname,\n\t@CurrentDatabaseSchema sysname\n\nSET @EnrichedViewDatabase = 'DataverseEnriched'\nSET @EnrichedViewSchema = 'dbo'\nSET @EnrichedColumnSuffix = 'code'\nSET @LanguageCode = 1033\nSET @BaseTableSuffix = ''\nSET @PreviewOnly = 0 \nSET @CurrentDatabase = 'dataverse_montagu_org5a2bcccf'\nSET @CurrentDatabaseSchema = 'dbo'\n\n--=================================================================================================\n-- Do not edit the script below this point\n--=================================================================================================\n\n\n\nDECLARE @ColumnMetadata nvarchar(MAX), @ColumnMetadataSQL nvarchar(MAX)\n\n--Define the SQL statement to retrieve column metadata from the Lake Database managed by Synapse Link for Dataverse\n--Results will be stored as a JSON document in a variable\nSET @ColumnMetadataSQL = 'SET @ColumnMetadataOUT = (\nSELECT TABLE_SCHEMA, \n\tTABLE_NAME, \n\tCOLUMN_NAME, \n\tORDINAL_POSITION, \n\tDATA_TYPE\nFROM INFORMATION_SCHEMA.COLUMNS \nWHERE TABLE_SCHEMA = ''dbo''\n\tAND TABLE_NAME NOT IN (''OptionsetMetadata'', ''GlobalOptionsetMetadata'',''StateMetadata'',''StatusMetadata'', ''TargetMetadata'')\n\tAND TABLE_NAME LIKE ''%' + @BaseTableSuffix + '''\nFOR JSON AUTO)'\nDECLARE @ParmDefinition NVARCHAR(MAX);  \nSET @ParmDefinition = N'@ColumnMetadataOUT NVARCHAR(MAX) OUTPUT';  \nEXECUTE sp_executesql @ColumnMetadataSQL, @ParmDefinition, @ColumnMetadataOUT=@ColumnMetadata OUTPUT;  \n\n--Declare a variable to store a SQL statement for creating enriched views\nDECLARE @SQL nvarchar(MAX) = ''\n\n; WITH CM AS (\n--Parse column metadata variable and construct a table based on its content\nSELECT JSON_VALUE(CM.value, '$.TABLE_SCHEMA') AS TableSchema,\n\t JSON_VALUE(CM.value, '$.TABLE_NAME') AS TableName,\n\t LEFT(JSON_VALUE(CM.value, '$.TABLE_NAME'), LEN(JSON_VALUE(CM.value, '$.TABLE_NAME'))-LEN(@BaseTableSuffix)) AS EntityName,\n\t JSON_VALUE(CM.value, '$.COLUMN_NAME') AS ColumnName,\n\t CAST(JSON_VALUE(CM.value, '$.ORDINAL_POSITION') AS INT) AS OrdinalPosition,\n\t JSON_VALUE(CM.value, '$.DATA_TYPE') AS DataType\nFROM OPENJSON (@ColumnMetadata) AS CM\n)\n\n, OSM AS (\n--Get Option Set Metadata\nSELECT DISTINCT \n\tEntityName, \n\tOptionSetName, \n\tQUOTENAME(EntityName + '_' + OptionSetName) AS Alias\nFROM dbo.[OptionsetMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, GOSM AS (\n--Get Global Option Set Metadata\nSELECT DISTINCT \n\tOptionSetName, \n\tQUOTENAME('Global_' + OptionSetName) AS Alias\nFROM dbo.[GlobalOptionsetMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, GOSMM AS (\n--Get Global Option Set Metadata\nSELECT DISTINCT \n\tOptionSetName, \n\tQUOTENAME('Global_Multiselect_' + OptionSetName) AS Alias\nFROM dbo.[GlobalOptionsetMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, StateM AS (\n--Get State Metadata\nSELECT DISTINCT \n\tEntityName, \n\tQUOTENAME(EntityName + '_State') AS Alias\nFROM dbo.[StateMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, StatusM AS (\n--Get Status Metadata\nSELECT DISTINCT \n\tEntityName,\n\tQUOTENAME(EntityName + '_Status') AS Alias\nFROM dbo.[StatusMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, SQLStatement AS (\n--Enumerate all lines in the source table and replace codes with labels where applicable\nSELECT CM.EntityName,\n\t--Before the first column of each table, construct a CREATE OR ALTER VIEW statement\n\tCASE WHEN CM.OrdinalPosition = 1\n\t\tTHEN 'CREATE OR ALTER VIEW ' + QUOTENAME(@EnrichedViewSchema) + '.' + CM.EntityName + '\n\t\tAS\n\t\tSELECT DISTINCT '\n\t\tELSE '\t,'\n\t\tEND\n\t--For each column, check if it needs to be replaced with a suitable localized label\n\t+ CASE \n\t\tWHEN OSM.OptionSetName IS NOT NULL THEN OSM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tWHEN GOSM.OptionSetName IS NOT NULL THEN GOSM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tWHEN GOSMM.OptionSetName IS NOT NULL THEN \n\t\t'isnull(\n\t\tcast((\n\t\tselect string_agg(Value, '';'')\n\t\tfrom\n\t\t(\n\t\tselect distinct [Option], Value\n\t\tfrom (\n\t\tselect cast(gosm.[Option] as varchar(max)) [Option], gosm.LocalizedLabel Value\n\t\tfrom '+@CurrentDatabase+'.'+@CurrentDatabaseSchema+'.GlobalOptionsetMetadata gosm\n\t\twhere gosm.OptionSetName = ''' + CM.ColumnName + '''\n\t\tand gosm.LocalizedLabelLanguageCode = ' + (cast(@LanguageCode as varchar(4))) +\n\t\t'and cast(gosm.[Option] as nvarchar(max)) in (\n\t\tSELECT [Value] FROM (\n\t\tSELECT cast(value as nvarchar(max)) as [Value] \n\t\tFROM STRING_SPLIT(' + '[Base].' + QUOTENAME(CM.ColumnName) + ', '';'')\n\t\t) t\n\t\tUNION\n\t\tSELECT ''Not-Valid-Value''\n\t\t)\n\t\t) t\n\t\t) t\n\t\t) as nvarchar(max)),\n\t\t' + '[Base].' + QUOTENAME(CM.ColumnName) + ') as ' + CM.ColumnName\n\t\tWHEN EOSM.OptionSetName IS NOT NULL THEN\n\t\t'isnull(\n\t\tcast((\n\t\tselect string_agg(Value, '';'')\n\t\tfrom\n\t\t(\n\t\tselect distinct [Option], Value\n\t\tfrom (\n\t\tselect cast(osm.[Option] as varchar(max)) [Option], osm.LocalizedLabel Value\n\t\tfrom '+@CurrentDatabase+'.'+@CurrentDatabaseSchema+'.OptionsetMetadata osm\n\t\twhere osm.OptionSetName = ''' + CM.ColumnName + '''\n\t\tand osm.EntityName = ''' + CM.EntityName + '''\n\t\tand osm.LocalizedLabelLanguageCode = ' + (cast(@LanguageCode as varchar(4))) +\n\t\t'and cast(osm.[Option] as nvarchar(max)) in (\n\t\tSELECT [Value] FROM (\n\t\tSELECT cast(value as nvarchar(max)) as [Value] \n\t\tFROM STRING_SPLIT(' + '[Base].' + QUOTENAME(CM.ColumnName) + ', '';'')\n\t\t) t\n\t\tUNION\n\t\tSELECT ''Not-Valid-Value''\n\t\t)\n\t\t) t\n\t\t) t\n\t\t) as nvarchar(max)),\n\t\t' + '[Base].' + QUOTENAME(CM.ColumnName) + ') as ' + CM.ColumnName\n\t\tWHEN StateM.EntityName IS NOT NULL THEN StateM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tWHEN StatusM.EntityName IS NOT NULL THEN StatusM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tELSE '[Base].' + QUOTENAME(CM.ColumnName)\n\t\tEND AS [SQLLine],\n\tCM.OrdinalPosition\nFROM CM \n\tLEFT JOIN OSM\n\t\tON CM.EntityName = OSM.EntityName\n\t\tAND CM.ColumnName = OSM.OptionSetName\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\tLEFT JOIN GOSM\n\t\tON CM.ColumnName = GOSM.OptionSetName\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\tLEFT JOIN GOSMM\n\t\tON CM.ColumnName = GOSMM.OptionSetName\n\t\tAND CM.DataType LIKE '%varchar%' --Only include columns with varchar data type that can potentially have multiselect values\n\tLEFT JOIN OSM EOSM\n\t\tON CM.ColumnName = EOSM.OptionSetName\n\t\tAND CM.EntityName = EOSM.EntityName\n\t\tAND CM.DataType LIKE '%varchar%' --Only include columns with varchar data type that can potentially have multiselect values\n\tLEFT JOIN StateM\n\t\tON CM.EntityName = StateM.EntityName\n\t\tAND CM.ColumnName = 'statecode'\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\tLEFT JOIN StatusM\n\t\tON CM.EntityName = StatusM.EntityName\n\t\tAND CM.ColumnName = 'statuscode'\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\nUNION ALL\n--Construct the first line of the FROM clause, referencing external tables created by Synapse Link for Dataverse\nSELECT DISTINCT\nCM.EntityName,\n'FROM ' + QUOTENAME(DB_NAME()) + '.' + QUOTENAME(CM.TableSchema) + '.' + QUOTENAME(CM.TableName) + ' AS Base' AS SQLLine,\n10000 AS OrdinalPosition\nFROM CM\n\nUNION ALL \n--Construct LEFT JOIN statements for each relevant OptionSetMetadata field\nSELECT DISTINCT OSM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[OptionSetMetadata] AS ' + OSM.Alias + ' \n\t\tON ' + OSM.Alias + '.EntityName = ''' + OSM.EntityName + ''' \n\t\tAND ' + OSM.Alias + '.OptionSetName = ''' +  OSM.OptionSetName + '''\n\t\tAND [Base].' + QUOTENAME(OSM.OptionSetName) + ' = ' + OSM.Alias + '.[Option]\n\t\tAND ' + OSM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n20000 AS OrdinalPosition\nFROM OSM\n\tJOIN CM\n\t\tON CM.EntityName = OSM.EntityName\n\t\tAND CM.ColumnName = OSM.OptionSetName\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL \n--Construct LEFT JOIN statements for each relevant GlobalOptionSetMetadata field\nSELECT DISTINCT CM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[GlobalOptionSetMetadata] AS ' + Alias + ' \n\t\tON ' + Alias + '.OptionSetName = ''' +  OptionSetName + '''\n\t\tAND [Base].' + QUOTENAME(OptionSetName) + ' = ' + Alias + '.[Option]\n\t\tAND ' + Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n30000 AS OrdinalPosition\nFROM GOSM\n\tJOIN CM\n\t\tON CM.ColumnName = GOSM.OptionSetName\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL \n--Construct LEFT JOIN statements for each relevant State Metadata field\nSELECT DISTINCT CM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[StateMetadata] AS ' + StateM.Alias + ' \n\t\tON ' + StateM.Alias + '.EntityName = ''' + StateM.EntityName + ''' \n\t\tAND [Base].statecode' + ' = ' + StateM.Alias + '.[State]\n\t\tAND ' + StateM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n40000 AS OrdinalPosition\nFROM StateM\n\tJOIN CM\n\t\tON CM.EntityName = StateM.EntityName\n\t\tAND CM.ColumnName = 'statecode'\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL\n--Construct LEFT JOIN statements for each relevant Status Metadata field\nSELECT DISTINCT CM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[StatusMetadata] AS ' + StatusM.Alias + ' \n\t\tON ' + StatusM.Alias + '.EntityName = ''' + StatusM.EntityName + ''' \n\t\tAND [Base].statuscode' + ' = ' + StatusM.Alias + '.[Status]\n\t\tAND ' + StatusM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n40000 AS OrdinalPosition\nFROM StatusM\n\tJOIN CM\n\t\tON CM.EntityName = StatusM.EntityName\n\t\tAND CM.ColumnName = 'statuscode'\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL\n--Add statement terminator\nSELECT DISTINCT\nEntityName,\n'; ' + CHAR(10) AS SQLLine,\n100000 AS OrdinalPosition\nFROM CM\n)\n\n--Construct individual statements to create views (1 view per row)\n--Since CREATE VIEW statement must be the first statement in a batch, assign each view definition to a variable \n--and use the EXEC(@variable) command to create view as part of its own, separate batch.\n, ViewDefinitions AS (\nSELECT 'DECLARE @' + EntityName + ' NVARCHAR(MAX) = ''\n\t' + REPLACE(STRING_AGG(CAST(SQLLine as varchar(MAX)), CHAR(10)) WITHIN GROUP (ORDER BY EntityName, OrdinalPosition, SQLLine), '''', '''''') + ''' ' + CHAR(10) + 'EXEC [' + @EnrichedViewDatabase + '].dbo.sp_executesql @' + EntityName + CHAR(10) AS ViewDefinition\nFROM SQLStatement\nGROUP BY EntityName\n)\n\n--Construct a comprehensive SQL statement to create all views\nSELECT @SQL = STRING_AGG(ViewDefinition, ';' + CHAR(10) + CHAR(10))\nFROM ViewDefinitions\n\n--Return a preview of the SQL Script to be generated or go ahead and create the views.\nIF @PreviewOnly = 1\nBEGIN\n\t--Return the final SQL statement\n\tSELECT '--================================================================================================='+ CHAR(10) +' ' + CHAR(10) AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '-- A preview of the script to generate enriched views is provided below.'  AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '-- No database objects have been created.' AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '-- Re-run this script with the @PreviewOnly parameter set to 0 to actually create the views.' AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '--================================================================================================='+ CHAR(10) +' ' + CHAR(10) AS [--SQL Statement]\n\tUNION ALL \n\tSELECT VALUE AS [--SQL Statement] FROM STRING_SPLIT(@SQL, CHAR(10))\nEND\nELSE\nBEGIN\n\t--Execute the SQL statement\n\tPRINT 'Beginning view creation'\n\t--PRINT @SQL\n\tEXEC sp_executesql @SQL\n\tPRINT 'Completed view creation'\nEND"
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"TableName": {
						"type": "string"
					},
					"Zone": {
						"type": "string",
						"defaultValue": "RAW"
					},
					"Year": {
						"type": "string"
					},
					"Month": {
						"type": "string"
					},
					"Day": {
						"type": "string"
					},
					"Domain": {
						"type": "string"
					},
					"Classification": {
						"type": "string"
					},
					"EntityStageID": {
						"type": "int"
					},
					"ProcessID": {
						"type": "int"
					},
					"Version": {
						"type": "string"
					},
					"SlicePath": {
						"type": "string"
					},
					"Time": {
						"type": "string"
					},
					"FileFormat": {
						"type": "string"
					},
					"Area": {
						"type": "string"
					}
				},
				"folder": {
					"name": "0 - Source2Raw/Montagu"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:40:54Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_SQL_AnalyticsHub')]",
				"[concat(variables('workspaceId'), '/datasets/DS_SQL_DYN')]",
				"[concat(variables('workspaceId'), '/datasets/DS_ADLS_RAW1')]",
				"[concat(variables('workspaceId'), '/linkedServices/ServerLessSQL2')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/EX_SourceToRaw_Single_Table_SPA')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Start Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[StartProcess]",
							"storedProcedureParameters": {
								"ADFExecution": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Copy File EnrichmentDB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Start Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SharePointOnlineListSource",
								"query": {
									"value": "@concat('SELECT * FROM ',pipeline().parameters.Domain,'.',pipeline().parameters.TableName)",
									"type": "Expression"
								},
								"httpRequestTimeout": "00:05:00"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "SharePointOnlineListResource2",
								"type": "DatasetReference",
								"parameters": {
									"sourcetablename": {
										"value": "@pipeline().parameters.TableName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "AzureSqlTable3",
								"type": "DatasetReference",
								"parameters": {
									"targettable": {
										"value": "@pipeline().parameters.TableName",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Log Process Throughput",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy File EnrichmentDB",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[LogThroughput]",
							"storedProcedureParameters": {
								"CountName": {
									"value": "rowsCopied",
									"type": "String"
								},
								"CountValue": {
									"value": {
										"value": "@activity('Copy File EnrichmentDB').output.rowsCopied",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy File EnrichmentDB",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FailProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Finalise Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Log Process Throughput",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FinaliseProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail Process From Log Failure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Log Process Throughput",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FailProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Add Dependencies to Queue",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Finalise Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[InitiateDependency]",
							"storedProcedureParameters": {
								"EntityStageID": {
									"value": {
										"value": "@pipeline().parameters.EntityStageID",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"SlicePath": {
									"value": {
										"value": "@concat('Year=',pipeline().parameters.Year,'/Month=',pipeline().parameters.Month,'/Day=',pipeline().parameters.Day,'/Time=',pipeline().parameters.Time)",
										"type": "Expression"
									},
									"type": "String"
								},
								"MultiLine": {
									"value": "0"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"TableName": {
						"type": "string"
					},
					"Zone": {
						"type": "string"
					},
					"Year": {
						"type": "string"
					},
					"Month": {
						"type": "string"
					},
					"Day": {
						"type": "string"
					},
					"Domain": {
						"type": "string"
					},
					"Classification": {
						"type": "string"
					},
					"EntityStageID": {
						"type": "int"
					},
					"ProcessID": {
						"type": "int"
					},
					"Version": {
						"type": "string"
					},
					"SlicePath": {
						"type": "string"
					},
					"Time": {
						"type": "string"
					},
					"FileFormat": {
						"type": "string"
					},
					"Area": {
						"type": "string"
					}
				},
				"variables": {
					"FilenameMask": {
						"type": "String"
					},
					"RecursiveFlag": {
						"type": "String"
					},
					"UnzipFlag": {
						"type": "String"
					}
				},
				"folder": {
					"name": "0 - Source2Raw/Montagu"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:40:33Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_SQL_AnalyticsHub')]",
				"[concat(variables('workspaceId'), '/datasets/SharePointOnlineListResource2')]",
				"[concat(variables('workspaceId'), '/datasets/AzureSqlTable3')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/EX_SourceToRaw_Single_Zip')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Start Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[StartProcess]",
							"storedProcedureParameters": {
								"ADFExecution": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SetFileMask",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Start Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "FilenameMask",
							"value": {
								"value": "@if(greater(indexof(string(pipeline().parameters.Config),'FilenameMask'),0),pipeline().parameters.Config.FilenameMask,'')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SetRecursiveFlag",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Start Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "RecursiveFlag",
							"value": {
								"value": "@if(greater(indexof(string(pipeline().parameters.Config),'RecursiveFlag'),0),pipeline().parameters.Config.RecursiveFlag,'')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy File to Archive BLOB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetFileMask",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "SetRecursiveFlag",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "BinarySource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"wildcardFileName": {
										"value": "@if(empty(variables('FilenameMask')),\nconcat('*.',pipeline().parameters.FileFormat),\nconcat(variables('FilenameMask'),toLower(pipeline().parameters.FileFormat)))",
										"type": "Expression"
									},
									"deleteFilesAfterCompletion": false
								},
								"formatSettings": {
									"type": "BinaryReadSettings"
								}
							},
							"sink": {
								"type": "BinarySink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "DS_BLOB_Landing_DYN_BINARY",
								"type": "DatasetReference",
								"parameters": {
									"Path": {
										"value": "@pipeline().parameters.Path",
										"type": "Expression"
									},
									"Container": {
										"value": "@pipeline().parameters.PathRoute",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_BLOB_Landing_DYN_BINARY",
								"type": "DatasetReference",
								"parameters": {
									"Path": {
										"value": "@pipeline().parameters.Path",
										"type": "Expression"
									},
									"Container": {
										"value": "@pipeline().parameters.PathRoute",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy File to Lake",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy File to Archive BLOB",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "BinarySource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"wildcardFileName": {
										"value": "@if(empty(variables('FilenameMask')),\nconcat('*.',pipeline().parameters.FileFormat),\nconcat(variables('FilenameMask'),toLower(pipeline().parameters.FileFormat)))",
										"type": "Expression"
									},
									"deleteFilesAfterCompletion": false
								},
								"formatSettings": {
									"type": "BinaryReadSettings",
									"compressionProperties": {
										"type": "ZipDeflateReadSettings"
									}
								}
							},
							"sink": {
								"type": "BinarySink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "DS_BLOB_Landing_DYN_ZIP",
								"type": "DatasetReference",
								"parameters": {
									"Path": {
										"value": "@pipeline().parameters.Path",
										"type": "Expression"
									},
									"Container": {
										"value": "@pipeline().parameters.PathRoute",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_ALDS_RAW_BINARY",
								"type": "DatasetReference",
								"parameters": {
									"Directory": {
										"value": "@{pipeline().parameters.Zone}/@{pipeline().parameters.Classification}/@{pipeline().parameters.Area}/@{pipeline().parameters.Domain}/@{pipeline().parameters.TableName}/@{pipeline().parameters.Version}/Year=@{pipeline().parameters.Year}/Month=@{pipeline().parameters.Month}/Day=@{pipeline().parameters.Day}/Time=@{pipeline().parameters.Time}",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Log Process Throughput",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy File to Lake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[LogThroughput]",
							"storedProcedureParameters": {
								"CountName": {
									"value": "rowsCopied",
									"type": "String"
								},
								"CountValue": {
									"value": {
										"value": "@activity('Copy File to Lake').output.filesRead",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy File to Lake",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FailProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Finalise Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Log Process Throughput",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FinaliseProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail Process From Log Failure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Log Process Throughput",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FailProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"TableName": {
						"type": "string",
						"defaultValue": "CashSales"
					},
					"Zone": {
						"type": "string",
						"defaultValue": "RAW"
					},
					"Year": {
						"type": "string",
						"defaultValue": "2020"
					},
					"Month": {
						"type": "string",
						"defaultValue": "11"
					},
					"Day": {
						"type": "string",
						"defaultValue": "02"
					},
					"Area": {
						"type": "string",
						"defaultValue": "MuleSoft"
					},
					"Domain": {
						"type": "string",
						"defaultValue": "StarKis"
					},
					"Classification": {
						"type": "string",
						"defaultValue": "Internal"
					},
					"EntityStageID": {
						"type": "string",
						"defaultValue": "51"
					},
					"ProcessID": {
						"type": "int",
						"defaultValue": 999
					},
					"Version": {
						"type": "string",
						"defaultValue": "1"
					},
					"SlicePath": {
						"type": "string"
					},
					"Time": {
						"type": "string",
						"defaultValue": "00:00"
					},
					"FileFormat": {
						"type": "string",
						"defaultValue": "CSV"
					},
					"Path": {
						"type": "string",
						"defaultValue": "import/starkis/UK"
					},
					"PathRoute": {
						"type": "string"
					},
					"Config": {
						"type": "object"
					}
				},
				"variables": {
					"FilenameMask": {
						"type": "String"
					},
					"RecursiveFlag": {
						"type": "String"
					},
					"UnzipFlag": {
						"type": "String"
					}
				},
				"folder": {
					"name": "0 - Source2Raw/Montagu"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:40:59Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_SQL_AnalyticsHub')]",
				"[concat(variables('workspaceId'), '/datasets/DS_BLOB_Landing_DYN_BINARY')]",
				"[concat(variables('workspaceId'), '/datasets/DS_BLOB_Landing_DYN_ZIP')]",
				"[concat(variables('workspaceId'), '/datasets/DS_ALDS_RAW_BINARY')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Execute Montagu Load')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Initiate Montagu Load",
						"description": "",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[InitiateLoad]",
							"storedProcedureParameters": {
								"Area": {
									"value": {
										"value": "@pipeline().parameters.Area",
										"type": "Expression"
									},
									"type": "String"
								},
								"Domain": {
									"value": {
										"value": "@pipeline().parameters.Domain",
										"type": "Expression"
									},
									"type": "String"
								},
								"Months": {
									"value": null,
									"type": "Int32"
								},
								"SliceDate": {
									"value": {
										"value": "@formatDateTime(utcnow(),'yyyy/MM/dd')",
										"type": "Expression"
									},
									"type": "Datetime"
								},
								"Stage": {
									"value": "Raw",
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Trigger Master Control",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Initiate Montagu Load",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Master Control",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"SliceDate": {
									"value": "@pipeline().parameters.SliceDate",
									"type": "Expression"
								},
								"Area": {
									"value": "@pipeline().parameters.Area",
									"type": "Expression"
								},
								"Domain": {
									"value": "@pipeline().parameters.Domain",
									"type": "Expression"
								},
								"Region": {
									"value": "@pipeline().parameters.Region",
									"type": "Expression"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"SliceDate": {
						"type": "string"
					},
					"Area": {
						"type": "string",
						"defaultValue": "origination"
					},
					"Domain": {
						"type": "string",
						"defaultValue": "dbo"
					},
					"Region": {
						"type": "string",
						"defaultValue": "-2"
					}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:45:19Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_SQL_AnalyticsHub')]",
				"[concat(variables('workspaceId'), '/pipelines/Master Control')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Full Flow MVP plus Script')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Raw Staging",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "MagicScript",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "PH 1 FullEnrich No Cache",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"AccountIn": {},
									"OriginationOpportunityIn": {},
									"MeetingsAppointmentsIn": {},
									"ContactsIn": {},
									"EnrichedAccount": {},
									"EnrichedOriginationOpportunities": {},
									"EnrichedMeetingAppointments": {},
									"EnrichedContacts": {},
									"SystemUserIn": {},
									"EnrichedSystemUser": {},
									"AccountCleanSink": {},
									"MeetingStageCleanSink": {},
									"ContactsStageCleanSink": {},
									"OriginationCleanSink": {},
									"SystemUserSink": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "prod-synapse-uks-001-WorkspaceDefaultStorage",
									"type": "LinkedServiceReference"
								},
								"folderPath": "users/stage"
							},
							"compute": {
								"coreCount": 16,
								"computeType": "MemoryOptimized"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "Curated",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "Raw Staging",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "PH 4 BA Activity DatasetReports",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"AccountIn": {},
									"OriginationOpportunityIn": {},
									"MeetingsAppointmentsIn": {},
									"ContactsIn": {},
									"SystemuserSource": {},
									"AccountCleanSink": {},
									"MeetingStageCleanSink": {},
									"ContactsStageCleanSink": {},
									"OriginationCleanSink": {},
									"SystemUserCleanSink": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "prod-synapse-uks-001-WorkspaceDefaultStorage",
									"type": "LinkedServiceReference"
								},
								"folderPath": "users/stage"
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine",
							"sourceStagingConcurrency": 1
						}
					},
					{
						"name": "MagicScript",
						"type": "Script",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "EnrichedDatabase",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "NonQuery",
									"text": "\r\nUSE [dataverse_montagu_org5a2bcccf] --Specify the name of the database corresponding to your Synapse Link for Dataverse\r\n\r\n--=================================================================================================\r\n--PROVIDE INPUT PARAMETERS:\r\n--=================================================================================================\r\nDECLARE\r\n\t@EnrichedViewDatabase sysname, --Specify the name of the database in which views with enriched entities will be created\r\n\t@EnrichedViewSchema sysname, --Specify the name of the database schema in which views with enriched entities will be created\r\n\t@EnrichedColumnSuffix varchar(50), \t--Specify the suffix for columns enriched with human-readable descriptions. For example, the suffix of \"label\" will change a statecode column in the base table to a statelabel column in the enriched view.\r\n\t@LanguageCode varchar(10), --Specify the language code for localized labels. For example, English - United States is 1033 (https://docs.microsoft.com/en-us/openspecs/office_standards/ms-oe376/6c085406-a698-4e12-9d4d-c3b0ee3dbc4a)\r\n\t@BaseTableSuffix varchar(50), --If applicable, specify the suffix in the names of the base tables or views (e.g., '_partitiond'). The default is an empty string.\r\n\t@PreviewOnly bit --Indicate whether to preview the SQL Script (without creating the views) = 1 ; Create views = 0;\r\n\r\nSET @EnrichedViewDatabase = 'DataverseEnriched'\r\nSET @EnrichedViewSchema = 'dbo'\r\nSET @EnrichedColumnSuffix = 'AZOption'\r\nSET @LanguageCode = 1033\r\nSET @BaseTableSuffix = ''\r\nSET @PreviewOnly = 0\r\n\r\n--=================================================================================================\r\n-- Do not edit the script below this point\r\n--=================================================================================================\r\n\r\n--Get column metadata from the Lake Database managed by Synapse Link for Dataverse\r\n--The column metadata will be stored as a JSON document in a scalar variable\r\n--This is needed as a workaround for the limitation of not allowing system objects to be used in distributed queries\r\nDECLARE @ColumnMetadata nvarchar(MAX), @ColumnMetadataSQL nvarchar(MAX)\r\n\r\n--Define the SQL statement to retrieve column metadata from the Lake Database managed by Synapse Link for Dataverse\r\n--Results will be stored as a JSON document in a variable\r\nSET @ColumnMetadataSQL = 'SET @ColumnMetadataOUT = (\r\nSELECT TABLE_SCHEMA, \r\n\tTABLE_NAME, \r\n\tCOLUMN_NAME, \r\n\tORDINAL_POSITION, \r\n\tDATA_TYPE\r\nFROM INFORMATION_SCHEMA.COLUMNS \r\nWHERE TABLE_SCHEMA = ''dbo''\r\n\tAND TABLE_NAME NOT IN (''OptionsetMetadata'', ''GlobalOptionsetMetadata'',''StateMetadata'',''StatusMetadata'', ''TargetMetadata'')\r\n\tAND TABLE_NAME LIKE ''%' + @BaseTableSuffix + '''\r\nFOR JSON AUTO)'\r\nDECLARE @ParmDefinition NVARCHAR(MAX);  \r\nSET @ParmDefinition = N'@ColumnMetadataOUT NVARCHAR(MAX) OUTPUT';  \r\nEXECUTE sp_executesql @ColumnMetadataSQL, @ParmDefinition, @ColumnMetadataOUT=@ColumnMetadata OUTPUT;  \r\n\r\n--Declare a variable to store a SQL statement for creating enriched views\r\nDECLARE @SQL nvarchar(MAX) = ''\r\n\r\n; WITH CM AS (\r\n--Parse column metadata variable and construct a table based on its content\r\nSELECT JSON_VALUE(CM.value, '$.TABLE_SCHEMA') AS TableSchema,\r\n\t JSON_VALUE(CM.value, '$.TABLE_NAME') AS TableName,\r\n\t LEFT(JSON_VALUE(CM.value, '$.TABLE_NAME'), LEN(JSON_VALUE(CM.value, '$.TABLE_NAME'))-LEN(@BaseTableSuffix)) AS EntityName,\r\n\t JSON_VALUE(CM.value, '$.COLUMN_NAME') AS ColumnName,\r\n\t CAST(JSON_VALUE(CM.value, '$.ORDINAL_POSITION') AS INT) AS OrdinalPosition,\r\n\t JSON_VALUE(CM.value, '$.DATA_TYPE') AS DataType\r\nFROM OPENJSON (@ColumnMetadata) AS CM\r\n)\r\n\r\n, OSM AS (\r\n--Get Option Set Metadata\r\nSELECT DISTINCT \r\n\tEntityName, \r\n\tOptionSetName, \r\n\tQUOTENAME(EntityName + '_' + OptionSetName) AS Alias\r\nFROM dbo.[OptionsetMetadata]\r\nWHERE LocalizedLabelLanguageCode = @LanguageCode\r\n)\r\n\r\n, GOSM AS (\r\n--Get Global Option Set Metadata\r\nSELECT DISTINCT \r\n\tOptionSetName, \r\n\tQUOTENAME('Global_' + OptionSetName) AS Alias\r\nFROM dbo.[GlobalOptionsetMetadata]\r\nWHERE LocalizedLabelLanguageCode = @LanguageCode\r\n)\r\n\r\n, StateM AS (\r\n--Get State Metadata\r\nSELECT DISTINCT \r\n\tEntityName, \r\n\tQUOTENAME(EntityName + '_State') AS Alias\r\nFROM dbo.[StateMetadata]\r\nWHERE LocalizedLabelLanguageCode = @LanguageCode\r\n)\r\n\r\n, StatusM AS (\r\n--Get Status Metadata\r\nSELECT DISTINCT \r\n\tEntityName,\r\n\tQUOTENAME(EntityName + '_Status') AS Alias\r\nFROM dbo.[StatusMetadata]\r\nWHERE LocalizedLabelLanguageCode = @LanguageCode\r\n)\r\n\r\n, SQLStatement AS (\r\n--Enumerate all lines in the source table and replace codes with labels where applicable\r\nSELECT CM.EntityName,\r\n\t--Before the first column of each table, construct a CREATE OR ALTER VIEW statement\r\n\tCASE WHEN CM.OrdinalPosition = 1\r\n\t\tTHEN 'CREATE OR ALTER VIEW ' + QUOTENAME(@EnrichedViewSchema) + '.' + CM.EntityName + '\r\n\t\tAS\r\n\t\tSELECT '\r\n\t\tELSE '\t,'\r\n\t\tEND\r\n\t--For each column, check if it needs to be replaced with a suitable localized label\r\n\t+ CASE \r\n\t\tWHEN OSM.OptionSetName IS NOT NULL THEN OSM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\r\n\t\tWHEN GOSM.OptionSetName IS NOT NULL THEN GOSM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\r\n\t\tWHEN StateM.EntityName IS NOT NULL THEN StateM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\r\n\t\tWHEN StatusM.EntityName IS NOT NULL THEN StatusM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\r\n\t\tELSE '[Base].' + QUOTENAME(CM.ColumnName)\r\n\t\tEND AS [SQLLine],\r\n\tCM.OrdinalPosition\r\nFROM CM \r\n\tLEFT JOIN OSM\r\n\t\tON CM.EntityName = OSM.EntityName\r\n\t\tAND CM.ColumnName = OSM.OptionSetName\r\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\r\n\tLEFT JOIN GOSM\r\n\t\tON CM.ColumnName = GOSM.OptionSetName\r\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\r\n\tLEFT JOIN StateM\r\n\t\tON CM.EntityName = StateM.EntityName\r\n\t\tAND CM.ColumnName = 'statecode'\r\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\r\n\tLEFT JOIN StatusM\r\n\t\tON CM.EntityName = StatusM.EntityName\r\n\t\tAND CM.ColumnName = 'statuscode'\r\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\r\n\r\nUNION ALL\r\n--Construct the first line of the FROM clause, referencing external tables created by Synapse Link for Dataverse\r\nSELECT DISTINCT\r\nCM.EntityName,\r\n'FROM ' + QUOTENAME(DB_NAME()) + '.' + QUOTENAME(CM.TableSchema) + '.' + QUOTENAME(CM.TableName) + ' AS Base' AS SQLLine,\r\n10000 AS OrdinalPosition\r\nFROM CM\r\n\r\nUNION ALL \r\n--Construct LEFT JOIN statements for each relevant OptionSetMetadata field\r\nSELECT DISTINCT OSM.EntityName AS EntityName,\r\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[OptionSetMetadata] AS ' + OSM.Alias + ' \r\n\t\tON ' + OSM.Alias + '.EntityName = ''' + OSM.EntityName + ''' \r\n\t\tAND ' + OSM.Alias + '.OptionSetName = ''' +  OSM.OptionSetName + '''\r\n\t\tAND [Base].' + QUOTENAME(OSM.OptionSetName) + ' = ' + OSM.Alias + '.[Option]\r\n\t\tAND ' + OSM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\r\n20000 AS OrdinalPosition\r\nFROM OSM\r\n\tJOIN CM\r\n\t\tON CM.EntityName = OSM.EntityName\r\n\t\tAND CM.ColumnName = OSM.OptionSetName\r\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\r\n\r\nUNION ALL \r\n--Construct LEFT JOIN statements for each relevant GlobalOptionSetMetadata field\r\nSELECT DISTINCT CM.EntityName AS EntityName,\r\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[GlobalOptionSetMetadata] AS ' + Alias + ' \r\n\t\tON ' + Alias + '.OptionSetName = ''' +  OptionSetName + '''\r\n\t\tAND [Base].' + QUOTENAME(OptionSetName) + ' = ' + Alias + '.[Option]\r\n\t\tAND ' + Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\r\n30000 AS OrdinalPosition\r\nFROM GOSM\r\n\tJOIN CM\r\n\t\tON CM.ColumnName = GOSM.OptionSetName\r\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\r\n\r\nUNION ALL \r\n--Construct LEFT JOIN statements for each relevant State Metadata field\r\nSELECT DISTINCT CM.EntityName AS EntityName,\r\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[StateMetadata] AS ' + StateM.Alias + ' \r\n\t\tON ' + StateM.Alias + '.EntityName = ''' + StateM.EntityName + ''' \r\n\t\tAND [Base].statecode' + ' = ' + StateM.Alias + '.[State]\r\n\t\tAND ' + StateM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\r\n40000 AS OrdinalPosition\r\nFROM StateM\r\n\tJOIN CM\r\n\t\tON CM.EntityName = StateM.EntityName\r\n\t\tAND CM.ColumnName = 'statecode'\r\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\r\n\r\nUNION ALL\r\n--Construct LEFT JOIN statements for each relevant Status Metadata field\r\nSELECT DISTINCT CM.EntityName AS EntityName,\r\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[StatusMetadata] AS ' + StatusM.Alias + ' \r\n\t\tON ' + StatusM.Alias + '.EntityName = ''' + StatusM.EntityName + ''' \r\n\t\tAND [Base].statuscode' + ' = ' + StatusM.Alias + '.[Status]\r\n\t\tAND ' + StatusM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\r\n40000 AS OrdinalPosition\r\nFROM StatusM\r\n\tJOIN CM\r\n\t\tON CM.EntityName = StatusM.EntityName\r\n\t\tAND CM.ColumnName = 'statuscode'\r\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\r\n\r\nUNION ALL\r\n--Add statement terminator\r\nSELECT DISTINCT\r\nEntityName,\r\n'; ' + CHAR(10) AS SQLLine,\r\n100000 AS OrdinalPosition\r\nFROM CM\r\n)\r\n\r\n--Construct individual statements to create views (1 view per row)\r\n--Since CREATE VIEW statement must be the first statement in a batch, assign each view definition to a variable \r\n--and use the EXEC(@variable) command to create view as part of its own, separate batch.\r\n, ViewDefinitions AS (\r\nSELECT 'DECLARE @' + EntityName + ' NVARCHAR(MAX) = ''\r\n\t' + REPLACE(STRING_AGG(CAST(SQLLine as varchar(MAX)), CHAR(10)) WITHIN GROUP (ORDER BY EntityName, OrdinalPosition, SQLLine), '''', '''''') + ''' ' + CHAR(10) + 'EXEC [' + @EnrichedViewDatabase + '].dbo.sp_executesql @' + EntityName + CHAR(10) AS ViewDefinition\r\nFROM SQLStatement\r\nGROUP BY EntityName\r\n)\r\n\r\n--Construct a comprehensive SQL statement to create all views\r\nSELECT @SQL = STRING_AGG(ViewDefinition, ';' + CHAR(10) + CHAR(10))\r\nFROM ViewDefinitions\r\n\r\n--Return a preview of the SQL Script to be generated or go ahead and create the views.\r\nIF @PreviewOnly = 1\r\nBEGIN\r\n\t--Return the final SQL statement\r\n\tSELECT '--================================================================================================='+ CHAR(10) +' ' + CHAR(10) AS [--SQL Statement]\r\n\tUNION ALL \r\n\tSELECT '-- A preview of the script to generate enriched views is provided below.'  AS [--SQL Statement]\r\n\tUNION ALL \r\n\tSELECT '-- No database objects have been created.' AS [--SQL Statement]\r\n\tUNION ALL \r\n\tSELECT '-- Re-run this script with the @PreviewOnly parameter set to 0 to actually create the views.' AS [--SQL Statement]\r\n\tUNION ALL \r\n\tSELECT '--================================================================================================='+ CHAR(10) +' ' + CHAR(10) AS [--SQL Statement]\r\n\tUNION ALL \r\n\tSELECT VALUE AS [--SQL Statement] FROM STRING_SPLIT(@SQL, CHAR(10))\r\nEND\r\nELSE\r\nBEGIN\r\n\t--Execute the SQL statement\r\n\tPRINT 'Beginning view creation'\r\n\tEXEC sp_executesql @SQL\r\n\tPRINT 'Completed view creation'\r\nEND"
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:41:08Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/dataflows/PH 1 FullEnrich No Cache')]",
				"[concat(variables('workspaceId'), '/linkedServices/prod-synapse-uks-001-WorkspaceDefaultStorage')]",
				"[concat(variables('workspaceId'), '/dataflows/PH 4 BA Activity DatasetReports')]",
				"[concat(variables('workspaceId'), '/linkedServices/EnrichedDatabase')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Full Flow MVP')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Raw Staging",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "PH 1 FullEnrich No Cache",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"AccountIn": {},
									"OriginationOpportunityIn": {},
									"MeetingsAppointmentsIn": {},
									"ContactsIn": {},
									"EnrichedAccount": {},
									"EnrichedOriginationOpportunities": {},
									"EnrichedMeetingAppointments": {},
									"EnrichedContacts": {},
									"SystemUserIn": {},
									"EnrichedSystemUser": {},
									"AccountCleanSink": {},
									"MeetingStageCleanSink": {},
									"ContactsStageCleanSink": {},
									"OriginationCleanSink": {},
									"SystemUserSink": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "prod-synapse-uks-001-WorkspaceDefaultStorage",
									"type": "LinkedServiceReference"
								},
								"folderPath": "users/stage"
							},
							"compute": {
								"coreCount": 16,
								"computeType": "MemoryOptimized"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "Curated",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "Raw Staging",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "PH 4 BA Activity DatasetReports",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"AccountIn": {},
									"OriginationOpportunityIn": {},
									"MeetingsAppointmentsIn": {},
									"ContactsIn": {},
									"SystemuserSource": {},
									"AccountCleanSink": {},
									"MeetingStageCleanSink": {},
									"ContactsStageCleanSink": {},
									"OriginationCleanSink": {},
									"SystemUserCleanSink": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "prod-synapse-uks-001-WorkspaceDefaultStorage",
									"type": "LinkedServiceReference"
								},
								"folderPath": "users/stage"
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine",
							"sourceStagingConcurrency": 1
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:41:11Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/dataflows/PH 1 FullEnrich No Cache')]",
				"[concat(variables('workspaceId'), '/linkedServices/prod-synapse-uks-001-WorkspaceDefaultStorage')]",
				"[concat(variables('workspaceId'), '/dataflows/PH 4 BA Activity DatasetReports')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Full Flow')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Raw Staging",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "Serverless Join Read",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "PH 1 FullEnrich No Cache",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"AccountIn": {},
									"OriginationOpportunityIn": {},
									"MeetingsAppointmentsIn": {},
									"ContactsIn": {},
									"EnrichedAccount": {},
									"EnrichedOriginationOpportunities": {},
									"EnrichedMeetingAppointments": {},
									"EnrichedContacts": {},
									"SystemUserIn": {},
									"EnrichedSystemUser": {},
									"AccountCleanSink": {},
									"MeetingStageCleanSink": {},
									"ContactsStageCleanSink": {},
									"OriginationCleanSink": {},
									"SystemUserSink": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "prod-synapse-uks-001-WorkspaceDefaultStorage",
									"type": "LinkedServiceReference"
								},
								"folderPath": "users/stage"
							},
							"compute": {
								"coreCount": 16,
								"computeType": "MemoryOptimized"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "Curated",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "Raw Staging",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "PH 4 BA Activity DatasetReports",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"AccountIn": {},
									"OriginationOpportunityIn": {},
									"MeetingsAppointmentsIn": {},
									"ContactsIn": {},
									"SystemuserSource": {},
									"AccountCleanSink": {},
									"MeetingStageCleanSink": {},
									"ContactsStageCleanSink": {},
									"OriginationCleanSink": {},
									"SystemUserCleanSink": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "prod-synapse-uks-001-WorkspaceDefaultStorage",
									"type": "LinkedServiceReference"
								},
								"folderPath": "users/stage"
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine",
							"sourceStagingConcurrency": 1
						}
					},
					{
						"name": "Serverless Join Read",
						"type": "Script",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "prod-synapse-uks-001-WorkspaceDefaultSqlServer",
							"type": "LinkedServiceReference",
							"parameters": {
								"DBName": "dataverse_montagu_org5a2bcccf"
							}
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "NonQuery",
									"text": "\r\nUSE [dataverse_montagu_org5a2bcccf] --Specify the name of the database corresponding to your Synapse Link for Dataverse\r\n\r\n--=================================================================================================\r\n--PROVIDE INPUT PARAMETERS:\r\n--=================================================================================================\r\nDECLARE\r\n\t@EnrichedViewDatabase sysname, --Specify the name of the database in which views with enriched entities will be created\r\n\t@EnrichedViewSchema sysname, --Specify the name of the database schema in which views with enriched entities will be created\r\n\t@EnrichedColumnSuffix varchar(50), \t--Specify the suffix for columns enriched with human-readable descriptions. For example, the suffix of \"label\" will change a statecode column in the base table to a statelabel column in the enriched view.\r\n\t@LanguageCode varchar(10), --Specify the language code for localized labels. For example, English - United States is 1033 (https://docs.microsoft.com/en-us/openspecs/office_standards/ms-oe376/6c085406-a698-4e12-9d4d-c3b0ee3dbc4a)\r\n\t@BaseTableSuffix varchar(50), --If applicable, specify the suffix in the names of the base tables or views (e.g., '_partitiond'). The default is an empty string.\r\n\t@PreviewOnly bit --Indicate whether to preview the SQL Script (without creating the views) = 1 ; Create views = 0;\r\n\r\nSET @EnrichedViewDatabase = 'DataverseEnriched'\r\nSET @EnrichedViewSchema = 'dbo'\r\nSET @EnrichedColumnSuffix = ''\r\nSET @LanguageCode = 1033\r\nSET @BaseTableSuffix = ''\r\nSET @PreviewOnly = 0\r\n\r\n--=================================================================================================\r\n-- Do not edit the script below this point\r\n--=================================================================================================\r\n\r\n--Get column metadata from the Lake Database managed by Synapse Link for Dataverse\r\n--The column metadata will be stored as a JSON document in a scalar variable\r\n--This is needed as a workaround for the limitation of not allowing system objects to be used in distributed queries\r\nDECLARE @ColumnMetadata nvarchar(MAX), @ColumnMetadataSQL nvarchar(MAX)\r\n\r\n--Define the SQL statement to retrieve column metadata from the Lake Database managed by Synapse Link for Dataverse\r\n--Results will be stored as a JSON document in a variable\r\nSET @ColumnMetadataSQL = 'SET @ColumnMetadataOUT = (\r\nSELECT TABLE_SCHEMA, \r\n\tTABLE_NAME, \r\n\tCOLUMN_NAME, \r\n\tORDINAL_POSITION, \r\n\tDATA_TYPE\r\nFROM INFORMATION_SCHEMA.COLUMNS \r\nWHERE TABLE_SCHEMA = ''dbo''\r\n\tAND TABLE_NAME NOT IN (''OptionsetMetadata'', ''GlobalOptionsetMetadata'',''StateMetadata'',''StatusMetadata'', ''TargetMetadata'')\r\n\tAND TABLE_NAME LIKE ''%' + @BaseTableSuffix + '''\r\nFOR JSON AUTO)'\r\nDECLARE @ParmDefinition NVARCHAR(MAX);  \r\nSET @ParmDefinition = N'@ColumnMetadataOUT NVARCHAR(MAX) OUTPUT';  \r\nEXECUTE sp_executesql @ColumnMetadataSQL, @ParmDefinition, @ColumnMetadataOUT=@ColumnMetadata OUTPUT;  \r\n\r\n--Declare a variable to store a SQL statement for creating enriched views\r\nDECLARE @SQL nvarchar(MAX) = ''\r\n\r\n; WITH CM AS (\r\n--Parse column metadata variable and construct a table based on its content\r\nSELECT JSON_VALUE(CM.value, '$.TABLE_SCHEMA') AS TableSchema,\r\n\t JSON_VALUE(CM.value, '$.TABLE_NAME') AS TableName,\r\n\t LEFT(JSON_VALUE(CM.value, '$.TABLE_NAME'), LEN(JSON_VALUE(CM.value, '$.TABLE_NAME'))-LEN(@BaseTableSuffix)) AS EntityName,\r\n\t JSON_VALUE(CM.value, '$.COLUMN_NAME') AS ColumnName,\r\n\t CAST(JSON_VALUE(CM.value, '$.ORDINAL_POSITION') AS INT) AS OrdinalPosition,\r\n\t JSON_VALUE(CM.value, '$.DATA_TYPE') AS DataType\r\nFROM OPENJSON (@ColumnMetadata) AS CM\r\n)\r\n\r\n, OSM AS (\r\n--Get Option Set Metadata\r\nSELECT DISTINCT \r\n\tEntityName, \r\n\tOptionSetName, \r\n\tQUOTENAME(EntityName + '_' + OptionSetName) AS Alias\r\nFROM dbo.[OptionsetMetadata]\r\nWHERE LocalizedLabelLanguageCode = @LanguageCode\r\n)\r\n\r\n, GOSM AS (\r\n--Get Global Option Set Metadata\r\nSELECT DISTINCT \r\n\tOptionSetName, \r\n\tQUOTENAME('Global_' + OptionSetName) AS Alias\r\nFROM dbo.[GlobalOptionsetMetadata]\r\nWHERE LocalizedLabelLanguageCode = @LanguageCode\r\n)\r\n\r\n, StateM AS (\r\n--Get State Metadata\r\nSELECT DISTINCT \r\n\tEntityName, \r\n\tQUOTENAME(EntityName + '_State') AS Alias\r\nFROM dbo.[StateMetadata]\r\nWHERE LocalizedLabelLanguageCode = @LanguageCode\r\n)\r\n\r\n, StatusM AS (\r\n--Get Status Metadata\r\nSELECT DISTINCT \r\n\tEntityName,\r\n\tQUOTENAME(EntityName + '_Status') AS Alias\r\nFROM dbo.[StatusMetadata]\r\nWHERE LocalizedLabelLanguageCode = @LanguageCode\r\n)\r\n\r\n, SQLStatement AS (\r\n--Enumerate all lines in the source table and replace codes with labels where applicable\r\nSELECT CM.EntityName,\r\n\t--Before the first column of each table, construct a CREATE OR ALTER VIEW statement\r\n\tCASE WHEN CM.OrdinalPosition = 1\r\n\t\tTHEN 'CREATE OR ALTER VIEW ' + QUOTENAME(@EnrichedViewSchema) + '.' + CM.EntityName + '\r\n\t\tAS\r\n\t\tSELECT '\r\n\t\tELSE '\t,'\r\n\t\tEND\r\n\t--For each column, check if it needs to be replaced with a suitable localized label\r\n\t+ CASE \r\n\t\tWHEN OSM.OptionSetName IS NOT NULL THEN OSM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\r\n\t\tWHEN GOSM.OptionSetName IS NOT NULL THEN GOSM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\r\n\t\tWHEN StateM.EntityName IS NOT NULL THEN StateM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\r\n\t\tWHEN StatusM.EntityName IS NOT NULL THEN StatusM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\r\n\t\tELSE '[Base].' + QUOTENAME(CM.ColumnName)\r\n\t\tEND AS [SQLLine],\r\n\tCM.OrdinalPosition\r\nFROM CM \r\n\tLEFT JOIN OSM\r\n\t\tON CM.EntityName = OSM.EntityName\r\n\t\tAND CM.ColumnName = OSM.OptionSetName\r\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\r\n\tLEFT JOIN GOSM\r\n\t\tON CM.ColumnName = GOSM.OptionSetName\r\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\r\n\tLEFT JOIN StateM\r\n\t\tON CM.EntityName = StateM.EntityName\r\n\t\tAND CM.ColumnName = 'statecode'\r\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\r\n\tLEFT JOIN StatusM\r\n\t\tON CM.EntityName = StatusM.EntityName\r\n\t\tAND CM.ColumnName = 'statuscode'\r\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\r\n\r\nUNION ALL\r\n--Construct the first line of the FROM clause, referencing external tables created by Synapse Link for Dataverse\r\nSELECT DISTINCT\r\nCM.EntityName,\r\n'FROM ' + QUOTENAME(DB_NAME()) + '.' + QUOTENAME(CM.TableSchema) + '.' + QUOTENAME(CM.TableName) + ' AS Base' AS SQLLine,\r\n10000 AS OrdinalPosition\r\nFROM CM\r\n\r\nUNION ALL \r\n--Construct LEFT JOIN statements for each relevant OptionSetMetadata field\r\nSELECT DISTINCT OSM.EntityName AS EntityName,\r\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[OptionSetMetadata] AS ' + OSM.Alias + ' \r\n\t\tON ' + OSM.Alias + '.EntityName = ''' + OSM.EntityName + ''' \r\n\t\tAND ' + OSM.Alias + '.OptionSetName = ''' +  OSM.OptionSetName + '''\r\n\t\tAND [Base].' + QUOTENAME(OSM.OptionSetName) + ' = ' + OSM.Alias + '.[Option]\r\n\t\tAND ' + OSM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\r\n20000 AS OrdinalPosition\r\nFROM OSM\r\n\tJOIN CM\r\n\t\tON CM.EntityName = OSM.EntityName\r\n\t\tAND CM.ColumnName = OSM.OptionSetName\r\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\r\n\r\nUNION ALL \r\n--Construct LEFT JOIN statements for each relevant GlobalOptionSetMetadata field\r\nSELECT DISTINCT CM.EntityName AS EntityName,\r\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[GlobalOptionSetMetadata] AS ' + Alias + ' \r\n\t\tON ' + Alias + '.OptionSetName = ''' +  OptionSetName + '''\r\n\t\tAND [Base].' + QUOTENAME(OptionSetName) + ' = ' + Alias + '.[Option]\r\n\t\tAND ' + Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\r\n30000 AS OrdinalPosition\r\nFROM GOSM\r\n\tJOIN CM\r\n\t\tON CM.ColumnName = GOSM.OptionSetName\r\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\r\n\r\nUNION ALL \r\n--Construct LEFT JOIN statements for each relevant State Metadata field\r\nSELECT DISTINCT CM.EntityName AS EntityName,\r\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[StateMetadata] AS ' + StateM.Alias + ' \r\n\t\tON ' + StateM.Alias + '.EntityName = ''' + StateM.EntityName + ''' \r\n\t\tAND [Base].statecode' + ' = ' + StateM.Alias + '.[State]\r\n\t\tAND ' + StateM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\r\n40000 AS OrdinalPosition\r\nFROM StateM\r\n\tJOIN CM\r\n\t\tON CM.EntityName = StateM.EntityName\r\n\t\tAND CM.ColumnName = 'statecode'\r\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\r\n\r\nUNION ALL\r\n--Construct LEFT JOIN statements for each relevant Status Metadata field\r\nSELECT DISTINCT CM.EntityName AS EntityName,\r\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[StatusMetadata] AS ' + StatusM.Alias + ' \r\n\t\tON ' + StatusM.Alias + '.EntityName = ''' + StatusM.EntityName + ''' \r\n\t\tAND [Base].statuscode' + ' = ' + StatusM.Alias + '.[Status]\r\n\t\tAND ' + StatusM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\r\n40000 AS OrdinalPosition\r\nFROM StatusM\r\n\tJOIN CM\r\n\t\tON CM.EntityName = StatusM.EntityName\r\n\t\tAND CM.ColumnName = 'statuscode'\r\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\r\n\r\nUNION ALL\r\n--Add statement terminator\r\nSELECT DISTINCT\r\nEntityName,\r\n'; ' + CHAR(10) AS SQLLine,\r\n100000 AS OrdinalPosition\r\nFROM CM\r\n)\r\n\r\n--Construct individual statements to create views (1 view per row)\r\n--Since CREATE VIEW statement must be the first statement in a batch, assign each view definition to a variable \r\n--and use the EXEC(@variable) command to create view as part of its own, separate batch.\r\n, ViewDefinitions AS (\r\nSELECT 'DECLARE @' + EntityName + ' NVARCHAR(MAX) = ''\r\n\t' + REPLACE(STRING_AGG(CAST(SQLLine as varchar(MAX)), CHAR(10)) WITHIN GROUP (ORDER BY EntityName, OrdinalPosition, SQLLine), '''', '''''') + ''' ' + CHAR(10) + 'EXEC [' + @EnrichedViewDatabase + '].dbo.sp_executesql @' + EntityName + CHAR(10) AS ViewDefinition\r\nFROM SQLStatement\r\nGROUP BY EntityName\r\n)\r\n\r\n--Construct a comprehensive SQL statement to create all views\r\nSELECT @SQL = STRING_AGG(ViewDefinition, ';' + CHAR(10) + CHAR(10))\r\nFROM ViewDefinitions\r\n\r\n--Return a preview of the SQL Script to be generated or go ahead and create the views.\r\nIF @PreviewOnly = 1\r\nBEGIN\r\n\t--Return the final SQL statement\r\n\tSELECT '--================================================================================================='+ CHAR(10) +' ' + CHAR(10) AS [--SQL Statement]\r\n\tUNION ALL \r\n\tSELECT '-- A preview of the script to generate enriched views is provided below.'  AS [--SQL Statement]\r\n\tUNION ALL \r\n\tSELECT '-- No database objects have been created.' AS [--SQL Statement]\r\n\tUNION ALL \r\n\tSELECT '-- Re-run this script with the @PreviewOnly parameter set to 0 to actually create the views.' AS [--SQL Statement]\r\n\tUNION ALL \r\n\tSELECT '--================================================================================================='+ CHAR(10) +' ' + CHAR(10) AS [--SQL Statement]\r\n\tUNION ALL \r\n\tSELECT VALUE AS [--SQL Statement] FROM STRING_SPLIT(@SQL, CHAR(10))\r\nEND\r\nELSE\r\nBEGIN\r\n\t--Execute the SQL statement\r\n\tPRINT 'Beginning view creation'\r\n\tEXEC sp_executesql @SQL\r\n\tPRINT 'Completed view creation'\r\nEND"
								}
							]
						}
					},
					{
						"name": "Data Set A",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "Curated",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "test",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"Accounts": {},
									"sink1": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "Potential Filter Based on Office",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "Curated",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "test",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"Accounts": {},
									"sink1": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "Data Set B",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "Curated",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "test",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"Accounts": {},
									"sink1": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:41:16Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/dataflows/PH 1 FullEnrich No Cache')]",
				"[concat(variables('workspaceId'), '/linkedServices/prod-synapse-uks-001-WorkspaceDefaultStorage')]",
				"[concat(variables('workspaceId'), '/dataflows/PH 4 BA Activity DatasetReports')]",
				"[concat(variables('workspaceId'), '/linkedServices/prod-synapse-uks-001-WorkspaceDefaultSqlServer')]",
				"[concat(variables('workspaceId'), '/dataflows/test')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Master Control')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Source to Raw",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "EX_SourceToRaw_Parent",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"SliceDate": {
									"value": "@pipeline().parameters.SliceDate",
									"type": "Expression"
								},
								"Area": {
									"value": "@pipeline().parameters.Area",
									"type": "Expression"
								},
								"Domain": {
									"value": "@pipeline().parameters.Domain",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Raw to Base",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Source to Raw",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "R2B_CSV_Parent",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Area": {
									"value": "@pipeline().parameters.Area",
									"type": "Expression"
								},
								"Domain": {
									"value": "@pipeline().parameters.Domain",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Base to Enrich",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Raw to Base",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "B2E_Parent",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Area": {
									"value": "@pipeline().parameters.Area",
									"type": "Expression"
								},
								"Domain": {
									"value": "@pipeline().parameters.Domain",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Enrich To Curate",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Base to Enrich",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "DYN_EnrToCurated_Parent",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Region": {
									"value": "@pipeline().parameters.Region",
									"type": "Expression"
								},
								"Area": {
									"value": "@pipeline().parameters.Area",
									"type": "Expression"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"SliceDate": {
						"type": "string"
					},
					"Area": {
						"type": "string"
					},
					"Domain": {
						"type": "string"
					},
					"Region": {
						"type": "string"
					}
				},
				"variables": {
					"EnrichJobs": {
						"type": "String"
					}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:45:01Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/pipelines/EX_SourceToRaw_Parent')]",
				"[concat(variables('workspaceId'), '/pipelines/R2B_CSV_Parent')]",
				"[concat(variables('workspaceId'), '/pipelines/B2E_Parent')]",
				"[concat(variables('workspaceId'), '/pipelines/DYN_EnrToCurated_Parent')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Master Control_With_Curated')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Source to Raw",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "EX_SourceToRaw_Parent",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"SliceDate": {
									"value": "@pipeline().parameters.SliceDate",
									"type": "Expression"
								},
								"Area": {
									"value": "@pipeline().parameters.Area",
									"type": "Expression"
								},
								"Domain": {
									"value": "@pipeline().parameters.Domain",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Raw to Base",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Source to Raw",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "R2B_CSV_Parent",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Area": {
									"value": "@pipeline().parameters.Area",
									"type": "Expression"
								},
								"Domain": {
									"value": "@pipeline().parameters.Domain",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Base to Enrich",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Raw to Base",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "B2E_Parent",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Area": {
									"value": "@pipeline().parameters.Area",
									"type": "Expression"
								},
								"Domain": {
									"value": "@pipeline().parameters.Domain",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Enrich To Curate",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Base to Enrich",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "DYN_EnrToCurated_Parent",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Region": {
									"value": "@pipeline().parameters.Region",
									"type": "Expression"
								},
								"Area": {
									"value": "@pipeline().parameters.Area",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Post Processing Maintenance",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Enrich To Curate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "PE_Parent",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Area": "Simphony"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"SliceDate": {
						"type": "string"
					},
					"Area": {
						"type": "string"
					},
					"Domain": {
						"type": "string"
					},
					"Region": {
						"type": "string"
					}
				},
				"variables": {
					"EnrichJobs": {
						"type": "String"
					}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:45:05Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/pipelines/EX_SourceToRaw_Parent')]",
				"[concat(variables('workspaceId'), '/pipelines/R2B_CSV_Parent')]",
				"[concat(variables('workspaceId'), '/pipelines/B2E_Parent')]",
				"[concat(variables('workspaceId'), '/pipelines/DYN_EnrToCurated_Parent')]",
				"[concat(variables('workspaceId'), '/pipelines/PE_Parent')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/PE_Parent')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Initiate Parent Process",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[Process].[InitiateParentLoad]",
								"storedProcedureParameters": {
									"ADFExecution": {
										"type": "String",
										"value": {
											"value": "@pipeline().RunId",
											"type": "Expression"
										}
									},
									"Area": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.Area",
											"type": "Expression"
										}
									},
									"EntityStageID": {
										"type": "Int32",
										"value": "-1"
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_AnalyticsHub_DYN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Get Jobs to Run",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Initiate Parent Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[Process].[GetChildProcesses]",
								"storedProcedureParameters": {
									"ParentProcessID": {
										"type": "Int32",
										"value": {
											"value": "@activity('Initiate Parent Process').output.firstRow.ParentProcessID",
											"type": "Expression"
										}
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_AnalyticsHub_DYN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Run Child Processes",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Get Jobs to Run",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get Jobs to Run').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "Run Post Execution Pipeline",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "PE_Single",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"ProcessId": {
												"value": "@item().ProcessID",
												"type": "Expression"
											},
											"ProcessSubType": {
												"value": "@item().ProcessSubType",
												"type": "Expression"
											},
											"EntityStageId": {
												"value": "@item().EntityStageID",
												"type": "Expression"
											},
											"stageName": {
												"value": "@item().StageName",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					},
					{
						"name": "Finalise Parent Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Run Child Processes",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FinaliseProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@activity('Initiate Parent Process').output.firstRow.ParentProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail Parent Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Run Child Processes",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FailProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@activity('Initiate Parent Process').output.firstRow.ParentProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Area": {
						"type": "string",
						"defaultValue": "Simphony"
					}
				},
				"folder": {
					"name": "4 - PostExecution"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:41:21Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/DS_AnalyticsHub_DYN')]",
				"[concat(variables('workspaceId'), '/linkedServices/LS_SQL_AnalyticsHub')]",
				"[concat(variables('workspaceId'), '/pipelines/PE_Single')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/PE_Single')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Start Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[StartProcess]",
							"storedProcedureParameters": {
								"ADFExecution": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessId",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Run Enrichment Notebook",
						"type": "DatabricksNotebook",
						"dependsOn": [
							{
								"activity": "Start Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebookPath": {
								"value": "/Hydr8 Framework/Utilities/@{pipeline().parameters.ProcessSubType}",
								"type": "Expression"
							},
							"baseParameters": {
								"entityStageId": {
									"value": "@string(pipeline().parameters.EntityStageID)",
									"type": "Expression"
								},
								"stageName": {
									"value": "@pipeline().parameters.stageName",
									"type": "Expression"
								},
								"processId": {
									"value": "@string(pipeline().parameters.ProcessID)",
									"type": "Expression"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LB_DBX_EngineeringSml",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Finalise Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Run Enrichment Notebook",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FinaliseProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessId",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Run Enrichment Notebook",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FailProcess]",
							"storedProcedureParameters": {
								" ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessId",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"ProcessId": {
						"type": "int"
					},
					"ProcessSubType": {
						"type": "string"
					},
					"EntityStageId": {
						"type": "string"
					},
					"stageName": {
						"type": "string",
						"defaultValue": "POST"
					}
				},
				"folder": {
					"name": "4 - PostExecution"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:35:36Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_SQL_AnalyticsHub')]",
				"[concat(variables('workspaceId'), '/linkedServices/LB_DBX_EngineeringSml')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/PH 1 Enrich Data for RAW')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Data flow1",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "PH 1 FullEnrich Only",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"AccountIn": {},
									"OriginationOpportunityIn": {},
									"MeetingsAppointmentsIn": {},
									"ContactsIn": {},
									"EnrichedAccount": {},
									"EnrichedOriginationOpportunities": {},
									"EnrichedMeetingAppointments": {},
									"EnrichedContacts": {},
									"SystemUserIn": {},
									"EnrichedSystemUser": {},
									"AccountCleanSink": {},
									"MeetingStageCleanSink": {},
									"ContactsStageCleanSink": {},
									"OriginationCleanSink": {},
									"SinkEnrichedOrigination": {},
									"SinkEnrichedAccount": {},
									"SinkEnrichedMeeting": {},
									"SinkEnrichedContacts": {},
									"SystemUserSink": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "prod-synapse-uks-001-WorkspaceDefaultStorage",
									"type": "LinkedServiceReference"
								},
								"folderPath": "users/stage"
							},
							"compute": {
								"coreCount": 8,
								"computeType": "MemoryOptimized"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:41:26Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/dataflows/PH 1 FullEnrich Only')]",
				"[concat(variables('workspaceId'), '/linkedServices/prod-synapse-uks-001-WorkspaceDefaultStorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/PH 1A Enriched Dataset Seperate Tables')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "PrimaryEnrichment",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "PH Full InputDataflow_Split Table",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"AccountIn": {},
									"OriginationOpportunityIn": {},
									"MeetingsAppointmentsIn": {},
									"ContactsIn": {},
									"SystemuserSource": {},
									"EnrichedAccount": {},
									"EnrichedOriginationOpportunities": {},
									"EnrichedMeetingAppointments": {},
									"EnrichedContacts": {},
									"EnrichedSystemuser": {},
									"AccountCleanSink": {},
									"MeetingStageCleanSink": {},
									"ContactsStageCleanSink": {},
									"OriginationCleanSink": {},
									"SystemUserCleanSink": {},
									"SinkEnrichedOrigination": {},
									"SinkEnrichedAccount": {},
									"SinkEnrichedMeeting": {},
									"SinkEnrichedContacts": {},
									"SinkEnrichedSystemUser": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "ADLSLinkedService",
									"type": "LinkedServiceReference"
								},
								"folderPath": "users/stage"
							},
							"compute": {
								"coreCount": 16,
								"computeType": "MemoryOptimized"
							},
							"traceLevel": "Coarse"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:44:36Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/dataflows/PH Full InputDataflow_Split Table')]",
				"[concat(variables('workspaceId'), '/linkedServices/ADLSLinkedService')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/PauseSQL')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Get List",
						"type": "WebActivity",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": {
								"value": "@concat('https://management.azure.com/subscriptions/',pipeline().parameters.SubscriptionID,'/resourceGroups/',pipeline().parameters.ResourceGroup,'/providers/Microsoft.Synapse/workspaces/',pipeline().parameters.WorkspaceName,'/sqlPools?api-version=2019-06-01-preview')\n",
								"type": "Expression"
							},
							"connectVia": {
								"referenceName": "AutoResolveIntegrationRuntime",
								"type": "IntegrationRuntimeReference"
							},
							"method": "GET",
							"headers": {},
							"authentication": {
								"type": "MSI",
								"resource": "https://management.azure.com/"
							}
						}
					},
					{
						"name": "Filter_Servers",
						"type": "Filter",
						"dependsOn": [
							{
								"activity": "Get List",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get list').output.value",
								"type": "Expression"
							},
							"condition": {
								"value": "@not(endswith(item().name,'prod'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "ForEach_pool",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Filter_Servers",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Filter_Servers').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "CheckState",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "@concat('https://management.azure.com/subscriptions/',pipeline().parameters.SubscriptionID,'/resourceGroups/',pipeline().parameters.ResourceGroup,'/providers/Microsoft.Synapse/workspaces/',pipeline().parameters.WorkspaceName,'/sqlPools/',item().name,'?api-version=2019-06-01-preview')",
											"type": "Expression"
										},
										"connectVia": {
											"referenceName": "AutoResolveIntegrationRuntime",
											"type": "IntegrationRuntimeReference"
										},
										"method": "GET",
										"headers": {},
										"authentication": {
											"type": "MSI",
											"resource": "https://management.azure.com/"
										}
									}
								},
								{
									"name": "State-PauseOrResume",
									"type": "Switch",
									"dependsOn": [
										{
											"activity": "CheckState",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"on": {
											"value": "@concat(activity('CheckState').output.properties.status,'-',pipeline().parameters.PauseOrResume)",
											"type": "Expression"
										},
										"cases": [
											{
												"value": "Paused-Resume",
												"activities": [
													{
														"name": "Web1",
														"type": "WebActivity",
														"dependsOn": [],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"url": {
																"value": "@concat('https://management.azure.com/subscriptions/',pipeline().parameters.SubscriptionID,'/resourceGroups/',pipeline().parameters.ResourceGroup,'/providers/Microsoft.Synapse/workspaces/',pipeline().parameters.WorkspaceName,'/sqlPools/',activity('CheckState').output.name,'/resume?api-version=2019-06-01-preview')",
																"type": "Expression"
															},
															"connectVia": {
																"referenceName": "AutoResolveIntegrationRuntime",
																"type": "IntegrationRuntimeReference"
															},
															"method": "POST",
															"headers": {},
															"body": "Resume",
															"authentication": {
																"type": "MSI",
																"resource": "https://management.azure.com/"
															}
														}
													}
												]
											},
											{
												"value": "Online-Pause",
												"activities": [
													{
														"name": "Web2",
														"type": "WebActivity",
														"dependsOn": [],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"url": {
																"value": "@concat('https://management.azure.com/subscriptions/',pipeline().parameters.SubscriptionID,'/resourceGroups/',pipeline().parameters.ResourceGroup,'/providers/Microsoft.Synapse/workspaces/',pipeline().parameters.WorkspaceName,'/sqlPools/',activity('CheckState').output.name,'/pause?api-version=2019-06-01-preview')",
																"type": "Expression"
															},
															"connectVia": {
																"referenceName": "AutoResolveIntegrationRuntime",
																"type": "IntegrationRuntimeReference"
															},
															"method": "POST",
															"headers": {},
															"body": "Pause",
															"authentication": {
																"type": "MSI",
																"resource": "https://management.azure.com/"
															}
														}
													}
												]
											}
										]
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"ResourceGroup": {
						"type": "string",
						"defaultValue": "MontaguData"
					},
					"SubscriptionID": {
						"type": "string",
						"defaultValue": "5c1bc415-b561-4700-9cbe-71f1079bb536"
					},
					"WorkspaceName": {
						"type": "string",
						"defaultValue": "prod-synapse-uks-001"
					},
					"SQLPoolName": {
						"type": "string",
						"defaultValue": "ReportsDW"
					},
					"PauseorResume": {
						"type": "string",
						"defaultValue": "Pause"
					}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:25:37Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/PopulateRESTful')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Countries Lookup",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"dataset": {
								"referenceName": "CountrieConfig",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "For Each Country",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Countries Lookup",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Countries Lookup').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Copy Rest to ADLS",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "RestSource",
											"httpRequestTimeout": "00:04:40",
											"requestInterval": "00.00:00:00.010",
											"requestMethod": "GET",
											"paginationRules": {
												"supportRFC5988": "true"
											}
										},
										"sink": {
											"type": "JsonSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "JsonWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "CountriesRest",
											"type": "DatasetReference",
											"parameters": {
												"CountryName": {
													"value": "@item().CountryName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "jsoncountries",
											"type": "DatasetReference",
											"parameters": {
												"CountryName": {
													"value": "@item().CountryName",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:41:34Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/CountrieConfig')]",
				"[concat(variables('workspaceId'), '/datasets/CountriesRest')]",
				"[concat(variables('workspaceId'), '/datasets/jsoncountries')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/R2B_CSV_CleanseCSV')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Start Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[StartProcess]",
							"storedProcedureParameters": {
								"ADFExecution": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									}
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Run Cleanse CSV",
						"type": "DatabricksNotebook",
						"dependsOn": [
							{
								"activity": "Start Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebookPath": {
								"value": "/Hydr8 Framework/Validation/@{pipeline().parameters.ProcessSubType}",
								"type": "Expression"
							},
							"baseParameters": {
								"processId": {
									"value": "@string(pipeline().parameters.ProcessID)",
									"type": "Expression"
								},
								"entityStageId": {
									"value": "@string(pipeline().parameters.EntityStageID)",
									"type": "Expression"
								},
								"stageName": {
									"value": "@pipeline().parameters.Zone",
									"type": "Expression"
								},
								"entityName": {
									"value": "@pipeline().parameters.TableName",
									"type": "Expression"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LB_DBX_EngineeringSml",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Finalise Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Run Cleanse CSV",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FinaliseProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Run Cleanse CSV",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FailProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Log Process Throughput - Good",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Finalise Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[LogThroughput]",
							"storedProcedureParameters": {
								"CountName": {
									"value": "goodRows",
									"type": "String"
								},
								"CountValue": {
									"value": {
										"value": "@activity('Run Cleanse CSV').Output.runOutput.goodRows",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Add Dependencies to Queue",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Finalise Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[InitiateDependency]",
							"storedProcedureParameters": {
								"EntityStageID": {
									"value": {
										"value": "@pipeline().parameters.EntityStageID",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"SlicePath": {
									"value": {
										"value": "@concat('Year=',pipeline().parameters.Year,'/Month=',pipeline().parameters.Month,'/Day=',pipeline().parameters.Day)",
										"type": "Expression"
									},
									"type": "String"
								},
								"MultiLine": {
									"value": "0"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Log Process Throughput - Reject",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Finalise Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[LogThroughput]",
							"storedProcedureParameters": {
								"CountName": {
									"value": "rejectedRows",
									"type": "String"
								},
								"CountValue": {
									"value": {
										"value": "@activity('Run Cleanse CSV').Output.runOutput.rejectedRows",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Log Process Throughput - Total",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Finalise Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[LogThroughput]",
							"storedProcedureParameters": {
								"CountName": {
									"value": "totalRows",
									"type": "String"
								},
								"CountValue": {
									"value": {
										"value": "@activity('Run Cleanse CSV').Output.runOutput.totalRows",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Log Process Throughput - DuplicateRows",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Finalise Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[LogThroughput]",
							"storedProcedureParameters": {
								"CountName": {
									"value": "duplicateRows",
									"type": "String"
								},
								"CountValue": {
									"value": {
										"value": "@activity('Run Cleanse CSV').Output.runOutput.duplicateRows",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Log Process Throughput - validRows",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Finalise Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[LogThroughput]",
							"storedProcedureParameters": {
								"CountName": {
									"value": "validRows",
									"type": "String"
								},
								"CountValue": {
									"value": {
										"value": "@activity('Run Cleanse CSV').Output.runOutput.validRows",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"ProcessID": {
									"value": {
										"value": "@pipeline().parameters.ProcessID",
										"type": "Expression"
									}
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"TableName": {
						"type": "string"
					},
					"Zone": {
						"type": "string"
					},
					"Year": {
						"type": "string"
					},
					"Month": {
						"type": "string"
					},
					"Day": {
						"type": "string"
					},
					"Area": {
						"type": "string"
					},
					"Domain": {
						"type": "string"
					},
					"Classification": {
						"type": "string"
					},
					"EntityStageID": {
						"type": "int"
					},
					"ProcessID": {
						"type": "int"
					},
					"Version": {
						"type": "string"
					},
					"ProcessSubType": {
						"type": "string"
					}
				},
				"folder": {
					"name": "1 - RawToBase"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:35:40Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_SQL_AnalyticsHub')]",
				"[concat(variables('workspaceId'), '/linkedServices/LB_DBX_EngineeringSml')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/R2B_CSV_Parent')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Initiate Parent Process",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[Process].[InitiateParentLoad]",
								"storedProcedureParameters": {
									"ADFExecution": {
										"type": "String",
										"value": {
											"value": "@pipeline().RunId",
											"type": "Expression"
										}
									},
									"Area": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.Area",
											"type": "Expression"
										}
									},
									"EntityStageID": {
										"type": "Int32",
										"value": null
									},
									"ParentProcessID": {
										"type": "Int32",
										"value": null
									},
									"ProcessFilter": {
										"type": "String",
										"value": "%"
									},
									"Stage": {
										"type": "String",
										"value": "Base"
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_AnalyticsHub_DYN",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Get Jobs to Run",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Initiate Parent Process",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[Process].[GetChildProcesses]",
								"storedProcedureParameters": {
									"ParentProcessID": {
										"type": "Int32",
										"value": {
											"value": "@activity('Initiate Parent Process').output.firstRow.ParentProcessID",
											"type": "Expression"
										}
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_AnalyticsHub_DYN",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Run Child Processes",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Get Jobs to Run",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get Jobs to Run').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "Run Copy Pipeline",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "R2B_CSV_CleanseCSV",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"TableName": {
												"value": "@item().EntityName",
												"type": "Expression"
											},
											"Zone": {
												"value": "@item().StageName",
												"type": "Expression"
											},
											"Year": {
												"value": "@item().Year",
												"type": "Expression"
											},
											"Month": {
												"value": "@item().Month",
												"type": "Expression"
											},
											"Day": {
												"value": "@item().Day",
												"type": "Expression"
											},
											"Area": {
												"value": "@item().Area",
												"type": "Expression"
											},
											"Domain": {
												"value": "@item().Domain",
												"type": "Expression"
											},
											"Classification": {
												"value": "@item().Classification",
												"type": "Expression"
											},
											"EntityStageID": {
												"value": "@item().EntityStageID",
												"type": "Expression"
											},
											"ProcessID": {
												"value": "@item().ProcessID",
												"type": "Expression"
											},
											"Version": {
												"value": "@item().Version",
												"type": "Expression"
											},
											"ProcessSubType": {
												"value": "@item().ProcessSubType",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					},
					{
						"name": "Finalise Parent Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Run Child Processes",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FinaliseProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@activity('Initiate Parent Process').output.firstRow.ParentProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail Parent Process",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Run Child Processes",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[Process].[FailProcess]",
							"storedProcedureParameters": {
								"ProcessID": {
									"value": {
										"value": "@activity('Initiate Parent Process').output.firstRow.ParentProcessID",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_AnalyticsHub",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Area": {
						"type": "string"
					},
					"Domain": {
						"type": "string"
					}
				},
				"folder": {
					"name": "1 - RawToBase"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:41:37Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/DS_AnalyticsHub_DYN')]",
				"[concat(variables('workspaceId'), '/linkedServices/LS_SQL_AnalyticsHub')]",
				"[concat(variables('workspaceId'), '/pipelines/R2B_CSV_CleanseCSV')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ResumeSQL')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Get List",
						"type": "WebActivity",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": {
								"value": "@concat('https://management.azure.com/subscriptions/',pipeline().parameters.SubscriptionID,'/resourceGroups/',pipeline().parameters.ResourceGroup,'/providers/Microsoft.Synapse/workspaces/',pipeline().parameters.WorkspaceName,'/sqlPools?api-version=2019-06-01-preview')\n",
								"type": "Expression"
							},
							"connectVia": {
								"referenceName": "AutoResolveIntegrationRuntime",
								"type": "IntegrationRuntimeReference"
							},
							"method": "GET",
							"headers": {},
							"authentication": {
								"type": "MSI",
								"resource": "https://management.azure.com/"
							}
						}
					},
					{
						"name": "Filter_Servers",
						"type": "Filter",
						"dependsOn": [
							{
								"activity": "Get List",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get list').output.value",
								"type": "Expression"
							},
							"condition": {
								"value": "@not(endswith(item().name,'prod'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "ForEach_pool",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Filter_Servers",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Filter_Servers').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "CheckState",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "@concat('https://management.azure.com/subscriptions/',pipeline().parameters.SubscriptionID,'/resourceGroups/',pipeline().parameters.ResourceGroup,'/providers/Microsoft.Synapse/workspaces/',pipeline().parameters.WorkspaceName,'/sqlPools/',item().name,'?api-version=2019-06-01-preview')",
											"type": "Expression"
										},
										"connectVia": {
											"referenceName": "AutoResolveIntegrationRuntime",
											"type": "IntegrationRuntimeReference"
										},
										"method": "GET",
										"headers": {},
										"authentication": {
											"type": "MSI",
											"resource": "https://management.azure.com/"
										}
									}
								},
								{
									"name": "State-PauseOrResume",
									"type": "Switch",
									"dependsOn": [
										{
											"activity": "CheckState",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"on": {
											"value": "@concat(activity('CheckState').output.properties.status,'-',pipeline().parameters.PauseOrResume)",
											"type": "Expression"
										},
										"cases": [
											{
												"value": "Paused-Resume",
												"activities": [
													{
														"name": "Web1",
														"type": "WebActivity",
														"dependsOn": [],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"url": {
																"value": "@concat('https://management.azure.com/subscriptions/',pipeline().parameters.SubscriptionID,'/resourceGroups/',pipeline().parameters.ResourceGroup,'/providers/Microsoft.Synapse/workspaces/',pipeline().parameters.WorkspaceName,'/sqlPools/',activity('CheckState').output.name,'/resume?api-version=2019-06-01-preview')",
																"type": "Expression"
															},
															"connectVia": {
																"referenceName": "AutoResolveIntegrationRuntime",
																"type": "IntegrationRuntimeReference"
															},
															"method": "POST",
															"headers": {},
															"body": "Resume",
															"authentication": {
																"type": "MSI",
																"resource": "https://management.azure.com/"
															}
														}
													}
												]
											},
											{
												"value": "Online-Pause",
												"activities": [
													{
														"name": "Web2",
														"type": "WebActivity",
														"dependsOn": [],
														"policy": {
															"timeout": "7.00:00:00",
															"retry": 0,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"url": {
																"value": "@concat('https://management.azure.com/subscriptions/',pipeline().parameters.SubscriptionID,'/resourceGroups/',pipeline().parameters.ResourceGroup,'/providers/Microsoft.Synapse/workspaces/',pipeline().parameters.WorkspaceName,'/sqlPools/',activity('CheckState').output.name,'/pause?api-version=2019-06-01-preview')",
																"type": "Expression"
															},
															"connectVia": {
																"referenceName": "AutoResolveIntegrationRuntime",
																"type": "IntegrationRuntimeReference"
															},
															"method": "POST",
															"headers": {},
															"body": "Pause",
															"authentication": {
																"type": "MSI",
																"resource": "https://management.azure.com/"
															}
														}
													}
												]
											}
										]
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"ResourceGroup": {
						"type": "string",
						"defaultValue": "MontaguData"
					},
					"SubscriptionID": {
						"type": "string",
						"defaultValue": "5c1bc415-b561-4700-9cbe-71f1079bb536"
					},
					"WorkspaceName": {
						"type": "string",
						"defaultValue": "prod-synapse-uks-001"
					},
					"SQLPoolName": {
						"type": "string",
						"defaultValue": "ReportsDW"
					},
					"PauseorResume": {
						"type": "string",
						"defaultValue": "Resume"
					}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:25:43Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ScriptRunTest')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Script1",
						"type": "Script",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "ServerLessSQL2",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "SELECT TOP (100) [Id]\r\n,[SinkCreatedOn]\r\n,[SinkModifiedOn]\r\n,[statecode]\r\n,[statuscode]\r\n,[ts_primarysecondaryfocus]\r\n,[customertypecode]\r\n,[address1_addresstypecode]\r\n,[accountclassificationcode]\r\n,[ts_easeofworking]\r\n,[ts_ukrow]\r\n,[preferredappointmenttimecode]\r\n,[ts_address1addresstype]\r\n,[xpd_relationshipstatus]\r\n,[ts_relationship]\r\n,[xpd_remindermonths]\r\n,[ts_importance]\r\n,[address2_freighttermscode]\r\n,[ts_irrvsmomperformancemeasure]\r\n,[ts_introducertype]\r\n,[accountcategorycode]\r\n,[paymenttermscode]\r\n,[preferredappointmentdaycode]\r\n,[businesstypecode]\r\n,[industrycode]\r\n,[ts_sizeoffirm]\r\n,[ts_interaction]\r\n,[address1_shippingmethodcode]\r\n,[ts_portfoliocompanystatus]\r\n,[customersizecode]\r\n,[xpd_previousinvestorstatus]\r\n,[ts_recommendationoffirm]\r\n,[preferredcontactmethodcode]\r\n,[accountratingcode]\r\n,[ts_investorstatus]\r\n,[ts_capabilitiesoffirm]\r\n,[mpe_flowlastrunoutcome]\r\n,[address2_addresstypecode]\r\n,[address2_shippingmethodcode]\r\n,[ts_nextoriginationmeetingarranged]\r\n,[ownershipcode]\r\n,[territorycode]\r\n,[ts_investortype]\r\n,[shippingmethodcode]\r\n,[ts_investorregion]\r\n,[address1_freighttermscode]\r\n,[xpd_function]\r\n,[ts_quickcaptureuses]\r\n,[xpd_montagulevel]\r\n,[ts_permanentinterim]\r\n,[ts_quickcapturesectors]\r\n,[ts_roletypes]\r\n,[ts_companytype]\r\n,[xpd_level]\r\n,[ts_indicativeclientbase]\r\n,[xpd_specialisms]\r\n,[ts_vendorsummary]\r\n,[ts_producttype]\r\n,[ts_montaguoffice]\r\n,[ts_quickcapturegeography]\r\n,[xpd_roletypes]\r\n,[mpe_livedeal]\r\n,[donotbulkpostalmail]\r\n,[donotpostalmail]\r\n,[msdyn_gdproptout]\r\n,[ts_organisationalchange]\r\n,[xpd_publictoprivatetracker]\r\n,[ts_auditor]\r\n,[donotsendmm]\r\n,[donotbulkemail]\r\n,[followemail]\r\n,[creditonhold]\r\n,[marketingonly]\r\n,[participatesinworkflow]\r\n,[merged]\r\n,[ts_validated]\r\n,[xpd_sharepointlocationcreated]\r\n,[xpd_setreminder]\r\n,[ts_personnelchange]\r\n,[donotfax]\r\n,[isprivate]\r\n,[donotphone]\r\n,[xpd_rpo]\r\n,[ts_trackcompany]\r\n,[donotemail]\r\n,[parentaccountid]\r\n,[parentaccountid_entitytype]\r\n,[ts_recommendedby]\r\n,[ts_recommendedby_entitytype]\r\n,[ts_countryofeconomicoriginforthecapital]\r\n,[ts_countryofeconomicoriginforthecapital_entitytype]\r\n,[xpd_reminderto]\r\n,[xpd_reminderto_entitytype]\r\n,[preferredserviceid]\r\n,[preferredserviceid_entitytype]\r\n,[msdyn_segmentid]\r\n,[msdyn_segmentid_entitytype]\r\n,[owningbusinessunit]\r\n,[owningbusinessunit_entitytype]\r\n,[createdbyexternalparty]\r\n,[createdbyexternalparty_entitytype]\r\n,[ts_validatedby]\r\n,[ts_validatedby_entitytype]\r\n,[modifiedonbehalfby]\r\n,[modifiedonbehalfby_entitytype]\r\n,[transactioncurrencyid]\r\n,[transactioncurrencyid_entitytype]\r\n,[ts_primarymperelationshipmanager]\r\n,[ts_primarymperelationshipmanager_entitytype]\r\n,[modifiedbyexternalparty]\r\n,[modifiedbyexternalparty_entitytype]\r\n,[ts_headofficeid]\r\n,[ts_headofficeid_entitytype]\r\n,[ts_address1country]\r\n,[ts_address1country_entitytype]\r\n,[ts_address1usstate]\r\n,[ts_address1usstate_entitytype]\r\n,[msdyn_salesaccelerationinsightid]\r\n,[msdyn_salesaccelerationinsightid_entitytype]\r\n,[slaid]\r\n,[slaid_entitytype]\r\n,[originatingleadid]\r\n,[originatingleadid_entitytype]\r\n,[masterid]\r\n,[masterid_entitytype]\r\n,[ts_originationlead1]\r\n,[ts_originationlead1_entitytype]\r\n,[defaultpricelevelid]\r\n,[defaultpricelevelid_entitytype]\r\n,[owninguser]\r\n,[owninguser_entitytype]\r\n,[ts_originationlead2]\r\n,[ts_originationlead2_entitytype]\r\n,[slainvokedid]\r\n,[slainvokedid_entitytype]\r\n,[mpe_coinvestquestionnaireid]\r\n,[mpe_coinvestquestionnaireid_entitytype]\r\n,[ts_hub]\r\n,[ts_hub_entitytype]\r\n,[owningteam]\r\n,[owningteam_entitytype]\r\n,[ts_currentauditor]\r\n,[ts_currentauditor_entitytype]\r\n,[primarycontactid]\r\n,[primarycontactid_entitytype]\r\n,[modifiedby]\r\n,[modifiedby_entitytype]\r\n,[preferredsystemuserid]\r\n,[preferredsystemuserid_entitytype]\r\n,[preferredequipmentid]\r\n,[preferredequipmentid_entitytype]\r\n,[xpd_fund]\r\n,[xpd_fund_entitytype]\r\n,[createdonbehalfby]\r\n,[createdonbehalfby_entitytype]\r\n,[createdby]\r\n,[createdby_entitytype]\r\n,[territoryid]\r\n,[territoryid_entitytype]\r\n,[ownerid]\r\n,[ownerid_entitytype]\r\n,[xpd_totalinstitutionalcommitments_base]\r\n,[ts_minimumticketsize_base]\r\n,[xpd_totalinstitutionalcommitments]\r\n,[aging30]\r\n,[creditlimit]\r\n,[creditlimit_base]\r\n,[ts_totalcommitments_base]\r\n,[aging60]\r\n,[ts_transfersin_base]\r\n,[aging90]\r\n,[ts_maximumticketsize]\r\n,[ts_totalaum_base]\r\n,[marketcap_base]\r\n,[aging60_base]\r\n,[aging90_base]\r\n,[ts_transfersout]\r\n,[ts_maximumticketsize_base]\r\n,[ts_originalcommitments_base]\r\n,[revenue]\r\n,[ts_totalcommitments]\r\n,[ts_transfersout_base]\r\n,[ts_totalaum]\r\n,[ts_commitmentreductions_base]\r\n,[ts_commitmentreductions]\r\n,[marketcap]\r\n,[ts_originalcommitments]\r\n,[ts_minimumticketsize]\r\n,[revenue_base]\r\n,[openrevenue_base]\r\n,[aging30_base]\r\n,[openrevenue]\r\n,[ts_transfersin]\r\n,[ts_othernotes]\r\n,[ts_transfersin_date]\r\n,[msdyn_salesaccelerationinsightidname]\r\n,[address1_county]\r\n,[openrevenue_date]\r\n,[ts_recommendedbyname]\r\n,[ts_relationshipinteractioncomments]\r\n,[ts_originationlead2yominame]\r\n,[parentaccountidname]\r\n,[xpd_roletypes_text]\r\n,[address1_addressid]\r\n,[importsequencenumber]\r\n,[address1_longitude]\r\n,[ts_countryofeconomicoriginforthecapitalname]\r\n,[entityimageid]\r\n,[telephone2]\r\n,[ts_lastoriginationmeeting]\r\n,[address2_utcoffset]\r\n,[address1_upszone]\r\n,[ts_originalcommitments_state]\r\n,[ts_typicalcost]\r\n,[xpd_recommendingportfoliocompaniesrecommended]\r\n,[accountnumber]\r\n,[ts_currentauditoryominame]\r\n,[ts_originalcommitments_date]\r\n,[lastonholdtime]\r\n,[ts_sectorscoveredbyfirm]\r\n,[address1_telephone1]\r\n,[address1_telephone2]\r\n,[address1_telephone3]\r\n,[address2_upszone]\r\n,[opendeals_state]\r\n,[xpd_functionuse_text]\r\n,[slainvokedidname]\r\n,[address2_longitude]\r\n,[defaultpricelevelidname]\r\n,[stockexchange]\r\n,[mpe_liveofferingscount_date]\r\n,[xpd_relationshipcomments]\r\n,[originatingleadidname]\r\n,[slaname]\r\n,[ts_currentauditorname]\r\n,[xpd_remindertoyominame]\r\n,[ts_address1usstatename]\r\n,[ts_tempcompanytype]\r\n,[versionnumber]\r\n,[address1_latitude]\r\n,[ts_formername]\r\n,[yominame]\r\n,[createdbyyominame]\r\n,[ts_cityofvisit]\r\n,[address2_telephone1]\r\n,[ts_globalgeographiescoveredids]\r\n,[preferredserviceidname]\r\n,[address2_city]\r\n,[ts_mpeapproachstrategy]\r\n,[address2_line2]\r\n,[ts_lastdatestatuschanged]\r\n,[li_companyid]\r\n,[transactioncurrencyidname]\r\n,[entityimage_url]\r\n,[xpd_relationshipstatuschangeddate]\r\n,[createdonbehalfbyname]\r\n,[mpe_liveofferingscount_state]\r\n,[xpd_numberofcoinvestinvestments_date]\r\n,[ts_validateddate]\r\n,[owneridname]\r\n,[xpd_generalcomments]\r\n,[ts_companylegalname]\r\n,[description]\r\n,[ts_validatedbyname]\r\n,[originatingleadidyominame]\r\n,[opendeals]\r\n,[xpd_numberofopportunitiesshown_state]\r\n,[address2_postalcode]\r\n,[websiteurl]\r\n,[xpd_fundname]\r\n,[address1_utcoffset]\r\n,[exchangerate]\r\n,[mpe_flowlastrundate]\r\n,[fax]\r\n,[address1_line3]\r\n,[ts_monthssincelastmeeting]\r\n,[ts_hubname]\r\n,[address2_line1]\r\n,[ts_capiqticket]\r\n,[address2_stateorprovince]\r\n,[address2_name]\r\n,[ts_transfersout_state]\r\n,[xpd_numberofopportunitiesshown]\r\n,[primarytwitterid]\r\n,[mpe_coinvestquestionnaireidname]\r\n,[xpd_numberofopportunitiesshown_date]\r\n,[xpd_preferentialterms]\r\n,[address1_primarycontactname]\r\n,[territoryidname]\r\n,[ts_processstatus]\r\n,[address1_name]\r\n,[address2_telephone2]\r\n,[address2_telephone3]\r\n,[xpd_recruitmentareateam_text]\r\n,[ftpsiteurl]\r\n,[address1_postalcode]\r\n,[ts_companynumber]\r\n,[createdon]\r\n,[mpe_liveofferingscount]\r\n,[traversedpath]\r\n,[address1_stateorprovince]\r\n,[ts_transfersin_state]\r\n,[address2_addressid]\r\n,[ts_monthlyreviewmeetingname]\r\n,[primarysatoriid]\r\n,[telephone3]\r\n,[openrevenue_state]\r\n,[ts_usesprovidedids]\r\n,[ts_originationcomments]\r\n,[lastusedincampaign]\r\n,[primarycontactidname]\r\n,[ts_originationlead1name]\r\n,[ts_headofficeidname]\r\n,[msdyn_segmentidname]\r\n,[ts_montagucomments]\r\n,[address2_fax]\r\n,[createdbyname]\r\n,[xpd_numberofcoinvestinvestments]\r\n,[ts_capitaliqlink]\r\n,[ts_primarymperelationshipmanagername]\r\n,[mpe_relationshipstatus_text]\r\n,[xpd_datereminderwasset]\r\n,[xpd_numberofcoinvestinvestments_state]\r\n,[address1_postofficebox]\r\n,[address1_city]\r\n,[teamsfollowed]\r\n,[ts_originationlead2name]\r\n,[timezoneruleversionnumber]\r\n,[modifiedonbehalfbyyominame]\r\n,[entityimage_timestamp]\r\n,[tickersymbol]\r\n,[ts_theirprogrammecomments]\r\n,[xpd_companyuse_text]\r\n,[modifiedbyname]\r\n,[owneridtype]\r\n,[sic]\r\n,[sharesoutstanding]\r\n,[opendeals_date]\r\n,[address2_postofficebox]\r\n,[emailaddress3]\r\n,[emailaddress2]\r\n,[emailaddress1]\r\n,[ts_globalgeographiescoveredbyfirm]\r\n,[ts_recommendationoffirmupdated]\r\n,[ts_lastmet]\r\n,[ts_reminderdatesetto]\r\n,[ts_commitmentreductions_state]\r\n,[owningbusinessunitname]\r\n,[onholdtime]\r\n,[ts_alias]\r\n,[createdonbehalfbyyominame]\r\n,[ts_transfersout_date]\r\n,[ts_address1countryname]\r\n,[preferredsystemuseridyominame]\r\n,[createdbyexternalpartyname]\r\n,[mpe_documentsetid]\r\n,[telephone1]\r\n,[ts_legacycompanytypes]\r\n,[ts_validatedbyyominame]\r\n,[address1_composite]\r\n,[ts_investorgroupgatekeeperid]\r\n,[primarycontactidyominame]\r\n,[address2_country]\r\n,[xpd_recommendationcomments]\r\n,[owneridyominame]\r\n,[createdbyexternalpartyyominame]\r\n,[ts_originationlead1yominame]\r\n,[ts_usesprovidedbyfirm]\r\n,[xpd_recommendingportco]\r\n,[address1_country]\r\n,[ts_commitmentreductions_date]\r\n,[name]\r\n,[modifiedbyexternalpartyyominame]\r\n,[xpd_remindertoname]\r\n,[stageid]\r\n,[modifiedonbehalfbyname]\r\n,[masteraccountidname]\r\n,[timespentbymeonemailandmeetings]\r\n,[address2_latitude]\r\n,[overriddencreatedon]\r\n,[parentaccountidyominame]\r\n,[ts_specificareaofexpertisecomments]\r\n,[preferredsystemuseridname]\r\n,[utcconversiontimezonecode]\r\n,[address2_county]\r\n,[address1_line1]\r\n,[address2_primarycontactname]\r\n,[address1_line2]\r\n,[xpd_reasonaction]\r\n,[ts_primarymperelationshipmanageryominame]\r\n,[processid]\r\n,[ts_sectorscoveredids]\r\n,[ts_recommendedbyyominame]\r\n,[modifiedbyexternalpartyname]\r\n,[ts_relevantsituations]\r\n,[accountid]\r\n,[modifiedon]\r\n,[preferredequipmentidname]\r\n,[modifiedbyyominame]\r\n,[ts_dealstageofmostrecentopportunity]\r\n,[address2_composite]\r\n,[masteraccountidyominame]\r\n,[numberofemployees]\r\n,[address1_fax]\r\n,[address2_line3]\r\n FROM [dataverse_montagu_org5a2bcccf].[dbo].[account]"
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:35:42Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/ServerLessSQL2')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Serverlessview')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Serverlessbuildreport",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "Dataflow1",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"OriginationOppSourceSL": {},
									"OptionSetInSL": {},
									"AccountInSourceSL": {},
									"AppointmentInSourceSL": {},
									"ContactsInSourceSL": {},
									"SystemUserInSourceSL": {},
									"GapOptionsetIn": {},
									"OriginationSL": {},
									"OpionsetSLSink": {},
									"GapOptionSetSinkSL": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "prod-synapse-uks-001-WorkspaceDefaultStorage",
									"type": "LinkedServiceReference"
								},
								"folderPath": "users"
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:44:42Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/dataflows/Dataflow1')]",
				"[concat(variables('workspaceId'), '/linkedServices/prod-synapse-uks-001-WorkspaceDefaultStorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/TEST PH Enriched Dataset Seperate Tables_copy1')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Data flow1",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "debugInputDataflow_Split Table",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"AccountIn": {},
									"OriginationOpportunityIn": {},
									"MeetingsAppointmentsIn": {},
									"ContactsIn": {},
									"EnrichedAccount": {},
									"EnrichedOriginationOpportunities": {},
									"EnrichedMeetingAppointments": {},
									"EnrichedContacts": {},
									"AccountCleanSink": {},
									"MeetingStageCleanSink": {},
									"ContactsStageCleanSink": {},
									"OriginationCleanSink": {},
									"SinkEnrichedOrigination": {},
									"SinkEnrichedAccount": {},
									"SinkEnrichedMeeting": {},
									"SinkEnrichedContacts": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "prod-synapse-uks-001-WorkspaceDefaultStorage",
									"type": "LinkedServiceReference"
								},
								"folderPath": "users/stage"
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:44:46Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/dataflows/debugInputDataflow_Split Table')]",
				"[concat(variables('workspaceId'), '/linkedServices/prod-synapse-uks-001-WorkspaceDefaultStorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Transform Dataverse data from CSV to Parquet')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "After using Azure Synapse Link for Dataverse, use this pipeline to transform the CSV files of data to the Parquet format. The transformed files will land in the <Table>/Snapshot directory of the Dataverse container.",
				"activities": [
					{
						"name": "Dataverse CSV to Parquet",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DataverseToParquet",
								"type": "DataFlowReference",
								"parameters": {
									"ContainerName": "\"dataverse-montagu-org5a2bcccf\"",
									"TableName": "\"ts_country\""
								},
								"datasetParameters": {
									"ADLS": {},
									"DataverseParquet": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:41:42Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/dataflows/DataverseToParquet')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/V2 Dataverse data from Azure Data Lake to Azure SQL1')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "After using Azure Synapse Link for Dataverse, use this template to copy the Dataverse data from Azure Data Lake to Azure SQL.",
				"activities": [
					{
						"name": "Dataverse mapping to Azure SQL",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DataverseToAzureSQL1",
								"type": "DataFlowReference",
								"parameters": {
									"ContainerName": "\"Dataverse Container Name\"",
									"TableName": "\"Dataverse Table Name\""
								},
								"datasetParameters": {
									"ADLS": {},
									"SQL": {
										"SQLTableName": "\"SQL Table Name\""
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:44:51Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/dataflows/DataverseToAzureSQL1')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/crunchbasebkup')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "GET Crunchbase Bulk Import",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"uuid"
									]
								},
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "organisationcopysource",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "crunchbasebksink",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GET Crunchbase Bulk Import",
						"description": "Hello Part2 Part 5",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "BinarySource",
								"storeSettings": {
									"type": "HttpReadSettings",
									"requestMethod": "GET"
								},
								"formatSettings": {
									"type": "BinaryReadSettings",
									"compressionProperties": {
										"type": "TarGZipReadSettings",
										"preserveCompressionFileNameAsFolder": false
									}
								}
							},
							"sink": {
								"type": "BinarySink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "crunchbasesourceDS",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Binary4Crunchbase",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T12:16:50Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/organisationcopysource')]",
				"[concat(variables('workspaceId'), '/datasets/crunchbasebksink')]",
				"[concat(variables('workspaceId'), '/datasets/crunchbasesourceDS')]",
				"[concat(variables('workspaceId'), '/datasets/Binary4Crunchbase')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/duedil Json2tablecompanies')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Copy Essentials2Enrichment",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Merge Essential",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"companyId"
									]
								},
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "$['countryCode']"
										},
										"sink": {
											"name": "countryCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['companyId']"
										},
										"sink": {
											"name": "companyId",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['name']"
										},
										"sink": {
											"name": "name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['legalEntityIdentifier']['lei']"
										},
										"sink": {
											"name": "lei",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['legalEntityIdentifier']['sourceUrl']"
										},
										"sink": {
											"name": "sourceUrl",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['type']"
										},
										"sink": {
											"name": "type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['incorporationCountry']"
										},
										"sink": {
											"name": "incorporationCountry",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['incorporationDate']"
										},
										"sink": {
											"name": "incorporationDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['officialStatus']"
										},
										"sink": {
											"name": "officialStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['simplifiedStatus']"
										},
										"sink": {
											"name": "simplifiedStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['numberOfEmployees']"
										},
										"sink": {
											"name": "numberOfEmployees",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "$['primaryWebsite']"
										},
										"sink": {
											"name": "primaryWebsite",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['registeredAddress']['fullAddress']"
										},
										"sink": {
											"name": "fullAddress",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['registeredAddress']['structuredAddress']['premises']"
										},
										"sink": {
											"name": "premises",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['registeredAddress']['structuredAddress']['thoroughfare']"
										},
										"sink": {
											"name": "thoroughfare",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['registeredAddress']['structuredAddress']['dependentLocality']"
										},
										"sink": {
											"name": "dependentLocality",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['registeredAddress']['structuredAddress']['postTown']"
										},
										"sink": {
											"name": "postTown",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['registeredAddress']['structuredAddress']['county']"
										},
										"sink": {
											"name": "county",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['registeredAddress']['structuredAddress']['postcode']"
										},
										"sink": {
											"name": "postcode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['registeredAddress']['structuredAddress']['countryCode']"
										},
										"sink": {
											"name": "registeredAddress_structuredAddress_countryCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['registeredAddress']['geolocation']['latitude']"
										},
										"sink": {
											"name": "latitude",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['registeredAddress']['geolocation']['longitude']"
										},
										"sink": {
											"name": "longitude",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['charitableIdentitiesCount']"
										},
										"sink": {
											"name": "charitableIdentitiesCount",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "$['accounts']['filingType']"
										},
										"sink": {
											"name": "filingType",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['accounts']['currency']"
										},
										"sink": {
											"name": "currency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['accounts']['latestAccountsDate']"
										},
										"sink": {
											"name": "latestAccountsDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['accounts']['consolidatedAccounts']"
										},
										"sink": {
											"name": "consolidatedAccounts",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "$['accounts']['nextAccountsDueDate']"
										},
										"sink": {
											"name": "nextAccountsDueDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['financialSummary']['turnover']"
										},
										"sink": {
											"name": "turnover",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['financialSummary']['ebitda']"
										},
										"sink": {
											"name": "ebitda",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['financialSummary']['postTaxProfit']"
										},
										"sink": {
											"name": "postTaxProfit",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['financialSummary']['totalAssets']"
										},
										"sink": {
											"name": "totalAssets",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['financialSummary']['netAssets']"
										},
										"sink": {
											"name": "netAssets",
											"type": "Double"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "Json1Vitals2SQLDB",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "AzureSqlVitals",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Merge Essential",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"wildcardFileName": "*.json",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings",
									"copyBehavior": "MergeFiles"
								},
								"formatSettings": {
									"type": "JsonWriteSettings",
									"filePattern": "setOfObjects"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "JsonMergeVitals",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Json1Merge4Vitals",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:41:51Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/Json1Vitals2SQLDB')]",
				"[concat(variables('workspaceId'), '/datasets/AzureSqlVitals')]",
				"[concat(variables('workspaceId'), '/datasets/JsonMergeVitals')]",
				"[concat(variables('workspaceId'), '/datasets/Json1Merge4Vitals')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/duedulRESTful_Financials')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "CompanyId Lookup",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"dataset": {
								"referenceName": "CompanyConfigCSV",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "CompanyId Lookup",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('CompanyId Lookup').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Copy dueREST to ADLS",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "RestSource",
											"httpRequestTimeout": "00:01:40",
											"requestInterval": "00.00:00:00.010",
											"requestMethod": "GET",
											"paginationRules": {
												"supportRFC5988": "true"
											}
										},
										"sink": {
											"type": "JsonSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "JsonWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "CompanyIdsRest",
											"type": "DatasetReference",
											"parameters": {
												"companyId": {
													"value": "@item().companyId",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "jsonCompanyId",
											"type": "DatasetReference",
											"parameters": {
												"companyId": {
													"value": "@item().companyId",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "DuedilMerge",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"wildcardFileName": "*.json",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings",
									"copyBehavior": "MergeFiles"
								},
								"formatSettings": {
									"type": "JsonWriteSettings",
									"filePattern": "setOfObjects"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "Json1Mergev2",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Json1Merge4Duedil",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Copy To Enrichment Financials",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "DuedilMerge",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"companyId"
									]
								},
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "$['companyId']"
										},
										"sink": {
											"name": "companyId",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['financials'][0]['accountsDate']"
										},
										"sink": {
											"name": "accountsDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['financials'][0]['turnover']['value']"
										},
										"sink": {
											"name": "financials_0_turnover_value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['financials'][0]['turnover']['threeYearCAGR']"
										},
										"sink": {
											"name": "financials_0_turnover_threeYearCAGR",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['financials'][0]['turnover']['fiveYearCAGR']"
										},
										"sink": {
											"name": "financials_0_turnover_fiveYearCAGR",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['financials'][0]['ebitda']['value']"
										},
										"sink": {
											"name": "financials_0_ebitda_value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['financials'][0]['ebitda']['threeYearCAGR']"
										},
										"sink": {
											"name": "financials_0_ebitda_threeYearCAGR",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['financials'][0]['ebitda']['fiveYearCAGR']"
										},
										"sink": {
											"name": "financials_0_ebitda_fiveYearCAGR",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['financials'][1]['turnover']['value']"
										},
										"sink": {
											"name": "financials_1_turnover_value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['financials'][1]['ebitda']['value']"
										},
										"sink": {
											"name": "financials_1_ebitda_value",
											"type": "Double"
										}
									}
								],
								"collectionReference": "",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "Json12SQLDS",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "AzureSqlTable2",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:41:55Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/CompanyConfigCSV')]",
				"[concat(variables('workspaceId'), '/datasets/Json1Mergev2')]",
				"[concat(variables('workspaceId'), '/datasets/Json1Merge4Duedil')]",
				"[concat(variables('workspaceId'), '/datasets/Json12SQLDS')]",
				"[concat(variables('workspaceId'), '/datasets/AzureSqlTable2')]",
				"[concat(variables('workspaceId'), '/datasets/CompanyIdsRest')]",
				"[concat(variables('workspaceId'), '/datasets/jsonCompanyId')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/duedulRESTful_companies')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "CompanyId Lookup",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"dataset": {
								"referenceName": "CompanyConfigCSV",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "CompanyId Lookup",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('CompanyId Lookup').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Copy dueREST to ADLS",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "RestSource",
											"httpRequestTimeout": "00:01:40",
											"requestInterval": "00.00:00:00.010",
											"requestMethod": "GET",
											"paginationRules": {
												"supportRFC5988": "true"
											}
										},
										"sink": {
											"type": "JsonSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "JsonWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "CompanyInfoRest",
											"type": "DatasetReference",
											"parameters": {
												"companyId": {
													"value": "@item().companyId",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "Json1CompanyInfo",
											"type": "DatasetReference",
											"parameters": {
												"companyId": {
													"value": "@item().companyId",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "Copy Essentials",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"wildcardFileName": "*.json",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings",
									"copyBehavior": "MergeFiles"
								},
								"formatSettings": {
									"type": "JsonWriteSettings",
									"filePattern": "setOfObjects"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "JsonMergeVitals",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Json1Merge4Vitals",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Copy Essentials2Enrichment",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy Essentials",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"companyId"
									]
								},
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "$['countryCode']"
										},
										"sink": {
											"name": "countryCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['companyId']"
										},
										"sink": {
											"name": "companyId",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['name']"
										},
										"sink": {
											"name": "name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['legalEntityIdentifier']['lei']"
										},
										"sink": {
											"name": "lei",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['legalEntityIdentifier']['sourceUrl']"
										},
										"sink": {
											"name": "sourceUrl",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['type']"
										},
										"sink": {
											"name": "type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['incorporationCountry']"
										},
										"sink": {
											"name": "incorporationCountry",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['incorporationDate']"
										},
										"sink": {
											"name": "incorporationDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['officialStatus']"
										},
										"sink": {
											"name": "officialStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['simplifiedStatus']"
										},
										"sink": {
											"name": "simplifiedStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['numberOfEmployees']"
										},
										"sink": {
											"name": "numberOfEmployees",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "$['primaryWebsite']"
										},
										"sink": {
											"name": "primaryWebsite",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['registeredAddress']['fullAddress']"
										},
										"sink": {
											"name": "fullAddress",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['registeredAddress']['structuredAddress']['premises']"
										},
										"sink": {
											"name": "premises",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['registeredAddress']['structuredAddress']['thoroughfare']"
										},
										"sink": {
											"name": "thoroughfare",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['registeredAddress']['structuredAddress']['dependentLocality']"
										},
										"sink": {
											"name": "dependentLocality",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['registeredAddress']['structuredAddress']['postTown']"
										},
										"sink": {
											"name": "postTown",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['registeredAddress']['structuredAddress']['county']"
										},
										"sink": {
											"name": "county",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['registeredAddress']['structuredAddress']['postcode']"
										},
										"sink": {
											"name": "postcode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['registeredAddress']['structuredAddress']['countryCode']"
										},
										"sink": {
											"name": "registeredAddress_structuredAddress_countryCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['registeredAddress']['geolocation']['latitude']"
										},
										"sink": {
											"name": "latitude",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['registeredAddress']['geolocation']['longitude']"
										},
										"sink": {
											"name": "longitude",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['charitableIdentitiesCount']"
										},
										"sink": {
											"name": "charitableIdentitiesCount",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "$['accounts']['filingType']"
										},
										"sink": {
											"name": "filingType",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['accounts']['currency']"
										},
										"sink": {
											"name": "currency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['accounts']['latestAccountsDate']"
										},
										"sink": {
											"name": "latestAccountsDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['accounts']['consolidatedAccounts']"
										},
										"sink": {
											"name": "consolidatedAccounts",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "$['accounts']['nextAccountsDueDate']"
										},
										"sink": {
											"name": "nextAccountsDueDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['financialSummary']['turnover']"
										},
										"sink": {
											"name": "turnover",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['financialSummary']['ebitda']"
										},
										"sink": {
											"name": "ebitda",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['financialSummary']['postTaxProfit']"
										},
										"sink": {
											"name": "postTaxProfit",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['financialSummary']['totalAssets']"
										},
										"sink": {
											"name": "totalAssets",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['financialSummary']['netAssets']"
										},
										"sink": {
											"name": "netAssets",
											"type": "Double"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "Json1Vitals2SQLDB",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "AzureSqlVitals",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:41:57Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/CompanyConfigCSV')]",
				"[concat(variables('workspaceId'), '/datasets/JsonMergeVitals')]",
				"[concat(variables('workspaceId'), '/datasets/Json1Merge4Vitals')]",
				"[concat(variables('workspaceId'), '/datasets/Json1Vitals2SQLDB')]",
				"[concat(variables('workspaceId'), '/datasets/AzureSqlVitals')]",
				"[concat(variables('workspaceId'), '/datasets/CompanyInfoRest')]",
				"[concat(variables('workspaceId'), '/datasets/Json1CompanyInfo')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dynCommentTexts')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookupv2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookupv2').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "GetToken",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": "https://pm2.preqinsolutions.com/identityCore/connect/token",
										"connectVia": {
											"referenceName": "AutoResolveIntegrationRuntime",
											"type": "IntegrationRuntimeReference"
										},
										"method": "POST",
										"headers": {
											"Content-Type": "application/x-www-form-urlencoded"
										},
										"body": "scope=openid profile email api offline_access&username=BellCarratt&password=QWE123QWE&client_id=Pcms&client_secret=secretPCMS&CompanyCode=Montagu&grant_type=password",
										"disableCertValidation": false
									}
								},
								{
									"name": "ExtractCommentTexts",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "GetToken",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "BinarySource",
											"storeSettings": {
												"type": "HttpReadSettings",
												"requestMethod": "GET",
												"additionalHeaders": {
													"value": "@{concat('Authorization:Bearer ',activity('GetToken').output.access_token)}",
													"type": "Expression"
												},
												"requestTimeout": ""
											},
											"formatSettings": {
												"type": "BinaryReadSettings"
											}
										},
										"sink": {
											"type": "BinarySink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "dynamoBinaryComments",
											"type": "DatasetReference",
											"parameters": {
												"companyId": {
													"value": "@item().companyId",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "dynamoBlobComments",
											"type": "DatasetReference",
											"parameters": {
												"companyId": {
													"value": "@item().companyId",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookupv2",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"dataset": {
								"referenceName": "DynamoCompanyID_DS",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:42:01Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/DynamoCompanyID_DS')]",
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]",
				"[concat(variables('workspaceId'), '/datasets/dynamoBinaryComments')]",
				"[concat(variables('workspaceId'), '/datasets/dynamoBlobComments')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dynCommentsSearch')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookupv2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookupv2').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "GetToken",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": "https://pm2.preqinsolutions.com/identityCore/connect/token",
										"connectVia": {
											"referenceName": "AutoResolveIntegrationRuntime",
											"type": "IntegrationRuntimeReference"
										},
										"method": "POST",
										"headers": {
											"Content-Type": "application/x-www-form-urlencoded"
										},
										"body": "scope=openid profile email api offline_access&username=BellCarratt&password=QWE123QWE&client_id=Pcms&client_secret=secretPCMS&CompanyCode=Montagu&grant_type=password",
										"disableCertValidation": false
									}
								},
								{
									"name": "Copy data1",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "GetToken",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "BinarySource",
											"storeSettings": {
												"type": "HttpReadSettings",
												"requestMethod": "GET",
												"additionalHeaders": {
													"value": "@{concat('Authorization:Bearer ',activity('GetToken').output.access_token)}",
													"type": "Expression"
												},
												"requestTimeout": ""
											},
											"formatSettings": {
												"type": "BinaryReadSettings"
											}
										},
										"sink": {
											"type": "BinarySink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "dynamoBinaryComments",
											"type": "DatasetReference",
											"parameters": {
												"companyId": {
													"value": "@item().companyId",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "dynamoBlobStore",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookupv2",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"dataset": {
								"referenceName": "DynamoCompanyID_DS",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:42:04Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/DynamoCompanyID_DS')]",
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]",
				"[concat(variables('workspaceId'), '/datasets/dynamoBinaryComments')]",
				"[concat(variables('workspaceId'), '/datasets/dynamoBlobStore')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dynMetricValues')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookupv2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookupv2').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "GetToken",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": "https://pm2.preqinsolutions.com/identityCore/connect/token",
										"connectVia": {
											"referenceName": "AutoResolveIntegrationRuntime",
											"type": "IntegrationRuntimeReference"
										},
										"method": "POST",
										"headers": {
											"Content-Type": "application/x-www-form-urlencoded"
										},
										"body": "scope=openid profile email api offline_access&username=BellCarratt&password=QWE123QWE&client_id=Pcms&client_secret=secretPCMS&CompanyCode=Montagu&grant_type=password",
										"disableCertValidation": false
									}
								},
								{
									"name": "ExtractMetricValues",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "GetToken",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "BinarySource",
											"storeSettings": {
												"type": "HttpReadSettings",
												"requestMethod": "GET",
												"additionalHeaders": {
													"value": "@{concat('Authorization:Bearer ',activity('GetToken').output.access_token)}",
													"type": "Expression"
												},
												"requestTimeout": ""
											},
											"formatSettings": {
												"type": "BinaryReadSettings"
											}
										},
										"sink": {
											"type": "BinarySink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "dynamoBinaryMetricValue",
											"type": "DatasetReference",
											"parameters": {
												"companyId": {
													"value": "@item().companyId",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "dynamoBlobMetricValues",
											"type": "DatasetReference",
											"parameters": {
												"companyId": {
													"value": "@item().companyId",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookupv2",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"dataset": {
								"referenceName": "DynamoCompanyID_DS",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:42:10Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/DynamoCompanyID_DS')]",
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]",
				"[concat(variables('workspaceId'), '/datasets/dynamoBinaryMetricValue')]",
				"[concat(variables('workspaceId'), '/datasets/dynamoBlobMetricValues')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dynMetrics')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookupv2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookupv2').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "GetToken",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": "https://pm2.preqinsolutions.com/identityCore/connect/token",
										"connectVia": {
											"referenceName": "AutoResolveIntegrationRuntime",
											"type": "IntegrationRuntimeReference"
										},
										"method": "POST",
										"headers": {
											"Content-Type": "application/x-www-form-urlencoded"
										},
										"body": "scope=openid profile email api offline_access&username=BellCarratt&password=QWE123QWE&client_id=Pcms&client_secret=secretPCMS&CompanyCode=Montagu&grant_type=password",
										"disableCertValidation": false
									}
								},
								{
									"name": "ExtractMetrics",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "GetToken",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "BinarySource",
											"storeSettings": {
												"type": "HttpReadSettings",
												"requestMethod": "GET",
												"additionalHeaders": {
													"value": "@{concat('Authorization:Bearer ',activity('GetToken').output.access_token)}",
													"type": "Expression"
												},
												"requestTimeout": ""
											},
											"formatSettings": {
												"type": "BinaryReadSettings"
											}
										},
										"sink": {
											"type": "BinarySink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "dynamoBinaryMetric",
											"type": "DatasetReference",
											"parameters": {
												"companyId": {
													"value": "@item().companyId",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "dynamoMetricBlobDS",
											"type": "DatasetReference",
											"parameters": {
												"companyId": {
													"value": "@item().companyId",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookupv2",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"dataset": {
								"referenceName": "DynamoCompanyID_DS",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Copy MetricsOnly",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"wildcardFileName": "*.json",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings",
									"copyBehavior": "MergeFiles"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "Json1Merge",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Json1TheMerged",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"set": {
						"type": "String"
					},
					"Inded": {
						"type": "Array"
					},
					"var1": {
						"type": "String"
					},
					"Index": {
						"type": "String"
					}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:42:16Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/DynamoCompanyID_DS')]",
				"[concat(variables('workspaceId'), '/datasets/Json1Merge')]",
				"[concat(variables('workspaceId'), '/datasets/Json1TheMerged')]",
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]",
				"[concat(variables('workspaceId'), '/datasets/dynamoBinaryMetric')]",
				"[concat(variables('workspaceId'), '/datasets/dynamoMetricBlobDS')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dynamoHTTP')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "HttpReadSettings",
									"requestMethod": "GET"
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "dynamoHTTPDataset",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "JsonDynamo",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:42:24Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/dynamoHTTPDataset')]",
				"[concat(variables('workspaceId'), '/datasets/JsonDynamo')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dynamoRESTFUL')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:04:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "DynamoResource1",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "JsonDynamo",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:42:31Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/DynamoResource1')]",
				"[concat(variables('workspaceId'), '/datasets/JsonDynamo')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dynamoWEB')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "GetToken",
						"type": "WebActivity",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": "https://pm2.preqinsolutions.com/identityCore/connect/token",
							"connectVia": {
								"referenceName": "AutoResolveIntegrationRuntime",
								"type": "IntegrationRuntimeReference"
							},
							"method": "POST",
							"headers": {
								"Content-Type": "application/x-www-form-urlencoded"
							},
							"body": "scope=openid profile email api offline_access&username=BellCarratt&password=QWE123QWE&client_id=Pcms&client_secret=secretPCMS&CompanyCode=Montagu&grant_type=password",
							"disableCertValidation": false
						}
					},
					{
						"name": "dynamoCompanies",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "GetToken",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "BinarySource",
								"storeSettings": {
									"type": "HttpReadSettings",
									"requestMethod": "GET",
									"additionalHeaders": {
										"value": "@{concat('Authorization:Bearer ',activity('GetToken').output.access_token)}",
										"type": "Expression"
									},
									"requestTimeout": ""
								},
								"formatSettings": {
									"type": "BinaryReadSettings"
								}
							},
							"sink": {
								"type": "BinarySink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "dynamoBinaryDS",
								"type": "DatasetReference",
								"parameters": {
									"relativeURL": "relativeURL"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DestinationDataset_t7r",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:42:37Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]",
				"[concat(variables('workspaceId'), '/datasets/dynamoBinaryDS')]",
				"[concat(variables('workspaceId'), '/datasets/DestinationDataset_t7r')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dynamoWEB_copy1')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Set variable1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@pipeline().parameters.relativeURLs",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "GetToken",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": "https://pm2.preqinsolutions.com/identityCore/connect/token",
										"connectVia": {
											"referenceName": "AutoResolveIntegrationRuntime",
											"type": "IntegrationRuntimeReference"
										},
										"method": "POST",
										"headers": {
											"Content-Type": "application/x-www-form-urlencoded"
										},
										"body": "scope=openid profile email api offline_access&username=BellCarratt&password=QWE123QWE&client_id=Pcms&client_secret=secretPCMS&CompanyCode=Montagu&grant_type=password",
										"disableCertValidation": false
									}
								},
								{
									"name": "dynamoCompanies",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "GetToken",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "BinarySource",
											"storeSettings": {
												"type": "HttpReadSettings",
												"requestMethod": "GET",
												"additionalHeaders": {
													"value": "@{concat('Authorization:Bearer ',activity('GetToken').output.access_token)}",
													"type": "Expression"
												},
												"requestTimeout": ""
											},
											"formatSettings": {
												"type": "BinaryReadSettings"
											}
										},
										"sink": {
											"type": "BinarySink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "dynamoBinaryDS",
											"type": "DatasetReference",
											"parameters": {
												"relativeURL": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "dynamoBlobStore",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "MyLookup",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"dataset": {
								"referenceName": "DynamoCompanyID_DS",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Set variable1",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "MyLookup",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "val",
							"value": {
								"value": "https://pm2.preqinsolutions.com@{pipeline().parameters.relativeURLs}@{activity('MyLookup').output.value}",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"relativeURLs": {
						"type": "array",
						"defaultValue": [
							"/apiCore/api/Companies",
							"/apiCore/api/Metrics/dimensions"
						]
					}
				},
				"variables": {
					"val": {
						"type": "String"
					}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:42:43Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/DynamoCompanyID_DS')]",
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]",
				"[concat(variables('workspaceId'), '/datasets/dynamoBinaryDS')]",
				"[concat(variables('workspaceId'), '/datasets/dynamoBlobStore')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dynamoWEB_lookup')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "DynamoMetricLookup",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"dataset": {
								"referenceName": "DynamoCompanyID_DS",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "GetToken_copy1",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Set variable1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": "https://pm2.preqinsolutions.com/identityCore/connect/token",
							"connectVia": {
								"referenceName": "AutoResolveIntegrationRuntime",
								"type": "IntegrationRuntimeReference"
							},
							"method": "POST",
							"headers": {
								"Content-Type": "application/x-www-form-urlencoded"
							},
							"body": "scope=openid profile email api offline_access&username=BellCarratt&password=QWE123QWE&client_id=Pcms&client_secret=secretPCMS&CompanyCode=Montagu&grant_type=password",
							"disableCertValidation": false
						}
					},
					{
						"name": "Copy data1_copy1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "GetToken_copy1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "dynamoMetricDS",
								"type": "DatasetReference",
								"parameters": {
									"companyId": {
										"value": "@activity('DynamoMetricLookup').output.value",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "dynamoMetricSink",
								"type": "DatasetReference",
								"parameters": {
									"companyId": {
										"value": "@activity('DynamoMetricLookup').output.value",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Set variable1",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "DynamoMetricLookup",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "val",
							"value": {
								"value": "https://pm2.preqinsolutions.com@{pipeline().parameters.relativeURLs}@{activity('DynamoMetricLookup').output.value}",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"relativeURLs": {
						"type": "array",
						"defaultValue": [
							"/apiCore/api/Metrics/",
							"/apiCore/api/Companies"
						]
					}
				},
				"variables": {
					"val": {
						"type": "String"
					},
					"val2": {
						"type": "Array"
					}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:42:48Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/DynamoCompanyID_DS')]",
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]",
				"[concat(variables('workspaceId'), '/datasets/dynamoMetricDS')]",
				"[concat(variables('workspaceId'), '/datasets/dynamoMetricSink')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/get_duedil')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "GETDUEDIL",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "BinarySource",
								"storeSettings": {
									"type": "HttpReadSettings",
									"requestMethod": "GET"
								},
								"formatSettings": {
									"type": "BinaryReadSettings"
								}
							},
							"sink": {
								"type": "BinarySink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "DS_DUEDIL_LIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DestinationDataset_t7r",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:42:53Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/DS_DUEDIL_LIN')]",
				"[concat(variables('workspaceId'), '/datasets/DestinationDataset_t7r')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/gz_import_test')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "crunchbasetest copy",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "HttpReadSettings",
									"requestMethod": "GET"
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings",
									"copyBehavior": "PreserveHierarchy"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "crunchbase_source",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "CB_Delimited_CSV",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T11:43:00Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/crunchbase_source')]",
				"[concat(variables('workspaceId'), '/datasets/CB_Delimited_CSV')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/mergepipeline')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "DuedilMerge",
						"description": "Test today",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"wildcardFileName": "*.json",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings",
									"copyBehavior": "MergeFiles"
								},
								"formatSettings": {
									"type": "JsonWriteSettings",
									"filePattern": "setOfObjects"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "Json1Mergev2",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Json1Merge4Duedil",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-12-17T12:10:54Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/Json1Mergev2')]",
				"[concat(variables('workspaceId'), '/datasets/Json1Merge4Duedil')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/APIPULL1')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "DueDil",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/DueDil')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AccountTable')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "ReportsAnalytics",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "account"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/ReportsAnalytics')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Appointment')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "ReportsAnalytics",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "appointment"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/ReportsAnalytics')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AzureSqlTable')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "The destination Azure SQL Table for the Dataverse data.",
				"linkedServiceName": {
					"referenceName": "ReportsSql",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"SQLTableName": {
						"type": "string",
						"defaultValue": "\"SQL Table Name\""
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": {
						"value": "@dataset().SQLTableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/ReportsSql')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AzureSqlTable1')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "The destination Azure SQL Table for the Dataverse data.",
				"linkedServiceName": {
					"referenceName": "ReportsSql",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"SQLTableName": {
						"type": "string",
						"defaultValue": "\"SQL Table Name\""
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": {
						"value": "@dataset().SQLTableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/ReportsSql')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AzureSqlTable2')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "MyOrigination",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "financials"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/MyOrigination')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AzureSqlTable3')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "EnrichmentDB",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"targettable": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "CORE",
					"table": {
						"value": "@dataset().targettable",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/EnrichmentDB')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AzureSqlVitals')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "EnrichmentDB",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "essentials"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/EnrichmentDB')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AzureSynapseAnalyticsTable1')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "prod-synapse-uks-001-WorkspaceDefaultSqlServer",
					"type": "LinkedServiceReference",
					"parameters": {
						"DBName": "DedicatedSQLPool"
					}
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "duedil"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/prod-synapse-uks-001-WorkspaceDefaultSqlServer')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AzureSynapseAnalyticsTable2')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "prod-synapse-uks-001-WorkspaceDefaultSqlServer",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "enrichedtables"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/prod-synapse-uks-001-WorkspaceDefaultSqlServer')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AzureSynapseAnalyticsTable3')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "ServerLessSQL2",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "ts_lender"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/ServerLessSQL2')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Binary4Crunchbase')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_BLOB_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"folderPath": "testfolder1",
						"container": "testcontainer"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_BLOB_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Binary4duedil')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "duedilHTTPLinkService",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"companyId": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "HttpServerLocation",
						"relativeUrl": {
							"value": "@concat(dataset().companyId, '/financials.json')",
							"type": "Expression"
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/duedilHTTPLinkService')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CB_Delimited_CSV')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "prod-synapse-uks-001-WorkspaceDefaultStorage",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "testname",
						"folderPath": "RAW",
						"fileSystem": "root"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/prod-synapse-uks-001-WorkspaceDefaultStorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CompanyConfigCSV')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_ADLS_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "companyId.csv",
						"folderPath": "duedil",
						"fileSystem": "insights"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CompanyConfigTXT')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_ADLS_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "companyIdv2.txt",
						"folderPath": "duedil",
						"fileSystem": "insights"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CompanyConfigXLS')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_ADLS_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Excel",
				"typeProperties": {
					"sheetName": "Sheet1",
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "companyid.xlsx",
						"folderPath": "duedil",
						"fileSystem": "insights"
					},
					"firstRowAsHeader": true
				},
				"schema": [
					{
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CompanyIdConfig')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_ADLS_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "companyid.xlsx",
						"folderPath": "duedil",
						"fileSystem": "insights"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CompanyIdsRest')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "duedilRESTLink",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"companyId": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "@concat('https://duedil.io/v4/company/gb/', dataset().companyId, '/financials.json')",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/duedilRESTLink')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CompanyInfoRest')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "DuedilCompanies",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"companyId": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "@concat('https://duedil.io/v4/company/gb/', dataset().companyId,'.json')",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/DuedilCompanies')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Contacttable')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "ReportsAnalytics",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "contact"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/ReportsAnalytics')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CountrieConfig')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_ADLS_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "Countries.csv",
						"folderPath": "duedil",
						"fileSystem": "insights"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "CountryName",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CountriesRest')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "REST Companies API",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"CountryName": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "@concat('https://restcountries.com/v3.1/name/', dataset().CountryName)",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/REST Companies API')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DS_ADLS_RAW1')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_ADLS_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"Directory": {
						"type": "string"
					},
					"Entity": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": {
							"value": "/@{dataset().Directory}",
							"type": "Expression"
						},
						"fileSystem": "root"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DS_ALDS_RAW_BINARY')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_ADLS_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"Directory": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": {
							"value": "/@{dataset().Directory}",
							"type": "Expression"
						},
						"fileSystem": "root"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DS_AnalyticsHub_DYN')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_SQL_AnalyticsHub",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "Process",
					"table": "ProcessStatus"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_SQL_AnalyticsHub')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DS_BLOB_Landing_DYN_BINARY')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_BLOB_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"Path": {
						"type": "string"
					},
					"Container": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"folderPath": {
							"value": "@dataset().Path",
							"type": "Expression"
						},
						"container": {
							"value": "@dataset().Container",
							"type": "Expression"
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_BLOB_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DS_BLOB_Landing_DYN_ZIP')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_BLOB_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"Path": {
						"type": "string"
					},
					"Container": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"folderPath": {
							"value": "@dataset().Path",
							"type": "Expression"
						},
						"container": {
							"value": "@dataset().Container",
							"type": "Expression"
						}
					},
					"compression": {
						"type": "ZipDeflate",
						"level": "Optimal"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_BLOB_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DS_DUEDIL_LIN')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "duedilHTTPLinkService",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "HttpServerLocation"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/duedilHTTPLinkService')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DS_Metadata')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_Metadata_SQL",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"SchemaName": {
						"type": "string",
						"defaultValue": "config"
					},
					"TableName": {
						"type": "string",
						"defaultValue": "Application"
					}
				},
				"folder": {
					"name": "Framework"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": {
						"value": "@dataset().SchemaName",
						"type": "Expression"
					},
					"table": {
						"value": "@dataset().TableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_Metadata_SQL')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DS_SQL_DYN')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureSQLEnrichedServerless",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/AzureSQLEnrichedServerless')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DestinationDataset_lne')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_ADLS_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileSystem": "testcontainer"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"quoteChar": "\""
				},
				"schema": {}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DestinationDataset_n7v')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_ADLS_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileSystem": "testcontainer"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DestinationDataset_nyc')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_ADLS_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileSystem": "testcontainer"
					}
				},
				"schema": {}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DestinationDataset_t7r')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_ADLS_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "RAW",
						"fileSystem": "root"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DestinationDataset_wzj')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_ADLS_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileSystem": "testcontainer"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DynamoCompanyID_DS')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_ADLS_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "companyId.csv",
						"folderPath": "RAW/dynamopmv",
						"fileSystem": "root"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DynamoResource1')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "dynamoREST",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": ""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/dynamoREST')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Json12SQLDS')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_ADLS_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "duedilfinance.json",
						"folderPath": "RAW/Internal/insights/duedil/financials/FinancialMerged",
						"fileSystem": "root"
					}
				},
				"schema": {
					"type": "object",
					"properties": {
						"countryCode": {
							"type": "string"
						},
						"companyId": {
							"type": "string"
						},
						"pagination": {
							"type": "object",
							"properties": {
								"offset": {
									"type": "integer"
								},
								"limit": {
									"type": "integer"
								},
								"total": {
									"type": "integer"
								}
							}
						},
						"financials": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"accountsDate": {
										"type": "string"
									},
									"reportingPeriod": {
										"type": "integer"
									},
									"currency": {
										"type": "string"
									},
									"consolidatedAccounts": {
										"type": "boolean"
									},
									"auditQualification": {
										"type": "string"
									},
									"numberOfEmployees": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"turnover": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"costOfSales": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"sgaPlusOtherNetCosts": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"operatingProfit": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"interestReceivable": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"interestPayable": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"preTaxProfit": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"taxation": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"postTaxProfit": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"dividendsPayable": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"retainedProfits": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"intangibleAssets": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"tangibleAssets": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"investmentsAndOtherAssets": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "integer"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"fixedAssets": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "integer"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"stock": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"tradeDebtors": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"otherDebtors": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"miscellaneousCurrentAssets": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"cash": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"currentAssets": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"totalAssets": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"bankLoansAndOverdrafts": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"tradeCreditors": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"miscellaneousCurrentLiabilities": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "integer"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"otherShortTermFinances": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"currentLiabilities": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"contingentLiabilities": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"otherLongTermFinances": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"totalLongTermLiabilities": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"totalLiabilities": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"netAssets": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"equityPaidUp": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "integer"
											},
											"threeYearCAGR": {
												"type": "integer"
											},
											"fiveYearCAGR": {
												"type": "integer"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"revaluationReserve": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"sundryReserves": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "integer"
											},
											"threeYearCAGR": {
												"type": "integer"
											},
											"fiveYearCAGR": {
												"type": "integer"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"profitAndLossAccountReserve": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"shareholderFunds": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"depreciation": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"amortisationOfIntangibles": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"ebitda": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"workingCapital": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"capitalEmployed": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"wagesAndSalaries": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"directorsEmoluments": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"auditFees": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"bankOverdraftAndLongTermLoans": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"netCashFlowFromOperations": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"netCashFlowBeforeFinancing": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"netCashFlowFromFinancing": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"increaseInCash": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"debtorDays": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"exports": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"grossMarginPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"operatingProfitMarginPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"ebitdaMarginPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"preTaxProfitMarginPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"netMarginPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"returnOnAssetsPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"returnOnCapitalEmployedPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"returnOnEquity": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"currentRatio": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"cashToCurrentLiabilitiesRatio": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"cashToTotalAssetsPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"liquidityRatio": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"gearingPercentageOnLiabilityBasis": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"gearingPercentageOnGrossDebtBasis": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"gearingPercentageOnNetDebtBasis": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"debtToCapitalPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"inventoryTurnoverRatio": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"cashToTurnoverRatio": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"cashToTurnoverPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"daysInventoryOutstanding": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"daysSalesOutstanding": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"daysPayableOutstanding": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"cashConversionCycle": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"revenuePerEmployee": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"humanCapitalValueAdded": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"interestCoverageRatio": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"netDebtToEBITDARatio": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"cfoToSalesRatio": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"auditor": {
										"type": "object",
										"properties": {
											"sourceName": {
												"type": "string"
											}
										}
									},
									"jointAuditor": {
										"type": "object",
										"properties": {
											"sourceName": {
												"type": "null"
											}
										}
									},
									"solicitor": {
										"type": "object",
										"properties": {
											"sourceName": {
												"type": "null"
											}
										}
									},
									"accountant": {
										"type": "object",
										"properties": {
											"sourceName": {
												"type": "null"
											}
										}
									}
								}
							}
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Json1CompanyInfo')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "placeholder",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"companyId": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@concat(dataset().companyId, '.json')",
							"type": "Expression"
						},
						"folderPath": "RAW/Internal/insights/duedil/vitals",
						"fileSystem": "root"
					}
				},
				"schema": {}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/placeholder')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Json1Merge')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_BLOB_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"folderPath": "dynamotestfolder",
						"container": "testcontainer"
					}
				},
				"schema": {}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_BLOB_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Json1Merge4Duedil')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_ADLS_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "duedilfinance.json",
						"folderPath": "RAW/Internal/insights/duedil/financials/FinancialMerged",
						"fileSystem": "root"
					}
				},
				"schema": {
					"type": "object",
					"properties": {
						"countryCode": {
							"type": "string"
						},
						"companyId": {
							"type": "string"
						},
						"pagination": {
							"type": "object",
							"properties": {
								"offset": {
									"type": "integer"
								},
								"limit": {
									"type": "integer"
								},
								"total": {
									"type": "integer"
								}
							}
						},
						"financials": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"accountsDate": {
										"type": "string"
									},
									"reportingPeriod": {
										"type": "integer"
									},
									"currency": {
										"type": "string"
									},
									"consolidatedAccounts": {
										"type": "boolean"
									},
									"auditQualification": {
										"type": "string"
									},
									"numberOfEmployees": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"turnover": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"costOfSales": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"sgaPlusOtherNetCosts": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"operatingProfit": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"interestReceivable": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"interestPayable": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"preTaxProfit": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"taxation": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"postTaxProfit": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"dividendsPayable": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"retainedProfits": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"intangibleAssets": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"tangibleAssets": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"investmentsAndOtherAssets": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "integer"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"fixedAssets": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "integer"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"stock": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"tradeDebtors": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"otherDebtors": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"miscellaneousCurrentAssets": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"cash": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"currentAssets": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"totalAssets": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"bankLoansAndOverdrafts": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"tradeCreditors": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"miscellaneousCurrentLiabilities": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "integer"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"otherShortTermFinances": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"currentLiabilities": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"contingentLiabilities": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"otherLongTermFinances": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"totalLongTermLiabilities": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"totalLiabilities": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"netAssets": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"equityPaidUp": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "integer"
											},
											"threeYearCAGR": {
												"type": "integer"
											},
											"fiveYearCAGR": {
												"type": "integer"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"revaluationReserve": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"sundryReserves": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "integer"
											},
											"threeYearCAGR": {
												"type": "integer"
											},
											"fiveYearCAGR": {
												"type": "integer"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"profitAndLossAccountReserve": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"shareholderFunds": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"depreciation": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"amortisationOfIntangibles": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"ebitda": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"workingCapital": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"capitalEmployed": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"wagesAndSalaries": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"directorsEmoluments": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"auditFees": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"bankOverdraftAndLongTermLoans": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"netCashFlowFromOperations": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"netCashFlowBeforeFinancing": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"netCashFlowFromFinancing": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"increaseInCash": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"debtorDays": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"exports": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"grossMarginPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"operatingProfitMarginPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"ebitdaMarginPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"preTaxProfitMarginPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"netMarginPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"returnOnAssetsPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"returnOnCapitalEmployedPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"returnOnEquity": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"currentRatio": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"cashToCurrentLiabilitiesRatio": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"cashToTotalAssetsPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"liquidityRatio": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"gearingPercentageOnLiabilityBasis": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"gearingPercentageOnGrossDebtBasis": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"gearingPercentageOnNetDebtBasis": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"debtToCapitalPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"inventoryTurnoverRatio": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"cashToTurnoverRatio": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"cashToTurnoverPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"daysInventoryOutstanding": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"daysSalesOutstanding": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"daysPayableOutstanding": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"cashConversionCycle": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"revenuePerEmployee": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"humanCapitalValueAdded": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"interestCoverageRatio": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"netDebtToEBITDARatio": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"cfoToSalesRatio": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"auditor": {
										"type": "object",
										"properties": {
											"sourceName": {
												"type": "string"
											}
										}
									},
									"jointAuditor": {
										"type": "object",
										"properties": {
											"sourceName": {
												"type": "null"
											}
										}
									},
									"solicitor": {
										"type": "object",
										"properties": {
											"sourceName": {
												"type": "null"
											}
										}
									},
									"accountant": {
										"type": "object",
										"properties": {
											"sourceName": {
												"type": "null"
											}
										}
									}
								}
							}
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Json1Merge4Vitals')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_ADLS_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "vitalsmerged.json",
						"folderPath": "RAW/Internal/insights/duedil/vitals/vitalsmerged",
						"fileSystem": "root"
					}
				},
				"schema": {}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Json1Mergev2')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_ADLS_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "RAW/Internal/insights/duedil/financials",
						"fileSystem": "root"
					}
				},
				"schema": {
					"type": "object",
					"properties": {
						"countryCode": {
							"type": "string"
						},
						"companyId": {
							"type": "string"
						},
						"pagination": {
							"type": "object",
							"properties": {
								"offset": {
									"type": "integer"
								},
								"limit": {
									"type": "integer"
								},
								"total": {
									"type": "integer"
								}
							}
						},
						"financials": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"accountsDate": {
										"type": "string"
									},
									"reportingPeriod": {
										"type": "integer"
									},
									"currency": {
										"type": "string"
									},
									"consolidatedAccounts": {
										"type": "boolean"
									},
									"auditQualification": {
										"type": "string"
									},
									"numberOfEmployees": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"turnover": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"costOfSales": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"sgaPlusOtherNetCosts": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"operatingProfit": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"interestReceivable": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "integer"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"interestPayable": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"preTaxProfit": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"taxation": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"postTaxProfit": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"dividendsPayable": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"retainedProfits": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"intangibleAssets": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"tangibleAssets": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"investmentsAndOtherAssets": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"fixedAssets": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"stock": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"tradeDebtors": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"otherDebtors": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"miscellaneousCurrentAssets": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"cash": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"currentAssets": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"totalAssets": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"bankLoansAndOverdrafts": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"tradeCreditors": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"miscellaneousCurrentLiabilities": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"otherShortTermFinances": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "integer"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"currentLiabilities": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"contingentLiabilities": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"otherLongTermFinances": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"totalLongTermLiabilities": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"totalLiabilities": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"netAssets": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"equityPaidUp": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "integer"
											},
											"threeYearCAGR": {
												"type": "integer"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"revaluationReserve": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"sundryReserves": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"profitAndLossAccountReserve": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"shareholderFunds": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"depreciation": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"amortisationOfIntangibles": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"ebitda": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"workingCapital": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"capitalEmployed": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"wagesAndSalaries": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"directorsEmoluments": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"auditFees": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"bankOverdraftAndLongTermLoans": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"netCashFlowFromOperations": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"netCashFlowBeforeFinancing": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"netCashFlowFromFinancing": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"increaseInCash": {
										"type": "object",
										"properties": {
											"value": {
												"type": "integer"
											},
											"deltaAbsolute": {
												"type": "integer"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"debtorDays": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											},
											"deltaAbsolute": {
												"type": "number"
											},
											"deltaPercentage": {
												"type": "number"
											},
											"threeYearCAGR": {
												"type": "number"
											},
											"fiveYearCAGR": {
												"type": "number"
											},
											"tenYearCAGR": {
												"type": "number"
											}
										}
									},
									"exports": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											},
											"deltaAbsolute": {
												"type": "null"
											},
											"deltaPercentage": {
												"type": "null"
											},
											"threeYearCAGR": {
												"type": "null"
											},
											"fiveYearCAGR": {
												"type": "null"
											},
											"tenYearCAGR": {
												"type": "null"
											}
										}
									},
									"grossMarginPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"operatingProfitMarginPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"ebitdaMarginPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"preTaxProfitMarginPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"netMarginPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"returnOnAssetsPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"returnOnCapitalEmployedPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"returnOnEquity": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"currentRatio": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"cashToCurrentLiabilitiesRatio": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"cashToTotalAssetsPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"liquidityRatio": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"gearingPercentageOnLiabilityBasis": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"gearingPercentageOnGrossDebtBasis": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"gearingPercentageOnNetDebtBasis": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"debtToCapitalPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"inventoryTurnoverRatio": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"cashToTurnoverRatio": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"cashToTurnoverPercentage": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"daysInventoryOutstanding": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"daysSalesOutstanding": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"daysPayableOutstanding": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"cashConversionCycle": {
										"type": "object",
										"properties": {
											"value": {
												"type": "null"
											}
										}
									},
									"revenuePerEmployee": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"humanCapitalValueAdded": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"interestCoverageRatio": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"netDebtToEBITDARatio": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"cfoToSalesRatio": {
										"type": "object",
										"properties": {
											"value": {
												"type": "number"
											}
										}
									},
									"auditor": {
										"type": "object",
										"properties": {
											"sourceName": {
												"type": "string"
											}
										}
									},
									"jointAuditor": {
										"type": "object",
										"properties": {
											"sourceName": {
												"type": "null"
											}
										}
									},
									"solicitor": {
										"type": "object",
										"properties": {
											"sourceName": {
												"type": "null"
											}
										}
									},
									"accountant": {
										"type": "object",
										"properties": {
											"sourceName": {
												"type": "null"
											}
										}
									}
								}
							}
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Json1TheMerged')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_BLOB_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "mergedmetric.json",
						"folderPath": "staticdata/apiCore/api/Metrics/MergedMetric",
						"container": "source"
					}
				},
				"schema": {}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_BLOB_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Json1Vitals2SQLDB')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_ADLS_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "vitalsmerged.json",
						"folderPath": "RAW/Internal/insights/duedil/vitals/vitalsmerged",
						"fileSystem": "root"
					}
				},
				"schema": {}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/JsonDynamo')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_ADLS_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "RAW",
						"fileSystem": "root"
					}
				},
				"schema": {}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/JsonMergeVitals')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_ADLS_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "RAW/Internal/insights/duedil/vitals",
						"fileSystem": "root"
					}
				},
				"schema": {
					"type": "object",
					"properties": {
						"countryCode": {
							"type": "string"
						},
						"companyId": {
							"type": "string"
						},
						"name": {
							"type": "string"
						},
						"legalEntityIdentifier": {
							"type": "object",
							"properties": {
								"lei": {
									"type": "string"
								},
								"sourceUrl": {
									"type": "string"
								}
							}
						},
						"type": {
							"type": "string"
						},
						"incorporationCountry": {
							"type": "string"
						},
						"incorporationDate": {
							"type": "string"
						},
						"officialStatus": {
							"type": "string"
						},
						"simplifiedStatus": {
							"type": "string"
						},
						"numberOfEmployees": {
							"type": "integer"
						},
						"primaryWebsite": {
							"type": "string"
						},
						"registeredAddress": {
							"type": "object",
							"properties": {
								"fullAddress": {
									"type": "string"
								},
								"structuredAddress": {
									"type": "object",
									"properties": {
										"premises": {
											"type": "string"
										},
										"thoroughfare": {
											"type": "string"
										},
										"dependentLocality": {
											"type": "string"
										},
										"postTown": {
											"type": "string"
										},
										"county": {
											"type": "string"
										},
										"postcode": {
											"type": "string"
										},
										"countryCode": {
											"type": "string"
										}
									}
								},
								"geolocation": {
									"type": "object",
									"properties": {
										"latitude": {
											"type": "number"
										},
										"longitude": {
											"type": "number"
										}
									}
								}
							}
						},
						"charitableIdentitiesCount": {
							"type": "integer"
						},
						"accounts": {
							"type": "object",
							"properties": {
								"filingType": {
									"type": "string"
								},
								"currency": {
									"type": "string"
								},
								"latestAccountsDate": {
									"type": "string"
								},
								"consolidatedAccounts": {
									"type": "boolean"
								},
								"nextAccountsDueDate": {
									"type": "string"
								}
							}
						},
						"financialSummary": {
							"type": "object",
							"properties": {
								"turnover": {
									"type": "integer"
								},
								"ebitda": {
									"type": "integer"
								},
								"postTaxProfit": {
									"type": "integer"
								},
								"totalAssets": {
									"type": "integer"
								},
								"netAssets": {
									"type": "integer"
								}
							}
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/LoggingStore')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_ADLS_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "*",
						"folderPath": "RAW/LOGGING",
						"fileSystem": "root"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"quoteChar": "\""
				},
				"schema": [
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Optionsettable')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "ReportsAnalytics",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "optionset"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/ReportsAnalytics')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/OriginationOpp')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "ReportsAnalytics",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "OriginationOpportunities"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/ReportsAnalytics')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Parquet')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "Transforms Dataverse data CSV files to Parquet format in lands the new files in the  Table/Snapshot directory.",
				"linkedServiceName": {
					"referenceName": "prod-synapse-uks-001-WorkspaceDefaultStorage",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"ContainerName": {
						"type": "string",
						"defaultValue": "\"Dataverse Container Name\""
					},
					"TableName": {
						"type": "string",
						"defaultValue": "\"Dataverse Table Name\""
					}
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": {
							"value": "concat(@dataset().TableName, \"/Snapshot\")",
							"type": "Expression"
						},
						"fileSystem": {
							"value": "@dataset().ContainerName",
							"type": "Expression"
						}
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/prod-synapse-uks-001-WorkspaceDefaultStorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ReportsDataset1')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "ReportsAnalytics",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [],
				"typeProperties": {
					"schema": "reports",
					"table": "Reports"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/ReportsAnalytics')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ReportsSL')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "ReportsSLLinkedSVC",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "EntityName",
						"type": "nvarchar"
					},
					{
						"name": "OptionSetName",
						"type": "nvarchar"
					},
					{
						"name": "Option",
						"type": "int",
						"precision": 10
					},
					{
						"name": "IsUserLocalizedLabel",
						"type": "nvarchar"
					},
					{
						"name": "LocalizedLabelLanguageCode",
						"type": "int",
						"precision": 10
					},
					{
						"name": "LocalizedLabel",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "dt_origination"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/ReportsSLLinkedSVC')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SharePointListSinkDS')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "SharePointSinkLS",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"Directory": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": {
							"value": "/@{dataset().Directory}",
							"type": "Expression"
						},
						"fileSystem": "root"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/SharePointSinkLS')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SharePointOnlineListResource2')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "SharePointOnlineList1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"sourcetablename": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "SharePointOnlineListResource",
				"schema": [],
				"typeProperties": {
					"listName": {
						"value": "@dataset().sourcetablename",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/SharePointOnlineList1')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Systemusertable')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "ReportsAnalytics",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "systemuser"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/ReportsAnalytics')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/crunchbase_api')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "CrunchRESTService",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/CrunchRESTService')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/crunchbase_source')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "crunchbasehttpsource",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "HttpServerLocation"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/crunchbasehttpsource')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/crunchbasebksink')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "MyOrigination",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "organization"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/MyOrigination')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/crunchbasesourceDS')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "crunchbasehttpsource",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "HttpServerLocation"
					},
					"compression": {
						"type": "TarGZip"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/crunchbasehttpsource')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dynamoBinaryComments')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "dynamoMetricValueLink",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"companyId": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "HttpServerLocation",
						"relativeUrl": {
							"value": "@concat('apiCore/api/CommentTexts/' ,dataset().companyId, '/search')",
							"type": "Expression"
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/dynamoMetricValueLink')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dynamoBinaryDS')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "dynamoPMVHttpLink",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"relativeURL": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "HttpServerLocation",
						"relativeUrl": {
							"value": "@dataset().relativeURL",
							"type": "Expression"
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/dynamoPMVHttpLink')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dynamoBinaryMetric')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "dynamoMetricValueLink",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"companyId": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "HttpServerLocation",
						"relativeUrl": {
							"value": "@concat('apiCore/api/Metrics/',dataset().companyId)",
							"type": "Expression"
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/dynamoMetricValueLink')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dynamoBinaryMetricValue')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "dynamoMetricValueLink",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"companyId": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "HttpServerLocation",
						"relativeUrl": {
							"value": "@concat('apiCore/api/Metrics/values/',dataset().companyId)",
							"type": "Expression"
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/dynamoMetricValueLink')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dynamoBlobComments')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "dynamoBlobLink",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"companyId": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": {
							"value": "@concat('apiCore/api/CommentTexts/' ,dataset().companyId,'.json')",
							"type": "Expression"
						},
						"folderPath": "staticdata",
						"container": "source"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/dynamoBlobLink')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dynamoBlobMetricValues')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "dynamoBlobLink",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"companyId": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": {
							"value": "@concat('apiCore/api/Metrics/values/',dataset().companyId, '.json')",
							"type": "Expression"
						},
						"folderPath": "staticdata",
						"container": "source"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/dynamoBlobLink')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dynamoBlobStore')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "dynamoBlobLink",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"folderPath": "staticdata",
						"container": "source"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/dynamoBlobLink')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dynamoHTTPDataset')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "dynamoMetricValueLink",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "HttpServerLocation"
					}
				},
				"schema": {}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/dynamoMetricValueLink')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dynamoMetricBlobDS')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "dynamoBlobLink",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"companyId": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": {
							"value": "@concat('apiCore/api/Metrics/',dataset().companyId, '.json')",
							"type": "Expression"
						},
						"folderPath": "staticdata",
						"container": "source"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/dynamoBlobLink')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dynamoMetricDS')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "dynamoMetricLINK",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"companyId": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "@concat('https://pm2.preqinsolutions.com/apiCore/api/Metrics/', dataset().companyId)",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/dynamoMetricLINK')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dynamoMetricSink')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_ADLS_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"companyId": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@concat(dataset().companyId)",
							"type": "Expression"
						},
						"folderPath": "RAW",
						"fileSystem": "root"
					}
				},
				"schema": {}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/jsonCompanyId')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_ADLS_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"companyId": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@concat(dataset().companyId, '.json')",
							"type": "Expression"
						},
						"folderPath": "RAW/Internal/insights/duedil/financials",
						"fileSystem": "root"
					}
				},
				"schema": {}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/jsoncountries')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_ADLS_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"CountryName": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@concat(dataset().CountryName, '.json')",
							"type": "Expression"
						},
						"folderPath": "duedil",
						"fileSystem": "insights"
					}
				},
				"schema": {}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/organisationcopysource')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_BLOB_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "organizations.csv",
						"folderPath": "testfolder",
						"container": "testcontainer"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "uuid",
						"type": "String"
					},
					{
						"name": "name",
						"type": "String"
					},
					{
						"name": "type",
						"type": "String"
					},
					{
						"name": "permalink",
						"type": "String"
					},
					{
						"name": "cb_url",
						"type": "String"
					},
					{
						"name": "rank",
						"type": "String"
					},
					{
						"name": "created_at",
						"type": "String"
					},
					{
						"name": "updated_at",
						"type": "String"
					},
					{
						"name": "legal_name",
						"type": "String"
					},
					{
						"name": "roles",
						"type": "String"
					},
					{
						"name": "domain",
						"type": "String"
					},
					{
						"name": "homepage_url",
						"type": "String"
					},
					{
						"name": "country_code",
						"type": "String"
					},
					{
						"name": "state_code",
						"type": "String"
					},
					{
						"name": "region",
						"type": "String"
					},
					{
						"name": "city",
						"type": "String"
					},
					{
						"name": "address",
						"type": "String"
					},
					{
						"name": "postal_code",
						"type": "String"
					},
					{
						"name": "status",
						"type": "String"
					},
					{
						"name": "short_description",
						"type": "String"
					},
					{
						"name": "category_list",
						"type": "String"
					},
					{
						"name": "category_groups_list",
						"type": "String"
					},
					{
						"name": "num_funding_rounds",
						"type": "String"
					},
					{
						"name": "total_funding_usd",
						"type": "String"
					},
					{
						"name": "total_funding",
						"type": "String"
					},
					{
						"name": "total_funding_currency_code",
						"type": "String"
					},
					{
						"name": "founded_on",
						"type": "String"
					},
					{
						"name": "last_funding_on",
						"type": "String"
					},
					{
						"name": "closed_on",
						"type": "String"
					},
					{
						"name": "employee_count",
						"type": "String"
					},
					{
						"name": "email",
						"type": "String"
					},
					{
						"name": "phone",
						"type": "String"
					},
					{
						"name": "facebook_url",
						"type": "String"
					},
					{
						"name": "linkedin_url",
						"type": "String"
					},
					{
						"name": "twitter_url",
						"type": "String"
					},
					{
						"name": "logo_url",
						"type": "String"
					},
					{
						"name": "alias1",
						"type": "String"
					},
					{
						"name": "alias2",
						"type": "String"
					},
					{
						"name": "alias3",
						"type": "String"
					},
					{
						"name": "primary_role",
						"type": "String"
					},
					{
						"name": "num_exits",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_BLOB_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/organizationBKDS')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_BLOB_PRIVATE_DYN",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "organizations.csv",
						"folderPath": "testfolder",
						"container": "testcontainer"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_BLOB_PRIVATE_DYN')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/originationtestDB')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "MyOrigination",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"targettable": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": {
						"value": "@dataset().targettable",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/MyOrigination')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ADLSLinkedService')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "Linked Service ",
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('ADLSLinkedService_properties_typeProperties_url')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AzureDataLakeStorage1')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('AzureDataLakeStorage1_properties_typeProperties_url')]",
					"accountKey": {
						"type": "SecureString",
						"value": "[parameters('AzureDataLakeStorage1_accountKey')]"
					}
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AzureDataLakeStorage2')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('AzureDataLakeStorage2_properties_typeProperties_url')]",
					"accountKey": {
						"type": "SecureString",
						"value": "[parameters('AzureDataLakeStorage2_accountKey')]"
					}
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AzureKeyVaultClientsecretSynapse')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureKeyVault",
				"typeProperties": {
					"baseUrl": "[parameters('AzureKeyVaultClientsecretSynapse_properties_typeProperties_baseUrl')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AzureSQLEnrichedServerless')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "DB Enriched Serverless v4",
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('AzureSQLEnrichedServerless_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AzureSynapseAnalytics1')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDW",
				"typeProperties": {
					"connectionString": "[parameters('AzureSynapseAnalytics1_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ChoiceDB DataverseEnriched')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDW",
				"typeProperties": {
					"connectionString": "[parameters('ChoiceDB DataverseEnriched_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CrunchRESTService')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "RestService",
				"typeProperties": {
					"url": "[parameters('CrunchRESTService_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Anonymous"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Dataverserondemand')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('Dataverserondemand_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DedicatedPoolInsight')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDW",
				"typeProperties": {
					"connectionString": "[parameters('DedicatedPoolInsight_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DueDil')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "RestService",
				"typeProperties": {
					"url": "[parameters('DueDil_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Anonymous",
					"authHeaders": {
						"X-AUTH-TOKEN": {
							"type": "SecureString",
							"value": "**********"
						}
					}
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DuedilCompanies')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "RestService",
				"typeProperties": {
					"url": "[parameters('DuedilCompanies_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Anonymous",
					"authHeaders": {
						"X-AUTH-TOKEN": {
							"type": "SecureString",
							"value": "**********"
						}
					}
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/EnrichedDatabase')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDW",
				"typeProperties": {
					"connectionString": "[parameters('EnrichedDatabase_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/EnrichmentDB')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('EnrichmentDB_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/InsightsAzureSynapseAnalytics')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDW",
				"typeProperties": {
					"connectionString": "[parameters('InsightsAzureSynapseAnalytics_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/LB_DBX_EngineeringSml')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureDatabricks",
				"typeProperties": {
					"domain": "https://adb-6189685947808943.3.azuredatabricks.net",
					"accessToken": {
						"type": "SecureString",
						"value": "[parameters('LB_DBX_EngineeringSml_accessToken')]"
					},
					"existingClusterId": "0926-113049-jx39fj8i"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/LS_ADLS_PRIVATE_DYN')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "Move",
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('LS_ADLS_PRIVATE_DYN_properties_typeProperties_url')]",
					"accountKey": {
						"type": "SecureString",
						"value": "[parameters('LS_ADLS_PRIVATE_DYN_accountKey')]"
					}
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/LS_BLOB_PRIVATE_DYN')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "Description",
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"connectionString": "[parameters('LS_BLOB_PRIVATE_DYN_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/LS_FIVERR_SQL_AnalyticsHub')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('LS_FIVERR_SQL_AnalyticsHub_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/LS_Metadata_SQL')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "make change",
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('LS_Metadata_SQL_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/LS_SQL_AnalyticsHub')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('LS_SQL_AnalyticsHub_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/LS_SQL_PretBIReference')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('LS_SQL_PretBIReference_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/LinkedServiceCDM')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('LinkedServiceCDM_properties_typeProperties_url')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/MyOrigination')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "Description",
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('MyOrigination_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/REST Companies API')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "RestService",
				"typeProperties": {
					"url": "[parameters('REST Companies API_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Anonymous"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ReportsAnalytics')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "Dataset Linked Service",
				"annotations": [],
				"type": "AzureSqlDW",
				"typeProperties": {
					"connectionString": "[parameters('ReportsAnalytics_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ReportsPowerBI')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "Power BI Reporting",
				"annotations": [],
				"type": "PowerBIWorkspace",
				"typeProperties": {
					"workspaceID": "6ca445fc-2a92-4d6e-8b51-1512ede98b84",
					"tenantID": "fca5641e-2829-432a-8b58-6259654f2a0e"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ReportsSLLinkedSVC')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDW",
				"typeProperties": {
					"connectionString": "[parameters('ReportsSLLinkedSVC_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ReportsSql')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('ReportsSql_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ServerLessSQL2')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDW",
				"typeProperties": {
					"connectionString": "[parameters('ServerLessSQL2_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SharePointOnlineList1')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "SharePointOnlineList",
				"typeProperties": {
					"siteUrl": "https://montaguequity.sharepoint.com/sites/InsightsTeam/",
					"tenantId": "fca5641e-2829-432a-8b58-6259654f2a0e",
					"servicePrincipalId": "[parameters('SharePointOnlineList1_properties_typeProperties_servicePrincipalId')]",
					"servicePrincipalKey": {
						"type": "SecureString",
						"value": "[parameters('SharePointOnlineList1_servicePrincipalKey')]"
					}
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SharePointSinkLS')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('SharePointSinkLS_properties_typeProperties_url')]",
					"accountKey": {
						"type": "SecureString",
						"value": "[parameters('SharePointSinkLS_accountKey')]"
					}
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SynapseDataAzureKeyVault')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureKeyVault",
				"typeProperties": {
					"baseUrl": "[parameters('SynapseDataAzureKeyVault_properties_typeProperties_baseUrl')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/crunchbasehttpsource')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "Descriptionv2",
				"annotations": [],
				"type": "HttpServer",
				"typeProperties": {
					"url": "[parameters('crunchbasehttpsource_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Anonymous"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dataverseprod')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('dataverseprod_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/duedilHTTPLinkService')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "HttpServer",
				"typeProperties": {
					"url": "[parameters('duedilHTTPLinkService_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Anonymous",
					"authHeaders": {
						"X-AUTH-TOKEN": {
							"type": "SecureString",
							"value": "**********"
						}
					}
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/duedilRESTLink')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "RestService",
				"typeProperties": {
					"url": "[parameters('duedilRESTLink_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Anonymous",
					"authHeaders": {
						"X-AUTH-TOKEN": {
							"type": "SecureString",
							"value": "**********"
						}
					}
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dynamoBlobLink')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"connectionString": "[parameters('dynamoBlobLink_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dynamoDirectRESTLINK')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "RestService",
				"typeProperties": {
					"url": "[parameters('dynamoDirectRESTLINK_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Anonymous"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dynamoMetricLINK')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "RestService",
				"typeProperties": {
					"url": "[parameters('dynamoMetricLINK_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Anonymous"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dynamoMetricLinkV4')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "HttpServer",
				"typeProperties": {
					"url": "[parameters('dynamoMetricLinkV4_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Anonymous"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dynamoMetricValueLink')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "HttpServer",
				"typeProperties": {
					"url": "[parameters('dynamoMetricValueLink_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Anonymous"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dynamoPMVHttpLink')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "HttpServer",
				"typeProperties": {
					"url": "[parameters('dynamoPMVHttpLink_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Anonymous"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dynamoREST')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "RestService",
				"typeProperties": {
					"url": "[parameters('dynamoREST_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Anonymous",
					"authHeaders": {
						"Authorization": {
							"type": "SecureString",
							"value": "**********"
						}
					}
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/mssfttestworkspace-WorkspaceDefaultSqlServer')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"parameters": {
					"DBName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "AzureSqlDW",
				"typeProperties": {
					"connectionString": "[parameters('mssfttestworkspace-WorkspaceDefaultSqlServer_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/mssfttestworkspace-WorkspaceDefaultStorage')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('mssfttestworkspace-WorkspaceDefaultStorage_properties_typeProperties_url')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/placeholder')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('placeholder_properties_typeProperties_url')]",
					"accountKey": {
						"type": "SecureString",
						"value": "[parameters('placeholder_accountKey')]"
					}
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/prod-synapse-uks-001-WorkspaceDefaultSqlServer')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"parameters": {
					"DBName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "AzureSqlDW",
				"typeProperties": {
					"connectionString": "[parameters('prod-synapse-uks-001-WorkspaceDefaultSqlServer_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/prod-synapse-uks-001-WorkspaceDefaultStorage')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('prod-synapse-uks-001-WorkspaceDefaultStorage_properties_typeProperties_url')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/synapseworksparcev4-WorkspaceDefaultSqlServer')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"parameters": {
					"DBName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "AzureSqlDW",
				"typeProperties": {
					"connectionString": "[parameters('synapseworksparcev4-WorkspaceDefaultSqlServer_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/synapseworksparcev4-WorkspaceDefaultStorage')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('synapseworksparcev4-WorkspaceDefaultStorage_properties_typeProperties_url')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/test-ws-synapse-uks-01-WorkspaceDefaultSqlServer')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"parameters": {
					"DBName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "AzureSqlDW",
				"typeProperties": {
					"connectionString": "[parameters('test-ws-synapse-uks-01-WorkspaceDefaultSqlServer_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/test-ws-synapse-uks-01-WorkspaceDefaultStorage')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('test-ws-synapse-uks-01-WorkspaceDefaultStorage_properties_typeProperties_url')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CRM Daily Extract')]",
			"type": "Microsoft.Synapse/workspaces/triggers",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Execute Montagu Load",
							"type": "PipelineReference"
						},
						"parameters": {
							"Area": "[parameters('CRM Daily Extract_properties_Execute Montagu Load_parameters_Area')]",
							"Domain": "[parameters('CRM Daily Extract_properties_Execute Montagu Load_parameters_Domain')]",
							"Region": "[parameters('CRM Daily Extract_properties_Execute Montagu Load_parameters_Region')]"
						}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Hour",
						"interval": 3,
						"startTime": "2022-12-12T07:00:00Z",
						"timeZone": "UTC"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/pipelines/Execute Montagu Load')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Crunchbase Daily Extract')]",
			"type": "Microsoft.Synapse/workspaces/triggers",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "crunchbasebkup",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Day",
						"interval": 1,
						"startTime": "2022-12-12T14:00:00Z",
						"timeZone": "UTC"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/pipelines/crunchbasebkup')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Duedil Monthly Trigger')]",
			"type": "Microsoft.Synapse/workspaces/triggers",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "duedulRESTful_companies",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Month",
						"interval": 1,
						"startTime": "2022-10-01T10:00:00Z",
						"timeZone": "UTC",
						"schedule": {
							"monthDays": [
								-1
							]
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/pipelines/duedulRESTful_companies')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Duedil_RelationshipReview')]",
			"type": "Microsoft.Synapse/workspaces/triggers",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "EX_SourceToRaw_Parent",
							"type": "PipelineReference"
						},
						"parameters": {
							"Area": "[parameters('Duedil_RelationshipReview_properties_EX_SourceToRaw_Parent_parameters_Area')]",
							"Domain": "[parameters('Duedil_RelationshipReview_properties_EX_SourceToRaw_Parent_parameters_Domain')]"
						}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Week",
						"interval": 1,
						"startTime": "2022-11-01T00:16:00Z",
						"timeZone": "UTC",
						"schedule": {
							"weekDays": [
								"Friday"
							]
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/pipelines/EX_SourceToRaw_Parent')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/OC Weeekly')]",
			"type": "Microsoft.Synapse/workspaces/triggers",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Execute Montagu Load",
							"type": "PipelineReference"
						},
						"parameters": {
							"SliceDate": "[parameters('OC Weeekly_properties_Execute Montagu Load_parameters_SliceDate')]",
							"Area": "[parameters('OC Weeekly_properties_Execute Montagu Load_parameters_Area')]",
							"Domain": "[parameters('OC Weeekly_properties_Execute Montagu Load_parameters_Domain')]",
							"Region": "[parameters('OC Weeekly_properties_Execute Montagu Load_parameters_Region')]"
						}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Day",
						"interval": 1,
						"startTime": "2023-01-11T05:00:00Z",
						"timeZone": "UTC",
						"schedule": {
							"minutes": [
								0,
								30
							],
							"hours": [
								6,
								7,
								8,
								9,
								10,
								11,
								12,
								13,
								14,
								15,
								16,
								17,
								18,
								19,
								20
							]
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/pipelines/Execute Montagu Load')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/OC Weekly Test')]",
			"type": "Microsoft.Synapse/workspaces/triggers",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Hour",
						"interval": 1,
						"startTime": "2023-01-11T05:00:00Z",
						"timeZone": "UTC"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Pause_Server_ReportsDW')]",
			"type": "Microsoft.Synapse/workspaces/triggers",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "Pause Every Day at 20:30",
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "PauseSQL",
							"type": "PipelineReference"
						},
						"parameters": {
							"ResourceGroup": "[parameters('Pause_Server_ReportsDW_properties_PauseSQL_parameters_ResourceGroup')]",
							"SubscriptionID": "[parameters('Pause_Server_ReportsDW_properties_PauseSQL_parameters_SubscriptionID')]",
							"WorkspaceName": "[parameters('Pause_Server_ReportsDW_properties_PauseSQL_parameters_WorkspaceName')]",
							"PauseorResume": "[parameters('Pause_Server_ReportsDW_properties_PauseSQL_parameters_PauseorResume')]"
						}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Day",
						"interval": 1,
						"startTime": "2022-04-20T20:30:00Z",
						"timeZone": "UTC"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/pipelines/PauseSQL')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ReferenceDataOnceDaily')]",
			"type": "Microsoft.Synapse/workspaces/triggers",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Hour",
						"interval": 24,
						"startTime": "2021-09-06T16:24:00Z",
						"timeZone": "UTC"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/cabreport')]",
			"type": "Microsoft.Synapse/workspaces/triggers",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Execute Montagu Load",
							"type": "PipelineReference"
						},
						"parameters": {
							"SliceDate": "[parameters('cabreport_properties_Execute Montagu Load_parameters_SliceDate')]",
							"Area": "[parameters('cabreport_properties_Execute Montagu Load_parameters_Area')]",
							"Domain": "[parameters('cabreport_properties_Execute Montagu Load_parameters_Domain')]",
							"Region": "[parameters('cabreport_properties_Execute Montagu Load_parameters_Region')]"
						}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Hour",
						"interval": 2,
						"startTime": "2023-01-25T12:37:00Z",
						"timeZone": "UTC"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/pipelines/Execute Montagu Load')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AutoResolveIntegrationRuntime')]",
			"type": "Microsoft.Synapse/workspaces/integrationRuntimes",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "Managed",
				"typeProperties": {
					"computeProperties": {
						"location": "AutoResolve",
						"dataFlowProperties": {
							"computeType": "General",
							"coreCount": 8,
							"timeToLive": 0,
							"cleanup": true
						},
						"pipelineExternalComputeScaleProperties": {
							"timeToLive": 60
						}
					}
				},
				"managedVirtualNetwork": {
					"type": "ManagedVirtualNetworkReference",
					"referenceName": "default"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/managedVirtualNetworks/default')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/IntegrationRuntime1')]",
			"type": "Microsoft.Synapse/workspaces/integrationRuntimes",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "Managed",
				"typeProperties": {
					"computeProperties": {
						"location": "AutoResolve",
						"dataFlowProperties": {
							"computeType": "General",
							"coreCount": 8,
							"timeToLive": 10,
							"cleanup": false
						}
					}
				},
				"managedVirtualNetwork": {
					"type": "ManagedVirtualNetworkReference",
					"referenceName": "default"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/managedVirtualNetworks/default')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/IntegrationRuntime4')]",
			"type": "Microsoft.Synapse/workspaces/integrationRuntimes",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "Managed",
				"typeProperties": {
					"computeProperties": {
						"location": "AutoResolve",
						"dataFlowProperties": {
							"computeType": "General",
							"coreCount": 8,
							"timeToLive": 10,
							"cleanup": false
						},
						"copyComputeScaleProperties": {
							"dataIntegrationUnit": 4,
							"timeToLive": 5
						},
						"pipelineExternalComputeScaleProperties": {
							"timeToLive": 60
						}
					}
				},
				"managedVirtualNetwork": {
					"type": "ManagedVirtualNetworkReference",
					"referenceName": "default"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/managedVirtualNetworks/default')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/IntegrationRuntime5')]",
			"type": "Microsoft.Synapse/workspaces/integrationRuntimes",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "Managed",
				"typeProperties": {
					"computeProperties": {
						"location": "AutoResolve",
						"dataFlowProperties": {
							"computeType": "General",
							"coreCount": 8,
							"timeToLive": 10,
							"cleanup": false
						},
						"copyComputeScaleProperties": {
							"dataIntegrationUnit": 4,
							"timeToLive": 5
						},
						"pipelineExternalComputeScaleProperties": {
							"timeToLive": 60
						}
					}
				},
				"managedVirtualNetwork": {
					"type": "ManagedVirtualNetworkReference",
					"referenceName": "default"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/managedVirtualNetworks/default')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Dataflow1')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"name": "OriginationOppSourceSL"
						},
						{
							"linkedService": {
								"referenceName": "ReportsSLLinkedSVC",
								"type": "LinkedServiceReference"
							},
							"name": "OptionSetInSL"
						},
						{
							"name": "AccountInSourceSL"
						},
						{
							"name": "AppointmentInSourceSL"
						},
						{
							"name": "ContactsInSourceSL"
						},
						{
							"name": "SystemUserInSourceSL"
						},
						{
							"name": "GapOptionsetIn"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "ReportsSL",
								"type": "DatasetReference"
							},
							"name": "OriginationSL"
						},
						{
							"linkedService": {
								"referenceName": "ReportsSLLinkedSVC",
								"type": "LinkedServiceReference"
							},
							"name": "OpionsetSLSink",
							"rejectedDataLinkedService": {
								"referenceName": "prod-synapse-uks-001-WorkspaceDefaultStorage",
								"type": "LinkedServiceReference"
							}
						},
						{
							"linkedService": {
								"referenceName": "ReportsSLLinkedSVC",
								"type": "LinkedServiceReference"
							},
							"name": "GapOptionSetSinkSL"
						}
					],
					"transformations": [
						{
							"name": "OriginationSelectOutput"
						},
						{
							"name": "AccountSelectOutput"
						},
						{
							"name": "AppointmentSelectOutput"
						},
						{
							"name": "ContactSelectOutput"
						},
						{
							"name": "SystemUserSelectInSL"
						},
						{
							"name": "OptionSetPivotSL"
						},
						{
							"name": "GapOptionSetOutputSL"
						},
						{
							"name": "join1"
						},
						{
							"name": "derivedColumn1"
						},
						{
							"name": "unpivot1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          ts_dealannouncedreason as long,",
						"          ts_highprioritynew as long,",
						"          ts_actionstatus as long,",
						"          mpe_targetrelationshipstatus as long,",
						"          ts_producttype as long,",
						"          ts_internalintermediarysource as long,",
						"          mpe_flowlastrunoutcome as long,",
						"          ts_currentactivity as long,",
						"          ts_opportunitystatus as long,",
						"          ts_montaguprimaryoffice as long,",
						"          ts_opportunitytype as long,",
						"          ts_posthumstatus as long,",
						"          ts_meetingremindermonths as long,",
						"          ts_choppedreason as string,",
						"          ts_setreminder as boolean,",
						"          ts_stagereachedfir as boolean,",
						"          ts_stagereachedipr as boolean,",
						"          ts_duplicateopportunityfordiscussion as boolean,",
						"          mpe_smalltarget as boolean,",
						"          ts_stagereachedcr as boolean,",
						"          xpd_includeonallpapers as boolean,",
						"          ts_sold as boolean,",
						"          xpd_sharepointlocationcreated as boolean,",
						"          ts_statuschangedby as string,",
						"          ts_statuschangedby_entitytype as string,",
						"          ts_buyer as string,",
						"          ts_buyer_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          ts_reminderto as string,",
						"          ts_reminderto_entitytype as string,",
						"          mpe_productid as string,",
						"          mpe_productid_entitytype as string,",
						"          ts_targetbusiness as string,",
						"          ts_targetbusiness_entitytype as string,",
						"          ts_firstreferralcompany as string,",
						"          ts_firstreferralcompany_entitytype as string,",
						"          ts_deallead as string,",
						"          ts_deallead_entitytype as string,",
						"          ts_montaguowner as string,",
						"          ts_montaguowner_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          ts_firstreferralcontact as string,",
						"          ts_firstreferralcontact_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ts_managerwedback as string,",
						"          ts_managerwedback_entitytype as string,",
						"          ts_country as string,",
						"          ts_country_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          ts_sellmandate as string,",
						"          ts_sellmandate_entitytype as string,",
						"          ts_estebitda_base as decimal(38,4),",
						"          ts_estebit_base as decimal(38,4),",
						"          ts_estebitda as decimal(38,4),",
						"          ts_estebit as decimal(38,4),",
						"          ts_estturnover_base as decimal(38,4),",
						"          ts_estdealsize as decimal(38,4),",
						"          ts_estdealsize_base as decimal(38,4),",
						"          ts_estturnover as decimal(38,4),",
						"          ts_buyeryominame as string,",
						"          modifiedon as timestamp,",
						"          ts_statuschangedbyname as string,",
						"          ts_managerwedbackyominame as string,",
						"          xpd_montaguprojectname as string,",
						"          transactioncurrencyidname as string,",
						"          ts_nextsteps as string,",
						"          ts_montaguowneryominame as string,",
						"          ts_firstreferralcontactname as string,",
						"          ts_opportunitydescription as string,",
						"          ts_buyerpaidxltmebitda as decimal(38,1),",
						"          ts_targetbusinessyominame as string,",
						"          ts_montaguownername as string,",
						"          ts_managerwedbackname as string,",
						"          ts_opportunitystage as string,",
						"          ts_otherdocumentsurl as string,",
						"          exchangerate as decimal(38,10),",
						"          mpe_documentsetid as string,",
						"          ts_buyername as string,",
						"          ts_firstreferralcontactyominame as string,",
						"          createdon as string,",
						"          ts_sellmandateyominame as string,",
						"          mpe_montaguprimaryofficestring as string,",
						"          ts_statuschangedbyyominame as string,",
						"          ts_firstreferralcompanyname as string,",
						"          owneridyominame as string,",
						"          ts_choppedcomments as string,",
						"          timezoneruleversionnumber as long,",
						"          createdbyname as string,",
						"          ts_dealleadname as string,",
						"          owningbusinessunitname as string,",
						"          ts_dealleadyominame as string,",
						"          ts_lastdatestatuschanged as timestamp,",
						"          traversedpath as string,",
						"          overriddencreatedon as timestamp,",
						"          ts_iprdocumenturl as string,",
						"          createdonbehalfbyname as string,",
						"          ts_sellmandatename as string,",
						"          owneridtype as string,",
						"          owneridname as string,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          mpe_productidname as string,",
						"          ts_originationopportunityid as string,",
						"          ts_crdocumenturl as string,",
						"          ts_datedealannounced as timestamp,",
						"          processid as string,",
						"          mpe_montaguprimaryofficeowner as string,",
						"          ts_reason as string,",
						"          ts_targetbusinessname as string,",
						"          ts_remindertoname as string,",
						"          ts_postcompletionnoteurl as string,",
						"          ts_name as string,",
						"          stageid as string,",
						"          ts_currentopportunitystatus as string,",
						"          ts_firstreferralcompanyyominame as string,",
						"          mpe_flowlastrundate as timestamp,",
						"          ts_firdocumenturl as string,",
						"          modifiedbyyominame as string,",
						"          modifiedonbehalfbyyominame as string,",
						"          ts_movedoutofwipdate as timestamp,",
						"          ts_equitychequesize as decimal(38,2),",
						"          utcconversiontimezonecode as long,",
						"          ts_weofferedxltmebitda as decimal(38,1),",
						"          importsequencenumber as long,",
						"          ts_remindertoyominame as string,",
						"          ts_companyid as long,",
						"          ts_datereminderwasset as timestamp,",
						"          versionnumber as long,",
						"          ts_originationid as long,",
						"          ts_countryname as string,",
						"          ts_choppeddate as timestamp,",
						"          mpe_posthunstatustext as string,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          ts_humdate as timestamp,",
						"          ts_sellmandateidtype as string,",
						"          ts_dateofreminder as timestamp,",
						"          ts_humurl as string,",
						"          mpe_carveout as long,",
						"          mpe_targetbusiness_parentid as string,",
						"          mpe_targetbusiness_parentid_entitytype as string,",
						"          mpe_targetbusiness_parentidyominame as string,",
						"          mpe_targetbusiness_parentidname as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     limit: 100,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'ts_originationopportunity') ~> OriginationOppSourceSL",
						"source(output(",
						"          EntityName as string,",
						"          OptionSetName as string,",
						"          Option as integer,",
						"          IsUserLocalizedLabel as string,",
						"          LocalizedLabelLanguageCode as integer,",
						"          LocalizedLabel as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'optionview',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: true) ~> OptionSetInSL",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          ts_primarysecondaryfocus as long,",
						"          customertypecode as long,",
						"          ts_relationship as long,",
						"          address1_addresstypecode as long,",
						"          accountclassificationcode as long,",
						"          ts_easeofworking as long,",
						"          ts_ukrow as long,",
						"          preferredappointmenttimecode as long,",
						"          ts_address1addresstype as long,",
						"          xpd_relationshipstatus as long,",
						"          ts_introducertype as long,",
						"          xpd_remindermonths as long,",
						"          ts_importance as long,",
						"          address2_freighttermscode as long,",
						"          ts_irrvsmomperformancemeasure as long,",
						"          accountcategorycode as long,",
						"          paymenttermscode as long,",
						"          preferredappointmentdaycode as long,",
						"          businesstypecode as long,",
						"          industrycode as long,",
						"          ts_sizeoffirm as long,",
						"          ts_interaction as long,",
						"          address1_shippingmethodcode as long,",
						"          ts_portfoliocompanystatus as long,",
						"          customersizecode as long,",
						"          xpd_previousinvestorstatus as long,",
						"          ts_recommendationoffirm as long,",
						"          preferredcontactmethodcode as long,",
						"          accountratingcode as long,",
						"          ts_investorstatus as long,",
						"          ts_capabilitiesoffirm as long,",
						"          mpe_flowlastrunoutcome as long,",
						"          address2_addresstypecode as long,",
						"          address2_shippingmethodcode as long,",
						"          ts_nextoriginationmeetingarranged as long,",
						"          ownershipcode as long,",
						"          territorycode as long,",
						"          ts_investortype as long,",
						"          shippingmethodcode as long,",
						"          ts_investorregion as long,",
						"          address1_freighttermscode as long,",
						"          xpd_function as string,",
						"          ts_quickcaptureuses as string,",
						"          ts_permanentinterim as string,",
						"          ts_quickcapturesectors as string,",
						"          ts_roletypes as string,",
						"          ts_companytype as string,",
						"          xpd_level as string,",
						"          ts_indicativeclientbase as string,",
						"          xpd_specialisms as string,",
						"          xpd_montagulevel as string,",
						"          ts_vendorsummary as string,",
						"          ts_producttype as string,",
						"          ts_montaguoffice as string,",
						"          ts_quickcapturegeography as string,",
						"          xpd_roletypes as string,",
						"          mpe_livedeal as boolean,",
						"          donotbulkpostalmail as boolean,",
						"          donotpostalmail as boolean,",
						"          msdyn_gdproptout as boolean,",
						"          ts_organisationalchange as boolean,",
						"          xpd_publictoprivatetracker as boolean,",
						"          ts_auditor as boolean,",
						"          donotsendmm as boolean,",
						"          donotbulkemail as boolean,",
						"          followemail as boolean,",
						"          creditonhold as boolean,",
						"          marketingonly as boolean,",
						"          participatesinworkflow as boolean,",
						"          merged as boolean,",
						"          ts_validated as boolean,",
						"          xpd_sharepointlocationcreated as boolean,",
						"          xpd_setreminder as boolean,",
						"          ts_personnelchange as boolean,",
						"          donotfax as boolean,",
						"          isprivate as boolean,",
						"          donotphone as boolean,",
						"          xpd_rpo as boolean,",
						"          ts_trackcompany as boolean,",
						"          donotemail as boolean,",
						"          parentaccountid as string,",
						"          parentaccountid_entitytype as string,",
						"          ts_recommendedby as string,",
						"          ts_recommendedby_entitytype as string,",
						"          ts_countryofeconomicoriginforthecapital as string,",
						"          ts_countryofeconomicoriginforthecapital_entitytype as string,",
						"          xpd_reminderto as string,",
						"          xpd_reminderto_entitytype as string,",
						"          preferredserviceid as string,",
						"          preferredserviceid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          createdbyexternalparty as string,",
						"          createdbyexternalparty_entitytype as string,",
						"          ts_validatedby as string,",
						"          ts_validatedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          ts_primarymperelationshipmanager as string,",
						"          ts_primarymperelationshipmanager_entitytype as string,",
						"          modifiedbyexternalparty as string,",
						"          modifiedbyexternalparty_entitytype as string,",
						"          ts_headofficeid as string,",
						"          ts_headofficeid_entitytype as string,",
						"          ts_address1country as string,",
						"          ts_address1country_entitytype as string,",
						"          ts_address1usstate as string,",
						"          ts_address1usstate_entitytype as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          originatingleadid as string,",
						"          originatingleadid_entitytype as string,",
						"          masterid as string,",
						"          masterid_entitytype as string,",
						"          ts_originationlead1 as string,",
						"          ts_originationlead1_entitytype as string,",
						"          defaultpricelevelid as string,",
						"          defaultpricelevelid_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          ts_originationlead2 as string,",
						"          ts_originationlead2_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          mpe_coinvestquestionnaireid as string,",
						"          mpe_coinvestquestionnaireid_entitytype as string,",
						"          ts_hub as string,",
						"          ts_hub_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          ts_currentauditor as string,",
						"          ts_currentauditor_entitytype as string,",
						"          primarycontactid as string,",
						"          primarycontactid_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          preferredsystemuserid as string,",
						"          preferredsystemuserid_entitytype as string,",
						"          preferredequipmentid as string,",
						"          preferredequipmentid_entitytype as string,",
						"          xpd_fund as string,",
						"          xpd_fund_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          territoryid as string,",
						"          territoryid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          xpd_totalinstitutionalcommitments_base as decimal(38,0),",
						"          ts_minimumticketsize_base as decimal(38,4),",
						"          xpd_totalinstitutionalcommitments as decimal(38,0),",
						"          aging30 as decimal(38,0),",
						"          creditlimit as decimal(38,0),",
						"          creditlimit_base as decimal(38,0),",
						"          ts_totalcommitments_base as decimal(38,4),",
						"          aging60 as decimal(38,0),",
						"          ts_transfersin_base as decimal(38,0),",
						"          aging90 as decimal(38,0),",
						"          ts_maximumticketsize as decimal(38,4),",
						"          ts_totalaum_base as decimal(38,0),",
						"          marketcap_base as decimal(38,0),",
						"          aging60_base as decimal(38,0),",
						"          aging90_base as decimal(38,0),",
						"          ts_transfersout as decimal(38,0),",
						"          ts_maximumticketsize_base as decimal(38,4),",
						"          ts_originalcommitments_base as decimal(38,0),",
						"          revenue as decimal(38,0),",
						"          ts_totalcommitments as decimal(38,4),",
						"          ts_transfersout_base as decimal(38,0),",
						"          ts_totalaum as decimal(38,0),",
						"          ts_commitmentreductions_base as decimal(38,0),",
						"          ts_commitmentreductions as decimal(38,0),",
						"          marketcap as decimal(38,0),",
						"          ts_originalcommitments as decimal(38,0),",
						"          ts_minimumticketsize as decimal(38,4),",
						"          revenue_base as decimal(38,0),",
						"          openrevenue_base as decimal(38,0),",
						"          aging30_base as decimal(38,0),",
						"          openrevenue as decimal(38,0),",
						"          ts_transfersin as decimal(38,0),",
						"          ts_othernotes as string,",
						"          ts_transfersin_date as timestamp,",
						"          address1_county as string,",
						"          openrevenue_date as timestamp,",
						"          ts_recommendedbyname as string,",
						"          ts_relationshipinteractioncomments as string,",
						"          ts_originationlead2yominame as string,",
						"          parentaccountidname as string,",
						"          xpd_roletypes_text as string,",
						"          address1_addressid as string,",
						"          importsequencenumber as long,",
						"          address1_longitude as double,",
						"          ts_countryofeconomicoriginforthecapitalname as string,",
						"          entityimageid as string,",
						"          telephone2 as string,",
						"          ts_lastoriginationmeeting as timestamp,",
						"          address2_utcoffset as long,",
						"          address1_upszone as string,",
						"          ts_originalcommitments_state as long,",
						"          ts_typicalcost as string,",
						"          xpd_recommendingportfoliocompaniesrecommended as string,",
						"          accountnumber as string,",
						"          ts_currentauditoryominame as string,",
						"          ts_originalcommitments_date as timestamp,",
						"          lastonholdtime as timestamp,",
						"          ts_sectorscoveredbyfirm as string,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          address2_upszone as string,",
						"          opendeals_state as long,",
						"          xpd_functionuse_text as string,",
						"          slainvokedidname as string,",
						"          address2_longitude as double,",
						"          defaultpricelevelidname as string,",
						"          stockexchange as string,",
						"          mpe_liveofferingscount_date as timestamp,",
						"          xpd_relationshipcomments as string,",
						"          originatingleadidname as string,",
						"          slaname as string,",
						"          ts_currentauditorname as string,",
						"          xpd_remindertoyominame as string,",
						"          ts_address1usstatename as string,",
						"          ts_tempcompanytype as string,",
						"          versionnumber as long,",
						"          address1_latitude as double,",
						"          ts_formername as string,",
						"          yominame as string,",
						"          createdbyyominame as string,",
						"          ts_cityofvisit as string,",
						"          address2_telephone1 as string,",
						"          ts_globalgeographiescoveredids as string,",
						"          preferredserviceidname as string,",
						"          address2_city as string,",
						"          ts_mpeapproachstrategy as string,",
						"          address2_line2 as string,",
						"          ts_lastdatestatuschanged as timestamp,",
						"          li_companyid as long,",
						"          transactioncurrencyidname as string,",
						"          entityimage_url as string,",
						"          xpd_relationshipstatuschangeddate as timestamp,",
						"          createdonbehalfbyname as string,",
						"          mpe_liveofferingscount_state as long,",
						"          xpd_numberofcoinvestinvestments_date as timestamp,",
						"          ts_validateddate as timestamp,",
						"          owneridname as string,",
						"          xpd_generalcomments as string,",
						"          ts_companylegalname as string,",
						"          description as string,",
						"          ts_validatedbyname as string,",
						"          originatingleadidyominame as string,",
						"          opendeals as long,",
						"          xpd_numberofopportunitiesshown_state as long,",
						"          address2_postalcode as string,",
						"          websiteurl as string,",
						"          xpd_fundname as string,",
						"          address1_utcoffset as long,",
						"          exchangerate as decimal(38,10),",
						"          mpe_flowlastrundate as timestamp,",
						"          fax as string,",
						"          address1_line3 as string,",
						"          ts_monthssincelastmeeting as long,",
						"          ts_hubname as string,",
						"          address2_line1 as string,",
						"          ts_capiqticket as string,",
						"          address2_stateorprovince as string,",
						"          address2_name as string,",
						"          ts_transfersout_state as long,",
						"          xpd_numberofopportunitiesshown as long,",
						"          primarytwitterid as string,",
						"          mpe_coinvestquestionnaireidname as string,",
						"          xpd_numberofopportunitiesshown_date as timestamp,",
						"          xpd_preferentialterms as string,",
						"          address1_primarycontactname as string,",
						"          territoryidname as string,",
						"          ts_processstatus as string,",
						"          address1_name as string,",
						"          address2_telephone2 as string,",
						"          address2_telephone3 as string,",
						"          xpd_recruitmentareateam_text as string,",
						"          ftpsiteurl as string,",
						"          address1_postalcode as string,",
						"          ts_companynumber as string,",
						"          createdon as string,",
						"          mpe_liveofferingscount as long,",
						"          traversedpath as string,",
						"          address1_stateorprovince as string,",
						"          ts_transfersin_state as long,",
						"          address2_addressid as string,",
						"          ts_monthlyreviewmeetingname as string,",
						"          primarysatoriid as string,",
						"          telephone3 as string,",
						"          openrevenue_state as long,",
						"          ts_usesprovidedids as string,",
						"          ts_originationcomments as string,",
						"          lastusedincampaign as timestamp,",
						"          primarycontactidname as string,",
						"          ts_originationlead1name as string,",
						"          ts_headofficeidname as string,",
						"          ts_montagucomments as string,",
						"          address2_fax as string,",
						"          createdbyname as string,",
						"          xpd_numberofcoinvestinvestments as long,",
						"          ts_capitaliqlink as string,",
						"          ts_primarymperelationshipmanagername as string,",
						"          mpe_relationshipstatus_text as string,",
						"          xpd_datereminderwasset as timestamp,",
						"          xpd_numberofcoinvestinvestments_state as long,",
						"          address1_postofficebox as string,",
						"          address1_city as string,",
						"          teamsfollowed as long,",
						"          ts_originationlead2name as string,",
						"          timezoneruleversionnumber as long,",
						"          modifiedonbehalfbyyominame as string,",
						"          entityimage_timestamp as long,",
						"          tickersymbol as string,",
						"          ts_theirprogrammecomments as string,",
						"          xpd_companyuse_text as string,",
						"          modifiedbyname as string,",
						"          owneridtype as string,",
						"          sic as string,",
						"          sharesoutstanding as long,",
						"          opendeals_date as timestamp,",
						"          address2_postofficebox as string,",
						"          emailaddress3 as string,",
						"          emailaddress2 as string,",
						"          emailaddress1 as string,",
						"          ts_globalgeographiescoveredbyfirm as string,",
						"          ts_recommendationoffirmupdated as timestamp,",
						"          ts_lastmet as timestamp,",
						"          ts_reminderdatesetto as timestamp,",
						"          ts_commitmentreductions_state as long,",
						"          owningbusinessunitname as string,",
						"          onholdtime as long,",
						"          ts_alias as string,",
						"          createdonbehalfbyyominame as string,",
						"          ts_transfersout_date as timestamp,",
						"          ts_address1countryname as string,",
						"          preferredsystemuseridyominame as string,",
						"          createdbyexternalpartyname as string,",
						"          mpe_documentsetid as string,",
						"          telephone1 as string,",
						"          ts_legacycompanytypes as string,",
						"          ts_validatedbyyominame as string,",
						"          address1_composite as string,",
						"          ts_investorgroupgatekeeperid as string,",
						"          primarycontactidyominame as string,",
						"          address2_country as string,",
						"          xpd_recommendationcomments as string,",
						"          owneridyominame as string,",
						"          createdbyexternalpartyyominame as string,",
						"          ts_originationlead1yominame as string,",
						"          ts_usesprovidedbyfirm as string,",
						"          xpd_recommendingportco as string,",
						"          address1_country as string,",
						"          ts_commitmentreductions_date as timestamp,",
						"          name as string,",
						"          modifiedbyexternalpartyyominame as string,",
						"          xpd_remindertoname as string,",
						"          stageid as string,",
						"          modifiedonbehalfbyname as string,",
						"          masteraccountidname as string,",
						"          timespentbymeonemailandmeetings as string,",
						"          address2_latitude as double,",
						"          overriddencreatedon as timestamp,",
						"          parentaccountidyominame as string,",
						"          ts_specificareaofexpertisecomments as string,",
						"          preferredsystemuseridname as string,",
						"          utcconversiontimezonecode as long,",
						"          address2_county as string,",
						"          address1_line1 as string,",
						"          address2_primarycontactname as string,",
						"          address1_line2 as string,",
						"          xpd_reasonaction as string,",
						"          ts_primarymperelationshipmanageryominame as string,",
						"          processid as string,",
						"          ts_sectorscoveredids as string,",
						"          ts_recommendedbyyominame as string,",
						"          modifiedbyexternalpartyname as string,",
						"          ts_relevantsituations as string,",
						"          accountid as string,",
						"          modifiedon as timestamp,",
						"          preferredequipmentidname as string,",
						"          modifiedbyyominame as string,",
						"          ts_dealstageofmostrecentopportunity as string,",
						"          address2_composite as string,",
						"          masteraccountidyominame as string,",
						"          numberofemployees as long,",
						"          address1_fax as string,",
						"          address2_line3 as string,",
						"          msdyn_segmentid as string,",
						"          msdyn_segmentid_entitytype as string,",
						"          msdyn_segmentidname as string,",
						"          msdyn_salesaccelerationinsightid as string,",
						"          msdyn_salesaccelerationinsightid_entitytype as string,",
						"          msdyn_salesaccelerationinsightidname as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     limit: 100,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'account') ~> AccountInSourceSL",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          ts_stageofmeetingrounds as long,",
						"          ts_talentmeetingtype as long,",
						"          instancetypecode as long,",
						"          ts_whooriginatedthemeeting as long,",
						"          onlinemeetingtype as long,",
						"          ts_meetingteam as long,",
						"          ts_othermeetingmethod as long,",
						"          ts_tone as long,",
						"          ts_meetingmethod as long,",
						"          ts_originationmeetingtype as long,",
						"          prioritycode as long,",
						"          attachmenterrors as long,",
						"          ts_eventtype as long,",
						"          ts_talentmeetingmethod as long,",
						"          ts_productsdiscussed as string,",
						"          ts_contentcovered as string,",
						"          isonlinemeeting as boolean,",
						"          isworkflowcreated as boolean,",
						"          isalldayevent as boolean,",
						"          ts_interview as boolean,",
						"          isbilled as boolean,",
						"          isdraft as boolean,",
						"          ts_keyiractivity as boolean,",
						"          ts_noninvestor as boolean,",
						"          ismapiprivate as boolean,",
						"          isregularactivity as boolean,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          ts_investorgroup as string,",
						"          ts_investorgroup_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          regardingobjectid as string,",
						"          regardingobjectid_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ts_officemet as string,",
						"          ts_officemet_entitytype as string,",
						"          ts_taskowner as string,",
						"          ts_taskowner_entitytype as string,",
						"          serviceid as string,",
						"          serviceid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          requiredattendees as string,",
						"          optionalattendees as string,",
						"          organizer as string,",
						"          scheduledend as timestamp,",
						"          ts_taskdescription as string,",
						"          modifiedon as timestamp,",
						"          ts_purpose as string,",
						"          overriddencreatedon as timestamp,",
						"          ts_taskownername as string,",
						"          activityadditionalparams as string,",
						"          ts_tonepersonalities as string,",
						"          seriesid as string,",
						"          transactioncurrencyidname as string,",
						"          activityid as string,",
						"          modifiedfieldsmask as string,",
						"          utcconversiontimezonecode as long,",
						"          ts_officemetname as string,",
						"          scheduledstart as timestamp,",
						"          outlookownerapptid as long,",
						"          ts_topicscovered as string,",
						"          ts_objective as string,",
						"          onholdtime as long,",
						"          onlinemeetingjoinurl as string,",
						"          ts_notes as string,",
						"          originalstartdate as timestamp,",
						"          ts_opportunitiesdiscussed as string,",
						"          ts_sectorscoveredbyfirm as string,",
						"          attachmentcount as long,",
						"          exchangerate as decimal(38,10),",
						"          ts_originationcommentsnotes as string,",
						"          category as string,",
						"          createdon as string,",
						"          ts_eventdescription as string,",
						"          globalobjectid as string,",
						"          onlinemeetingid as string,",
						"          serviceidname as string,",
						"          owneridyominame as string,",
						"          description as string,",
						"          subcategory as string,",
						"          owningbusinessunitname as string,",
						"          ts_taskduedate as timestamp,",
						"          traversedpath as string,",
						"          sortdate as timestamp,",
						"          createdonbehalfbyname as string,",
						"          ts_sectorscoveredids as string,",
						"          safedescription as string,",
						"          ts_taskowneryominame as string,",
						"          owneridtype as string,",
						"          isunsafe as long,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          ts_conferencename as string,",
						"          timezoneruleversionnumber as long,",
						"          actualend as timestamp,",
						"          regardingobjectidname as string,",
						"          processid as string,",
						"          activitytypecode as string,",
						"          actualstart as timestamp,",
						"          xpd_listofexternalattendees as string,",
						"          slainvokedidname as string,",
						"          location as string,",
						"          subject as string,",
						"          createdbyname as string,",
						"          actualdurationminutes as long,",
						"          modifiedbyyominame as string,",
						"          lastonholdtime as timestamp,",
						"          modifiedonbehalfbyyominame as string,",
						"          ts_attendeestoaddtocrm as string,",
						"          regardingobjectidyominame as string,",
						"          regardingobjecttypecode as string,",
						"          stageid as string,",
						"          scheduleddurationminutes as long,",
						"          ts_sourceid as string,",
						"          ts_investorgroupyominame as string,",
						"          importsequencenumber as long,",
						"          subscriptionid as string,",
						"          onlinemeetingchatid as string,",
						"          ts_lpupdates as string,",
						"          ts_executivesummary as string,",
						"          ts_investorgroupname as string,",
						"          ts_meetingcity as string,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          owneridname as string,",
						"          ts_theirprogramme as string,",
						"          ts_ifdeclinedreason as string,",
						"          slaname as string,",
						"          versionnumber as long",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     limit: 100,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'appointment') ~> AppointmentInSourceSL",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          haschildrencode as long,",
						"          customertypecode as long,",
						"          ts_recommendationofindividual as long,",
						"          gendercode as long,",
						"          address1_addresstypecode as long,",
						"          leadsourcecode as long,",
						"          preferredappointmenttimecode as long,",
						"          address2_freighttermscode as long,",
						"          address2_shippingmethodcode as long,",
						"          ts_debtsubtype as long,",
						"          msdyn_orgchangestatus as long,",
						"          ts_suffix as long,",
						"          xpd_gender as long,",
						"          ts_title as long,",
						"          paymenttermscode as long,",
						"          accountrolecode as long,",
						"          territorycode as long,",
						"          ts_vendortargettrackingrole as long,",
						"          address3_freighttermscode as long,",
						"          address1_shippingmethodcode as long,",
						"          preferredappointmentdaycode as long,",
						"          customersizecode as long,",
						"          preferredcontactmethodcode as long,",
						"          ts_futurecontactmethod as long,",
						"          address3_shippingmethodcode as long,",
						"          address2_addresstypecode as long,",
						"          mpe_flowlastrunoutcome as long,",
						"          ts_capabilitiesofindividual as long,",
						"          address3_addresstypecode as long,",
						"          familystatuscode as long,",
						"          shippingmethodcode as long,",
						"          xpd_availability as long,",
						"          educationcode as long,",
						"          address1_freighttermscode as long,",
						"          ts_quickcaptureuses as string,",
						"          xpd_montagulevel as string,",
						"          ts_permanentinterim as string,",
						"          ts_ircontactrole as string,",
						"          xpd_level as string,",
						"          ts_languagesspokenwritten as string,",
						"          ts_contacttype as string,",
						"          ts_montaguoffice as string,",
						"          ts_roletypes as string,",
						"          xpd_specialisms as string,",
						"          ts_quickcapturesectors as string,",
						"          xpd_function as string,",
						"          ts_producttype as string,",
						"          ts_quickcapturegeography as string,",
						"          ts_productsinterestedin as string,",
						"          ts_potentialrolecandidate as boolean,",
						"          isbackofficecustomer as boolean,",
						"          donotpostalmail as boolean,",
						"          xpd_addcontacttooutlook as boolean,",
						"          ts_centralrelationshipmanager as boolean,",
						"          msdyn_gdproptout as boolean,",
						"          xpd_hascompany as boolean,",
						"          creditonhold as boolean,",
						"          xpd_benchcandidate as boolean,",
						"          donotbulkpostalmail as boolean,",
						"          donotsendmm as boolean,",
						"          donotbulkemail as boolean,",
						"          followemail as boolean,",
						"          xpd_sharepointdocumentlocationcreated as boolean,",
						"          xpd_available as boolean,",
						"          ts_leadearlystageinteraction as boolean,",
						"          participatesinworkflow as boolean,",
						"          ts_doyouwishtotrackthiscontact as boolean,",
						"          merged as boolean,",
						"          ts_validated as boolean,",
						"          marketingonly as boolean,",
						"          donotfax as boolean,",
						"          isprivate as boolean,",
						"          donotphone as boolean,",
						"          isautocreate as boolean,",
						"          donotemail as boolean,",
						"          ts_unconfirmedemailaddress as boolean,",
						"          preferredsystemuserid as string,",
						"          preferredsystemuserid_entitytype as string,",
						"          mpe_accountid as string,",
						"          mpe_accountid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          ts_recommendedby as string,",
						"          ts_recommendedby_entitytype as string,",
						"          ts_previousemployerid as string,",
						"          ts_previousemployerid_entitytype as string,",
						"          preferredserviceid as string,",
						"          preferredserviceid_entitytype as string,",
						"          parentcontactid as string,",
						"          parentcontactid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          ts_pa as string,",
						"          ts_pa_entitytype as string,",
						"          ts_businessaddress as string,",
						"          ts_businessaddress_entitytype as string,",
						"          modifiedbyexternalparty as string,",
						"          modifiedbyexternalparty_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          originatingleadid as string,",
						"          originatingleadid_entitytype as string,",
						"          masterid as string,",
						"          masterid_entitytype as string,",
						"          defaultpricelevelid as string,",
						"          defaultpricelevelid_entitytype as string,",
						"          parent_contactid as string,",
						"          parent_contactid_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          createdbyexternalparty as string,",
						"          createdbyexternalparty_entitytype as string,",
						"          preferredequipmentid as string,",
						"          preferredequipmentid_entitytype as string,",
						"          xpd_referredbyinternal as string,",
						"          xpd_referredbyinternal_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          xpd_homecountry as string,",
						"          xpd_homecountry_entitytype as string,",
						"          ts_placementfirmintroducedby as string,",
						"          ts_placementfirmintroducedby_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          accountid as string,",
						"          accountid_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          parentcustomerid as string,",
						"          parentcustomerid_entitytype as string,",
						"          xpd_referredbyexternal as string,",
						"          xpd_referredbyexternal_entitytype as string,",
						"          aging30 as decimal(38,2),",
						"          creditlimit_base as decimal(38,4),",
						"          aging60 as decimal(38,2),",
						"          aging90 as decimal(38,2),",
						"          aging60_base as decimal(38,4),",
						"          aging90_base as decimal(38,4),",
						"          annualincome_base as decimal(38,4),",
						"          creditlimit as decimal(38,2),",
						"          annualincome as decimal(38,2),",
						"          aging30_base as decimal(38,4),",
						"          ts_othernotes as string,",
						"          xpd_referredbyinternalyominame as string,",
						"          address1_county as string,",
						"          yomilastname as string,",
						"          address3_utcoffset as long,",
						"          ts_recommendedbyname as string,",
						"          description as string,",
						"          li_membertoken as string,",
						"          department as string,",
						"          xpd_roletypes_text as string,",
						"          address1_addressid as string,",
						"          importsequencenumber as long,",
						"          address1_longitude as double,",
						"          address3_fax as string,",
						"          managername as string,",
						"          entityimageid as string,",
						"          telephone2 as string,",
						"          parentcustomeridtype as string,",
						"          address2_upszone as string,",
						"          address1_upszone as string,",
						"          xpd_recommendingportfoliocompaniesrecommended as string,",
						"          lastonholdtime as timestamp,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          address1_fax as string,",
						"          address3_telephone1 as string,",
						"          address3_telephone2 as string,",
						"          address3_telephone3 as string,",
						"          fax as string,",
						"          assistantname as string,",
						"          address2_line3 as string,",
						"          accountidyominame as string,",
						"          parentcontactidyominame as string,",
						"          mpe_accountidyominame as string,",
						"          slainvokedidname as string,",
						"          defaultpricelevelidname as string,",
						"          fullname as string,",
						"          address2_longitude as double,",
						"          subscriptionid as string,",
						"          originatingleadidname as string,",
						"          slaname as string,",
						"          versionnumber as long,",
						"          address1_latitude as double,",
						"          createdbyyominame as string,",
						"          parent_contactidname as string,",
						"          address2_telephone1 as string,",
						"          pager as string,",
						"          salutation as string,",
						"          mpe_accountidname as string,",
						"          xpd_functionuse_text as string,",
						"          accountidname as string,",
						"          mpe_companysummary as string,",
						"          parent_contactidyominame as string,",
						"          preferredserviceidname as string,",
						"          address2_city as string,",
						"          address3_postalcode as string,",
						"          address2_line2 as string,",
						"          li_companyid as long,",
						"          ts_otherphonelabel as string,",
						"          ts_reportingemail as string,",
						"          address3_upszone as string,",
						"          transactioncurrencyidname as string,",
						"          address3_county as string,",
						"          entityimage_url as string,",
						"          governmentid as string,",
						"          callback as string,",
						"          business2 as string,",
						"          createdonbehalfbyname as string,",
						"          ts_validateddate as timestamp,",
						"          address2_telephone2 as string,",
						"          owneridname as string,",
						"          originatingleadidyominame as string,",
						"          ts_otherlanguages as string,",
						"          address2_postalcode as string,",
						"          birthdate as timestamp,",
						"          parentcontactidname as string,",
						"          spousesname as string,",
						"          xpd_compensationdate as timestamp,",
						"          address1_utcoffset as long,",
						"          address3_line1 as string,",
						"          traversedpath as string,",
						"          exchangerate as decimal(38,10),",
						"          mpe_flowlastrundate as timestamp,",
						"          address1_line3 as string,",
						"          address3_country as string,",
						"          mpe_documentsetid as string,",
						"          address2_line1 as string,",
						"          ts_previousemployeridyominame as string,",
						"          middlename as string,",
						"          managerphone as string,",
						"          address2_stateorprovince as string,",
						"          childrensnames as string,",
						"          address2_name as string,",
						"          address3_addressid as string,",
						"          address3_stateorprovince as string,",
						"          ts_sectorspecialtyids as string,",
						"          businesscardattributes as string,",
						"          anniversary as timestamp,",
						"          ts_employmentstartdate as timestamp,",
						"          ts_legacycontacttypes as string,",
						"          address1_primarycontactname as string,",
						"          address2_utcoffset as long,",
						"          home2 as string,",
						"          ts_geographicspecialtyids as string,",
						"          address1_name as string,",
						"          ts_recommendationcomments as string,",
						"          address2_telephone3 as string,",
						"          address3_primarycontactname as string,",
						"          ftpsiteurl as string,",
						"          address1_postalcode as string,",
						"          createdon as string,",
						"          address1_stateorprovince as string,",
						"          yomimiddlename as string,",
						"          jobtitle as string,",
						"          telephone3 as string,",
						"          ts_usesspeciality as string,",
						"          ts_knowntouserinitials as string,",
						"          address2_fax as string,",
						"          createdbyname as string,",
						"          xpd_contactuse_text as string,",
						"          ts_sourceid as string,",
						"          address2_addressid as string,",
						"          employeeid as string,",
						"          address1_postofficebox as string,",
						"          address1_city as string,",
						"          ts_businessaddressname as string,",
						"          teamsfollowed as long,",
						"          ts_cv as string,",
						"          timezoneruleversionnumber as long,",
						"          modifiedonbehalfbyyominame as string,",
						"          xpd_hrcompensation as string,",
						"          ts_currentbonusandorupliftconsiderations as string,",
						"          modifiedbyname as string,",
						"          address3_line2 as string,",
						"          yomifullname as string,",
						"          owneridtype as string,",
						"          entityimage_timestamp as long,",
						"          ts_placementfirmintroducedbyyominame as string,",
						"          xpd_previousrole as string,",
						"          ts_compensation as string,",
						"          address2_postofficebox as string,",
						"          emailaddress3 as string,",
						"          emailaddress2 as string,",
						"          emailaddress1 as string,",
						"          ts_interactioncontactuniqueidentifier as string,",
						"          ts_investmentcafeid as string,",
						"          websiteurl as string,",
						"          nickname as string,",
						"          ts_lastmet as timestamp,",
						"          address3_name as string,",
						"          ts_usesspecialtyids as string,",
						"          ts_linkedinurl as string,",
						"          lastname as string,",
						"          address3_longitude as double,",
						"          xpd_referredbyexternalidtype as string,",
						"          parentcustomeridname as string,",
						"          owningbusinessunitname as string,",
						"          onholdtime as long,",
						"          createdonbehalfbyyominame as string,",
						"          preferredsystemuseridyominame as string,",
						"          createdbyexternalpartyname as string,",
						"          ts_tone as string,",
						"          telephone1 as string,",
						"          overriddencreatedon as timestamp,",
						"          address3_postofficebox as string,",
						"          assistantphone as string,",
						"          address1_composite as string,",
						"          address3_line3 as string,",
						"          address2_country as string,",
						"          xpd_referredbyinternalname as string,",
						"          mobilephone as string,",
						"          owneridyominame as string,",
						"          address1_line1 as string,",
						"          createdbyexternalpartyyominame as string,",
						"          xpd_referredbyexternalyominame as string,",
						"          yomifirstname as string,",
						"          mastercontactidname as string,",
						"          address3_city as string,",
						"          address1_country as string,",
						"          externaluseridentifier as string,",
						"          modifiedbyexternalpartyyominame as string,",
						"          firstname as string,",
						"          xpd_hrcurrentbonusandorupliftconsiderations as string,",
						"          stageid as string,",
						"          modifiedonbehalfbyname as string,",
						"          xpd_homecountryname as string,",
						"          mastercontactidyominame as string,",
						"          suffix as string,",
						"          ts_payominame as string,",
						"          lastusedincampaign as timestamp,",
						"          ts_geographicspeciality as string,",
						"          xpd_recruitmentareateam_text as string,",
						"          ts_retentionreviewdate as timestamp,",
						"          parentcustomeridyominame as string,",
						"          timespentbymeonemailandmeetings as string,",
						"          address2_latitude as double,",
						"          xpd_availablefrom as timestamp,",
						"          address3_composite as string,",
						"          xpd_recommendingportco as string,",
						"          preferredsystemuseridname as string,",
						"          utcconversiontimezonecode as long,",
						"          address2_county as string,",
						"          ts_paname as string,",
						"          contactid as string,",
						"          address2_primarycontactname as string,",
						"          ts_specificareasofexpertisecomments as string,",
						"          address1_line2 as string,",
						"          ts_recommendationofindividualupdated as timestamp,",
						"          xpd_referredbyexternalname as string,",
						"          ts_placementfirmintroducedbyname as string,",
						"          ts_sectorspeciality as string,",
						"          ts_previousemployeridname as string,",
						"          processid as string,",
						"          ts_recommendedbyyominame as string,",
						"          modifiedon as timestamp,",
						"          modifiedbyexternalpartyname as string,",
						"          ts_relevantsituations as string,",
						"          businesscard as string,",
						"          company as string,",
						"          preferredequipmentidname as string,",
						"          modifiedbyyominame as string,",
						"          ts_preferredname as string,",
						"          address2_composite as string,",
						"          numberofchildren as long,",
						"          address3_latitude as double,",
						"          mpe_companysearchbyemail as boolean,",
						"          msdyn_segmentid as string,",
						"          msdyn_segmentid_entitytype as string,",
						"          msdyn_segmentidname as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     limit: 100,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'contact') ~> ContactsInSourceSL",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          address1_addresstypecode as long,",
						"          address1_shippingmethodcode as long,",
						"          azurestate as long,",
						"          invitestatuscode as long,",
						"          preferredaddresscode as long,",
						"          preferredemailcode as long,",
						"          outgoingemaildeliverymethod as long,",
						"          preferredphonecode as long,",
						"          emailrouteraccessapproval as long,",
						"          deletedstate as long,",
						"          incomingemaildeliverymethod as long,",
						"          accessmode as long,",
						"          caltype as long,",
						"          address2_addresstypecode as long,",
						"          address2_shippingmethodcode as long,",
						"          setupuser as boolean,",
						"          islicensed as boolean,",
						"          defaultfilterspopulated as boolean,",
						"          isactivedirectoryuser as boolean,",
						"          displayinserviceviews as boolean,",
						"          msdyn_gdproptout as boolean,",
						"          isdisabled as boolean,",
						"          isintegrationuser as boolean,",
						"          isemailaddressapprovedbyo365admin as boolean,",
						"          issyncwithdirectory as boolean,",
						"          calendarid as string,",
						"          calendarid_entitytype as string,",
						"          mobileofflineprofileid as string,",
						"          mobileofflineprofileid_entitytype as string,",
						"          queueid as string,",
						"          queueid_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          territoryid as string,",
						"          territoryid_entitytype as string,",
						"          defaultmailbox as string,",
						"          defaultmailbox_entitytype as string,",
						"          positionid as string,",
						"          positionid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          siteid as string,",
						"          siteid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          parentsystemuserid as string,",
						"          parentsystemuserid_entitytype as string,",
						"          businessunitid as string,",
						"          businessunitid_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          traversedpath as string,",
						"          azureactivedirectoryobjectid as string,",
						"          address1_line1 as string,",
						"          internalemailaddress as string,",
						"          siteidname as string,",
						"          modifiedon as timestamp,",
						"          address1_line3 as string,",
						"          skills as string,",
						"          yomifirstname as string,",
						"          address1_longitude as double,",
						"          yomifullname as string,",
						"          entityimage_timestamp as long,",
						"          parentsystemuseridname as string,",
						"          address2_county as string,",
						"          transactioncurrencyidname as string,",
						"          activedirectoryguid as string,",
						"          utcconversiontimezonecode as long,",
						"          passporthi as long,",
						"          homephone as string,",
						"          parentsystemuseridyominame as string,",
						"          address2_stateorprovince as string,",
						"          mobilephone as string,",
						"          address2_country as string,",
						"          address2_line2 as string,",
						"          disabledreason as string,",
						"          lastname as string,",
						"          address1_city as string,",
						"          address1_utcoffset as long,",
						"          userlicensetype as long,",
						"          nickname as string,",
						"          passportlo as long,",
						"          title as string,",
						"          address2_latitude as double,",
						"          applicationid as string,",
						"          address1_composite as string,",
						"          firstname as string,",
						"          address2_postalcode as string,",
						"          employeeid as string,",
						"          processid as string,",
						"          mobileofflineprofileidname as string,",
						"          governmentid as string,",
						"          entityimage_url as string,",
						"          address2_line3 as string,",
						"          azuredeletedon as timestamp,",
						"          timezoneruleversionnumber as long,",
						"          address1_county as string,",
						"          address2_telephone2 as string,",
						"          address2_postofficebox as string,",
						"          address2_telephone1 as string,",
						"          yomilastname as string,",
						"          address2_telephone3 as string,",
						"          address1_addressid as string,",
						"          territoryidname as string,",
						"          overriddencreatedon as timestamp,",
						"          userpuid as string,",
						"          createdonbehalfbyname as string,",
						"          systemuserid as string,",
						"          address2_name as string,",
						"          middlename as string,",
						"          entityimageid as string,",
						"          applicationiduri as string,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          address2_composite as string,",
						"          address1_country as string,",
						"          mobilealertemail as string,",
						"          sharepointemailaddress as string,",
						"          businessunitidname as string,",
						"          address1_stateorprovince as string,",
						"          exchangerate as decimal(38,10),",
						"          jobtitle as string,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          latestupdatetime as timestamp,",
						"          address1_postofficebox as string,",
						"          organizationid as string,",
						"          yammeremailaddress as string,",
						"          defaultmailboxname as string,",
						"          identityid as long,",
						"          yomimiddlename as string,",
						"          address2_utcoffset as long,",
						"          photourl as string,",
						"          personalemailaddress as string,",
						"          address2_addressid as string,",
						"          address2_longitude as double,",
						"          createdon as string,",
						"          createdbyname as string,",
						"          domainname as string,",
						"          modifiedbyyominame as string,",
						"          address2_fax as string,",
						"          address1_line2 as string,",
						"          modifiedonbehalfbyyominame as string,",
						"          address2_upszone as string,",
						"          salutation as string,",
						"          address1_postalcode as string,",
						"          stageid as string,",
						"          defaultodbfoldername as string,",
						"          positionidname as string,",
						"          ts_inititals as string,",
						"          yammeruserid as string,",
						"          importsequencenumber as long,",
						"          address2_city as string,",
						"          windowsliveid as string,",
						"          organizationidname as string,",
						"          versionnumber as long,",
						"          queueidname as string,",
						"          address1_name as string,",
						"          address1_fax as string,",
						"          address1_latitude as double,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          address2_line1 as string,",
						"          address1_upszone as string,",
						"          fullname as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     limit: 100,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'systemuser') ~> SystemUserInSourceSL",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          organizationid as string,",
						"          organizationid_entitytype as string,",
						"          createdonbehalfbyyominame as string,",
						"          gap_language as long,",
						"          importsequencenumber as long,",
						"          organizationidname as string,",
						"          utcconversiontimezonecode as long,",
						"          createdbyyominame as string,",
						"          gap_entityname as string,",
						"          modifiedbyname as string,",
						"          versionnumber as long,",
						"          modifiedbyyominame as string,",
						"          timezoneruleversionnumber as long,",
						"          gap_entityschemaname as string,",
						"          modifiedon as timestamp,",
						"          gap_powerbioptionsetrefid as string,",
						"          gap_optionsetschemaname as string,",
						"          modifiedonbehalfbyyominame as string,",
						"          createdbyname as string,",
						"          createdon as string,",
						"          gap_value as long,",
						"          createdonbehalfbyname as string,",
						"          modifiedonbehalfbyname as string,",
						"          gap_label as string,",
						"          overriddencreatedon as timestamp,",
						"          gap_imageurl as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'gap_powerbioptionsetref') ~> GapOptionsetIn",
						"OriginationOppSourceSL select(mapColumn(",
						"          Id,",
						"          ts_actionstatus,",
						"          ts_producttype,",
						"          ts_internalintermediarysource,",
						"          ts_currentactivity,",
						"          ts_opportunitystatus,",
						"          ts_montaguprimaryoffice,",
						"          ts_opportunitytype,",
						"          ts_posthumstatus,",
						"          ts_choppedreason,",
						"          ts_duplicateopportunityfordiscussion,",
						"          mpe_smalltarget,",
						"          xpd_includeonallpapers,",
						"          ts_sold,",
						"          xpd_sharepointlocationcreated,",
						"          ts_buyer,",
						"          mpe_productid,",
						"          ts_targetbusiness,",
						"          ts_firstreferralcompany,",
						"          ts_montaguowner,",
						"          ts_firstreferralcontact,",
						"          transactioncurrencyid,",
						"          ts_managerwedback,",
						"          ts_country,",
						"          ownerid,",
						"          ts_estebitda,",
						"          ts_estebit,",
						"          ts_estdealsize,",
						"          ts_estturnover,",
						"          ts_nextsteps,",
						"          ts_buyerpaidxltmebitda,",
						"          ts_opportunitystage,",
						"          ts_choppedcomments,",
						"          ts_datedealannounced,",
						"          ts_name,",
						"          ts_weofferedxltmebitda,",
						"          ts_companyid,",
						"          ts_choppeddate,",
						"          mpe_carveout,",
						"          mpe_targetbusiness_parentid",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> OriginationSelectOutput",
						"AccountInSourceSL select(mapColumn(",
						"          Id,",
						"          ts_primarysecondaryfocus,",
						"          xpd_relationshipstatus,",
						"          ts_introducertype,",
						"          xpd_remindermonths,",
						"          ts_portfoliocompanystatus,",
						"          ts_companytype,",
						"          ts_vendorsummary,",
						"          xpd_publictoprivatetracker,",
						"          xpd_setreminder,",
						"          ts_trackcompany,",
						"          parentaccountid,",
						"          xpd_reminderto,",
						"          ts_headofficeid,",
						"          ts_originationlead1,",
						"          ts_originationlead2,",
						"          ts_currentauditor,",
						"          ts_othernotes,",
						"          xpd_relationshipcomments,",
						"          ts_formername,",
						"          ts_mpeapproachstrategy,",
						"          ts_lastdatestatuschanged,",
						"          xpd_relationshipstatuschangeddate,",
						"          ts_companylegalname,",
						"          ts_companynumber,",
						"          ts_monthlyreviewmeetingname,",
						"          ts_originationcomments,",
						"          ts_capitaliqlink,",
						"          xpd_datereminderwasset,",
						"          ts_reminderdatesetto,",
						"          ts_alias,",
						"          xpd_reasonaction,",
						"          ts_relevantsituations,",
						"          ts_dealstageofmostrecentopportunity",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> AccountSelectOutput",
						"AppointmentInSourceSL select(mapColumn(",
						"          Id,",
						"          ts_meetingteam,",
						"          ts_othermeetingmethod,",
						"          isonlinemeeting,",
						"          isalldayevent,",
						"          regardingobjectid,",
						"          ts_taskowner,",
						"          scheduledend,",
						"          ts_taskdescription,",
						"          scheduledstart,",
						"          onlinemeetingjoinurl,",
						"          ts_notes,",
						"          ts_opportunitiesdiscussed,",
						"          ts_sectorscoveredbyfirm,",
						"          ts_originationcommentsnotes,",
						"          ts_taskduedate,",
						"          ts_sectorscoveredids,",
						"          location,",
						"          scheduleddurationminutes",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> AppointmentSelectOutput",
						"ContactsInSourceSL select(mapColumn(",
						"          Id,",
						"          ts_recommendationofindividual,",
						"          gendercode,",
						"          paymenttermscode,",
						"          ts_vendortargettrackingrole,",
						"          address1_shippingmethodcode,",
						"          preferredcontactmethodcode,",
						"          ts_capabilitiesofindividual,",
						"          familystatuscode,",
						"          xpd_availability,",
						"          address1_freighttermscode,",
						"          xpd_montagulevel,",
						"          ts_permanentinterim,",
						"          ts_ircontactrole,",
						"          xpd_level,",
						"          ts_languagesspokenwritten,",
						"          ts_montaguoffice,",
						"          ts_roletypes,",
						"          xpd_specialisms,",
						"          xpd_function,",
						"          ts_producttype,",
						"          ts_productsinterestedin,",
						"          donotpostalmail,",
						"          ts_centralrelationshipmanager,",
						"          creditonhold,",
						"          xpd_benchcandidate,",
						"          donotsendmm,",
						"          donotbulkemail,",
						"          followemail,",
						"          xpd_available,",
						"          donotfax,",
						"          donotphone,",
						"          donotemail,",
						"          ts_recommendedby,",
						"          transactioncurrencyid,",
						"          originatingleadid,",
						"          xpd_homecountry,",
						"          creditlimit,",
						"          telephone2,",
						"          salutation,",
						"          ts_reportingemail,",
						"          ts_otherlanguages,",
						"          birthdate,",
						"          spousesname,",
						"          xpd_compensationdate,",
						"          anniversary,",
						"          ts_recommendationcomments,",
						"          ts_usesspeciality,",
						"          xpd_hrcompensation,",
						"          ts_currentbonusandorupliftconsiderations,",
						"          ts_compensation,",
						"          emailaddress2,",
						"          ts_investmentcafeid,",
						"          ts_lastmet,",
						"          ts_tone,",
						"          xpd_hrcurrentbonusandorupliftconsiderations,",
						"          lastusedincampaign,",
						"          ts_geographicspeciality,",
						"          xpd_availablefrom,",
						"          xpd_recommendingportco,",
						"          contactid,",
						"          ts_sectorspeciality",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> ContactSelectOutput",
						"SystemUserInSourceSL select(mapColumn(",
						"          id = Id,",
						"          calendarid,",
						"          siteid,",
						"          azureactivedirectoryobjectid,",
						"          modifiedby,",
						"          address1_line1,",
						"          internalemailaddress,",
						"          siteidname,",
						"          yomifullname,",
						"          mobilephone,",
						"          lastname,",
						"          address1_city,",
						"          title,",
						"          address1_composite,",
						"          firstname,",
						"          address1_addressid,",
						"          userpuid,",
						"          parentsystemuserid,",
						"          entityimageid,",
						"          address1_country,",
						"          businessunitidname,",
						"          address1_telephone1,",
						"          organizationid,",
						"          defaultmailboxname,",
						"          identityid,",
						"          address2_addressid,",
						"          createdon,",
						"          domainname,",
						"          modifiedbyyominame,",
						"          address1_postalcode,",
						"          ts_inititals,",
						"          windowsliveid,",
						"          queueidname,",
						"          modifiedbyname",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SystemUserSelectInSL",
						"OptionSetInSL pivot(groupBy(Option,",
						"          LocalizedLabel,",
						"          EntityName),",
						"     pivotBy(EntityName),",
						"     Entity = max(EntityName),",
						"          Label = max(LocalizedLabel),",
						"     columnNaming: '$V$N',",
						"     lateral: true) ~> OptionSetPivotSL",
						"GapOptionsetIn select(mapColumn(",
						"          gap_entityschemanameTBL = gap_entityschemaname,",
						"          gap_optionsetschemanameCOL = gap_optionsetschemaname,",
						"          gap_value,",
						"          gap_label",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> GapOptionSetOutputSL",
						"derivedColumn1, GapOptionSetOutputSL join(EntityName == gap_entityschemanameTBL,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> join1",
						"OriginationSelectOutput derive(EntityName = 'ts_originationopportunity') ~> derivedColumn1",
						"GapOptionSetOutputSL unpivot(output(",
						"          NewColgap_entitycol as string,",
						"          gap_entityschemanameTBL as string",
						"     ),",
						"     ungroupBy(gap_value,",
						"          gap_label,",
						"          gap_optionsetschemanameCOL),",
						"     lateral: true,",
						"     ignoreNullPivots: false) ~> unpivot1",
						"join1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          EntityName as string,",
						"          OptionSetName as string,",
						"          Option as integer,",
						"          IsUserLocalizedLabel as string,",
						"          LocalizedLabelLanguageCode as integer,",
						"          LocalizedLabel as string",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> OriginationSL",
						"OptionSetPivotSL sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'OptionViewOutput',",
						"     insertable: true,",
						"     updateable: false,",
						"     deletable: false,",
						"     upsertable: false,",
						"     recreate: true,",
						"     allowCopyCommand: true,",
						"     staged: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> OpionsetSLSink",
						"unpivot1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'GapOptionsetSL',",
						"     insertable: true,",
						"     updateable: false,",
						"     deletable: false,",
						"     upsertable: false,",
						"     recreate: true,",
						"     allowCopyCommand: true,",
						"     staged: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> GapOptionSetSinkSL"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/ReportsSLLinkedSVC')]",
				"[concat(variables('workspaceId'), '/datasets/ReportsSL')]",
				"[concat(variables('workspaceId'), '/linkedServices/prod-synapse-uks-001-WorkspaceDefaultStorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DataverseToAzureSQL')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "Writes Dataverse data in Azure Data Lake Storage Gen2 to Azure SQL Database.",
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"name": "ADLS"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "ReportsDataset1",
								"type": "DatasetReference"
							},
							"name": "SQL"
						},
						{
							"dataset": {
								"referenceName": "ReportsDataset1",
								"type": "DatasetReference"
							},
							"name": "sink1"
						},
						{
							"dataset": {
								"referenceName": "ReportsDataset1",
								"type": "DatasetReference"
							},
							"name": "sink2"
						}
					],
					"transformations": [],
					"script": "parameters{\n\tContainerName as string (\"Dataverse Container Name\"),\n\tTableName as string (\"Dataverse Table Name\")\n}\nsource(allowSchemaDrift: true,\n\tvalidateSchema: true,\n\tstore: 'synapse',\n\tdatabaseType: 'spark',\n\tformat: 'table',\n\tdatabase: 'dataverse_montagu_org5a2bcccf',\n\ttableName: 'ts_originationopportunity',\n\tmanifestType: 'model') ~> ADLS\nADLS sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tstaged: true,\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError',\n\tmanifestType: 'manifest',\n\tpreCommands: [],\n\tpostCommands: []) ~> SQL\nADLS sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tstaged: true,\n\tallowCopyCommand: true,\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> sink1\nADLS sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tstaged: true,\n\tallowCopyCommand: true,\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> sink2"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/ReportsDataset1')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DataverseToAzureSQL1')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "Writes Dataverse data in Azure Data Lake Storage Gen2 to Azure SQL Database.",
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "ADLSLinkedService",
								"type": "LinkedServiceReference"
							},
							"name": "ADLS"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "AzureSqlTable1",
								"type": "DatasetReference"
							},
							"name": "SQL"
						}
					],
					"transformations": [],
					"script": "parameters{\n\tContainerName as string (\"Dataverse Container Name\"),\n\tTableName as string (\"Dataverse Table Name\")\n}\nsource(output(\n\t\tId as string,\n\t\tSinkCreatedOn as timestamp,\n\t\tSinkModifiedOn as timestamp,\n\t\tstatecode as long,\n\t\tstatuscode as long,\n\t\tindustrycode as long,\n\t\tcustomersizecode as long,\n\t\taccountratingcode as long,\n\t\taddress1_shippingmethodcode as long,\n\t\tbusinesstypecode as long,\n\t\tshippingmethodcode as long,\n\t\tpreferredappointmenttimecode as long,\n\t\taddress2_shippingmethodcode as long,\n\t\tterritorycode as long,\n\t\taccountclassificationcode as long,\n\t\tpreferredcontactmethodcode as long,\n\t\tpreferredappointmentdaycode as long,\n\t\tpaymenttermscode as long,\n\t\taddress1_addresstypecode as long,\n\t\townershipcode as long,\n\t\taddress2_freighttermscode as long,\n\t\taddress2_addresstypecode as long,\n\t\taddress1_freighttermscode as long,\n\t\tcustomertypecode as long,\n\t\taccountcategorycode as long,\n\t\tmarketingonly as boolean,\n\t\tdonotpostalmail as boolean,\n\t\tdonotbulkpostalmail as boolean,\n\t\tdonotbulkemail as boolean,\n\t\tdonotphone as boolean,\n\t\tdonotsendmm as boolean,\n\t\tisprivate as boolean,\n\t\tmerged as boolean,\n\t\tdonotfax as boolean,\n\t\tdonotemail as boolean,\n\t\tcreditonhold as boolean,\n\t\tfollowemail as boolean,\n\t\tparticipatesinworkflow as boolean,\n\t\tmodifiedby as string,\n\t\tmodifiedby_entitytype as string,\n\t\tdefaultpricelevelid as string,\n\t\tdefaultpricelevelid_entitytype as string,\n\t\tmodifiedbyexternalparty as string,\n\t\tmodifiedbyexternalparty_entitytype as string,\n\t\tprimarycontactid as string,\n\t\tprimarycontactid_entitytype as string,\n\t\tpreferredserviceid as string,\n\t\tpreferredserviceid_entitytype as string,\n\t\tpreferredequipmentid as string,\n\t\tpreferredequipmentid_entitytype as string,\n\t\towninguser as string,\n\t\towninguser_entitytype as string,\n\t\ttransactioncurrencyid as string,\n\t\ttransactioncurrencyid_entitytype as string,\n\t\tslainvokedid as string,\n\t\tslainvokedid_entitytype as string,\n\t\tcreatedbyexternalparty as string,\n\t\tcreatedbyexternalparty_entitytype as string,\n\t\tmodifiedonbehalfby as string,\n\t\tmodifiedonbehalfby_entitytype as string,\n\t\tcreatedonbehalfby as string,\n\t\tcreatedonbehalfby_entitytype as string,\n\t\tparentaccountid as string,\n\t\tparentaccountid_entitytype as string,\n\t\tslaid as string,\n\t\tslaid_entitytype as string,\n\t\tterritoryid as string,\n\t\tterritoryid_entitytype as string,\n\t\tmasterid as string,\n\t\tmasterid_entitytype as string,\n\t\towningbusinessunit as string,\n\t\towningbusinessunit_entitytype as string,\n\t\toriginatingleadid as string,\n\t\toriginatingleadid_entitytype as string,\n\t\towningteam as string,\n\t\towningteam_entitytype as string,\n\t\tpreferredsystemuserid as string,\n\t\tpreferredsystemuserid_entitytype as string,\n\t\tcreatedby as string,\n\t\tcreatedby_entitytype as string,\n\t\townerid as string,\n\t\townerid_entitytype as string,\n\t\taging90 as decimal(18,2),\n\t\tcreditlimit_base as decimal(18,2),\n\t\taging60_base as decimal(18,2),\n\t\tmarketcap as decimal(18,2),\n\t\topenrevenue as decimal(18,2),\n\t\trevenue as decimal(18,2),\n\t\taging30_base as decimal(18,2),\n\t\tmarketcap_base as decimal(18,2),\n\t\trevenue_base as decimal(18,2),\n\t\taging60 as decimal(18,2),\n\t\taging90_base as decimal(18,2),\n\t\taging30 as decimal(18,2),\n\t\topenrevenue_base as decimal(18,2),\n\t\tcreditlimit as decimal(18,2),\n\t\taddress2_postalcode as string,\n\t\taddress1_longitude as decimal(18,2),\n\t\taddress2_county as string,\n\t\tdefaultpricelevelidname as string,\n\t\tslainvokedidname as string,\n\t\tmasteraccountidname as string,\n\t\toverriddencreatedon as timestamp,\n\t\tentityimageid as string,\n\t\taddress2_longitude as decimal(18,2),\n\t\taddress2_line3 as string,\n\t\toriginatingleadidyominame as string,\n\t\taddress1_telephone2 as string,\n\t\ttransactioncurrencyidname as string,\n\t\taddress1_upszone as string,\n\t\tprocessid as string,\n\t\topenrevenue_date as timestamp,\n\t\taddress2_city as string,\n\t\tmasteraccountidyominame as string,\n\t\temailaddress2 as string,\n\t\temailaddress1 as string,\n\t\towneridyominame as string,\n\t\taddress1_country as string,\n\t\tmodifiedonbehalfbyname as string,\n\t\tmodifiedbyname as string,\n\t\texchangerate as decimal(18,2),\n\t\taddress1_line2 as string,\n\t\taddress1_postofficebox as string,\n\t\tcreatedbyexternalpartyyominame as string,\n\t\topenrevenue_state as long,\n\t\tnumberofemployees as long,\n\t\tmodifiedbyexternalpartyyominame as string,\n\t\taddress1_utcoffset as long,\n\t\taddress2_stateorprovince as string,\n\t\tterritoryidname as string,\n\t\ttelephone1 as string,\n\t\taddress1_stateorprovince as string,\n\t\tmodifiedon as timestamp,\n\t\tcreatedon as timestamp,\n\t\taccountid as string,\n\t\taddress2_utcoffset as long,\n\t\toriginatingleadidname as string,\n\t\tmodifiedbyyominame as string,\n\t\tparentaccountidyominame as string,\n\t\tpreferredserviceidname as string,\n\t\taddress1_county as string,\n\t\taddress1_telephone3 as string,\n\t\tentityimage_url as string,\n\t\tprimarytwitterid as string,\n\t\taddress2_line2 as string,\n\t\tyominame as string,\n\t\tcreatedonbehalfbyname as string,\n\t\topendeals_state as long,\n\t\taddress1_city as string,\n\t\tfax as string,\n\t\ttimezoneruleversionnumber as long,\n\t\tcreatedonbehalfbyyominame as string,\n\t\taddress2_composite as string,\n\t\towneridtype as string,\n\t\taddress1_name as string,\n\t\taddress2_upszone as string,\n\t\tparentaccountidname as string,\n\t\ttelephone3 as string,\n\t\tentityimage_timestamp as long,\n\t\tmodifiedbyexternalpartyname as string,\n\t\temailaddress3 as string,\n\t\taddress1_latitude as decimal(18,2),\n\t\tteamsfollowed as long,\n\t\tprimarysatoriid as string,\n\t\taddress2_country as string,\n\t\ttelephone2 as string,\n\t\tcreatedbyexternalpartyname as string,\n\t\tlastusedincampaign as timestamp,\n\t\taccountnumber as string,\n\t\taddress1_line3 as string,\n\t\tprimarycontactidname as string,\n\t\ttimespentbymeonemailandmeetings as string,\n\t\taddress1_primarycontactname as string,\n\t\tpreferredsystemuseridname as string,\n\t\taddress2_postofficebox as string,\n\t\tpreferredequipmentidname as string,\n\t\tprimarycontactidyominame as string,\n\t\tversionnumber as long,\n\t\topendeals as long,\n\t\tslaname as string,\n\t\taddress1_composite as string,\n\t\tftpsiteurl as string,\n\t\tsic as string,\n\t\taddress2_line1 as string,\n\t\tlastonholdtime as timestamp,\n\t\taddress1_telephone1 as string,\n\t\taddress2_fax as string,\n\t\tdescription as string,\n\t\tstageid as string,\n\t\twebsiteurl as string,\n\t\tutcconversiontimezonecode as long,\n\t\tstockexchange as string,\n\t\taddress1_addressid as string,\n\t\taddress2_latitude as decimal(18,2),\n\t\ttraversedpath as string,\n\t\taddress2_addressid as string,\n\t\tonholdtime as long,\n\t\taddress1_line1 as string,\n\t\tcreatedbyyominame as string,\n\t\towneridname as string,\n\t\taddress2_telephone1 as string,\n\t\taddress2_telephone2 as string,\n\t\taddress2_telephone3 as string,\n\t\taddress2_name as string,\n\t\tcreatedbyname as string,\n\t\ttickersymbol as string,\n\t\taddress2_primarycontactname as string,\n\t\tmodifiedonbehalfbyyominame as string,\n\t\topendeals_date as timestamp,\n\t\taddress1_fax as string,\n\t\timportsequencenumber as long,\n\t\tname as string,\n\t\tcr79c_addcolumn as string,\n\t\tpreferredsystemuseridyominame as string,\n\t\tsharesoutstanding as long,\n\t\taddress1_postalcode as string\n\t),\n\tallowSchemaDrift: false,\n\tvalidateSchema: true,\n\tignoreNoFilesFound: false,\n\tentity: ($TableName),\n\tformat: 'cdm',\n\tmanifestType: 'model',\n\tfolderPath: '',\n\tfileSystem: ($ContainerName),\n\tdateFormats: ['MM/dd/yyyy'],\n\ttimestampFormats: ['MM/dd/yyyy hh:mm:ss a'],\n\tpreferredIntegralType: 'long',\n\tpreferredFractionalType: 'float') ~> ADLS\nADLS sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> SQL"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/ADLSLinkedService')]",
				"[concat(variables('workspaceId'), '/datasets/AzureSqlTable1')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DataverseToParquet')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "prod-synapse-uks-001-WorkspaceDefaultStorage",
								"type": "LinkedServiceReference"
							},
							"name": "ADLS"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Parquet",
								"type": "DatasetReference"
							},
							"name": "DataverseParquet"
						}
					],
					"transformations": [],
					"script": "parameters{\n\tContainerName as string (\"Dataverse Container Name\"),\n\tTableName as string (\"Dataverse Table Name\")\n}\nsource(output(\n\t\tId as string,\n\t\tSinkCreatedOn as timestamp,\n\t\tSinkModifiedOn as timestamp,\n\t\tstatecode as long,\n\t\tstatuscode as long,\n\t\tpreferredcontactmethodcode as long,\n\t\taccountratingcode as long,\n\t\taddress1_shippingmethodcode as long,\n\t\tbusinesstypecode as long,\n\t\tindustrycode as long,\n\t\tshippingmethodcode as long,\n\t\tpreferredappointmenttimecode as long,\n\t\taddress2_shippingmethodcode as long,\n\t\tterritorycode as long,\n\t\tpreferredappointmentdaycode as long,\n\t\tpaymenttermscode as long,\n\t\taccountclassificationcode as long,\n\t\taddress1_addresstypecode as long,\n\t\townershipcode as long,\n\t\taddress2_freighttermscode as long,\n\t\taddress2_addresstypecode as long,\n\t\taddress1_freighttermscode as long,\n\t\tcustomersizecode as long,\n\t\tcustomertypecode as long,\n\t\taccountcategorycode as long,\n\t\tdonotpostalmail as boolean,\n\t\tmarketingonly as boolean,\n\t\tdonotbulkemail as boolean,\n\t\tdonotbulkpostalmail as boolean,\n\t\tdonotphone as boolean,\n\t\tdonotsendmm as boolean,\n\t\tisprivate as boolean,\n\t\tparticipatesinworkflow as boolean,\n\t\tmerged as boolean,\n\t\tcreditonhold as boolean,\n\t\tdonotfax as boolean,\n\t\tdonotemail as boolean,\n\t\tfollowemail as boolean,\n\t\tmodifiedby as string,\n\t\tmodifiedby_entitytype as string,\n\t\tmodifiedonbehalfby as string,\n\t\tmodifiedonbehalfby_entitytype as string,\n\t\towningbusinessunit as string,\n\t\towningbusinessunit_entitytype as string,\n\t\tcreatedby as string,\n\t\tcreatedby_entitytype as string,\n\t\ttransactioncurrencyid as string,\n\t\ttransactioncurrencyid_entitytype as string,\n\t\tmodifiedbyexternalparty as string,\n\t\tmodifiedbyexternalparty_entitytype as string,\n\t\towninguser as string,\n\t\towninguser_entitytype as string,\n\t\towningteam as string,\n\t\towningteam_entitytype as string,\n\t\tcreatedonbehalfby as string,\n\t\tcreatedonbehalfby_entitytype as string,\n\t\tslainvokedid as string,\n\t\tslainvokedid_entitytype as string,\n\t\tmasterid as string,\n\t\tmasterid_entitytype as string,\n\t\tparentaccountid as string,\n\t\tparentaccountid_entitytype as string,\n\t\tpreferredsystemuserid as string,\n\t\tpreferredsystemuserid_entitytype as string,\n\t\tprimarycontactid as string,\n\t\tprimarycontactid_entitytype as string,\n\t\tslaid as string,\n\t\tslaid_entitytype as string,\n\t\tcreatedbyexternalparty as string,\n\t\tcreatedbyexternalparty_entitytype as string,\n\t\townerid as string,\n\t\townerid_entitytype as string,\n\t\taging90 as decimal(18,2),\n\t\tcreditlimit_base as decimal(18,2),\n\t\taging60_base as decimal(18,2),\n\t\tmarketcap as decimal(18,2),\n\t\trevenue_base as decimal(18,2),\n\t\taging60 as decimal(18,2),\n\t\tmarketcap_base as decimal(18,2),\n\t\trevenue as decimal(18,2),\n\t\taging90_base as decimal(18,2),\n\t\taging30_base as decimal(18,2),\n\t\tcreditlimit as decimal(18,2),\n\t\taging30 as decimal(18,2),\n\t\taddress2_postalcode as string,\n\t\taddress1_longitude as decimal(18,2),\n\t\taddress2_county as string,\n\t\tmasteraccountidname as string,\n\t\taddress1_county as string,\n\t\taddress2_line3 as string,\n\t\taddress2_longitude as decimal(18,2),\n\t\taddress1_telephone2 as string,\n\t\ttransactioncurrencyidname as string,\n\t\taddress1_upszone as string,\n\t\tprocessid as string,\n\t\taddress2_name as string,\n\t\taddress1_stateorprovince as string,\n\t\tmasteraccountidyominame as string,\n\t\temailaddress1 as string,\n\t\towneridyominame as string,\n\t\taddress1_country as string,\n\t\taddress2_upszone as string,\n\t\texchangerate as decimal(18,2),\n\t\taddress1_line2 as string,\n\t\tcreatedbyexternalpartyyominame as string,\n\t\taddress1_city as string,\n\t\taddress1_utcoffset as long,\n\t\taddress2_stateorprovince as string,\n\t\tversionnumber as long,\n\t\tentityimageid as string,\n\t\tmodifiedon as timestamp,\n\t\tcreatedon as timestamp,\n\t\taccountid as string,\n\t\taddress2_utcoffset as long,\n\t\tmodifiedbyyominame as string,\n\t\toverriddencreatedon as timestamp,\n\t\tmodifiedbyname as string,\n\t\tmodifiedonbehalfbyname as string,\n\t\tentityimage_url as string,\n\t\tprimarytwitterid as string,\n\t\taddress2_line2 as string,\n\t\tyominame as string,\n\t\taddress1_latitude as decimal(18,2),\n\t\tprimarysatoriid as string,\n\t\tfax as string,\n\t\ttimezoneruleversionnumber as long,\n\t\tcreatedonbehalfbyyominame as string,\n\t\taddress2_composite as string,\n\t\towneridtype as string,\n\t\taddress1_name as string,\n\t\tparentaccountidname as string,\n\t\ttelephone3 as string,\n\t\tparentaccountidyominame as string,\n\t\tentityimage_timestamp as long,\n\t\tmodifiedbyexternalpartyname as string,\n\t\temailaddress3 as string,\n\t\temailaddress2 as string,\n\t\taddress2_country as string,\n\t\ttelephone2 as string,\n\t\tcreatedbyexternalpartyname as string,\n\t\tlastusedincampaign as timestamp,\n\t\taccountnumber as string,\n\t\ttraversedpath as string,\n\t\tprimarycontactidname as string,\n\t\ttimespentbymeonemailandmeetings as string,\n\t\taddress1_primarycontactname as string,\n\t\tpreferredsystemuseridname as string,\n\t\tcreatedonbehalfbyname as string,\n\t\taddress2_postofficebox as string,\n\t\taddress2_latitude as decimal(18,2),\n\t\tmodifiedbyexternalpartyyominame as string,\n\t\tprimarycontactidyominame as string,\n\t\tslaname as string,\n\t\taddress1_composite as string,\n\t\tftpsiteurl as string,\n\t\tsic as string,\n\t\taddress2_line1 as string,\n\t\tlastonholdtime as timestamp,\n\t\taddress1_telephone1 as string,\n\t\taddress2_fax as string,\n\t\taddress1_telephone3 as string,\n\t\tdescription as string,\n\t\tstageid as string,\n\t\ttelephone1 as string,\n\t\twebsiteurl as string,\n\t\tutcconversiontimezonecode as long,\n\t\tstockexchange as string,\n\t\taddress1_addressid as string,\n\t\taddress2_city as string,\n\t\taddress2_primarycontactname as string,\n\t\taddress2_addressid as string,\n\t\tonholdtime as long,\n\t\taddress1_line1 as string,\n\t\taddress1_line3 as string,\n\t\tcreatedbyyominame as string,\n\t\taddress2_telephone1 as string,\n\t\taddress2_telephone2 as string,\n\t\taddress2_telephone3 as string,\n\t\taddress1_postofficebox as string,\n\t\tcreatedbyname as string,\n\t\ttickersymbol as string,\n\t\tnumberofemployees as long,\n\t\towneridname as string,\n\t\tmodifiedonbehalfbyyominame as string,\n\t\taddress1_fax as string,\n\t\timportsequencenumber as long,\n\t\tname as string,\n\t\tslainvokedidname as string,\n\t\tpreferredsystemuseridyominame as string,\n\t\tsharesoutstanding as long,\n\t\taddress1_postalcode as string,\n\t\towningbusinessunitname as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tentity: ($TableName),\n\tformat: 'cdm',\n\tmanifestType: 'model',\n\tfolderPath: '',\n\tfileSystem: ($ContainerName)) ~> ADLS\nADLS sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> DataverseParquet"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/prod-synapse-uks-001-WorkspaceDefaultStorage')]",
				"[concat(variables('workspaceId'), '/datasets/Parquet')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DueDil')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "prod-synapse-uks-001-WorkspaceDefaultStorage",
								"type": "LinkedServiceReference"
							},
							"name": "source1"
						},
						{
							"dataset": {
								"referenceName": "APIPULL1",
								"type": "DatasetReference"
							},
							"name": "source2"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "InsightsAzureSynapseAnalytics",
								"type": "LinkedServiceReference"
							},
							"name": "sink2"
						},
						{
							"name": "sink3"
						}
					],
					"transformations": [
						{
							"name": "MapDrifted1",
							"description": "Creates an explicit mapping for each drifted column"
						}
					],
					"scriptLines": [
						"source(useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     format: 'json',",
						"     fileSystem: 'insights',",
						"     folderPath: 'duedil',",
						"     fileName: 'response_1652290300695.json',",
						"     documentForm: 'singleDocument') ~> source1",
						"source(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     httpMethod: 'GET',",
						"     timeout: 30,",
						"     requestInterval: 0,",
						"     paginationRules: ['supportRFC5988' -> 'true'],",
						"     responseFormat: ['type' -> 'json', 'documentForm' -> 'documentPerLine']) ~> source2",
						"source1 derive(charitableIdentitiesCount = toString(byName('charitableIdentitiesCount')),",
						"          companyId = toString(byName('companyId')),",
						"          countryCode = toString(byName('countryCode')),",
						"          incorporationCountry = toString(byName('incorporationCountry')),",
						"          incorporationDate = toString(byName('incorporationDate')),",
						"          legalEntityIdentifier = toString(byName('legalEntityIdentifier')),",
						"          name = toString(byName('name')),",
						"          numberOfEmployees = toString(byName('numberOfEmployees')),",
						"          officialStatus = toString(byName('officialStatus')),",
						"          primaryWebsite = toString(byName('primaryWebsite')),",
						"          simplifiedStatus = toString(byName('simplifiedStatus')),",
						"          type = toString(byName('type'))) ~> MapDrifted1",
						"source2 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'DueDillAPI',",
						"     insertable: true,",
						"     updateable: false,",
						"     deletable: false,",
						"     upsertable: false,",
						"     recreate: true,",
						"     allowCopyCommand: true,",
						"     staged: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> sink2",
						"MapDrifted1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     store: 'cache',",
						"     format: 'inline',",
						"     output: false,",
						"     saveOrder: 1) ~> sink3"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/prod-synapse-uks-001-WorkspaceDefaultStorage')]",
				"[concat(variables('workspaceId'), '/datasets/APIPULL1')]",
				"[concat(variables('workspaceId'), '/linkedServices/InsightsAzureSynapseAnalytics')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/InputDataflow')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"name": "AccountIn"
						},
						{
							"name": "OriginationOpportunityIn"
						},
						{
							"name": "MeetingsAppointmentsIn"
						},
						{
							"name": "ContactsIn"
						},
						{
							"name": "Systemusersource"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "ReportsDataset1",
								"type": "DatasetReference"
							},
							"name": "AccountStage"
						},
						{
							"dataset": {
								"referenceName": "ReportsDataset1",
								"type": "DatasetReference"
							},
							"name": "MeetingStageClean"
						},
						{
							"dataset": {
								"referenceName": "ReportsDataset1",
								"type": "DatasetReference"
							},
							"name": "ContactsStageClean"
						},
						{
							"dataset": {
								"referenceName": "ReportsDataset1",
								"type": "DatasetReference"
							},
							"name": "OriginationSINK"
						},
						{
							"dataset": {
								"referenceName": "Systemusertable",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "MeetingsCleanselect"
						},
						{
							"name": "contactscleanselect"
						},
						{
							"name": "OrigiopportCleanout"
						},
						{
							"name": "AccountsSelectClean"
						},
						{
							"name": "Systemuserselect"
						}
					],
					"scriptLines": [
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          ts_primarysecondaryfocus as long,",
						"          customertypecode as long,",
						"          ts_relationship as long,",
						"          address1_addresstypecode as long,",
						"          accountclassificationcode as long,",
						"          ts_easeofworking as long,",
						"          ts_ukrow as long,",
						"          preferredappointmenttimecode as long,",
						"          ts_address1addresstype as long,",
						"          xpd_relationshipstatus as long,",
						"          ts_introducertype as long,",
						"          xpd_remindermonths as long,",
						"          ts_importance as long,",
						"          address2_freighttermscode as long,",
						"          ts_irrvsmomperformancemeasure as long,",
						"          accountcategorycode as long,",
						"          paymenttermscode as long,",
						"          preferredappointmentdaycode as long,",
						"          businesstypecode as long,",
						"          industrycode as long,",
						"          ts_sizeoffirm as long,",
						"          ts_interaction as long,",
						"          address1_shippingmethodcode as long,",
						"          ts_portfoliocompanystatus as long,",
						"          customersizecode as long,",
						"          xpd_previousinvestorstatus as long,",
						"          ts_recommendationoffirm as long,",
						"          preferredcontactmethodcode as long,",
						"          accountratingcode as long,",
						"          ts_investorstatus as long,",
						"          ts_capabilitiesoffirm as long,",
						"          mpe_flowlastrunoutcome as long,",
						"          address2_addresstypecode as long,",
						"          address2_shippingmethodcode as long,",
						"          ts_nextoriginationmeetingarranged as long,",
						"          ownershipcode as long,",
						"          territorycode as long,",
						"          ts_investortype as long,",
						"          shippingmethodcode as long,",
						"          ts_investorregion as long,",
						"          address1_freighttermscode as long,",
						"          xpd_function as string,",
						"          ts_quickcaptureuses as string,",
						"          ts_permanentinterim as string,",
						"          ts_quickcapturesectors as string,",
						"          ts_roletypes as string,",
						"          ts_companytype as string,",
						"          xpd_level as string,",
						"          ts_indicativeclientbase as string,",
						"          xpd_specialisms as string,",
						"          xpd_montagulevel as string,",
						"          ts_vendorsummary as string,",
						"          ts_producttype as string,",
						"          ts_montaguoffice as string,",
						"          ts_quickcapturegeography as string,",
						"          xpd_roletypes as string,",
						"          mpe_livedeal as boolean,",
						"          donotbulkpostalmail as boolean,",
						"          donotpostalmail as boolean,",
						"          msdyn_gdproptout as boolean,",
						"          ts_organisationalchange as boolean,",
						"          xpd_publictoprivatetracker as boolean,",
						"          ts_auditor as boolean,",
						"          donotsendmm as boolean,",
						"          donotbulkemail as boolean,",
						"          followemail as boolean,",
						"          creditonhold as boolean,",
						"          marketingonly as boolean,",
						"          participatesinworkflow as boolean,",
						"          merged as boolean,",
						"          ts_validated as boolean,",
						"          xpd_sharepointlocationcreated as boolean,",
						"          xpd_setreminder as boolean,",
						"          ts_personnelchange as boolean,",
						"          donotfax as boolean,",
						"          isprivate as boolean,",
						"          donotphone as boolean,",
						"          xpd_rpo as boolean,",
						"          ts_trackcompany as boolean,",
						"          donotemail as boolean,",
						"          parentaccountid as string,",
						"          parentaccountid_entitytype as string,",
						"          ts_recommendedby as string,",
						"          ts_recommendedby_entitytype as string,",
						"          ts_countryofeconomicoriginforthecapital as string,",
						"          ts_countryofeconomicoriginforthecapital_entitytype as string,",
						"          xpd_reminderto as string,",
						"          xpd_reminderto_entitytype as string,",
						"          preferredserviceid as string,",
						"          preferredserviceid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          createdbyexternalparty as string,",
						"          createdbyexternalparty_entitytype as string,",
						"          ts_validatedby as string,",
						"          ts_validatedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          ts_primarymperelationshipmanager as string,",
						"          ts_primarymperelationshipmanager_entitytype as string,",
						"          modifiedbyexternalparty as string,",
						"          modifiedbyexternalparty_entitytype as string,",
						"          ts_headofficeid as string,",
						"          ts_headofficeid_entitytype as string,",
						"          ts_address1country as string,",
						"          ts_address1country_entitytype as string,",
						"          ts_address1usstate as string,",
						"          ts_address1usstate_entitytype as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          originatingleadid as string,",
						"          originatingleadid_entitytype as string,",
						"          masterid as string,",
						"          masterid_entitytype as string,",
						"          ts_originationlead1 as string,",
						"          ts_originationlead1_entitytype as string,",
						"          defaultpricelevelid as string,",
						"          defaultpricelevelid_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          ts_originationlead2 as string,",
						"          ts_originationlead2_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          mpe_coinvestquestionnaireid as string,",
						"          mpe_coinvestquestionnaireid_entitytype as string,",
						"          ts_hub as string,",
						"          ts_hub_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          ts_currentauditor as string,",
						"          ts_currentauditor_entitytype as string,",
						"          primarycontactid as string,",
						"          primarycontactid_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          preferredsystemuserid as string,",
						"          preferredsystemuserid_entitytype as string,",
						"          preferredequipmentid as string,",
						"          preferredequipmentid_entitytype as string,",
						"          xpd_fund as string,",
						"          xpd_fund_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          territoryid as string,",
						"          territoryid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          xpd_totalinstitutionalcommitments_base as decimal(38,0),",
						"          ts_minimumticketsize_base as decimal(38,4),",
						"          xpd_totalinstitutionalcommitments as decimal(38,0),",
						"          aging30 as decimal(38,0),",
						"          creditlimit as decimal(38,0),",
						"          creditlimit_base as decimal(38,0),",
						"          ts_totalcommitments_base as decimal(38,4),",
						"          aging60 as decimal(38,0),",
						"          ts_transfersin_base as decimal(38,0),",
						"          aging90 as decimal(38,0),",
						"          ts_maximumticketsize as decimal(38,4),",
						"          ts_totalaum_base as decimal(38,0),",
						"          marketcap_base as decimal(38,0),",
						"          aging60_base as decimal(38,0),",
						"          aging90_base as decimal(38,0),",
						"          ts_transfersout as decimal(38,0),",
						"          ts_maximumticketsize_base as decimal(38,4),",
						"          ts_originalcommitments_base as decimal(38,0),",
						"          revenue as decimal(38,0),",
						"          ts_totalcommitments as decimal(38,4),",
						"          ts_transfersout_base as decimal(38,0),",
						"          ts_totalaum as decimal(38,0),",
						"          ts_commitmentreductions_base as decimal(38,0),",
						"          ts_commitmentreductions as decimal(38,0),",
						"          marketcap as decimal(38,0),",
						"          ts_originalcommitments as decimal(38,0),",
						"          ts_minimumticketsize as decimal(38,4),",
						"          revenue_base as decimal(38,0),",
						"          openrevenue_base as decimal(38,0),",
						"          aging30_base as decimal(38,0),",
						"          openrevenue as decimal(38,0),",
						"          ts_transfersin as decimal(38,0),",
						"          ts_othernotes as string,",
						"          ts_transfersin_date as timestamp,",
						"          address1_county as string,",
						"          openrevenue_date as timestamp,",
						"          ts_recommendedbyname as string,",
						"          ts_relationshipinteractioncomments as string,",
						"          ts_originationlead2yominame as string,",
						"          parentaccountidname as string,",
						"          xpd_roletypes_text as string,",
						"          address1_addressid as string,",
						"          importsequencenumber as long,",
						"          address1_longitude as double,",
						"          ts_countryofeconomicoriginforthecapitalname as string,",
						"          entityimageid as string,",
						"          telephone2 as string,",
						"          ts_lastoriginationmeeting as timestamp,",
						"          address2_utcoffset as long,",
						"          address1_upszone as string,",
						"          ts_originalcommitments_state as long,",
						"          ts_typicalcost as string,",
						"          xpd_recommendingportfoliocompaniesrecommended as string,",
						"          accountnumber as string,",
						"          ts_currentauditoryominame as string,",
						"          ts_originalcommitments_date as timestamp,",
						"          lastonholdtime as timestamp,",
						"          ts_sectorscoveredbyfirm as string,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          address2_upszone as string,",
						"          opendeals_state as long,",
						"          xpd_functionuse_text as string,",
						"          slainvokedidname as string,",
						"          address2_longitude as double,",
						"          defaultpricelevelidname as string,",
						"          stockexchange as string,",
						"          mpe_liveofferingscount_date as timestamp,",
						"          xpd_relationshipcomments as string,",
						"          originatingleadidname as string,",
						"          slaname as string,",
						"          ts_currentauditorname as string,",
						"          xpd_remindertoyominame as string,",
						"          ts_address1usstatename as string,",
						"          ts_tempcompanytype as string,",
						"          versionnumber as long,",
						"          address1_latitude as double,",
						"          ts_formername as string,",
						"          yominame as string,",
						"          createdbyyominame as string,",
						"          ts_cityofvisit as string,",
						"          address2_telephone1 as string,",
						"          ts_globalgeographiescoveredids as string,",
						"          preferredserviceidname as string,",
						"          address2_city as string,",
						"          ts_mpeapproachstrategy as string,",
						"          address2_line2 as string,",
						"          ts_lastdatestatuschanged as timestamp,",
						"          li_companyid as long,",
						"          transactioncurrencyidname as string,",
						"          entityimage_url as string,",
						"          xpd_relationshipstatuschangeddate as timestamp,",
						"          createdonbehalfbyname as string,",
						"          mpe_liveofferingscount_state as long,",
						"          xpd_numberofcoinvestinvestments_date as timestamp,",
						"          ts_validateddate as timestamp,",
						"          owneridname as string,",
						"          xpd_generalcomments as string,",
						"          ts_companylegalname as string,",
						"          description as string,",
						"          ts_validatedbyname as string,",
						"          originatingleadidyominame as string,",
						"          opendeals as long,",
						"          xpd_numberofopportunitiesshown_state as long,",
						"          address2_postalcode as string,",
						"          websiteurl as string,",
						"          xpd_fundname as string,",
						"          address1_utcoffset as long,",
						"          exchangerate as decimal(38,10),",
						"          mpe_flowlastrundate as timestamp,",
						"          fax as string,",
						"          address1_line3 as string,",
						"          ts_monthssincelastmeeting as long,",
						"          ts_hubname as string,",
						"          address2_line1 as string,",
						"          ts_capiqticket as string,",
						"          address2_stateorprovince as string,",
						"          address2_name as string,",
						"          ts_transfersout_state as long,",
						"          xpd_numberofopportunitiesshown as long,",
						"          primarytwitterid as string,",
						"          mpe_coinvestquestionnaireidname as string,",
						"          xpd_numberofopportunitiesshown_date as timestamp,",
						"          xpd_preferentialterms as string,",
						"          address1_primarycontactname as string,",
						"          territoryidname as string,",
						"          ts_processstatus as string,",
						"          address1_name as string,",
						"          address2_telephone2 as string,",
						"          address2_telephone3 as string,",
						"          xpd_recruitmentareateam_text as string,",
						"          ftpsiteurl as string,",
						"          address1_postalcode as string,",
						"          ts_companynumber as string,",
						"          createdon as string,",
						"          mpe_liveofferingscount as long,",
						"          traversedpath as string,",
						"          address1_stateorprovince as string,",
						"          ts_transfersin_state as long,",
						"          address2_addressid as string,",
						"          ts_monthlyreviewmeetingname as string,",
						"          primarysatoriid as string,",
						"          telephone3 as string,",
						"          openrevenue_state as long,",
						"          ts_usesprovidedids as string,",
						"          ts_originationcomments as string,",
						"          lastusedincampaign as timestamp,",
						"          primarycontactidname as string,",
						"          ts_originationlead1name as string,",
						"          ts_headofficeidname as string,",
						"          ts_montagucomments as string,",
						"          address2_fax as string,",
						"          createdbyname as string,",
						"          xpd_numberofcoinvestinvestments as long,",
						"          ts_capitaliqlink as string,",
						"          ts_primarymperelationshipmanagername as string,",
						"          mpe_relationshipstatus_text as string,",
						"          xpd_datereminderwasset as timestamp,",
						"          xpd_numberofcoinvestinvestments_state as long,",
						"          address1_postofficebox as string,",
						"          address1_city as string,",
						"          teamsfollowed as long,",
						"          ts_originationlead2name as string,",
						"          timezoneruleversionnumber as long,",
						"          modifiedonbehalfbyyominame as string,",
						"          entityimage_timestamp as long,",
						"          tickersymbol as string,",
						"          ts_theirprogrammecomments as string,",
						"          xpd_companyuse_text as string,",
						"          modifiedbyname as string,",
						"          owneridtype as string,",
						"          sic as string,",
						"          sharesoutstanding as long,",
						"          opendeals_date as timestamp,",
						"          address2_postofficebox as string,",
						"          emailaddress3 as string,",
						"          emailaddress2 as string,",
						"          emailaddress1 as string,",
						"          ts_globalgeographiescoveredbyfirm as string,",
						"          ts_recommendationoffirmupdated as timestamp,",
						"          ts_lastmet as timestamp,",
						"          ts_reminderdatesetto as timestamp,",
						"          ts_commitmentreductions_state as long,",
						"          owningbusinessunitname as string,",
						"          onholdtime as long,",
						"          ts_alias as string,",
						"          createdonbehalfbyyominame as string,",
						"          ts_transfersout_date as timestamp,",
						"          ts_address1countryname as string,",
						"          preferredsystemuseridyominame as string,",
						"          createdbyexternalpartyname as string,",
						"          mpe_documentsetid as string,",
						"          telephone1 as string,",
						"          ts_legacycompanytypes as string,",
						"          ts_validatedbyyominame as string,",
						"          address1_composite as string,",
						"          ts_investorgroupgatekeeperid as string,",
						"          primarycontactidyominame as string,",
						"          address2_country as string,",
						"          xpd_recommendationcomments as string,",
						"          owneridyominame as string,",
						"          createdbyexternalpartyyominame as string,",
						"          ts_originationlead1yominame as string,",
						"          ts_usesprovidedbyfirm as string,",
						"          xpd_recommendingportco as string,",
						"          address1_country as string,",
						"          ts_commitmentreductions_date as timestamp,",
						"          name as string,",
						"          modifiedbyexternalpartyyominame as string,",
						"          xpd_remindertoname as string,",
						"          stageid as string,",
						"          modifiedonbehalfbyname as string,",
						"          masteraccountidname as string,",
						"          timespentbymeonemailandmeetings as string,",
						"          address2_latitude as double,",
						"          overriddencreatedon as timestamp,",
						"          parentaccountidyominame as string,",
						"          ts_specificareaofexpertisecomments as string,",
						"          preferredsystemuseridname as string,",
						"          utcconversiontimezonecode as long,",
						"          address2_county as string,",
						"          address1_line1 as string,",
						"          address2_primarycontactname as string,",
						"          address1_line2 as string,",
						"          xpd_reasonaction as string,",
						"          ts_primarymperelationshipmanageryominame as string,",
						"          processid as string,",
						"          ts_sectorscoveredids as string,",
						"          ts_recommendedbyyominame as string,",
						"          modifiedbyexternalpartyname as string,",
						"          ts_relevantsituations as string,",
						"          accountid as string,",
						"          modifiedon as timestamp,",
						"          preferredequipmentidname as string,",
						"          modifiedbyyominame as string,",
						"          ts_dealstageofmostrecentopportunity as string,",
						"          address2_composite as string,",
						"          masteraccountidyominame as string,",
						"          numberofemployees as long,",
						"          address1_fax as string,",
						"          address2_line3 as string,",
						"          msdyn_segmentid as string,",
						"          msdyn_segmentid_entitytype as string,",
						"          msdyn_segmentidname as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'account') ~> AccountIn",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          ts_dealannouncedreason as long,",
						"          ts_highprioritynew as long,",
						"          ts_actionstatus as long,",
						"          mpe_targetrelationshipstatus as long,",
						"          ts_producttype as long,",
						"          ts_internalintermediarysource as long,",
						"          mpe_flowlastrunoutcome as long,",
						"          ts_currentactivity as long,",
						"          ts_opportunitystatus as long,",
						"          ts_montaguprimaryoffice as long,",
						"          ts_opportunitytype as long,",
						"          ts_posthumstatus as long,",
						"          ts_meetingremindermonths as long,",
						"          ts_choppedreason as string,",
						"          ts_setreminder as boolean,",
						"          ts_stagereachedfir as boolean,",
						"          ts_stagereachedipr as boolean,",
						"          ts_duplicateopportunityfordiscussion as boolean,",
						"          mpe_smalltarget as boolean,",
						"          ts_stagereachedcr as boolean,",
						"          xpd_includeonallpapers as boolean,",
						"          ts_sold as boolean,",
						"          xpd_sharepointlocationcreated as boolean,",
						"          ts_statuschangedby as string,",
						"          ts_statuschangedby_entitytype as string,",
						"          ts_buyer as string,",
						"          ts_buyer_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          ts_reminderto as string,",
						"          ts_reminderto_entitytype as string,",
						"          mpe_productid as string,",
						"          mpe_productid_entitytype as string,",
						"          ts_targetbusiness as string,",
						"          ts_targetbusiness_entitytype as string,",
						"          ts_firstreferralcompany as string,",
						"          ts_firstreferralcompany_entitytype as string,",
						"          ts_deallead as string,",
						"          ts_deallead_entitytype as string,",
						"          ts_montaguowner as string,",
						"          ts_montaguowner_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          ts_firstreferralcontact as string,",
						"          ts_firstreferralcontact_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ts_managerwedback as string,",
						"          ts_managerwedback_entitytype as string,",
						"          ts_country as string,",
						"          ts_country_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          ts_sellmandate as string,",
						"          ts_sellmandate_entitytype as string,",
						"          ts_estebitda_base as decimal(38,4),",
						"          ts_estebit_base as decimal(38,4),",
						"          ts_estebitda as decimal(38,4),",
						"          ts_estebit as decimal(38,4),",
						"          ts_estturnover_base as decimal(38,4),",
						"          ts_estdealsize as decimal(38,4),",
						"          ts_estdealsize_base as decimal(38,4),",
						"          ts_estturnover as decimal(38,4),",
						"          ts_buyeryominame as string,",
						"          modifiedon as timestamp,",
						"          ts_statuschangedbyname as string,",
						"          ts_managerwedbackyominame as string,",
						"          xpd_montaguprojectname as string,",
						"          transactioncurrencyidname as string,",
						"          ts_nextsteps as string,",
						"          ts_montaguowneryominame as string,",
						"          ts_firstreferralcontactname as string,",
						"          ts_opportunitydescription as string,",
						"          ts_buyerpaidxltmebitda as decimal(38,1),",
						"          ts_targetbusinessyominame as string,",
						"          ts_montaguownername as string,",
						"          ts_managerwedbackname as string,",
						"          ts_opportunitystage as string,",
						"          ts_otherdocumentsurl as string,",
						"          exchangerate as decimal(38,10),",
						"          mpe_documentsetid as string,",
						"          ts_buyername as string,",
						"          ts_firstreferralcontactyominame as string,",
						"          createdon as string,",
						"          ts_sellmandateyominame as string,",
						"          mpe_montaguprimaryofficestring as string,",
						"          ts_statuschangedbyyominame as string,",
						"          ts_firstreferralcompanyname as string,",
						"          owneridyominame as string,",
						"          ts_choppedcomments as string,",
						"          timezoneruleversionnumber as long,",
						"          createdbyname as string,",
						"          ts_dealleadname as string,",
						"          owningbusinessunitname as string,",
						"          ts_dealleadyominame as string,",
						"          ts_lastdatestatuschanged as timestamp,",
						"          traversedpath as string,",
						"          overriddencreatedon as timestamp,",
						"          ts_iprdocumenturl as string,",
						"          createdonbehalfbyname as string,",
						"          ts_sellmandatename as string,",
						"          owneridtype as string,",
						"          owneridname as string,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          mpe_productidname as string,",
						"          ts_originationopportunityid as string,",
						"          ts_crdocumenturl as string,",
						"          ts_datedealannounced as timestamp,",
						"          processid as string,",
						"          mpe_montaguprimaryofficeowner as string,",
						"          ts_reason as string,",
						"          ts_targetbusinessname as string,",
						"          ts_remindertoname as string,",
						"          ts_postcompletionnoteurl as string,",
						"          ts_name as string,",
						"          stageid as string,",
						"          ts_currentopportunitystatus as string,",
						"          ts_firstreferralcompanyyominame as string,",
						"          mpe_flowlastrundate as timestamp,",
						"          ts_firdocumenturl as string,",
						"          modifiedbyyominame as string,",
						"          modifiedonbehalfbyyominame as string,",
						"          ts_movedoutofwipdate as timestamp,",
						"          ts_equitychequesize as decimal(38,2),",
						"          utcconversiontimezonecode as long,",
						"          ts_weofferedxltmebitda as decimal(38,1),",
						"          importsequencenumber as long,",
						"          ts_remindertoyominame as string,",
						"          ts_companyid as long,",
						"          ts_datereminderwasset as timestamp,",
						"          versionnumber as long,",
						"          ts_originationid as long,",
						"          ts_countryname as string,",
						"          ts_choppeddate as timestamp,",
						"          mpe_posthunstatustext as string,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          ts_humdate as timestamp,",
						"          ts_sellmandateidtype as string,",
						"          ts_dateofreminder as timestamp,",
						"          ts_humurl as string,",
						"          mpe_carveout as long,",
						"          mpe_targetbusiness_parentid as string,",
						"          mpe_targetbusiness_parentid_entitytype as string,",
						"          mpe_targetbusiness_parentidyominame as string,",
						"          mpe_targetbusiness_parentidname as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'ts_originationopportunity') ~> OriginationOpportunityIn",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          ts_stageofmeetingrounds as long,",
						"          ts_talentmeetingtype as long,",
						"          instancetypecode as long,",
						"          ts_whooriginatedthemeeting as long,",
						"          onlinemeetingtype as long,",
						"          ts_meetingteam as long,",
						"          ts_othermeetingmethod as long,",
						"          ts_tone as long,",
						"          ts_meetingmethod as long,",
						"          ts_originationmeetingtype as long,",
						"          prioritycode as long,",
						"          attachmenterrors as long,",
						"          ts_eventtype as long,",
						"          ts_talentmeetingmethod as long,",
						"          ts_productsdiscussed as string,",
						"          ts_contentcovered as string,",
						"          isonlinemeeting as boolean,",
						"          isworkflowcreated as boolean,",
						"          isalldayevent as boolean,",
						"          ts_interview as boolean,",
						"          isbilled as boolean,",
						"          isdraft as boolean,",
						"          ts_keyiractivity as boolean,",
						"          ts_noninvestor as boolean,",
						"          ismapiprivate as boolean,",
						"          isregularactivity as boolean,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          ts_investorgroup as string,",
						"          ts_investorgroup_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          regardingobjectid as string,",
						"          regardingobjectid_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ts_officemet as string,",
						"          ts_officemet_entitytype as string,",
						"          ts_taskowner as string,",
						"          ts_taskowner_entitytype as string,",
						"          serviceid as string,",
						"          serviceid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          requiredattendees as string,",
						"          optionalattendees as string,",
						"          organizer as string,",
						"          scheduledend as timestamp,",
						"          ts_taskdescription as string,",
						"          modifiedon as timestamp,",
						"          ts_purpose as string,",
						"          overriddencreatedon as timestamp,",
						"          ts_taskownername as string,",
						"          activityadditionalparams as string,",
						"          ts_tonepersonalities as string,",
						"          seriesid as string,",
						"          transactioncurrencyidname as string,",
						"          activityid as string,",
						"          modifiedfieldsmask as string,",
						"          utcconversiontimezonecode as long,",
						"          ts_officemetname as string,",
						"          scheduledstart as timestamp,",
						"          outlookownerapptid as long,",
						"          ts_topicscovered as string,",
						"          ts_objective as string,",
						"          onholdtime as long,",
						"          onlinemeetingjoinurl as string,",
						"          ts_notes as string,",
						"          originalstartdate as timestamp,",
						"          ts_opportunitiesdiscussed as string,",
						"          ts_sectorscoveredbyfirm as string,",
						"          attachmentcount as long,",
						"          exchangerate as decimal(38,10),",
						"          ts_originationcommentsnotes as string,",
						"          category as string,",
						"          createdon as string,",
						"          ts_eventdescription as string,",
						"          globalobjectid as string,",
						"          onlinemeetingid as string,",
						"          serviceidname as string,",
						"          owneridyominame as string,",
						"          description as string,",
						"          subcategory as string,",
						"          owningbusinessunitname as string,",
						"          ts_taskduedate as timestamp,",
						"          traversedpath as string,",
						"          sortdate as timestamp,",
						"          createdonbehalfbyname as string,",
						"          ts_sectorscoveredids as string,",
						"          safedescription as string,",
						"          ts_taskowneryominame as string,",
						"          owneridtype as string,",
						"          isunsafe as long,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          ts_conferencename as string,",
						"          timezoneruleversionnumber as long,",
						"          actualend as timestamp,",
						"          regardingobjectidname as string,",
						"          processid as string,",
						"          activitytypecode as string,",
						"          actualstart as timestamp,",
						"          xpd_listofexternalattendees as string,",
						"          slainvokedidname as string,",
						"          location as string,",
						"          subject as string,",
						"          createdbyname as string,",
						"          actualdurationminutes as long,",
						"          modifiedbyyominame as string,",
						"          lastonholdtime as timestamp,",
						"          modifiedonbehalfbyyominame as string,",
						"          ts_attendeestoaddtocrm as string,",
						"          regardingobjectidyominame as string,",
						"          regardingobjecttypecode as string,",
						"          stageid as string,",
						"          scheduleddurationminutes as long,",
						"          ts_sourceid as string,",
						"          ts_investorgroupyominame as string,",
						"          importsequencenumber as long,",
						"          subscriptionid as string,",
						"          onlinemeetingchatid as string,",
						"          ts_lpupdates as string,",
						"          ts_executivesummary as string,",
						"          ts_investorgroupname as string,",
						"          ts_meetingcity as string,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          owneridname as string,",
						"          ts_theirprogramme as string,",
						"          ts_ifdeclinedreason as string,",
						"          slaname as string,",
						"          versionnumber as long",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'appointment') ~> MeetingsAppointmentsIn",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          haschildrencode as long,",
						"          customertypecode as long,",
						"          ts_recommendationofindividual as long,",
						"          gendercode as long,",
						"          address1_addresstypecode as long,",
						"          leadsourcecode as long,",
						"          preferredappointmenttimecode as long,",
						"          address2_freighttermscode as long,",
						"          address2_shippingmethodcode as long,",
						"          ts_debtsubtype as long,",
						"          msdyn_orgchangestatus as long,",
						"          ts_suffix as long,",
						"          xpd_gender as long,",
						"          ts_title as long,",
						"          paymenttermscode as long,",
						"          accountrolecode as long,",
						"          territorycode as long,",
						"          ts_vendortargettrackingrole as long,",
						"          address3_freighttermscode as long,",
						"          address1_shippingmethodcode as long,",
						"          preferredappointmentdaycode as long,",
						"          customersizecode as long,",
						"          preferredcontactmethodcode as long,",
						"          ts_futurecontactmethod as long,",
						"          address3_shippingmethodcode as long,",
						"          address2_addresstypecode as long,",
						"          mpe_flowlastrunoutcome as long,",
						"          ts_capabilitiesofindividual as long,",
						"          address3_addresstypecode as long,",
						"          familystatuscode as long,",
						"          shippingmethodcode as long,",
						"          xpd_availability as long,",
						"          educationcode as long,",
						"          address1_freighttermscode as long,",
						"          ts_quickcaptureuses as string,",
						"          xpd_montagulevel as string,",
						"          ts_permanentinterim as string,",
						"          ts_ircontactrole as string,",
						"          xpd_level as string,",
						"          ts_languagesspokenwritten as string,",
						"          ts_contacttype as string,",
						"          ts_montaguoffice as string,",
						"          ts_roletypes as string,",
						"          xpd_specialisms as string,",
						"          ts_quickcapturesectors as string,",
						"          xpd_function as string,",
						"          ts_producttype as string,",
						"          ts_quickcapturegeography as string,",
						"          ts_productsinterestedin as string,",
						"          ts_potentialrolecandidate as boolean,",
						"          isbackofficecustomer as boolean,",
						"          donotpostalmail as boolean,",
						"          xpd_addcontacttooutlook as boolean,",
						"          ts_centralrelationshipmanager as boolean,",
						"          msdyn_gdproptout as boolean,",
						"          xpd_hascompany as boolean,",
						"          creditonhold as boolean,",
						"          xpd_benchcandidate as boolean,",
						"          donotbulkpostalmail as boolean,",
						"          donotsendmm as boolean,",
						"          donotbulkemail as boolean,",
						"          followemail as boolean,",
						"          xpd_sharepointdocumentlocationcreated as boolean,",
						"          xpd_available as boolean,",
						"          ts_leadearlystageinteraction as boolean,",
						"          participatesinworkflow as boolean,",
						"          ts_doyouwishtotrackthiscontact as boolean,",
						"          merged as boolean,",
						"          ts_validated as boolean,",
						"          marketingonly as boolean,",
						"          donotfax as boolean,",
						"          isprivate as boolean,",
						"          donotphone as boolean,",
						"          isautocreate as boolean,",
						"          donotemail as boolean,",
						"          ts_unconfirmedemailaddress as boolean,",
						"          preferredsystemuserid as string,",
						"          preferredsystemuserid_entitytype as string,",
						"          mpe_accountid as string,",
						"          mpe_accountid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          ts_recommendedby as string,",
						"          ts_recommendedby_entitytype as string,",
						"          ts_previousemployerid as string,",
						"          ts_previousemployerid_entitytype as string,",
						"          preferredserviceid as string,",
						"          preferredserviceid_entitytype as string,",
						"          parentcontactid as string,",
						"          parentcontactid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          ts_pa as string,",
						"          ts_pa_entitytype as string,",
						"          ts_businessaddress as string,",
						"          ts_businessaddress_entitytype as string,",
						"          modifiedbyexternalparty as string,",
						"          modifiedbyexternalparty_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          originatingleadid as string,",
						"          originatingleadid_entitytype as string,",
						"          masterid as string,",
						"          masterid_entitytype as string,",
						"          defaultpricelevelid as string,",
						"          defaultpricelevelid_entitytype as string,",
						"          parent_contactid as string,",
						"          parent_contactid_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          createdbyexternalparty as string,",
						"          createdbyexternalparty_entitytype as string,",
						"          preferredequipmentid as string,",
						"          preferredequipmentid_entitytype as string,",
						"          xpd_referredbyinternal as string,",
						"          xpd_referredbyinternal_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          xpd_homecountry as string,",
						"          xpd_homecountry_entitytype as string,",
						"          ts_placementfirmintroducedby as string,",
						"          ts_placementfirmintroducedby_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          accountid as string,",
						"          accountid_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          parentcustomerid as string,",
						"          parentcustomerid_entitytype as string,",
						"          xpd_referredbyexternal as string,",
						"          xpd_referredbyexternal_entitytype as string,",
						"          aging30 as decimal(38,2),",
						"          creditlimit_base as decimal(38,4),",
						"          aging60 as decimal(38,2),",
						"          aging90 as decimal(38,2),",
						"          aging60_base as decimal(38,4),",
						"          aging90_base as decimal(38,4),",
						"          annualincome_base as decimal(38,4),",
						"          creditlimit as decimal(38,2),",
						"          annualincome as decimal(38,2),",
						"          aging30_base as decimal(38,4),",
						"          ts_othernotes as string,",
						"          xpd_referredbyinternalyominame as string,",
						"          address1_county as string,",
						"          yomilastname as string,",
						"          address3_utcoffset as long,",
						"          ts_recommendedbyname as string,",
						"          description as string,",
						"          li_membertoken as string,",
						"          department as string,",
						"          xpd_roletypes_text as string,",
						"          address1_addressid as string,",
						"          importsequencenumber as long,",
						"          address1_longitude as double,",
						"          address3_fax as string,",
						"          managername as string,",
						"          entityimageid as string,",
						"          telephone2 as string,",
						"          parentcustomeridtype as string,",
						"          address2_upszone as string,",
						"          address1_upszone as string,",
						"          xpd_recommendingportfoliocompaniesrecommended as string,",
						"          lastonholdtime as timestamp,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          address1_fax as string,",
						"          address3_telephone1 as string,",
						"          address3_telephone2 as string,",
						"          address3_telephone3 as string,",
						"          fax as string,",
						"          assistantname as string,",
						"          address2_line3 as string,",
						"          accountidyominame as string,",
						"          parentcontactidyominame as string,",
						"          mpe_accountidyominame as string,",
						"          slainvokedidname as string,",
						"          defaultpricelevelidname as string,",
						"          fullname as string,",
						"          address2_longitude as double,",
						"          subscriptionid as string,",
						"          originatingleadidname as string,",
						"          slaname as string,",
						"          versionnumber as long,",
						"          address1_latitude as double,",
						"          createdbyyominame as string,",
						"          parent_contactidname as string,",
						"          address2_telephone1 as string,",
						"          pager as string,",
						"          salutation as string,",
						"          mpe_accountidname as string,",
						"          xpd_functionuse_text as string,",
						"          accountidname as string,",
						"          mpe_companysummary as string,",
						"          parent_contactidyominame as string,",
						"          preferredserviceidname as string,",
						"          address2_city as string,",
						"          address3_postalcode as string,",
						"          address2_line2 as string,",
						"          li_companyid as long,",
						"          ts_otherphonelabel as string,",
						"          ts_reportingemail as string,",
						"          address3_upszone as string,",
						"          transactioncurrencyidname as string,",
						"          address3_county as string,",
						"          entityimage_url as string,",
						"          governmentid as string,",
						"          callback as string,",
						"          business2 as string,",
						"          createdonbehalfbyname as string,",
						"          ts_validateddate as timestamp,",
						"          address2_telephone2 as string,",
						"          owneridname as string,",
						"          originatingleadidyominame as string,",
						"          ts_otherlanguages as string,",
						"          address2_postalcode as string,",
						"          birthdate as timestamp,",
						"          parentcontactidname as string,",
						"          spousesname as string,",
						"          xpd_compensationdate as timestamp,",
						"          address1_utcoffset as long,",
						"          address3_line1 as string,",
						"          traversedpath as string,",
						"          exchangerate as decimal(38,10),",
						"          mpe_flowlastrundate as timestamp,",
						"          address1_line3 as string,",
						"          address3_country as string,",
						"          mpe_documentsetid as string,",
						"          address2_line1 as string,",
						"          ts_previousemployeridyominame as string,",
						"          middlename as string,",
						"          managerphone as string,",
						"          address2_stateorprovince as string,",
						"          childrensnames as string,",
						"          address2_name as string,",
						"          address3_addressid as string,",
						"          address3_stateorprovince as string,",
						"          ts_sectorspecialtyids as string,",
						"          businesscardattributes as string,",
						"          anniversary as timestamp,",
						"          ts_employmentstartdate as timestamp,",
						"          ts_legacycontacttypes as string,",
						"          address1_primarycontactname as string,",
						"          address2_utcoffset as long,",
						"          home2 as string,",
						"          ts_geographicspecialtyids as string,",
						"          address1_name as string,",
						"          ts_recommendationcomments as string,",
						"          address2_telephone3 as string,",
						"          address3_primarycontactname as string,",
						"          ftpsiteurl as string,",
						"          address1_postalcode as string,",
						"          createdon as string,",
						"          address1_stateorprovince as string,",
						"          yomimiddlename as string,",
						"          jobtitle as string,",
						"          telephone3 as string,",
						"          ts_usesspeciality as string,",
						"          ts_knowntouserinitials as string,",
						"          address2_fax as string,",
						"          createdbyname as string,",
						"          xpd_contactuse_text as string,",
						"          ts_sourceid as string,",
						"          address2_addressid as string,",
						"          employeeid as string,",
						"          address1_postofficebox as string,",
						"          address1_city as string,",
						"          ts_businessaddressname as string,",
						"          teamsfollowed as long,",
						"          ts_cv as string,",
						"          timezoneruleversionnumber as long,",
						"          modifiedonbehalfbyyominame as string,",
						"          xpd_hrcompensation as string,",
						"          ts_currentbonusandorupliftconsiderations as string,",
						"          modifiedbyname as string,",
						"          address3_line2 as string,",
						"          yomifullname as string,",
						"          owneridtype as string,",
						"          entityimage_timestamp as long,",
						"          ts_placementfirmintroducedbyyominame as string,",
						"          xpd_previousrole as string,",
						"          ts_compensation as string,",
						"          address2_postofficebox as string,",
						"          emailaddress3 as string,",
						"          emailaddress2 as string,",
						"          emailaddress1 as string,",
						"          ts_interactioncontactuniqueidentifier as string,",
						"          ts_investmentcafeid as string,",
						"          websiteurl as string,",
						"          nickname as string,",
						"          ts_lastmet as timestamp,",
						"          address3_name as string,",
						"          ts_usesspecialtyids as string,",
						"          ts_linkedinurl as string,",
						"          lastname as string,",
						"          address3_longitude as double,",
						"          xpd_referredbyexternalidtype as string,",
						"          parentcustomeridname as string,",
						"          owningbusinessunitname as string,",
						"          onholdtime as long,",
						"          createdonbehalfbyyominame as string,",
						"          preferredsystemuseridyominame as string,",
						"          createdbyexternalpartyname as string,",
						"          ts_tone as string,",
						"          telephone1 as string,",
						"          overriddencreatedon as timestamp,",
						"          address3_postofficebox as string,",
						"          assistantphone as string,",
						"          address1_composite as string,",
						"          address3_line3 as string,",
						"          address2_country as string,",
						"          xpd_referredbyinternalname as string,",
						"          mobilephone as string,",
						"          owneridyominame as string,",
						"          address1_line1 as string,",
						"          createdbyexternalpartyyominame as string,",
						"          xpd_referredbyexternalyominame as string,",
						"          yomifirstname as string,",
						"          mastercontactidname as string,",
						"          address3_city as string,",
						"          address1_country as string,",
						"          externaluseridentifier as string,",
						"          modifiedbyexternalpartyyominame as string,",
						"          firstname as string,",
						"          xpd_hrcurrentbonusandorupliftconsiderations as string,",
						"          stageid as string,",
						"          modifiedonbehalfbyname as string,",
						"          xpd_homecountryname as string,",
						"          mastercontactidyominame as string,",
						"          suffix as string,",
						"          ts_payominame as string,",
						"          lastusedincampaign as timestamp,",
						"          ts_geographicspeciality as string,",
						"          xpd_recruitmentareateam_text as string,",
						"          ts_retentionreviewdate as timestamp,",
						"          parentcustomeridyominame as string,",
						"          timespentbymeonemailandmeetings as string,",
						"          address2_latitude as double,",
						"          xpd_availablefrom as timestamp,",
						"          address3_composite as string,",
						"          xpd_recommendingportco as string,",
						"          preferredsystemuseridname as string,",
						"          utcconversiontimezonecode as long,",
						"          address2_county as string,",
						"          ts_paname as string,",
						"          contactid as string,",
						"          address2_primarycontactname as string,",
						"          ts_specificareasofexpertisecomments as string,",
						"          address1_line2 as string,",
						"          ts_recommendationofindividualupdated as timestamp,",
						"          xpd_referredbyexternalname as string,",
						"          ts_placementfirmintroducedbyname as string,",
						"          ts_sectorspeciality as string,",
						"          ts_previousemployeridname as string,",
						"          processid as string,",
						"          ts_recommendedbyyominame as string,",
						"          modifiedon as timestamp,",
						"          modifiedbyexternalpartyname as string,",
						"          ts_relevantsituations as string,",
						"          businesscard as string,",
						"          company as string,",
						"          preferredequipmentidname as string,",
						"          modifiedbyyominame as string,",
						"          ts_preferredname as string,",
						"          address2_composite as string,",
						"          numberofchildren as long,",
						"          address3_latitude as double,",
						"          mpe_companysearchbyemail as boolean,",
						"          msdyn_segmentid as string,",
						"          msdyn_segmentid_entitytype as string,",
						"          msdyn_segmentidname as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'contact') ~> ContactsIn",
						"source(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'systemuser') ~> Systemusersource",
						"MeetingsAppointmentsIn select(mapColumn(",
						"          Id,",
						"          ts_meetingteam,",
						"          ts_othermeetingmethod,",
						"          isonlinemeeting,",
						"          isalldayevent,",
						"          regardingobjectid,",
						"          ts_taskowner,",
						"          scheduledend,",
						"          ts_taskdescription,",
						"          scheduledstart,",
						"          onlinemeetingjoinurl,",
						"          ts_notes,",
						"          ts_opportunitiesdiscussed,",
						"          ts_sectorscoveredbyfirm,",
						"          ts_originationcommentsnotes,",
						"          ts_taskduedate,",
						"          ts_sectorscoveredids,",
						"          location,",
						"          scheduleddurationminutes",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> MeetingsCleanselect",
						"ContactsIn select(mapColumn(",
						"          Id,",
						"          ts_recommendationofindividual,",
						"          gendercode,",
						"          paymenttermscode,",
						"          ts_vendortargettrackingrole,",
						"          address1_shippingmethodcode,",
						"          preferredcontactmethodcode,",
						"          ts_capabilitiesofindividual,",
						"          familystatuscode,",
						"          xpd_availability,",
						"          address1_freighttermscode,",
						"          xpd_montagulevel,",
						"          ts_permanentinterim,",
						"          ts_ircontactrole,",
						"          xpd_level,",
						"          ts_languagesspokenwritten,",
						"          ts_montaguoffice,",
						"          ts_roletypes,",
						"          xpd_specialisms,",
						"          xpd_function,",
						"          ts_producttype,",
						"          ts_productsinterestedin,",
						"          donotpostalmail,",
						"          ts_centralrelationshipmanager,",
						"          creditonhold,",
						"          xpd_benchcandidate,",
						"          donotsendmm,",
						"          donotbulkemail,",
						"          followemail,",
						"          xpd_available,",
						"          donotfax,",
						"          donotphone,",
						"          donotemail,",
						"          ts_recommendedby,",
						"          transactioncurrencyid,",
						"          originatingleadid,",
						"          xpd_homecountry,",
						"          creditlimit,",
						"          telephone2,",
						"          salutation,",
						"          ts_reportingemail,",
						"          ts_otherlanguages,",
						"          birthdate,",
						"          spousesname,",
						"          xpd_compensationdate,",
						"          anniversary,",
						"          ts_recommendationcomments,",
						"          ts_usesspeciality,",
						"          xpd_hrcompensation,",
						"          ts_currentbonusandorupliftconsiderations,",
						"          ts_compensation,",
						"          emailaddress2,",
						"          ts_investmentcafeid,",
						"          ts_lastmet,",
						"          ts_tone,",
						"          xpd_hrcurrentbonusandorupliftconsiderations,",
						"          lastusedincampaign,",
						"          ts_geographicspeciality,",
						"          xpd_availablefrom,",
						"          xpd_recommendingportco,",
						"          contactid,",
						"          ts_sectorspeciality",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> contactscleanselect",
						"OriginationOpportunityIn select(mapColumn(",
						"          Id,",
						"          ts_actionstatus,",
						"          ts_producttype,",
						"          ts_internalintermediarysource,",
						"          ts_currentactivity,",
						"          ts_opportunitystatus,",
						"          ts_montaguprimaryoffice,",
						"          ts_opportunitytype,",
						"          ts_posthumstatus,",
						"          ts_choppedreason,",
						"          ts_duplicateopportunityfordiscussion,",
						"          mpe_smalltarget,",
						"          xpd_includeonallpapers,",
						"          ts_sold,",
						"          xpd_sharepointlocationcreated,",
						"          ts_buyer,",
						"          mpe_productid,",
						"          ts_targetbusiness,",
						"          ts_firstreferralcompany,",
						"          ts_montaguowner,",
						"          ts_firstreferralcontact,",
						"          transactioncurrencyid,",
						"          ts_managerwedback,",
						"          ts_country,",
						"          ownerid,",
						"          ts_estebitda,",
						"          ts_estebit,",
						"          ts_estdealsize,",
						"          ts_estturnover,",
						"          ts_nextsteps,",
						"          ts_buyerpaidxltmebitda,",
						"          ts_opportunitystage,",
						"          ts_choppedcomments,",
						"          ts_datedealannounced,",
						"          ts_name,",
						"          ts_weofferedxltmebitda,",
						"          ts_companyid,",
						"          ts_choppeddate,",
						"          mpe_carveout,",
						"          mpe_targetbusiness_parentid",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> OrigiopportCleanout",
						"AccountIn select(mapColumn(",
						"          Id,",
						"          ts_primarysecondaryfocus,",
						"          xpd_relationshipstatus,",
						"          ts_introducertype,",
						"          xpd_remindermonths,",
						"          ts_portfoliocompanystatus,",
						"          ts_companytype,",
						"          ts_vendorsummary,",
						"          xpd_publictoprivatetracker,",
						"          xpd_setreminder,",
						"          ts_trackcompany,",
						"          parentaccountid,",
						"          xpd_reminderto,",
						"          ts_headofficeid,",
						"          ts_originationlead1,",
						"          ts_originationlead2,",
						"          ts_currentauditor,",
						"          ts_othernotes,",
						"          xpd_relationshipcomments,",
						"          ts_formername,",
						"          ts_mpeapproachstrategy,",
						"          ts_lastdatestatuschanged,",
						"          xpd_relationshipstatuschangeddate,",
						"          ts_companylegalname,",
						"          ts_companynumber,",
						"          ts_monthlyreviewmeetingname,",
						"          ts_originationcomments,",
						"          ts_capitaliqlink,",
						"          xpd_datereminderwasset,",
						"          ts_reminderdatesetto,",
						"          ts_alias,",
						"          xpd_reasonaction,",
						"          ts_relevantsituations,",
						"          ts_dealstageofmostrecentopportunity",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> AccountsSelectClean",
						"Systemusersource select(skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> Systemuserselect",
						"AccountsSelectClean sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> AccountStage",
						"MeetingsCleanselect sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> MeetingStageClean",
						"contactscleanselect sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> ContactsStageClean",
						"OrigiopportCleanout sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> OriginationSINK",
						"Systemuserselect sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/ReportsDataset1')]",
				"[concat(variables('workspaceId'), '/datasets/Systemusertable')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/InputDataflow_CDM')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "prod-synapse-uks-001-WorkspaceDefaultStorage",
								"type": "LinkedServiceReference"
							},
							"name": "AccountIn"
						},
						{
							"linkedService": {
								"referenceName": "prod-synapse-uks-001-WorkspaceDefaultStorage",
								"type": "LinkedServiceReference"
							},
							"name": "OriginationOpportunityIn"
						},
						{
							"linkedService": {
								"referenceName": "prod-synapse-uks-001-WorkspaceDefaultStorage",
								"type": "LinkedServiceReference"
							},
							"name": "MeetingsAppointmentsIn"
						},
						{
							"linkedService": {
								"referenceName": "prod-synapse-uks-001-WorkspaceDefaultStorage",
								"type": "LinkedServiceReference"
							},
							"name": "ContactsIn"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "ReportsDataset1",
								"type": "DatasetReference"
							},
							"name": "AccountStage"
						},
						{
							"dataset": {
								"referenceName": "ReportsDataset1",
								"type": "DatasetReference"
							},
							"name": "MeetingStageClean"
						},
						{
							"dataset": {
								"referenceName": "ReportsDataset1",
								"type": "DatasetReference"
							},
							"name": "ContactsStageClean"
						},
						{
							"dataset": {
								"referenceName": "ReportsDataset1",
								"type": "DatasetReference"
							},
							"name": "OriginationSINK"
						},
						{
							"dataset": {
								"referenceName": "ReportsDataset1",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [],
					"scriptLines": [
						"source(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     entity: 'account',",
						"     format: 'cdm',",
						"     manifestType: 'model',",
						"     folderPath: '',",
						"     fileSystem: 'dataverse-montagu-org5a2bcccf') ~> AccountIn",
						"source(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     entity: 'ts_originationopportunity',",
						"     format: 'cdm',",
						"     manifestType: 'model',",
						"     folderPath: '',",
						"     fileSystem: 'dataverse-montagu-org5a2bcccf') ~> OriginationOpportunityIn",
						"source(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     entity: 'appointment',",
						"     format: 'cdm',",
						"     manifestType: 'model',",
						"     folderPath: '',",
						"     fileSystem: 'dataverse-montagu-org5a2bcccf') ~> MeetingsAppointmentsIn",
						"source(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     entity: 'contact',",
						"     format: 'cdm',",
						"     manifestType: 'model',",
						"     folderPath: '',",
						"     fileSystem: 'dataverse-montagu-org5a2bcccf') ~> ContactsIn",
						"AccountIn sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> AccountStage",
						"MeetingsAppointmentsIn sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> MeetingStageClean",
						"ContactsIn sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> ContactsStageClean",
						"OriginationOpportunityIn sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> OriginationSINK",
						"AccountIn sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/prod-synapse-uks-001-WorkspaceDefaultStorage')]",
				"[concat(variables('workspaceId'), '/datasets/ReportsDataset1')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/InputDataflow_Split Table')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"name": "AccountIn"
						},
						{
							"name": "OriginationOpportunityIn"
						},
						{
							"name": "MeetingsAppointmentsIn"
						},
						{
							"name": "ContactsIn"
						},
						{
							"name": "SystemuserSource"
						},
						{
							"name": "OptionsetSource"
						},
						{
							"linkedService": {
								"referenceName": "EnrichedDatabase",
								"type": "LinkedServiceReference"
							},
							"name": "EnrichedAccount"
						},
						{
							"linkedService": {
								"referenceName": "EnrichedDatabase",
								"type": "LinkedServiceReference"
							},
							"name": "EnrichedOriginationOpportunities"
						},
						{
							"linkedService": {
								"referenceName": "EnrichedDatabase",
								"type": "LinkedServiceReference"
							},
							"name": "EnrichedMeetingAppointments"
						},
						{
							"linkedService": {
								"referenceName": "EnrichedDatabase",
								"type": "LinkedServiceReference"
							},
							"name": "EnrichedContacts"
						},
						{
							"linkedService": {
								"referenceName": "EnrichedDatabase",
								"type": "LinkedServiceReference"
							},
							"name": "EnrichedSystemuser"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "AccountTable",
								"type": "DatasetReference"
							},
							"name": "AccountStage"
						},
						{
							"dataset": {
								"referenceName": "Appointment",
								"type": "DatasetReference"
							},
							"name": "MeetingStageClean"
						},
						{
							"dataset": {
								"referenceName": "Contacttable",
								"type": "DatasetReference"
							},
							"name": "ContactsStageClean"
						},
						{
							"dataset": {
								"referenceName": "OriginationOpp",
								"type": "DatasetReference"
							},
							"name": "OriginationSINK"
						},
						{
							"dataset": {
								"referenceName": "Systemusertable",
								"type": "DatasetReference"
							},
							"name": "SystemUserClean"
						},
						{
							"dataset": {
								"referenceName": "Optionsettable",
								"type": "DatasetReference"
							},
							"name": "sinkoptionset"
						},
						{
							"name": "SinkEnrichedOrigination"
						},
						{
							"name": "SinkAccount"
						},
						{
							"name": "SinkMeeting"
						},
						{
							"name": "SinkContacts"
						},
						{
							"name": "SinkSystemUser"
						}
					],
					"transformations": [
						{
							"name": "MeetingsCleanselect"
						},
						{
							"name": "contactscleanselect"
						},
						{
							"name": "OrigiopportCleanout"
						},
						{
							"name": "AccountsSelectClean"
						},
						{
							"name": "SystemUserSelect"
						},
						{
							"name": "Originationjoinoutput"
						},
						{
							"name": "GapOptionsetSelect"
						},
						{
							"name": "EnrichedAccountSelect"
						},
						{
							"name": "OutputEnrichedOrigination"
						},
						{
							"name": "select2"
						},
						{
							"name": "select3"
						},
						{
							"name": "select4"
						},
						{
							"name": "AppointmentsJoinOutput"
						},
						{
							"name": "ContactsJoin"
						},
						{
							"name": "SystemUserJoin"
						},
						{
							"name": "AccountEnrichedJoin"
						}
					],
					"scriptLines": [
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          ts_primarysecondaryfocus as long,",
						"          customertypecode as long,",
						"          ts_relationship as long,",
						"          address1_addresstypecode as long,",
						"          accountclassificationcode as long,",
						"          ts_easeofworking as long,",
						"          ts_ukrow as long,",
						"          preferredappointmenttimecode as long,",
						"          ts_address1addresstype as long,",
						"          xpd_relationshipstatus as long,",
						"          ts_introducertype as long,",
						"          xpd_remindermonths as long,",
						"          ts_importance as long,",
						"          address2_freighttermscode as long,",
						"          ts_irrvsmomperformancemeasure as long,",
						"          accountcategorycode as long,",
						"          paymenttermscode as long,",
						"          preferredappointmentdaycode as long,",
						"          businesstypecode as long,",
						"          industrycode as long,",
						"          ts_sizeoffirm as long,",
						"          ts_interaction as long,",
						"          address1_shippingmethodcode as long,",
						"          ts_portfoliocompanystatus as long,",
						"          customersizecode as long,",
						"          xpd_previousinvestorstatus as long,",
						"          ts_recommendationoffirm as long,",
						"          preferredcontactmethodcode as long,",
						"          accountratingcode as long,",
						"          ts_investorstatus as long,",
						"          ts_capabilitiesoffirm as long,",
						"          mpe_flowlastrunoutcome as long,",
						"          address2_addresstypecode as long,",
						"          address2_shippingmethodcode as long,",
						"          ts_nextoriginationmeetingarranged as long,",
						"          ownershipcode as long,",
						"          territorycode as long,",
						"          ts_investortype as long,",
						"          shippingmethodcode as long,",
						"          ts_investorregion as long,",
						"          address1_freighttermscode as long,",
						"          xpd_function as string,",
						"          ts_quickcaptureuses as string,",
						"          ts_permanentinterim as string,",
						"          ts_quickcapturesectors as string,",
						"          ts_roletypes as string,",
						"          ts_companytype as string,",
						"          xpd_level as string,",
						"          ts_indicativeclientbase as string,",
						"          xpd_specialisms as string,",
						"          xpd_montagulevel as string,",
						"          ts_vendorsummary as string,",
						"          ts_producttype as string,",
						"          ts_montaguoffice as string,",
						"          ts_quickcapturegeography as string,",
						"          xpd_roletypes as string,",
						"          mpe_livedeal as boolean,",
						"          donotbulkpostalmail as boolean,",
						"          donotpostalmail as boolean,",
						"          msdyn_gdproptout as boolean,",
						"          ts_organisationalchange as boolean,",
						"          xpd_publictoprivatetracker as boolean,",
						"          ts_auditor as boolean,",
						"          donotsendmm as boolean,",
						"          donotbulkemail as boolean,",
						"          followemail as boolean,",
						"          creditonhold as boolean,",
						"          marketingonly as boolean,",
						"          participatesinworkflow as boolean,",
						"          merged as boolean,",
						"          ts_validated as boolean,",
						"          xpd_sharepointlocationcreated as boolean,",
						"          xpd_setreminder as boolean,",
						"          ts_personnelchange as boolean,",
						"          donotfax as boolean,",
						"          isprivate as boolean,",
						"          donotphone as boolean,",
						"          xpd_rpo as boolean,",
						"          ts_trackcompany as boolean,",
						"          donotemail as boolean,",
						"          parentaccountid as string,",
						"          parentaccountid_entitytype as string,",
						"          ts_recommendedby as string,",
						"          ts_recommendedby_entitytype as string,",
						"          ts_countryofeconomicoriginforthecapital as string,",
						"          ts_countryofeconomicoriginforthecapital_entitytype as string,",
						"          xpd_reminderto as string,",
						"          xpd_reminderto_entitytype as string,",
						"          preferredserviceid as string,",
						"          preferredserviceid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          createdbyexternalparty as string,",
						"          createdbyexternalparty_entitytype as string,",
						"          ts_validatedby as string,",
						"          ts_validatedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          ts_primarymperelationshipmanager as string,",
						"          ts_primarymperelationshipmanager_entitytype as string,",
						"          modifiedbyexternalparty as string,",
						"          modifiedbyexternalparty_entitytype as string,",
						"          ts_headofficeid as string,",
						"          ts_headofficeid_entitytype as string,",
						"          ts_address1country as string,",
						"          ts_address1country_entitytype as string,",
						"          ts_address1usstate as string,",
						"          ts_address1usstate_entitytype as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          originatingleadid as string,",
						"          originatingleadid_entitytype as string,",
						"          masterid as string,",
						"          masterid_entitytype as string,",
						"          ts_originationlead1 as string,",
						"          ts_originationlead1_entitytype as string,",
						"          defaultpricelevelid as string,",
						"          defaultpricelevelid_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          ts_originationlead2 as string,",
						"          ts_originationlead2_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          mpe_coinvestquestionnaireid as string,",
						"          mpe_coinvestquestionnaireid_entitytype as string,",
						"          ts_hub as string,",
						"          ts_hub_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          ts_currentauditor as string,",
						"          ts_currentauditor_entitytype as string,",
						"          primarycontactid as string,",
						"          primarycontactid_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          preferredsystemuserid as string,",
						"          preferredsystemuserid_entitytype as string,",
						"          preferredequipmentid as string,",
						"          preferredequipmentid_entitytype as string,",
						"          xpd_fund as string,",
						"          xpd_fund_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          territoryid as string,",
						"          territoryid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          xpd_totalinstitutionalcommitments_base as decimal(38,0),",
						"          ts_minimumticketsize_base as decimal(38,4),",
						"          xpd_totalinstitutionalcommitments as decimal(38,0),",
						"          aging30 as decimal(38,0),",
						"          creditlimit as decimal(38,0),",
						"          creditlimit_base as decimal(38,0),",
						"          ts_totalcommitments_base as decimal(38,4),",
						"          aging60 as decimal(38,0),",
						"          ts_transfersin_base as decimal(38,0),",
						"          aging90 as decimal(38,0),",
						"          ts_maximumticketsize as decimal(38,4),",
						"          ts_totalaum_base as decimal(38,0),",
						"          marketcap_base as decimal(38,0),",
						"          aging60_base as decimal(38,0),",
						"          aging90_base as decimal(38,0),",
						"          ts_transfersout as decimal(38,0),",
						"          ts_maximumticketsize_base as decimal(38,4),",
						"          ts_originalcommitments_base as decimal(38,0),",
						"          revenue as decimal(38,0),",
						"          ts_totalcommitments as decimal(38,4),",
						"          ts_transfersout_base as decimal(38,0),",
						"          ts_totalaum as decimal(38,0),",
						"          ts_commitmentreductions_base as decimal(38,0),",
						"          ts_commitmentreductions as decimal(38,0),",
						"          marketcap as decimal(38,0),",
						"          ts_originalcommitments as decimal(38,0),",
						"          ts_minimumticketsize as decimal(38,4),",
						"          revenue_base as decimal(38,0),",
						"          openrevenue_base as decimal(38,0),",
						"          aging30_base as decimal(38,0),",
						"          openrevenue as decimal(38,0),",
						"          ts_transfersin as decimal(38,0),",
						"          ts_othernotes as string,",
						"          ts_transfersin_date as timestamp,",
						"          address1_county as string,",
						"          openrevenue_date as timestamp,",
						"          ts_recommendedbyname as string,",
						"          ts_relationshipinteractioncomments as string,",
						"          ts_originationlead2yominame as string,",
						"          parentaccountidname as string,",
						"          xpd_roletypes_text as string,",
						"          address1_addressid as string,",
						"          importsequencenumber as long,",
						"          address1_longitude as double,",
						"          ts_countryofeconomicoriginforthecapitalname as string,",
						"          entityimageid as string,",
						"          telephone2 as string,",
						"          ts_lastoriginationmeeting as timestamp,",
						"          address2_utcoffset as long,",
						"          address1_upszone as string,",
						"          ts_originalcommitments_state as long,",
						"          ts_typicalcost as string,",
						"          xpd_recommendingportfoliocompaniesrecommended as string,",
						"          accountnumber as string,",
						"          ts_currentauditoryominame as string,",
						"          ts_originalcommitments_date as timestamp,",
						"          lastonholdtime as timestamp,",
						"          ts_sectorscoveredbyfirm as string,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          address2_upszone as string,",
						"          opendeals_state as long,",
						"          xpd_functionuse_text as string,",
						"          slainvokedidname as string,",
						"          address2_longitude as double,",
						"          defaultpricelevelidname as string,",
						"          stockexchange as string,",
						"          mpe_liveofferingscount_date as timestamp,",
						"          xpd_relationshipcomments as string,",
						"          originatingleadidname as string,",
						"          slaname as string,",
						"          ts_currentauditorname as string,",
						"          xpd_remindertoyominame as string,",
						"          ts_address1usstatename as string,",
						"          ts_tempcompanytype as string,",
						"          versionnumber as long,",
						"          address1_latitude as double,",
						"          ts_formername as string,",
						"          yominame as string,",
						"          createdbyyominame as string,",
						"          ts_cityofvisit as string,",
						"          address2_telephone1 as string,",
						"          ts_globalgeographiescoveredids as string,",
						"          preferredserviceidname as string,",
						"          address2_city as string,",
						"          ts_mpeapproachstrategy as string,",
						"          address2_line2 as string,",
						"          ts_lastdatestatuschanged as timestamp,",
						"          li_companyid as long,",
						"          transactioncurrencyidname as string,",
						"          entityimage_url as string,",
						"          xpd_relationshipstatuschangeddate as timestamp,",
						"          createdonbehalfbyname as string,",
						"          mpe_liveofferingscount_state as long,",
						"          xpd_numberofcoinvestinvestments_date as timestamp,",
						"          ts_validateddate as timestamp,",
						"          owneridname as string,",
						"          xpd_generalcomments as string,",
						"          ts_companylegalname as string,",
						"          description as string,",
						"          ts_validatedbyname as string,",
						"          originatingleadidyominame as string,",
						"          opendeals as long,",
						"          xpd_numberofopportunitiesshown_state as long,",
						"          address2_postalcode as string,",
						"          websiteurl as string,",
						"          xpd_fundname as string,",
						"          address1_utcoffset as long,",
						"          exchangerate as decimal(38,10),",
						"          mpe_flowlastrundate as timestamp,",
						"          fax as string,",
						"          address1_line3 as string,",
						"          ts_monthssincelastmeeting as long,",
						"          ts_hubname as string,",
						"          address2_line1 as string,",
						"          ts_capiqticket as string,",
						"          address2_stateorprovince as string,",
						"          address2_name as string,",
						"          ts_transfersout_state as long,",
						"          xpd_numberofopportunitiesshown as long,",
						"          primarytwitterid as string,",
						"          mpe_coinvestquestionnaireidname as string,",
						"          xpd_numberofopportunitiesshown_date as timestamp,",
						"          xpd_preferentialterms as string,",
						"          address1_primarycontactname as string,",
						"          territoryidname as string,",
						"          ts_processstatus as string,",
						"          address1_name as string,",
						"          address2_telephone2 as string,",
						"          address2_telephone3 as string,",
						"          xpd_recruitmentareateam_text as string,",
						"          ftpsiteurl as string,",
						"          address1_postalcode as string,",
						"          ts_companynumber as string,",
						"          createdon as string,",
						"          mpe_liveofferingscount as long,",
						"          traversedpath as string,",
						"          address1_stateorprovince as string,",
						"          ts_transfersin_state as long,",
						"          address2_addressid as string,",
						"          ts_monthlyreviewmeetingname as string,",
						"          primarysatoriid as string,",
						"          telephone3 as string,",
						"          openrevenue_state as long,",
						"          ts_usesprovidedids as string,",
						"          ts_originationcomments as string,",
						"          lastusedincampaign as timestamp,",
						"          primarycontactidname as string,",
						"          ts_originationlead1name as string,",
						"          ts_headofficeidname as string,",
						"          ts_montagucomments as string,",
						"          address2_fax as string,",
						"          createdbyname as string,",
						"          xpd_numberofcoinvestinvestments as long,",
						"          ts_capitaliqlink as string,",
						"          ts_primarymperelationshipmanagername as string,",
						"          mpe_relationshipstatus_text as string,",
						"          xpd_datereminderwasset as timestamp,",
						"          xpd_numberofcoinvestinvestments_state as long,",
						"          address1_postofficebox as string,",
						"          address1_city as string,",
						"          teamsfollowed as long,",
						"          ts_originationlead2name as string,",
						"          timezoneruleversionnumber as long,",
						"          modifiedonbehalfbyyominame as string,",
						"          entityimage_timestamp as long,",
						"          tickersymbol as string,",
						"          ts_theirprogrammecomments as string,",
						"          xpd_companyuse_text as string,",
						"          modifiedbyname as string,",
						"          owneridtype as string,",
						"          sic as string,",
						"          sharesoutstanding as long,",
						"          opendeals_date as timestamp,",
						"          address2_postofficebox as string,",
						"          emailaddress3 as string,",
						"          emailaddress2 as string,",
						"          emailaddress1 as string,",
						"          ts_globalgeographiescoveredbyfirm as string,",
						"          ts_recommendationoffirmupdated as timestamp,",
						"          ts_lastmet as timestamp,",
						"          ts_reminderdatesetto as timestamp,",
						"          ts_commitmentreductions_state as long,",
						"          owningbusinessunitname as string,",
						"          onholdtime as long,",
						"          ts_alias as string,",
						"          createdonbehalfbyyominame as string,",
						"          ts_transfersout_date as timestamp,",
						"          ts_address1countryname as string,",
						"          preferredsystemuseridyominame as string,",
						"          createdbyexternalpartyname as string,",
						"          mpe_documentsetid as string,",
						"          telephone1 as string,",
						"          ts_legacycompanytypes as string,",
						"          ts_validatedbyyominame as string,",
						"          address1_composite as string,",
						"          ts_investorgroupgatekeeperid as string,",
						"          primarycontactidyominame as string,",
						"          address2_country as string,",
						"          xpd_recommendationcomments as string,",
						"          owneridyominame as string,",
						"          createdbyexternalpartyyominame as string,",
						"          ts_originationlead1yominame as string,",
						"          ts_usesprovidedbyfirm as string,",
						"          xpd_recommendingportco as string,",
						"          address1_country as string,",
						"          ts_commitmentreductions_date as timestamp,",
						"          name as string,",
						"          modifiedbyexternalpartyyominame as string,",
						"          xpd_remindertoname as string,",
						"          stageid as string,",
						"          modifiedonbehalfbyname as string,",
						"          masteraccountidname as string,",
						"          timespentbymeonemailandmeetings as string,",
						"          address2_latitude as double,",
						"          overriddencreatedon as timestamp,",
						"          parentaccountidyominame as string,",
						"          ts_specificareaofexpertisecomments as string,",
						"          preferredsystemuseridname as string,",
						"          utcconversiontimezonecode as long,",
						"          address2_county as string,",
						"          address1_line1 as string,",
						"          address2_primarycontactname as string,",
						"          address1_line2 as string,",
						"          xpd_reasonaction as string,",
						"          ts_primarymperelationshipmanageryominame as string,",
						"          processid as string,",
						"          ts_sectorscoveredids as string,",
						"          ts_recommendedbyyominame as string,",
						"          modifiedbyexternalpartyname as string,",
						"          ts_relevantsituations as string,",
						"          accountid as string,",
						"          modifiedon as timestamp,",
						"          preferredequipmentidname as string,",
						"          modifiedbyyominame as string,",
						"          ts_dealstageofmostrecentopportunity as string,",
						"          address2_composite as string,",
						"          masteraccountidyominame as string,",
						"          numberofemployees as long,",
						"          address1_fax as string,",
						"          address2_line3 as string,",
						"          msdyn_segmentid as string,",
						"          msdyn_segmentid_entitytype as string,",
						"          msdyn_segmentidname as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'account') ~> AccountIn",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          ts_dealannouncedreason as long,",
						"          ts_highprioritynew as long,",
						"          ts_actionstatus as long,",
						"          mpe_targetrelationshipstatus as long,",
						"          ts_producttype as long,",
						"          ts_internalintermediarysource as long,",
						"          mpe_flowlastrunoutcome as long,",
						"          ts_currentactivity as long,",
						"          ts_opportunitystatus as long,",
						"          ts_montaguprimaryoffice as long,",
						"          ts_opportunitytype as long,",
						"          ts_posthumstatus as long,",
						"          ts_meetingremindermonths as long,",
						"          ts_choppedreason as string,",
						"          ts_setreminder as boolean,",
						"          ts_stagereachedfir as boolean,",
						"          ts_stagereachedipr as boolean,",
						"          ts_duplicateopportunityfordiscussion as boolean,",
						"          mpe_smalltarget as boolean,",
						"          ts_stagereachedcr as boolean,",
						"          xpd_includeonallpapers as boolean,",
						"          ts_sold as boolean,",
						"          xpd_sharepointlocationcreated as boolean,",
						"          ts_statuschangedby as string,",
						"          ts_statuschangedby_entitytype as string,",
						"          ts_buyer as string,",
						"          ts_buyer_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          ts_reminderto as string,",
						"          ts_reminderto_entitytype as string,",
						"          mpe_productid as string,",
						"          mpe_productid_entitytype as string,",
						"          ts_targetbusiness as string,",
						"          ts_targetbusiness_entitytype as string,",
						"          ts_firstreferralcompany as string,",
						"          ts_firstreferralcompany_entitytype as string,",
						"          ts_deallead as string,",
						"          ts_deallead_entitytype as string,",
						"          ts_montaguowner as string,",
						"          ts_montaguowner_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          ts_firstreferralcontact as string,",
						"          ts_firstreferralcontact_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ts_managerwedback as string,",
						"          ts_managerwedback_entitytype as string,",
						"          ts_country as string,",
						"          ts_country_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          ts_sellmandate as string,",
						"          ts_sellmandate_entitytype as string,",
						"          ts_estebitda_base as decimal(38,4),",
						"          ts_estebit_base as decimal(38,4),",
						"          ts_estebitda as decimal(38,4),",
						"          ts_estebit as decimal(38,4),",
						"          ts_estturnover_base as decimal(38,4),",
						"          ts_estdealsize as decimal(38,4),",
						"          ts_estdealsize_base as decimal(38,4),",
						"          ts_estturnover as decimal(38,4),",
						"          ts_buyeryominame as string,",
						"          modifiedon as timestamp,",
						"          ts_statuschangedbyname as string,",
						"          ts_managerwedbackyominame as string,",
						"          xpd_montaguprojectname as string,",
						"          transactioncurrencyidname as string,",
						"          ts_nextsteps as string,",
						"          ts_montaguowneryominame as string,",
						"          ts_firstreferralcontactname as string,",
						"          ts_opportunitydescription as string,",
						"          ts_buyerpaidxltmebitda as decimal(38,1),",
						"          ts_targetbusinessyominame as string,",
						"          ts_montaguownername as string,",
						"          ts_managerwedbackname as string,",
						"          ts_opportunitystage as string,",
						"          ts_otherdocumentsurl as string,",
						"          exchangerate as decimal(38,10),",
						"          mpe_documentsetid as string,",
						"          ts_buyername as string,",
						"          ts_firstreferralcontactyominame as string,",
						"          createdon as string,",
						"          ts_sellmandateyominame as string,",
						"          mpe_montaguprimaryofficestring as string,",
						"          ts_statuschangedbyyominame as string,",
						"          ts_firstreferralcompanyname as string,",
						"          owneridyominame as string,",
						"          ts_choppedcomments as string,",
						"          timezoneruleversionnumber as long,",
						"          createdbyname as string,",
						"          ts_dealleadname as string,",
						"          owningbusinessunitname as string,",
						"          ts_dealleadyominame as string,",
						"          ts_lastdatestatuschanged as timestamp,",
						"          traversedpath as string,",
						"          overriddencreatedon as timestamp,",
						"          ts_iprdocumenturl as string,",
						"          createdonbehalfbyname as string,",
						"          ts_sellmandatename as string,",
						"          owneridtype as string,",
						"          owneridname as string,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          mpe_productidname as string,",
						"          ts_originationopportunityid as string,",
						"          ts_crdocumenturl as string,",
						"          ts_datedealannounced as timestamp,",
						"          processid as string,",
						"          mpe_montaguprimaryofficeowner as string,",
						"          ts_reason as string,",
						"          ts_targetbusinessname as string,",
						"          ts_remindertoname as string,",
						"          ts_postcompletionnoteurl as string,",
						"          ts_name as string,",
						"          stageid as string,",
						"          ts_currentopportunitystatus as string,",
						"          ts_firstreferralcompanyyominame as string,",
						"          mpe_flowlastrundate as timestamp,",
						"          ts_firdocumenturl as string,",
						"          modifiedbyyominame as string,",
						"          modifiedonbehalfbyyominame as string,",
						"          ts_movedoutofwipdate as timestamp,",
						"          ts_equitychequesize as decimal(38,2),",
						"          utcconversiontimezonecode as long,",
						"          ts_weofferedxltmebitda as decimal(38,1),",
						"          importsequencenumber as long,",
						"          ts_remindertoyominame as string,",
						"          ts_companyid as long,",
						"          ts_datereminderwasset as timestamp,",
						"          versionnumber as long,",
						"          ts_originationid as long,",
						"          ts_countryname as string,",
						"          ts_choppeddate as timestamp,",
						"          mpe_posthunstatustext as string,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          ts_humdate as timestamp,",
						"          ts_sellmandateidtype as string,",
						"          ts_dateofreminder as timestamp,",
						"          ts_humurl as string,",
						"          mpe_carveout as long,",
						"          mpe_targetbusiness_parentid as string,",
						"          mpe_targetbusiness_parentid_entitytype as string,",
						"          mpe_targetbusiness_parentidyominame as string,",
						"          mpe_targetbusiness_parentidname as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'ts_originationopportunity') ~> OriginationOpportunityIn",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          ts_stageofmeetingrounds as long,",
						"          ts_talentmeetingtype as long,",
						"          instancetypecode as long,",
						"          ts_whooriginatedthemeeting as long,",
						"          onlinemeetingtype as long,",
						"          ts_meetingteam as long,",
						"          ts_othermeetingmethod as long,",
						"          ts_tone as long,",
						"          ts_meetingmethod as long,",
						"          ts_originationmeetingtype as long,",
						"          prioritycode as long,",
						"          attachmenterrors as long,",
						"          ts_eventtype as long,",
						"          ts_talentmeetingmethod as long,",
						"          ts_productsdiscussed as string,",
						"          ts_contentcovered as string,",
						"          isonlinemeeting as boolean,",
						"          isworkflowcreated as boolean,",
						"          isalldayevent as boolean,",
						"          ts_interview as boolean,",
						"          isbilled as boolean,",
						"          isdraft as boolean,",
						"          ts_keyiractivity as boolean,",
						"          ts_noninvestor as boolean,",
						"          ismapiprivate as boolean,",
						"          isregularactivity as boolean,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          ts_investorgroup as string,",
						"          ts_investorgroup_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          regardingobjectid as string,",
						"          regardingobjectid_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ts_officemet as string,",
						"          ts_officemet_entitytype as string,",
						"          ts_taskowner as string,",
						"          ts_taskowner_entitytype as string,",
						"          serviceid as string,",
						"          serviceid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          requiredattendees as string,",
						"          optionalattendees as string,",
						"          organizer as string,",
						"          scheduledend as timestamp,",
						"          ts_taskdescription as string,",
						"          modifiedon as timestamp,",
						"          ts_purpose as string,",
						"          overriddencreatedon as timestamp,",
						"          ts_taskownername as string,",
						"          activityadditionalparams as string,",
						"          ts_tonepersonalities as string,",
						"          seriesid as string,",
						"          transactioncurrencyidname as string,",
						"          activityid as string,",
						"          modifiedfieldsmask as string,",
						"          utcconversiontimezonecode as long,",
						"          ts_officemetname as string,",
						"          scheduledstart as timestamp,",
						"          outlookownerapptid as long,",
						"          ts_topicscovered as string,",
						"          ts_objective as string,",
						"          onholdtime as long,",
						"          onlinemeetingjoinurl as string,",
						"          ts_notes as string,",
						"          originalstartdate as timestamp,",
						"          ts_opportunitiesdiscussed as string,",
						"          ts_sectorscoveredbyfirm as string,",
						"          attachmentcount as long,",
						"          exchangerate as decimal(38,10),",
						"          ts_originationcommentsnotes as string,",
						"          category as string,",
						"          createdon as string,",
						"          ts_eventdescription as string,",
						"          globalobjectid as string,",
						"          onlinemeetingid as string,",
						"          serviceidname as string,",
						"          owneridyominame as string,",
						"          description as string,",
						"          subcategory as string,",
						"          owningbusinessunitname as string,",
						"          ts_taskduedate as timestamp,",
						"          traversedpath as string,",
						"          sortdate as timestamp,",
						"          createdonbehalfbyname as string,",
						"          ts_sectorscoveredids as string,",
						"          safedescription as string,",
						"          ts_taskowneryominame as string,",
						"          owneridtype as string,",
						"          isunsafe as long,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          ts_conferencename as string,",
						"          timezoneruleversionnumber as long,",
						"          actualend as timestamp,",
						"          regardingobjectidname as string,",
						"          processid as string,",
						"          activitytypecode as string,",
						"          actualstart as timestamp,",
						"          xpd_listofexternalattendees as string,",
						"          slainvokedidname as string,",
						"          location as string,",
						"          subject as string,",
						"          createdbyname as string,",
						"          actualdurationminutes as long,",
						"          modifiedbyyominame as string,",
						"          lastonholdtime as timestamp,",
						"          modifiedonbehalfbyyominame as string,",
						"          ts_attendeestoaddtocrm as string,",
						"          regardingobjectidyominame as string,",
						"          regardingobjecttypecode as string,",
						"          stageid as string,",
						"          scheduleddurationminutes as long,",
						"          ts_sourceid as string,",
						"          ts_investorgroupyominame as string,",
						"          importsequencenumber as long,",
						"          subscriptionid as string,",
						"          onlinemeetingchatid as string,",
						"          ts_lpupdates as string,",
						"          ts_executivesummary as string,",
						"          ts_investorgroupname as string,",
						"          ts_meetingcity as string,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          owneridname as string,",
						"          ts_theirprogramme as string,",
						"          ts_ifdeclinedreason as string,",
						"          slaname as string,",
						"          versionnumber as long",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'appointment') ~> MeetingsAppointmentsIn",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          haschildrencode as long,",
						"          customertypecode as long,",
						"          ts_recommendationofindividual as long,",
						"          gendercode as long,",
						"          address1_addresstypecode as long,",
						"          leadsourcecode as long,",
						"          preferredappointmenttimecode as long,",
						"          address2_freighttermscode as long,",
						"          address2_shippingmethodcode as long,",
						"          ts_debtsubtype as long,",
						"          msdyn_orgchangestatus as long,",
						"          ts_suffix as long,",
						"          xpd_gender as long,",
						"          ts_title as long,",
						"          paymenttermscode as long,",
						"          accountrolecode as long,",
						"          territorycode as long,",
						"          ts_vendortargettrackingrole as long,",
						"          address3_freighttermscode as long,",
						"          address1_shippingmethodcode as long,",
						"          preferredappointmentdaycode as long,",
						"          customersizecode as long,",
						"          preferredcontactmethodcode as long,",
						"          ts_futurecontactmethod as long,",
						"          address3_shippingmethodcode as long,",
						"          address2_addresstypecode as long,",
						"          mpe_flowlastrunoutcome as long,",
						"          ts_capabilitiesofindividual as long,",
						"          address3_addresstypecode as long,",
						"          familystatuscode as long,",
						"          shippingmethodcode as long,",
						"          xpd_availability as long,",
						"          educationcode as long,",
						"          address1_freighttermscode as long,",
						"          ts_quickcaptureuses as string,",
						"          xpd_montagulevel as string,",
						"          ts_permanentinterim as string,",
						"          ts_ircontactrole as string,",
						"          xpd_level as string,",
						"          ts_languagesspokenwritten as string,",
						"          ts_contacttype as string,",
						"          ts_montaguoffice as string,",
						"          ts_roletypes as string,",
						"          xpd_specialisms as string,",
						"          ts_quickcapturesectors as string,",
						"          xpd_function as string,",
						"          ts_producttype as string,",
						"          ts_quickcapturegeography as string,",
						"          ts_productsinterestedin as string,",
						"          ts_potentialrolecandidate as boolean,",
						"          isbackofficecustomer as boolean,",
						"          donotpostalmail as boolean,",
						"          xpd_addcontacttooutlook as boolean,",
						"          ts_centralrelationshipmanager as boolean,",
						"          msdyn_gdproptout as boolean,",
						"          xpd_hascompany as boolean,",
						"          creditonhold as boolean,",
						"          xpd_benchcandidate as boolean,",
						"          donotbulkpostalmail as boolean,",
						"          donotsendmm as boolean,",
						"          donotbulkemail as boolean,",
						"          followemail as boolean,",
						"          xpd_sharepointdocumentlocationcreated as boolean,",
						"          xpd_available as boolean,",
						"          ts_leadearlystageinteraction as boolean,",
						"          participatesinworkflow as boolean,",
						"          ts_doyouwishtotrackthiscontact as boolean,",
						"          merged as boolean,",
						"          ts_validated as boolean,",
						"          marketingonly as boolean,",
						"          donotfax as boolean,",
						"          isprivate as boolean,",
						"          donotphone as boolean,",
						"          isautocreate as boolean,",
						"          donotemail as boolean,",
						"          ts_unconfirmedemailaddress as boolean,",
						"          preferredsystemuserid as string,",
						"          preferredsystemuserid_entitytype as string,",
						"          mpe_accountid as string,",
						"          mpe_accountid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          ts_recommendedby as string,",
						"          ts_recommendedby_entitytype as string,",
						"          ts_previousemployerid as string,",
						"          ts_previousemployerid_entitytype as string,",
						"          preferredserviceid as string,",
						"          preferredserviceid_entitytype as string,",
						"          parentcontactid as string,",
						"          parentcontactid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          ts_pa as string,",
						"          ts_pa_entitytype as string,",
						"          ts_businessaddress as string,",
						"          ts_businessaddress_entitytype as string,",
						"          modifiedbyexternalparty as string,",
						"          modifiedbyexternalparty_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          originatingleadid as string,",
						"          originatingleadid_entitytype as string,",
						"          masterid as string,",
						"          masterid_entitytype as string,",
						"          defaultpricelevelid as string,",
						"          defaultpricelevelid_entitytype as string,",
						"          parent_contactid as string,",
						"          parent_contactid_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          createdbyexternalparty as string,",
						"          createdbyexternalparty_entitytype as string,",
						"          preferredequipmentid as string,",
						"          preferredequipmentid_entitytype as string,",
						"          xpd_referredbyinternal as string,",
						"          xpd_referredbyinternal_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          xpd_homecountry as string,",
						"          xpd_homecountry_entitytype as string,",
						"          ts_placementfirmintroducedby as string,",
						"          ts_placementfirmintroducedby_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          accountid as string,",
						"          accountid_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          parentcustomerid as string,",
						"          parentcustomerid_entitytype as string,",
						"          xpd_referredbyexternal as string,",
						"          xpd_referredbyexternal_entitytype as string,",
						"          aging30 as decimal(38,2),",
						"          creditlimit_base as decimal(38,4),",
						"          aging60 as decimal(38,2),",
						"          aging90 as decimal(38,2),",
						"          aging60_base as decimal(38,4),",
						"          aging90_base as decimal(38,4),",
						"          annualincome_base as decimal(38,4),",
						"          creditlimit as decimal(38,2),",
						"          annualincome as decimal(38,2),",
						"          aging30_base as decimal(38,4),",
						"          ts_othernotes as string,",
						"          xpd_referredbyinternalyominame as string,",
						"          address1_county as string,",
						"          yomilastname as string,",
						"          address3_utcoffset as long,",
						"          ts_recommendedbyname as string,",
						"          description as string,",
						"          li_membertoken as string,",
						"          department as string,",
						"          xpd_roletypes_text as string,",
						"          address1_addressid as string,",
						"          importsequencenumber as long,",
						"          address1_longitude as double,",
						"          address3_fax as string,",
						"          managername as string,",
						"          entityimageid as string,",
						"          telephone2 as string,",
						"          parentcustomeridtype as string,",
						"          address2_upszone as string,",
						"          address1_upszone as string,",
						"          xpd_recommendingportfoliocompaniesrecommended as string,",
						"          lastonholdtime as timestamp,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          address1_fax as string,",
						"          address3_telephone1 as string,",
						"          address3_telephone2 as string,",
						"          address3_telephone3 as string,",
						"          fax as string,",
						"          assistantname as string,",
						"          address2_line3 as string,",
						"          accountidyominame as string,",
						"          parentcontactidyominame as string,",
						"          mpe_accountidyominame as string,",
						"          slainvokedidname as string,",
						"          defaultpricelevelidname as string,",
						"          fullname as string,",
						"          address2_longitude as double,",
						"          subscriptionid as string,",
						"          originatingleadidname as string,",
						"          slaname as string,",
						"          versionnumber as long,",
						"          address1_latitude as double,",
						"          createdbyyominame as string,",
						"          parent_contactidname as string,",
						"          address2_telephone1 as string,",
						"          pager as string,",
						"          salutation as string,",
						"          mpe_accountidname as string,",
						"          xpd_functionuse_text as string,",
						"          accountidname as string,",
						"          mpe_companysummary as string,",
						"          parent_contactidyominame as string,",
						"          preferredserviceidname as string,",
						"          address2_city as string,",
						"          address3_postalcode as string,",
						"          address2_line2 as string,",
						"          li_companyid as long,",
						"          ts_otherphonelabel as string,",
						"          ts_reportingemail as string,",
						"          address3_upszone as string,",
						"          transactioncurrencyidname as string,",
						"          address3_county as string,",
						"          entityimage_url as string,",
						"          governmentid as string,",
						"          callback as string,",
						"          business2 as string,",
						"          createdonbehalfbyname as string,",
						"          ts_validateddate as timestamp,",
						"          address2_telephone2 as string,",
						"          owneridname as string,",
						"          originatingleadidyominame as string,",
						"          ts_otherlanguages as string,",
						"          address2_postalcode as string,",
						"          birthdate as timestamp,",
						"          parentcontactidname as string,",
						"          spousesname as string,",
						"          xpd_compensationdate as timestamp,",
						"          address1_utcoffset as long,",
						"          address3_line1 as string,",
						"          traversedpath as string,",
						"          exchangerate as decimal(38,10),",
						"          mpe_flowlastrundate as timestamp,",
						"          address1_line3 as string,",
						"          address3_country as string,",
						"          mpe_documentsetid as string,",
						"          address2_line1 as string,",
						"          ts_previousemployeridyominame as string,",
						"          middlename as string,",
						"          managerphone as string,",
						"          address2_stateorprovince as string,",
						"          childrensnames as string,",
						"          address2_name as string,",
						"          address3_addressid as string,",
						"          address3_stateorprovince as string,",
						"          ts_sectorspecialtyids as string,",
						"          businesscardattributes as string,",
						"          anniversary as timestamp,",
						"          ts_employmentstartdate as timestamp,",
						"          ts_legacycontacttypes as string,",
						"          address1_primarycontactname as string,",
						"          address2_utcoffset as long,",
						"          home2 as string,",
						"          ts_geographicspecialtyids as string,",
						"          address1_name as string,",
						"          ts_recommendationcomments as string,",
						"          address2_telephone3 as string,",
						"          address3_primarycontactname as string,",
						"          ftpsiteurl as string,",
						"          address1_postalcode as string,",
						"          createdon as string,",
						"          address1_stateorprovince as string,",
						"          yomimiddlename as string,",
						"          jobtitle as string,",
						"          telephone3 as string,",
						"          ts_usesspeciality as string,",
						"          ts_knowntouserinitials as string,",
						"          address2_fax as string,",
						"          createdbyname as string,",
						"          xpd_contactuse_text as string,",
						"          ts_sourceid as string,",
						"          address2_addressid as string,",
						"          employeeid as string,",
						"          address1_postofficebox as string,",
						"          address1_city as string,",
						"          ts_businessaddressname as string,",
						"          teamsfollowed as long,",
						"          ts_cv as string,",
						"          timezoneruleversionnumber as long,",
						"          modifiedonbehalfbyyominame as string,",
						"          xpd_hrcompensation as string,",
						"          ts_currentbonusandorupliftconsiderations as string,",
						"          modifiedbyname as string,",
						"          address3_line2 as string,",
						"          yomifullname as string,",
						"          owneridtype as string,",
						"          entityimage_timestamp as long,",
						"          ts_placementfirmintroducedbyyominame as string,",
						"          xpd_previousrole as string,",
						"          ts_compensation as string,",
						"          address2_postofficebox as string,",
						"          emailaddress3 as string,",
						"          emailaddress2 as string,",
						"          emailaddress1 as string,",
						"          ts_interactioncontactuniqueidentifier as string,",
						"          ts_investmentcafeid as string,",
						"          websiteurl as string,",
						"          nickname as string,",
						"          ts_lastmet as timestamp,",
						"          address3_name as string,",
						"          ts_usesspecialtyids as string,",
						"          ts_linkedinurl as string,",
						"          lastname as string,",
						"          address3_longitude as double,",
						"          xpd_referredbyexternalidtype as string,",
						"          parentcustomeridname as string,",
						"          owningbusinessunitname as string,",
						"          onholdtime as long,",
						"          createdonbehalfbyyominame as string,",
						"          preferredsystemuseridyominame as string,",
						"          createdbyexternalpartyname as string,",
						"          ts_tone as string,",
						"          telephone1 as string,",
						"          overriddencreatedon as timestamp,",
						"          address3_postofficebox as string,",
						"          assistantphone as string,",
						"          address1_composite as string,",
						"          address3_line3 as string,",
						"          address2_country as string,",
						"          xpd_referredbyinternalname as string,",
						"          mobilephone as string,",
						"          owneridyominame as string,",
						"          address1_line1 as string,",
						"          createdbyexternalpartyyominame as string,",
						"          xpd_referredbyexternalyominame as string,",
						"          yomifirstname as string,",
						"          mastercontactidname as string,",
						"          address3_city as string,",
						"          address1_country as string,",
						"          externaluseridentifier as string,",
						"          modifiedbyexternalpartyyominame as string,",
						"          firstname as string,",
						"          xpd_hrcurrentbonusandorupliftconsiderations as string,",
						"          stageid as string,",
						"          modifiedonbehalfbyname as string,",
						"          xpd_homecountryname as string,",
						"          mastercontactidyominame as string,",
						"          suffix as string,",
						"          ts_payominame as string,",
						"          lastusedincampaign as timestamp,",
						"          ts_geographicspeciality as string,",
						"          xpd_recruitmentareateam_text as string,",
						"          ts_retentionreviewdate as timestamp,",
						"          parentcustomeridyominame as string,",
						"          timespentbymeonemailandmeetings as string,",
						"          address2_latitude as double,",
						"          xpd_availablefrom as timestamp,",
						"          address3_composite as string,",
						"          xpd_recommendingportco as string,",
						"          preferredsystemuseridname as string,",
						"          utcconversiontimezonecode as long,",
						"          address2_county as string,",
						"          ts_paname as string,",
						"          contactid as string,",
						"          address2_primarycontactname as string,",
						"          ts_specificareasofexpertisecomments as string,",
						"          address1_line2 as string,",
						"          ts_recommendationofindividualupdated as timestamp,",
						"          xpd_referredbyexternalname as string,",
						"          ts_placementfirmintroducedbyname as string,",
						"          ts_sectorspeciality as string,",
						"          ts_previousemployeridname as string,",
						"          processid as string,",
						"          ts_recommendedbyyominame as string,",
						"          modifiedon as timestamp,",
						"          modifiedbyexternalpartyname as string,",
						"          ts_relevantsituations as string,",
						"          businesscard as string,",
						"          company as string,",
						"          preferredequipmentidname as string,",
						"          modifiedbyyominame as string,",
						"          ts_preferredname as string,",
						"          address2_composite as string,",
						"          numberofchildren as long,",
						"          address3_latitude as double,",
						"          mpe_companysearchbyemail as boolean,",
						"          msdyn_segmentid as string,",
						"          msdyn_segmentid_entitytype as string,",
						"          msdyn_segmentidname as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'contact') ~> ContactsIn",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          address1_addresstypecode as long,",
						"          address1_shippingmethodcode as long,",
						"          azurestate as long,",
						"          invitestatuscode as long,",
						"          preferredaddresscode as long,",
						"          preferredemailcode as long,",
						"          outgoingemaildeliverymethod as long,",
						"          preferredphonecode as long,",
						"          emailrouteraccessapproval as long,",
						"          deletedstate as long,",
						"          incomingemaildeliverymethod as long,",
						"          accessmode as long,",
						"          caltype as long,",
						"          address2_addresstypecode as long,",
						"          address2_shippingmethodcode as long,",
						"          setupuser as boolean,",
						"          islicensed as boolean,",
						"          defaultfilterspopulated as boolean,",
						"          isactivedirectoryuser as boolean,",
						"          displayinserviceviews as boolean,",
						"          msdyn_gdproptout as boolean,",
						"          isdisabled as boolean,",
						"          isintegrationuser as boolean,",
						"          isemailaddressapprovedbyo365admin as boolean,",
						"          issyncwithdirectory as boolean,",
						"          calendarid as string,",
						"          calendarid_entitytype as string,",
						"          mobileofflineprofileid as string,",
						"          mobileofflineprofileid_entitytype as string,",
						"          queueid as string,",
						"          queueid_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          territoryid as string,",
						"          territoryid_entitytype as string,",
						"          defaultmailbox as string,",
						"          defaultmailbox_entitytype as string,",
						"          positionid as string,",
						"          positionid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          siteid as string,",
						"          siteid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          parentsystemuserid as string,",
						"          parentsystemuserid_entitytype as string,",
						"          businessunitid as string,",
						"          businessunitid_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          traversedpath as string,",
						"          azureactivedirectoryobjectid as string,",
						"          address1_line1 as string,",
						"          internalemailaddress as string,",
						"          siteidname as string,",
						"          modifiedon as timestamp,",
						"          address1_line3 as string,",
						"          skills as string,",
						"          yomifirstname as string,",
						"          address1_longitude as double,",
						"          yomifullname as string,",
						"          entityimage_timestamp as long,",
						"          parentsystemuseridname as string,",
						"          address2_county as string,",
						"          transactioncurrencyidname as string,",
						"          activedirectoryguid as string,",
						"          utcconversiontimezonecode as long,",
						"          passporthi as long,",
						"          homephone as string,",
						"          parentsystemuseridyominame as string,",
						"          address2_stateorprovince as string,",
						"          mobilephone as string,",
						"          address2_country as string,",
						"          address2_line2 as string,",
						"          disabledreason as string,",
						"          lastname as string,",
						"          address1_city as string,",
						"          address1_utcoffset as long,",
						"          userlicensetype as long,",
						"          nickname as string,",
						"          passportlo as long,",
						"          title as string,",
						"          address2_latitude as double,",
						"          applicationid as string,",
						"          address1_composite as string,",
						"          firstname as string,",
						"          address2_postalcode as string,",
						"          employeeid as string,",
						"          processid as string,",
						"          mobileofflineprofileidname as string,",
						"          governmentid as string,",
						"          entityimage_url as string,",
						"          address2_line3 as string,",
						"          azuredeletedon as timestamp,",
						"          timezoneruleversionnumber as long,",
						"          address1_county as string,",
						"          address2_telephone2 as string,",
						"          address2_postofficebox as string,",
						"          address2_telephone1 as string,",
						"          yomilastname as string,",
						"          address2_telephone3 as string,",
						"          address1_addressid as string,",
						"          territoryidname as string,",
						"          overriddencreatedon as timestamp,",
						"          userpuid as string,",
						"          createdonbehalfbyname as string,",
						"          systemuserid as string,",
						"          address2_name as string,",
						"          middlename as string,",
						"          entityimageid as string,",
						"          applicationiduri as string,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          address2_composite as string,",
						"          address1_country as string,",
						"          mobilealertemail as string,",
						"          sharepointemailaddress as string,",
						"          businessunitidname as string,",
						"          address1_stateorprovince as string,",
						"          exchangerate as decimal(38,10),",
						"          jobtitle as string,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          latestupdatetime as timestamp,",
						"          address1_postofficebox as string,",
						"          organizationid as string,",
						"          yammeremailaddress as string,",
						"          defaultmailboxname as string,",
						"          identityid as long,",
						"          yomimiddlename as string,",
						"          address2_utcoffset as long,",
						"          photourl as string,",
						"          personalemailaddress as string,",
						"          address2_addressid as string,",
						"          address2_longitude as double,",
						"          createdon as string,",
						"          createdbyname as string,",
						"          domainname as string,",
						"          modifiedbyyominame as string,",
						"          address2_fax as string,",
						"          address1_line2 as string,",
						"          modifiedonbehalfbyyominame as string,",
						"          address2_upszone as string,",
						"          salutation as string,",
						"          address1_postalcode as string,",
						"          stageid as string,",
						"          defaultodbfoldername as string,",
						"          positionidname as string,",
						"          ts_inititals as string,",
						"          yammeruserid as string,",
						"          importsequencenumber as long,",
						"          address2_city as string,",
						"          windowsliveid as string,",
						"          organizationidname as string,",
						"          versionnumber as long,",
						"          queueidname as string,",
						"          address1_name as string,",
						"          address1_fax as string,",
						"          address1_latitude as double,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          address2_line1 as string,",
						"          address1_upszone as string,",
						"          fullname as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'systemuser') ~> SystemuserSource",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          organizationid as string,",
						"          organizationid_entitytype as string,",
						"          createdonbehalfbyyominame as string,",
						"          gap_language as long,",
						"          importsequencenumber as long,",
						"          organizationidname as string,",
						"          utcconversiontimezonecode as long,",
						"          createdbyyominame as string,",
						"          gap_entityname as string,",
						"          modifiedbyname as string,",
						"          versionnumber as long,",
						"          modifiedbyyominame as string,",
						"          timezoneruleversionnumber as long,",
						"          gap_entityschemaname as string,",
						"          modifiedon as timestamp,",
						"          gap_powerbioptionsetrefid as string,",
						"          gap_optionsetschemaname as string,",
						"          modifiedonbehalfbyyominame as string,",
						"          createdbyname as string,",
						"          createdon as string,",
						"          gap_value as long,",
						"          createdonbehalfbyname as string,",
						"          modifiedonbehalfbyname as string,",
						"          gap_label as string,",
						"          overriddencreatedon as timestamp,",
						"          gap_imageurl as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     limit: 100,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'gap_powerbioptionsetref') ~> OptionsetSource",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          stateAZlabel as string,",
						"          statusAZlabel as string,",
						"          ts_primarysecondaryfocus as string,",
						"          customertypeAZlabel as string,",
						"          address1_addresstypeAZlabel as string,",
						"          accountclassificationAZlabel as string,",
						"          ts_easeofworking as string,",
						"          ts_ukrow as string,",
						"          preferredappointmenttimeAZlabel as string,",
						"          ts_address1addresstype as string,",
						"          xpd_relationshipstatus as string,",
						"          ts_relationship as string,",
						"          xpd_remindermonths as string,",
						"          ts_importance as string,",
						"          address2_freighttermsAZlabel as string,",
						"          ts_irrvsmomperformancemeasure as string,",
						"          ts_introducertype as string,",
						"          accountcategoryAZlabel as string,",
						"          paymenttermsAZlabel as string,",
						"          preferredappointmentdayAZlabel as string,",
						"          businesstypeAZlabel as string,",
						"          industryAZlabel as string,",
						"          ts_sizeoffirm as string,",
						"          ts_interaction as string,",
						"          address1_shippingmethodAZlabel as string,",
						"          ts_portfoliocompanystatus as string,",
						"          customersizeAZlabel as string,",
						"          xpd_previousinvestorstatus as string,",
						"          ts_recommendationoffirm as string,",
						"          preferredcontactmethodAZlabel as string,",
						"          accountratingAZlabel as string,",
						"          ts_investorstatus as string,",
						"          ts_capabilitiesoffirm as string,",
						"          mpe_flowlastrunoutcome as string,",
						"          address2_addresstypeAZlabel as string,",
						"          address2_shippingmethodAZlabel as string,",
						"          ts_nextoriginationmeetingarranged as string,",
						"          ownershipAZlabel as string,",
						"          territoryAZlabel as string,",
						"          ts_investortype as string,",
						"          shippingmethodAZlabel as string,",
						"          ts_investorregion as string,",
						"          address1_freighttermsAZlabel as string,",
						"          xpd_function as string,",
						"          ts_quickcaptureuses as string,",
						"          xpd_montagulevel as string,",
						"          ts_permanentinterim as string,",
						"          ts_quickcapturesectors as string,",
						"          ts_roletypes as string,",
						"          ts_companytype as string,",
						"          xpd_level as string,",
						"          ts_indicativeclientbase as string,",
						"          xpd_specialisms as string,",
						"          ts_vendorsummary as string,",
						"          ts_producttype as string,",
						"          ts_montaguoffice as string,",
						"          ts_quickcapturegeography as string,",
						"          xpd_roletypes as string,",
						"          mpe_livedeal as string,",
						"          donotbulkpostalmail as string,",
						"          donotpostalmail as string,",
						"          msdyn_gdproptout as string,",
						"          ts_organisationalchange as string,",
						"          xpd_publictoprivatetracker as string,",
						"          ts_auditor as string,",
						"          donotsendmm as string,",
						"          donotbulkemail as string,",
						"          followemail as string,",
						"          creditonhold as string,",
						"          marketingonly as string,",
						"          participatesinworkflow as string,",
						"          merged as string,",
						"          ts_validated as string,",
						"          xpd_sharepointlocationcreated as string,",
						"          xpd_setreminder as string,",
						"          ts_personnelchange as string,",
						"          donotfax as string,",
						"          isprivate as string,",
						"          donotphone as string,",
						"          xpd_rpo as string,",
						"          ts_trackcompany as string,",
						"          donotemail as string,",
						"          parentaccountid as string,",
						"          parentaccountid_entitytype as string,",
						"          ts_recommendedby as string,",
						"          ts_recommendedby_entitytype as string,",
						"          ts_countryofeconomicoriginforthecapital as string,",
						"          ts_countryofeconomicoriginforthecapital_entitytype as string,",
						"          xpd_reminderto as string,",
						"          xpd_reminderto_entitytype as string,",
						"          preferredserviceid as string,",
						"          preferredserviceid_entitytype as string,",
						"          msdyn_segmentid as string,",
						"          msdyn_segmentid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          createdbyexternalparty as string,",
						"          createdbyexternalparty_entitytype as string,",
						"          ts_validatedby as string,",
						"          ts_validatedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          ts_primarymperelationshipmanager as string,",
						"          ts_primarymperelationshipmanager_entitytype as string,",
						"          modifiedbyexternalparty as string,",
						"          modifiedbyexternalparty_entitytype as string,",
						"          ts_headofficeid as string,",
						"          ts_headofficeid_entitytype as string,",
						"          ts_address1country as string,",
						"          ts_address1country_entitytype as string,",
						"          ts_address1usstate as string,",
						"          ts_address1usstate_entitytype as string,",
						"          msdyn_salesaccelerationinsightid as string,",
						"          msdyn_salesaccelerationinsightid_entitytype as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          originatingleadid as string,",
						"          originatingleadid_entitytype as string,",
						"          masterid as string,",
						"          masterid_entitytype as string,",
						"          ts_originationlead1 as string,",
						"          ts_originationlead1_entitytype as string,",
						"          defaultpricelevelid as string,",
						"          defaultpricelevelid_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          ts_originationlead2 as string,",
						"          ts_originationlead2_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          mpe_coinvestquestionnaireid as string,",
						"          mpe_coinvestquestionnaireid_entitytype as string,",
						"          ts_hub as string,",
						"          ts_hub_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          ts_currentauditor as string,",
						"          ts_currentauditor_entitytype as string,",
						"          primarycontactid as string,",
						"          primarycontactid_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          preferredsystemuserid as string,",
						"          preferredsystemuserid_entitytype as string,",
						"          preferredequipmentid as string,",
						"          preferredequipmentid_entitytype as string,",
						"          xpd_fund as string,",
						"          xpd_fund_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          territoryid as string,",
						"          territoryid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          xpd_totalinstitutionalcommitments_base as decimal(38,0),",
						"          ts_minimumticketsize_base as decimal(38,4),",
						"          xpd_totalinstitutionalcommitments as decimal(38,0),",
						"          aging30 as decimal(38,0),",
						"          creditlimit as decimal(38,0),",
						"          creditlimit_base as decimal(38,0),",
						"          ts_totalcommitments_base as decimal(38,4),",
						"          aging60 as decimal(38,0),",
						"          ts_transfersin_base as decimal(38,0),",
						"          aging90 as decimal(38,0),",
						"          ts_maximumticketsize as decimal(38,4),",
						"          ts_totalaum_base as decimal(38,0),",
						"          marketcap_base as decimal(38,0),",
						"          aging60_base as decimal(38,0),",
						"          aging90_base as decimal(38,0),",
						"          ts_transfersout as decimal(38,0),",
						"          ts_maximumticketsize_base as decimal(38,4),",
						"          ts_originalcommitments_base as decimal(38,0),",
						"          revenue as decimal(38,0),",
						"          ts_totalcommitments as decimal(38,4),",
						"          ts_transfersout_base as decimal(38,0),",
						"          ts_totalaum as decimal(38,0),",
						"          ts_commitmentreductions_base as decimal(38,0),",
						"          ts_commitmentreductions as decimal(38,0),",
						"          marketcap as decimal(38,0),",
						"          ts_originalcommitments as decimal(38,0),",
						"          ts_minimumticketsize as decimal(38,4),",
						"          revenue_base as decimal(38,0),",
						"          openrevenue_base as decimal(38,0),",
						"          aging30_base as decimal(38,0),",
						"          openrevenue as decimal(38,0),",
						"          ts_transfersin as decimal(38,0),",
						"          ts_othernotes as string,",
						"          ts_transfersin_date as timestamp,",
						"          msdyn_salesaccelerationinsightidname as string,",
						"          address1_county as string,",
						"          openrevenue_date as timestamp,",
						"          ts_recommendedbyname as string,",
						"          ts_relationshipinteractioncomments as string,",
						"          ts_originationlead2yominame as string,",
						"          parentaccountidname as string,",
						"          xpd_roletypes_text as string,",
						"          address1_addressid as string,",
						"          importsequencenumber as long,",
						"          address1_longitude as double,",
						"          ts_countryofeconomicoriginforthecapitalname as string,",
						"          entityimageid as string,",
						"          telephone2 as string,",
						"          ts_lastoriginationmeeting as timestamp,",
						"          address2_utcoffset as long,",
						"          address1_upszone as string,",
						"          ts_originalcommitments_state as long,",
						"          ts_typicalcost as string,",
						"          xpd_recommendingportfoliocompaniesrecommended as string,",
						"          accountnumber as string,",
						"          ts_currentauditoryominame as string,",
						"          ts_originalcommitments_date as timestamp,",
						"          lastonholdtime as timestamp,",
						"          ts_sectorscoveredbyfirm as string,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          address2_upszone as string,",
						"          opendeals_state as long,",
						"          xpd_functionuse_text as string,",
						"          slainvokedidname as string,",
						"          address2_longitude as double,",
						"          defaultpricelevelidname as string,",
						"          stockexchange as string,",
						"          mpe_liveofferingscount_date as timestamp,",
						"          xpd_relationshipcomments as string,",
						"          originatingleadidname as string,",
						"          slaname as string,",
						"          ts_currentauditorname as string,",
						"          xpd_remindertoyominame as string,",
						"          ts_address1usstatename as string,",
						"          ts_tempcompanytype as string,",
						"          versionnumber as long,",
						"          address1_latitude as double,",
						"          ts_formername as string,",
						"          yominame as string,",
						"          createdbyyominame as string,",
						"          ts_cityofvisit as string,",
						"          address2_telephone1 as string,",
						"          ts_globalgeographiescoveredids as string,",
						"          preferredserviceidname as string,",
						"          address2_city as string,",
						"          ts_mpeapproachstrategy as string,",
						"          address2_line2 as string,",
						"          ts_lastdatestatuschanged as timestamp,",
						"          li_companyid as long,",
						"          transactioncurrencyidname as string,",
						"          entityimage_url as string,",
						"          xpd_relationshipstatuschangeddate as timestamp,",
						"          createdonbehalfbyname as string,",
						"          mpe_liveofferingscount_state as long,",
						"          xpd_numberofcoinvestinvestments_date as timestamp,",
						"          ts_validateddate as timestamp,",
						"          owneridname as string,",
						"          xpd_generalcomments as string,",
						"          ts_companylegalname as string,",
						"          description as string,",
						"          ts_validatedbyname as string,",
						"          originatingleadidyominame as string,",
						"          opendeals as long,",
						"          xpd_numberofopportunitiesshown_state as long,",
						"          address2_postalcode as string,",
						"          websiteurl as string,",
						"          xpd_fundname as string,",
						"          address1_utcoffset as long,",
						"          exchangerate as decimal(38,10),",
						"          mpe_flowlastrundate as timestamp,",
						"          fax as string,",
						"          address1_line3 as string,",
						"          ts_monthssincelastmeeting as long,",
						"          ts_hubname as string,",
						"          address2_line1 as string,",
						"          ts_capiqticket as string,",
						"          address2_stateorprovince as string,",
						"          address2_name as string,",
						"          ts_transfersout_state as long,",
						"          xpd_numberofopportunitiesshown as long,",
						"          primarytwitterid as string,",
						"          mpe_coinvestquestionnaireidname as string,",
						"          xpd_numberofopportunitiesshown_date as timestamp,",
						"          xpd_preferentialterms as string,",
						"          address1_primarycontactname as string,",
						"          territoryidname as string,",
						"          ts_processstatus as string,",
						"          address1_name as string,",
						"          address2_telephone2 as string,",
						"          address2_telephone3 as string,",
						"          xpd_recruitmentareateam_text as string,",
						"          ftpsiteurl as string,",
						"          address1_postalcode as string,",
						"          ts_companynumber as string,",
						"          createdon as string,",
						"          mpe_liveofferingscount as long,",
						"          traversedpath as string,",
						"          address1_stateorprovince as string,",
						"          ts_transfersin_state as long,",
						"          address2_addressid as string,",
						"          ts_monthlyreviewmeetingname as string,",
						"          primarysatoriid as string,",
						"          telephone3 as string,",
						"          openrevenue_state as long,",
						"          ts_usesprovidedids as string,",
						"          ts_originationcomments as string,",
						"          lastusedincampaign as timestamp,",
						"          primarycontactidname as string,",
						"          ts_originationlead1name as string,",
						"          ts_headofficeidname as string,",
						"          msdyn_segmentidname as string,",
						"          ts_montagucomments as string,",
						"          address2_fax as string,",
						"          createdbyname as string,",
						"          xpd_numberofcoinvestinvestments as long,",
						"          ts_capitaliqlink as string,",
						"          ts_primarymperelationshipmanagername as string,",
						"          mpe_relationshipstatus_text as string,",
						"          xpd_datereminderwasset as timestamp,",
						"          xpd_numberofcoinvestinvestments_state as long,",
						"          address1_postofficebox as string,",
						"          address1_city as string,",
						"          teamsfollowed as long,",
						"          ts_originationlead2name as string,",
						"          timezoneruleversionnumber as long,",
						"          modifiedonbehalfbyyominame as string,",
						"          entityimage_timestamp as long,",
						"          tickersymbol as string,",
						"          ts_theirprogrammecomments as string,",
						"          xpd_companyuse_text as string,",
						"          modifiedbyname as string,",
						"          owneridtype as string,",
						"          sic as string,",
						"          sharesoutstanding as long,",
						"          opendeals_date as timestamp,",
						"          address2_postofficebox as string,",
						"          emailaddress3 as string,",
						"          emailaddress2 as string,",
						"          emailaddress1 as string,",
						"          ts_globalgeographiescoveredbyfirm as string,",
						"          ts_recommendationoffirmupdated as timestamp,",
						"          ts_lastmet as timestamp,",
						"          ts_reminderdatesetto as timestamp,",
						"          ts_commitmentreductions_state as long,",
						"          owningbusinessunitname as string,",
						"          onholdtime as long,",
						"          ts_alias as string,",
						"          createdonbehalfbyyominame as string,",
						"          ts_transfersout_date as timestamp,",
						"          ts_address1countryname as string,",
						"          preferredsystemuseridyominame as string,",
						"          createdbyexternalpartyname as string,",
						"          mpe_documentsetid as string,",
						"          telephone1 as string,",
						"          ts_legacycompanytypes as string,",
						"          ts_validatedbyyominame as string,",
						"          address1_composite as string,",
						"          ts_investorgroupgatekeeperid as string,",
						"          primarycontactidyominame as string,",
						"          address2_country as string,",
						"          xpd_recommendationcomments as string,",
						"          owneridyominame as string,",
						"          createdbyexternalpartyyominame as string,",
						"          ts_originationlead1yominame as string,",
						"          ts_usesprovidedbyfirm as string,",
						"          xpd_recommendingportco as string,",
						"          address1_country as string,",
						"          ts_commitmentreductions_date as timestamp,",
						"          name as string,",
						"          modifiedbyexternalpartyyominame as string,",
						"          xpd_remindertoname as string,",
						"          stageid as string,",
						"          modifiedonbehalfbyname as string,",
						"          masteraccountidname as string,",
						"          timespentbymeonemailandmeetings as string,",
						"          address2_latitude as double,",
						"          overriddencreatedon as timestamp,",
						"          parentaccountidyominame as string,",
						"          ts_specificareaofexpertisecomments as string,",
						"          preferredsystemuseridname as string,",
						"          utcconversiontimezonecode as long,",
						"          address2_county as string,",
						"          address1_line1 as string,",
						"          address2_primarycontactname as string,",
						"          address1_line2 as string,",
						"          xpd_reasonaction as string,",
						"          ts_primarymperelationshipmanageryominame as string,",
						"          processid as string,",
						"          ts_sectorscoveredids as string,",
						"          ts_recommendedbyyominame as string,",
						"          modifiedbyexternalpartyname as string,",
						"          ts_relevantsituations as string,",
						"          accountid as string,",
						"          modifiedon as timestamp,",
						"          preferredequipmentidname as string,",
						"          modifiedbyyominame as string,",
						"          ts_dealstageofmostrecentopportunity as string,",
						"          address2_composite as string,",
						"          masteraccountidyominame as string,",
						"          numberofemployees as long,",
						"          address1_fax as string,",
						"          address2_line3 as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'account',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: true) ~> EnrichedAccount",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          stateAZlabel as string,",
						"          statusAZlabel as string,",
						"          ts_dealannouncedreason as string,",
						"          ts_highprioritynew as string,",
						"          ts_actionstatus as string,",
						"          mpe_targetrelationshipstatus as string,",
						"          mpe_carveout as string,",
						"          ts_producttype as string,",
						"          ts_internalintermediarysource as string,",
						"          mpe_flowlastrunoutcome as string,",
						"          ts_currentactivity as string,",
						"          ts_opportunitystatus as string,",
						"          ts_montaguprimaryoffice as string,",
						"          ts_opportunitytype as string,",
						"          ts_posthumstatus as string,",
						"          ts_meetingremindermonths as string,",
						"          ts_choppedreason as string,",
						"          ts_setreminder as string,",
						"          ts_stagereachedfir as string,",
						"          ts_stagereachedipr as string,",
						"          ts_duplicateopportunityfordiscussion as string,",
						"          mpe_smalltarget as string,",
						"          ts_stagereachedcr as string,",
						"          xpd_includeonallpapers as string,",
						"          ts_sold as string,",
						"          xpd_sharepointlocationcreated as string,",
						"          ts_statuschangedby as string,",
						"          ts_statuschangedby_entitytype as string,",
						"          ts_buyer as string,",
						"          ts_buyer_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          ts_reminderto as string,",
						"          ts_reminderto_entitytype as string,",
						"          mpe_productid as string,",
						"          mpe_productid_entitytype as string,",
						"          ts_targetbusiness as string,",
						"          ts_targetbusiness_entitytype as string,",
						"          ts_firstreferralcompany as string,",
						"          ts_firstreferralcompany_entitytype as string,",
						"          ts_deallead as string,",
						"          ts_deallead_entitytype as string,",
						"          ts_montaguowner as string,",
						"          ts_montaguowner_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          ts_firstreferralcontact as string,",
						"          ts_firstreferralcontact_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ts_managerwedback as string,",
						"          ts_managerwedback_entitytype as string,",
						"          ts_country as string,",
						"          ts_country_entitytype as string,",
						"          mpe_targetbusiness_parentid as string,",
						"          mpe_targetbusiness_parentid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          ts_sellmandate as string,",
						"          ts_sellmandate_entitytype as string,",
						"          ts_estebitda_base as decimal(38,4),",
						"          ts_estebit_base as decimal(38,4),",
						"          ts_estebitda as decimal(38,4),",
						"          ts_estebit as decimal(38,4),",
						"          ts_estturnover_base as decimal(38,4),",
						"          ts_estdealsize as decimal(38,4),",
						"          ts_estdealsize_base as decimal(38,4),",
						"          ts_estturnover as decimal(38,4),",
						"          ts_buyeryominame as string,",
						"          modifiedon as timestamp,",
						"          ts_statuschangedbyname as string,",
						"          ts_managerwedbackyominame as string,",
						"          xpd_montaguprojectname as string,",
						"          transactioncurrencyidname as string,",
						"          ts_nextsteps as string,",
						"          ts_montaguowneryominame as string,",
						"          ts_firstreferralcontactname as string,",
						"          ts_opportunitydescription as string,",
						"          ts_buyerpaidxltmebitda as decimal(38,1),",
						"          ts_targetbusinessyominame as string,",
						"          ts_montaguownername as string,",
						"          ts_managerwedbackname as string,",
						"          ts_opportunitystage as string,",
						"          ts_otherdocumentsurl as string,",
						"          exchangerate as decimal(38,10),",
						"          mpe_documentsetid as string,",
						"          ts_buyername as string,",
						"          ts_firstreferralcontactyominame as string,",
						"          createdon as string,",
						"          ts_sellmandateyominame as string,",
						"          mpe_montaguprimaryofficestring as string,",
						"          ts_statuschangedbyyominame as string,",
						"          ts_firstreferralcompanyname as string,",
						"          owneridyominame as string,",
						"          ts_choppedcomments as string,",
						"          timezoneruleversionnumber as long,",
						"          createdbyname as string,",
						"          ts_dealleadname as string,",
						"          owningbusinessunitname as string,",
						"          ts_dealleadyominame as string,",
						"          ts_lastdatestatuschanged as timestamp,",
						"          traversedpath as string,",
						"          overriddencreatedon as timestamp,",
						"          ts_iprdocumenturl as string,",
						"          createdonbehalfbyname as string,",
						"          ts_sellmandatename as string,",
						"          owneridtype as string,",
						"          owneridname as string,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          mpe_productidname as string,",
						"          mpe_targetbusiness_parentidyominame as string,",
						"          ts_originationopportunityid as string,",
						"          ts_crdocumenturl as string,",
						"          ts_datedealannounced as timestamp,",
						"          processid as string,",
						"          mpe_montaguprimaryofficeowner as string,",
						"          ts_reason as string,",
						"          ts_targetbusinessname as string,",
						"          ts_remindertoname as string,",
						"          ts_postcompletionnoteurl as string,",
						"          ts_name as string,",
						"          stageid as string,",
						"          ts_currentopportunitystatus as string,",
						"          ts_firstreferralcompanyyominame as string,",
						"          mpe_flowlastrundate as timestamp,",
						"          ts_firdocumenturl as string,",
						"          modifiedbyyominame as string,",
						"          modifiedonbehalfbyyominame as string,",
						"          ts_movedoutofwipdate as timestamp,",
						"          ts_equitychequesize as decimal(38,2),",
						"          utcconversiontimezonecode as long,",
						"          mpe_targetbusiness_parentidname as string,",
						"          ts_weofferedxltmebitda as decimal(38,1),",
						"          importsequencenumber as long,",
						"          ts_remindertoyominame as string,",
						"          ts_companyid as long,",
						"          ts_datereminderwasset as timestamp,",
						"          versionnumber as long,",
						"          ts_originationid as long,",
						"          ts_countryname as string,",
						"          ts_choppeddate as timestamp,",
						"          mpe_posthunstatustext as string,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          ts_humdate as timestamp,",
						"          ts_sellmandateidtype as string,",
						"          ts_dateofreminder as timestamp,",
						"          ts_humurl as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'ts_originationopportunity',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: true) ~> EnrichedOriginationOpportunities",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          stateAZlabel as string,",
						"          statusAZlabel as string,",
						"          ts_stageofmeetingrounds as string,",
						"          ts_talentmeetingtype as string,",
						"          instancetypeAZlabel as string,",
						"          ts_whooriginatedthemeeting as string,",
						"          onlinemeetingtype as string,",
						"          ts_meetingteam as string,",
						"          ts_othermeetingmethod as string,",
						"          ts_tone as string,",
						"          ts_meetingmethod as string,",
						"          ts_originationmeetingtype as string,",
						"          priorityAZlabel as string,",
						"          attachmenterrors as string,",
						"          ts_eventtype as string,",
						"          ts_talentmeetingmethod as string,",
						"          ts_productsdiscussed as string,",
						"          ts_contentcovered as string,",
						"          isonlinemeeting as string,",
						"          isworkflowcreated as string,",
						"          isalldayevent as string,",
						"          ts_interview as string,",
						"          isbilled as string,",
						"          isdraft as string,",
						"          ts_keyiractivity as string,",
						"          ts_noninvestor as string,",
						"          ismapiprivate as string,",
						"          isregularactivity as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          ts_investorgroup as string,",
						"          ts_investorgroup_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          regardingobjectid as string,",
						"          regardingobjectid_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ts_officemet as string,",
						"          ts_officemet_entitytype as string,",
						"          ts_taskowner as string,",
						"          ts_taskowner_entitytype as string,",
						"          serviceid as string,",
						"          serviceid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          requiredattendees as string,",
						"          optionalattendees as string,",
						"          organizer as string,",
						"          scheduledend as timestamp,",
						"          ts_taskdescription as string,",
						"          modifiedon as timestamp,",
						"          ts_purpose as string,",
						"          overriddencreatedon as timestamp,",
						"          ts_taskownername as string,",
						"          activityadditionalparams as string,",
						"          ts_tonepersonalities as string,",
						"          seriesid as string,",
						"          transactioncurrencyidname as string,",
						"          activityid as string,",
						"          modifiedfieldsmask as string,",
						"          utcconversiontimezonecode as long,",
						"          ts_officemetname as string,",
						"          scheduledstart as timestamp,",
						"          outlookownerapptid as long,",
						"          ts_topicscovered as string,",
						"          ts_objective as string,",
						"          onholdtime as long,",
						"          onlinemeetingjoinurl as string,",
						"          ts_notes as string,",
						"          originalstartdate as timestamp,",
						"          ts_opportunitiesdiscussed as string,",
						"          ts_sectorscoveredbyfirm as string,",
						"          attachmentcount as long,",
						"          exchangerate as decimal(38,10),",
						"          ts_originationcommentsnotes as string,",
						"          category as string,",
						"          createdon as string,",
						"          ts_eventdescription as string,",
						"          globalobjectid as string,",
						"          onlinemeetingid as string,",
						"          serviceidname as string,",
						"          owneridyominame as string,",
						"          description as string,",
						"          subcategory as string,",
						"          owningbusinessunitname as string,",
						"          ts_taskduedate as timestamp,",
						"          traversedpath as string,",
						"          sortdate as timestamp,",
						"          createdonbehalfbyname as string,",
						"          ts_sectorscoveredids as string,",
						"          safedescription as string,",
						"          ts_taskowneryominame as string,",
						"          owneridtype as string,",
						"          isunsafe as long,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          ts_conferencename as string,",
						"          timezoneruleversionnumber as long,",
						"          actualend as timestamp,",
						"          regardingobjectidname as string,",
						"          processid as string,",
						"          activitytypecode as string,",
						"          actualstart as timestamp,",
						"          xpd_listofexternalattendees as string,",
						"          slainvokedidname as string,",
						"          location as string,",
						"          subject as string,",
						"          createdbyname as string,",
						"          actualdurationminutes as long,",
						"          modifiedbyyominame as string,",
						"          lastonholdtime as timestamp,",
						"          modifiedonbehalfbyyominame as string,",
						"          ts_attendeestoaddtocrm as string,",
						"          regardingobjectidyominame as string,",
						"          regardingobjecttypecode as string,",
						"          stageid as string,",
						"          scheduleddurationminutes as long,",
						"          ts_sourceid as string,",
						"          ts_investorgroupyominame as string,",
						"          importsequencenumber as long,",
						"          subscriptionid as string,",
						"          onlinemeetingchatid as string,",
						"          ts_lpupdates as string,",
						"          ts_executivesummary as string,",
						"          ts_investorgroupname as string,",
						"          ts_meetingcity as string,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          owneridname as string,",
						"          ts_theirprogramme as string,",
						"          ts_ifdeclinedreason as string,",
						"          slaname as string,",
						"          versionnumber as long",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'appointment',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: true) ~> EnrichedMeetingAppointments",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          stateAZlabel as string,",
						"          statusAZlabel as string,",
						"          haschildrenAZlabel as string,",
						"          customertypeAZlabel as string,",
						"          ts_recommendationofindividual as string,",
						"          genderAZlabel as string,",
						"          address1_addresstypeAZlabel as string,",
						"          leadsourceAZlabel as string,",
						"          preferredappointmenttimeAZlabel as string,",
						"          address2_freighttermsAZlabel as string,",
						"          address2_shippingmethodAZlabel as string,",
						"          ts_debtsubtype as string,",
						"          msdyn_orgchangestatus as string,",
						"          ts_suffix as string,",
						"          xpd_gender as string,",
						"          ts_title as string,",
						"          paymenttermsAZlabel as string,",
						"          accountroleAZlabel as string,",
						"          territoryAZlabel as string,",
						"          ts_vendortargettrackingrole as string,",
						"          address3_freighttermsAZlabel as string,",
						"          address1_shippingmethodAZlabel as string,",
						"          preferredappointmentdayAZlabel as string,",
						"          customersizeAZlabel as string,",
						"          preferredcontactmethodAZlabel as string,",
						"          ts_futurecontactmethod as string,",
						"          address3_shippingmethodAZlabel as string,",
						"          address2_addresstypeAZlabel as string,",
						"          mpe_flowlastrunoutcome as string,",
						"          ts_capabilitiesofindividual as string,",
						"          address3_addresstypeAZlabel as string,",
						"          familystatusAZlabel as string,",
						"          shippingmethodAZlabel as string,",
						"          xpd_availability as string,",
						"          educationAZlabel as string,",
						"          address1_freighttermsAZlabel as string,",
						"          ts_quickcaptureuses as string,",
						"          xpd_montagulevel as string,",
						"          ts_permanentinterim as string,",
						"          ts_ircontactrole as string,",
						"          xpd_level as string,",
						"          ts_languagesspokenwritten as string,",
						"          ts_contacttype as string,",
						"          ts_montaguoffice as string,",
						"          ts_roletypes as string,",
						"          xpd_specialisms as string,",
						"          ts_quickcapturesectors as string,",
						"          xpd_function as string,",
						"          ts_producttype as string,",
						"          ts_quickcapturegeography as string,",
						"          ts_productsinterestedin as string,",
						"          ts_potentialrolecandidate as string,",
						"          isbackofficecustomer as string,",
						"          donotpostalmail as string,",
						"          xpd_addcontacttooutlook as string,",
						"          ts_centralrelationshipmanager as string,",
						"          msdyn_gdproptout as string,",
						"          xpd_hascompany as string,",
						"          creditonhold as string,",
						"          xpd_benchcandidate as string,",
						"          donotbulkpostalmail as string,",
						"          donotsendmm as string,",
						"          donotbulkemail as string,",
						"          followemail as string,",
						"          xpd_sharepointdocumentlocationcreated as string,",
						"          xpd_available as string,",
						"          ts_leadearlystageinteraction as string,",
						"          participatesinworkflow as string,",
						"          ts_doyouwishtotrackthiscontact as string,",
						"          merged as string,",
						"          ts_validated as string,",
						"          marketingonly as string,",
						"          donotfax as string,",
						"          isprivate as string,",
						"          donotphone as string,",
						"          isautocreate as string,",
						"          donotemail as string,",
						"          ts_unconfirmedemailaddress as string,",
						"          mpe_companysearchbyemail as string,",
						"          preferredsystemuserid as string,",
						"          preferredsystemuserid_entitytype as string,",
						"          mpe_accountid as string,",
						"          mpe_accountid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          ts_recommendedby as string,",
						"          ts_recommendedby_entitytype as string,",
						"          ts_previousemployerid as string,",
						"          ts_previousemployerid_entitytype as string,",
						"          preferredserviceid as string,",
						"          preferredserviceid_entitytype as string,",
						"          msdyn_segmentid as string,",
						"          msdyn_segmentid_entitytype as string,",
						"          parentcontactid as string,",
						"          parentcontactid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          ts_pa as string,",
						"          ts_pa_entitytype as string,",
						"          ts_businessaddress as string,",
						"          ts_businessaddress_entitytype as string,",
						"          modifiedbyexternalparty as string,",
						"          modifiedbyexternalparty_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          originatingleadid as string,",
						"          originatingleadid_entitytype as string,",
						"          masterid as string,",
						"          masterid_entitytype as string,",
						"          defaultpricelevelid as string,",
						"          defaultpricelevelid_entitytype as string,",
						"          parent_contactid as string,",
						"          parent_contactid_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          createdbyexternalparty as string,",
						"          createdbyexternalparty_entitytype as string,",
						"          preferredequipmentid as string,",
						"          preferredequipmentid_entitytype as string,",
						"          xpd_referredbyinternal as string,",
						"          xpd_referredbyinternal_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          xpd_homecountry as string,",
						"          xpd_homecountry_entitytype as string,",
						"          ts_placementfirmintroducedby as string,",
						"          ts_placementfirmintroducedby_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          accountid as string,",
						"          accountid_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          parentcustomerid as string,",
						"          parentcustomerid_entitytype as string,",
						"          xpd_referredbyexternal as string,",
						"          xpd_referredbyexternal_entitytype as string,",
						"          aging30 as decimal(38,2),",
						"          creditlimit_base as decimal(38,4),",
						"          aging60 as decimal(38,2),",
						"          aging90 as decimal(38,2),",
						"          aging60_base as decimal(38,4),",
						"          aging90_base as decimal(38,4),",
						"          annualincome_base as decimal(38,4),",
						"          creditlimit as decimal(38,2),",
						"          annualincome as decimal(38,2),",
						"          aging30_base as decimal(38,4),",
						"          ts_othernotes as string,",
						"          xpd_referredbyinternalyominame as string,",
						"          address1_county as string,",
						"          yomilastname as string,",
						"          address3_utcoffset as long,",
						"          ts_recommendedbyname as string,",
						"          description as string,",
						"          li_membertoken as string,",
						"          department as string,",
						"          xpd_roletypes_text as string,",
						"          address1_addressid as string,",
						"          importsequencenumber as long,",
						"          address1_longitude as double,",
						"          address3_fax as string,",
						"          managername as string,",
						"          entityimageid as string,",
						"          telephone2 as string,",
						"          parentcustomeridtype as string,",
						"          address2_upszone as string,",
						"          address1_upszone as string,",
						"          xpd_recommendingportfoliocompaniesrecommended as string,",
						"          lastonholdtime as timestamp,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          address1_fax as string,",
						"          address3_telephone1 as string,",
						"          address3_telephone2 as string,",
						"          address3_telephone3 as string,",
						"          fax as string,",
						"          assistantname as string,",
						"          address2_line3 as string,",
						"          accountidyominame as string,",
						"          parentcontactidyominame as string,",
						"          mpe_accountidyominame as string,",
						"          slainvokedidname as string,",
						"          defaultpricelevelidname as string,",
						"          fullname as string,",
						"          address2_longitude as double,",
						"          subscriptionid as string,",
						"          originatingleadidname as string,",
						"          slaname as string,",
						"          versionnumber as long,",
						"          address1_latitude as double,",
						"          createdbyyominame as string,",
						"          parent_contactidname as string,",
						"          address2_telephone1 as string,",
						"          pager as string,",
						"          salutation as string,",
						"          mpe_accountidname as string,",
						"          xpd_functionuse_text as string,",
						"          accountidname as string,",
						"          mpe_companysummary as string,",
						"          parent_contactidyominame as string,",
						"          preferredserviceidname as string,",
						"          address2_city as string,",
						"          address3_postalcode as string,",
						"          address2_line2 as string,",
						"          li_companyid as long,",
						"          ts_otherphonelabel as string,",
						"          ts_reportingemail as string,",
						"          address3_upszone as string,",
						"          transactioncurrencyidname as string,",
						"          address3_county as string,",
						"          entityimage_url as string,",
						"          governmentid as string,",
						"          callback as string,",
						"          business2 as string,",
						"          createdonbehalfbyname as string,",
						"          ts_validateddate as timestamp,",
						"          address2_telephone2 as string,",
						"          owneridname as string,",
						"          originatingleadidyominame as string,",
						"          ts_otherlanguages as string,",
						"          address2_postalcode as string,",
						"          birthdate as timestamp,",
						"          parentcontactidname as string,",
						"          spousesname as string,",
						"          xpd_compensationdate as timestamp,",
						"          address1_utcoffset as long,",
						"          address3_line1 as string,",
						"          traversedpath as string,",
						"          exchangerate as decimal(38,10),",
						"          mpe_flowlastrundate as timestamp,",
						"          address1_line3 as string,",
						"          address3_country as string,",
						"          mpe_documentsetid as string,",
						"          address2_line1 as string,",
						"          ts_previousemployeridyominame as string,",
						"          middlename as string,",
						"          managerphone as string,",
						"          address2_stateorprovince as string,",
						"          childrensnames as string,",
						"          address2_name as string,",
						"          address3_addressid as string,",
						"          address3_stateorprovince as string,",
						"          ts_sectorspecialtyids as string,",
						"          businesscardattributes as string,",
						"          anniversary as timestamp,",
						"          ts_employmentstartdate as timestamp,",
						"          ts_legacycontacttypes as string,",
						"          address1_primarycontactname as string,",
						"          address2_utcoffset as long,",
						"          home2 as string,",
						"          ts_geographicspecialtyids as string,",
						"          address1_name as string,",
						"          ts_recommendationcomments as string,",
						"          address2_telephone3 as string,",
						"          address3_primarycontactname as string,",
						"          ftpsiteurl as string,",
						"          address1_postalcode as string,",
						"          createdon as string,",
						"          address1_stateorprovince as string,",
						"          yomimiddlename as string,",
						"          jobtitle as string,",
						"          telephone3 as string,",
						"          ts_usesspeciality as string,",
						"          msdyn_segmentidname as string,",
						"          ts_knowntouserinitials as string,",
						"          address2_fax as string,",
						"          createdbyname as string,",
						"          xpd_contactuse_text as string,",
						"          ts_sourceid as string,",
						"          address2_addressid as string,",
						"          employeeid as string,",
						"          address1_postofficebox as string,",
						"          address1_city as string,",
						"          ts_businessaddressname as string,",
						"          teamsfollowed as long,",
						"          ts_cv as string,",
						"          timezoneruleversionnumber as long,",
						"          modifiedonbehalfbyyominame as string,",
						"          xpd_hrcompensation as string,",
						"          ts_currentbonusandorupliftconsiderations as string,",
						"          modifiedbyname as string,",
						"          address3_line2 as string,",
						"          yomifullname as string,",
						"          owneridtype as string,",
						"          entityimage_timestamp as long,",
						"          ts_placementfirmintroducedbyyominame as string,",
						"          xpd_previousrole as string,",
						"          ts_compensation as string,",
						"          address2_postofficebox as string,",
						"          emailaddress3 as string,",
						"          emailaddress2 as string,",
						"          emailaddress1 as string,",
						"          ts_interactioncontactuniqueidentifier as string,",
						"          ts_investmentcafeid as string,",
						"          websiteurl as string,",
						"          nickname as string,",
						"          ts_lastmet as timestamp,",
						"          address3_name as string,",
						"          ts_usesspecialtyids as string,",
						"          ts_linkedinurl as string,",
						"          lastname as string,",
						"          address3_longitude as double,",
						"          xpd_referredbyexternalidtype as string,",
						"          parentcustomeridname as string,",
						"          owningbusinessunitname as string,",
						"          onholdtime as long,",
						"          createdonbehalfbyyominame as string,",
						"          preferredsystemuseridyominame as string,",
						"          createdbyexternalpartyname as string,",
						"          ts_tone as string,",
						"          telephone1 as string,",
						"          overriddencreatedon as timestamp,",
						"          address3_postofficebox as string,",
						"          assistantphone as string,",
						"          address1_composite as string,",
						"          address3_line3 as string,",
						"          address2_country as string,",
						"          xpd_referredbyinternalname as string,",
						"          mobilephone as string,",
						"          owneridyominame as string,",
						"          address1_line1 as string,",
						"          createdbyexternalpartyyominame as string,",
						"          xpd_referredbyexternalyominame as string,",
						"          yomifirstname as string,",
						"          mastercontactidname as string,",
						"          address3_city as string,",
						"          address1_country as string,",
						"          externaluseridentifier as string,",
						"          modifiedbyexternalpartyyominame as string,",
						"          firstname as string,",
						"          xpd_hrcurrentbonusandorupliftconsiderations as string,",
						"          stageid as string,",
						"          modifiedonbehalfbyname as string,",
						"          xpd_homecountryname as string,",
						"          mastercontactidyominame as string,",
						"          suffix as string,",
						"          ts_payominame as string,",
						"          lastusedincampaign as timestamp,",
						"          ts_geographicspeciality as string,",
						"          xpd_recruitmentareateam_text as string,",
						"          ts_retentionreviewdate as timestamp,",
						"          parentcustomeridyominame as string,",
						"          timespentbymeonemailandmeetings as string,",
						"          address2_latitude as double,",
						"          xpd_availablefrom as timestamp,",
						"          address3_composite as string,",
						"          xpd_recommendingportco as string,",
						"          preferredsystemuseridname as string,",
						"          utcconversiontimezonecode as long,",
						"          address2_county as string,",
						"          ts_paname as string,",
						"          contactid as string,",
						"          address2_primarycontactname as string,",
						"          ts_specificareasofexpertisecomments as string,",
						"          address1_line2 as string,",
						"          ts_recommendationofindividualupdated as timestamp,",
						"          xpd_referredbyexternalname as string,",
						"          ts_placementfirmintroducedbyname as string,",
						"          ts_sectorspeciality as string,",
						"          ts_previousemployeridname as string,",
						"          processid as string,",
						"          ts_recommendedbyyominame as string,",
						"          modifiedon as timestamp,",
						"          modifiedbyexternalpartyname as string,",
						"          ts_relevantsituations as string,",
						"          businesscard as string,",
						"          company as string,",
						"          preferredequipmentidname as string,",
						"          modifiedbyyominame as string,",
						"          ts_preferredname as string,",
						"          address2_composite as string,",
						"          numberofchildren as long,",
						"          address3_latitude as double",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'contact',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: true) ~> EnrichedContacts",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          address1_addresstypeAZlabel as string,",
						"          address1_shippingmethodAZlabel as string,",
						"          azurestate as string,",
						"          invitestatusAZlabel as string,",
						"          preferredaddressAZlabel as string,",
						"          preferredemailAZlabel as string,",
						"          outgoingemaildeliverymethod as string,",
						"          preferredphoneAZlabel as string,",
						"          emailrouteraccessapproval as string,",
						"          deletedstate as string,",
						"          incomingemaildeliverymethod as string,",
						"          accessmode as string,",
						"          caltype as string,",
						"          address2_addresstypeAZlabel as string,",
						"          address2_shippingmethodAZlabel as string,",
						"          setupuser as string,",
						"          islicensed as string,",
						"          defaultfilterspopulated as string,",
						"          isactivedirectoryuser as string,",
						"          displayinserviceviews as string,",
						"          msdyn_gdproptout as string,",
						"          isdisabled as string,",
						"          isintegrationuser as string,",
						"          isemailaddressapprovedbyo365admin as string,",
						"          issyncwithdirectory as string,",
						"          calendarid as string,",
						"          calendarid_entitytype as string,",
						"          mobileofflineprofileid as string,",
						"          mobileofflineprofileid_entitytype as string,",
						"          queueid as string,",
						"          queueid_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          territoryid as string,",
						"          territoryid_entitytype as string,",
						"          defaultmailbox as string,",
						"          defaultmailbox_entitytype as string,",
						"          positionid as string,",
						"          positionid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          siteid as string,",
						"          siteid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          parentsystemuserid as string,",
						"          parentsystemuserid_entitytype as string,",
						"          businessunitid as string,",
						"          businessunitid_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          traversedpath as string,",
						"          azureactivedirectoryobjectid as string,",
						"          address1_line1 as string,",
						"          internalemailaddress as string,",
						"          siteidname as string,",
						"          modifiedon as timestamp,",
						"          address1_line3 as string,",
						"          skills as string,",
						"          yomifirstname as string,",
						"          address1_longitude as double,",
						"          yomifullname as string,",
						"          entityimage_timestamp as long,",
						"          parentsystemuseridname as string,",
						"          address2_county as string,",
						"          transactioncurrencyidname as string,",
						"          activedirectoryguid as string,",
						"          utcconversiontimezonecode as long,",
						"          passporthi as long,",
						"          homephone as string,",
						"          parentsystemuseridyominame as string,",
						"          address2_stateorprovince as string,",
						"          mobilephone as string,",
						"          address2_country as string,",
						"          address2_line2 as string,",
						"          disabledreason as string,",
						"          lastname as string,",
						"          address1_city as string,",
						"          address1_utcoffset as long,",
						"          userlicensetype as long,",
						"          nickname as string,",
						"          passportlo as long,",
						"          title as string,",
						"          address2_latitude as double,",
						"          applicationid as string,",
						"          address1_composite as string,",
						"          firstname as string,",
						"          address2_postalcode as string,",
						"          employeeid as string,",
						"          processid as string,",
						"          mobileofflineprofileidname as string,",
						"          governmentid as string,",
						"          entityimage_url as string,",
						"          address2_line3 as string,",
						"          azuredeletedon as timestamp,",
						"          timezoneruleversionnumber as long,",
						"          address1_county as string,",
						"          address2_telephone2 as string,",
						"          address2_postofficebox as string,",
						"          address2_telephone1 as string,",
						"          yomilastname as string,",
						"          address2_telephone3 as string,",
						"          address1_addressid as string,",
						"          territoryidname as string,",
						"          overriddencreatedon as timestamp,",
						"          userpuid as string,",
						"          createdonbehalfbyname as string,",
						"          systemuserid as string,",
						"          address2_name as string,",
						"          middlename as string,",
						"          entityimageid as string,",
						"          applicationiduri as string,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          address2_composite as string,",
						"          address1_country as string,",
						"          mobilealertemail as string,",
						"          sharepointemailaddress as string,",
						"          businessunitidname as string,",
						"          address1_stateorprovince as string,",
						"          exchangerate as decimal(38,10),",
						"          jobtitle as string,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          latestupdatetime as timestamp,",
						"          address1_postofficebox as string,",
						"          organizationid as string,",
						"          yammeremailaddress as string,",
						"          defaultmailboxname as string,",
						"          identityid as long,",
						"          yomimiddlename as string,",
						"          address2_utcoffset as long,",
						"          photourl as string,",
						"          personalemailaddress as string,",
						"          address2_addressid as string,",
						"          address2_longitude as double,",
						"          createdon as string,",
						"          createdbyname as string,",
						"          domainname as string,",
						"          modifiedbyyominame as string,",
						"          address2_fax as string,",
						"          address1_line2 as string,",
						"          modifiedonbehalfbyyominame as string,",
						"          address2_upszone as string,",
						"          salutation as string,",
						"          address1_postalcode as string,",
						"          stageid as string,",
						"          defaultodbfoldername as string,",
						"          positionidname as string,",
						"          ts_inititals as string,",
						"          yammeruserid as string,",
						"          importsequencenumber as long,",
						"          address2_city as string,",
						"          windowsliveid as string,",
						"          organizationidname as string,",
						"          versionnumber as long,",
						"          queueidname as string,",
						"          address1_name as string,",
						"          address1_fax as string,",
						"          address1_latitude as double,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          address2_line1 as string,",
						"          address1_upszone as string,",
						"          fullname as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'systemuser',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: true) ~> EnrichedSystemuser",
						"MeetingsAppointmentsIn select(mapColumn(",
						"          Id,",
						"          ts_meetingteam,",
						"          ts_othermeetingmethod,",
						"          isonlinemeeting,",
						"          isalldayevent,",
						"          regardingobjectid,",
						"          ts_taskowner,",
						"          scheduledend,",
						"          ts_taskdescription,",
						"          scheduledstart,",
						"          onlinemeetingjoinurl,",
						"          ts_notes,",
						"          ts_opportunitiesdiscussed,",
						"          ts_sectorscoveredbyfirm,",
						"          ts_originationcommentsnotes,",
						"          ts_taskduedate,",
						"          ts_sectorscoveredids,",
						"          location,",
						"          scheduleddurationminutes",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> MeetingsCleanselect",
						"ContactsIn select(mapColumn(",
						"          Id,",
						"          ts_recommendationofindividual,",
						"          gendercode,",
						"          paymenttermscode,",
						"          ts_vendortargettrackingrole,",
						"          address1_shippingmethodcode,",
						"          preferredcontactmethodcode,",
						"          ts_capabilitiesofindividual,",
						"          familystatuscode,",
						"          xpd_availability,",
						"          address1_freighttermscode,",
						"          xpd_montagulevel,",
						"          ts_permanentinterim,",
						"          ts_ircontactrole,",
						"          xpd_level,",
						"          ts_languagesspokenwritten,",
						"          ts_montaguoffice,",
						"          ts_roletypes,",
						"          xpd_specialisms,",
						"          xpd_function,",
						"          ts_producttype,",
						"          ts_productsinterestedin,",
						"          donotpostalmail,",
						"          ts_centralrelationshipmanager,",
						"          creditonhold,",
						"          xpd_benchcandidate,",
						"          donotsendmm,",
						"          donotbulkemail,",
						"          followemail,",
						"          xpd_available,",
						"          donotfax,",
						"          donotphone,",
						"          donotemail,",
						"          ts_recommendedby,",
						"          transactioncurrencyid,",
						"          originatingleadid,",
						"          xpd_homecountry,",
						"          creditlimit,",
						"          telephone2,",
						"          salutation,",
						"          ts_reportingemail,",
						"          ts_otherlanguages,",
						"          birthdate,",
						"          spousesname,",
						"          xpd_compensationdate,",
						"          anniversary,",
						"          ts_recommendationcomments,",
						"          ts_usesspeciality,",
						"          xpd_hrcompensation,",
						"          ts_currentbonusandorupliftconsiderations,",
						"          ts_compensation,",
						"          emailaddress2,",
						"          ts_investmentcafeid,",
						"          ts_lastmet,",
						"          ts_tone,",
						"          xpd_hrcurrentbonusandorupliftconsiderations,",
						"          lastusedincampaign,",
						"          ts_geographicspeciality,",
						"          xpd_availablefrom,",
						"          xpd_recommendingportco,",
						"          contactid,",
						"          ts_sectorspeciality",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> contactscleanselect",
						"OriginationOpportunityIn select(mapColumn(",
						"          Id,",
						"          ts_actionstatus,",
						"          ts_producttype,",
						"          ts_internalintermediarysource,",
						"          ts_currentactivity,",
						"          ts_opportunitystatus,",
						"          ts_montaguprimaryoffice,",
						"          ts_opportunitytype,",
						"          ts_posthumstatus,",
						"          ts_choppedreason,",
						"          ts_duplicateopportunityfordiscussion,",
						"          mpe_smalltarget,",
						"          xpd_includeonallpapers,",
						"          ts_sold,",
						"          xpd_sharepointlocationcreated,",
						"          ts_buyer,",
						"          mpe_productid,",
						"          ts_targetbusiness,",
						"          ts_firstreferralcompany,",
						"          ts_montaguowner,",
						"          ts_firstreferralcontact,",
						"          transactioncurrencyid,",
						"          ts_managerwedback,",
						"          ts_country,",
						"          ownerid,",
						"          ts_estebitda,",
						"          ts_estebit,",
						"          ts_estdealsize,",
						"          ts_estturnover,",
						"          ts_nextsteps,",
						"          ts_buyerpaidxltmebitda,",
						"          ts_opportunitystage,",
						"          ts_choppedcomments,",
						"          ts_datedealannounced,",
						"          ts_name,",
						"          ts_weofferedxltmebitda,",
						"          ts_companyid,",
						"          ts_choppeddate,",
						"          mpe_carveout,",
						"          mpe_targetbusiness_parentid",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> OrigiopportCleanout",
						"AccountIn select(mapColumn(",
						"          Id,",
						"          ts_primarysecondaryfocus,",
						"          xpd_relationshipstatus,",
						"          ts_introducertype,",
						"          xpd_remindermonths,",
						"          ts_portfoliocompanystatus,",
						"          ts_companytype,",
						"          ts_vendorsummary,",
						"          xpd_publictoprivatetracker,",
						"          xpd_setreminder,",
						"          ts_trackcompany,",
						"          parentaccountid,",
						"          xpd_reminderto,",
						"          ts_headofficeid,",
						"          ts_originationlead1,",
						"          ts_originationlead2,",
						"          ts_currentauditor,",
						"          ts_othernotes,",
						"          xpd_relationshipcomments,",
						"          ts_formername,",
						"          ts_mpeapproachstrategy,",
						"          ts_lastdatestatuschanged,",
						"          xpd_relationshipstatuschangeddate,",
						"          ts_companylegalname,",
						"          ts_companynumber,",
						"          ts_monthlyreviewmeetingname,",
						"          ts_originationcomments,",
						"          ts_capitaliqlink,",
						"          xpd_datereminderwasset,",
						"          ts_reminderdatesetto,",
						"          ts_alias,",
						"          xpd_reasonaction,",
						"          ts_relevantsituations,",
						"          ts_dealstageofmostrecentopportunity",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> AccountsSelectClean",
						"SystemuserSource select(mapColumn(",
						"          id = Id,",
						"          calendarid,",
						"          siteid,",
						"          azureactivedirectoryobjectid,",
						"          modifiedby,",
						"          address1_line1,",
						"          internalemailaddress,",
						"          siteidname,",
						"          yomifullname,",
						"          mobilephone,",
						"          lastname,",
						"          address1_city,",
						"          title,",
						"          address1_composite,",
						"          firstname,",
						"          address1_addressid,",
						"          userpuid,",
						"          parentsystemuserid,",
						"          entityimageid,",
						"          address1_country,",
						"          businessunitidname,",
						"          address1_telephone1,",
						"          organizationid,",
						"          defaultmailboxname,",
						"          identityid,",
						"          address2_addressid,",
						"          createdon,",
						"          domainname,",
						"          modifiedbyyominame,",
						"          address1_postalcode,",
						"          ts_inititals,",
						"          windowsliveid,",
						"          queueidname,",
						"          modifiedbyname",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SystemUserSelect",
						"OrigiopportCleanout, OutputEnrichedOrigination join(OrigiopportCleanout@Id == OutputEnrichedOrigination@Id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'right')~> Originationjoinoutput",
						"OptionsetSource select(mapColumn(",
						"          Id,",
						"          organizationid,",
						"          gap_entityname,",
						"          gap_entityschemaname,",
						"          gap_powerbioptionsetrefid,",
						"          gap_optionsetschemaname,",
						"          gap_value,",
						"          gap_label",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> GapOptionsetSelect",
						"EnrichedAccount select(mapColumn(",
						"          Id,",
						"          state = stateAZlabel,",
						"          status = statusAZlabel,",
						"          customertype = customertypeAZlabel,",
						"          address1_addresstype = address1_addresstypeAZlabel,",
						"          accountclassification = accountclassificationAZlabel,",
						"          preferredappointmenttime = preferredappointmenttimeAZlabel,",
						"          address2_freightterms = address2_freighttermsAZlabel,",
						"          accountcategory = accountcategoryAZlabel,",
						"          paymentterms = paymenttermsAZlabel,",
						"          preferredappointmentday = preferredappointmentdayAZlabel,",
						"          businesstype = businesstypeAZlabel,",
						"          industry = industryAZlabel,",
						"          address1_shippingmethod = address1_shippingmethodAZlabel,",
						"          customersize = customersizeAZlabel,",
						"          preferredcontactmethod = preferredcontactmethodAZlabel,",
						"          accountratingAZlabel,",
						"          address2_addresstypeAZlabel,",
						"          address2_shippingmethodAZlabel,",
						"          ownershipAZlabel,",
						"          territoryAZlabel,",
						"          shippingmethodAZlabel,",
						"          address1_freighttermsAZlabel",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> EnrichedAccountSelect",
						"EnrichedOriginationOpportunities select(mapColumn(",
						"          Id,",
						"          SinkCreatedOn,",
						"          SinkModifiedOn,",
						"          stateAZlabel,",
						"          statusAZlabel,",
						"          ts_dealannouncedreason,",
						"          ts_highprioritynew,",
						"          ts_actionstatus,",
						"          mpe_targetrelationshipstatus,",
						"          mpe_carveout,",
						"          ts_producttype,",
						"          ts_internalintermediarysource,",
						"          mpe_flowlastrunoutcome,",
						"          ts_currentactivity,",
						"          ts_opportunitystatus,",
						"          ts_montaguprimaryoffice,",
						"          ts_opportunitytype,",
						"          ts_posthumstatus,",
						"          ts_meetingremindermonths,",
						"          ts_choppedreason,",
						"          ts_setreminder,",
						"          ts_stagereachedfir,",
						"          ts_stagereachedipr,",
						"          ts_duplicateopportunityfordiscussion,",
						"          mpe_smalltarget,",
						"          ts_stagereachedcr,",
						"          xpd_includeonallpapers,",
						"          ts_sold,",
						"          xpd_sharepointlocationcreated,",
						"          ts_statuschangedby,",
						"          ts_statuschangedby_entitytype,",
						"          ts_buyer,",
						"          ts_buyer_entitytype,",
						"          owningbusinessunit,",
						"          owningbusinessunit_entitytype,",
						"          ts_reminderto,",
						"          ts_reminderto_entitytype,",
						"          mpe_productid,",
						"          mpe_productid_entitytype,",
						"          ts_targetbusiness,",
						"          ts_targetbusiness_entitytype,",
						"          ts_firstreferralcompany,",
						"          ts_firstreferralcompany_entitytype,",
						"          ts_deallead,",
						"          ts_deallead_entitytype,",
						"          ts_montaguowner,",
						"          ts_montaguowner_entitytype,",
						"          modifiedby,",
						"          modifiedby_entitytype,",
						"          modifiedonbehalfby,",
						"          modifiedonbehalfby_entitytype,",
						"          owninguser,",
						"          owninguser_entitytype,",
						"          ts_firstreferralcontact,",
						"          ts_firstreferralcontact_entitytype,",
						"          owningteam,",
						"          owningteam_entitytype,",
						"          createdonbehalfby,",
						"          createdonbehalfby_entitytype,",
						"          transactioncurrencyid,",
						"          transactioncurrencyid_entitytype,",
						"          createdby,",
						"          createdby_entitytype,",
						"          ts_managerwedback,",
						"          ts_managerwedback_entitytype,",
						"          ts_country,",
						"          ts_country_entitytype,",
						"          mpe_targetbusiness_parentid,",
						"          mpe_targetbusiness_parentid_entitytype,",
						"          ownerid,",
						"          ownerid_entitytype,",
						"          ts_sellmandate,",
						"          ts_sellmandate_entitytype,",
						"          ts_estebitda_base,",
						"          ts_estebit_base,",
						"          ts_estebitda,",
						"          ts_estebit,",
						"          ts_estturnover_base,",
						"          ts_estdealsize,",
						"          ts_estdealsize_base,",
						"          ts_estturnover,",
						"          ts_buyeryominame,",
						"          modifiedon,",
						"          ts_statuschangedbyname,",
						"          ts_managerwedbackyominame,",
						"          xpd_montaguprojectname,",
						"          transactioncurrencyidname,",
						"          ts_nextsteps,",
						"          ts_montaguowneryominame,",
						"          ts_firstreferralcontactname,",
						"          ts_opportunitydescription,",
						"          ts_buyerpaidxltmebitda,",
						"          ts_targetbusinessyominame,",
						"          ts_montaguownername,",
						"          ts_managerwedbackname,",
						"          ts_opportunitystage,",
						"          ts_otherdocumentsurl,",
						"          exchangerate,",
						"          mpe_documentsetid,",
						"          ts_buyername,",
						"          ts_firstreferralcontactyominame,",
						"          createdon,",
						"          ts_sellmandateyominame,",
						"          mpe_montaguprimaryofficestring,",
						"          ts_statuschangedbyyominame,",
						"          ts_firstreferralcompanyname,",
						"          owneridyominame,",
						"          ts_choppedcomments,",
						"          timezoneruleversionnumber,",
						"          createdbyname,",
						"          ts_dealleadname,",
						"          owningbusinessunitname,",
						"          ts_dealleadyominame,",
						"          ts_lastdatestatuschanged,",
						"          traversedpath,",
						"          overriddencreatedon,",
						"          ts_iprdocumenturl,",
						"          createdonbehalfbyname,",
						"          ts_sellmandatename,",
						"          owneridtype,",
						"          owneridname,",
						"          modifiedonbehalfbyname,",
						"          createdonbehalfbyyominame,",
						"          mpe_productidname,",
						"          mpe_targetbusiness_parentidyominame,",
						"          ts_originationopportunityid,",
						"          ts_crdocumenturl,",
						"          ts_datedealannounced,",
						"          processid,",
						"          mpe_montaguprimaryofficeowner,",
						"          ts_reason,",
						"          ts_targetbusinessname,",
						"          ts_remindertoname,",
						"          ts_postcompletionnoteurl,",
						"          ts_name,",
						"          stageid,",
						"          ts_currentopportunitystatus,",
						"          ts_firstreferralcompanyyominame,",
						"          mpe_flowlastrundate,",
						"          ts_firdocumenturl,",
						"          modifiedbyyominame,",
						"          modifiedonbehalfbyyominame,",
						"          ts_movedoutofwipdate,",
						"          ts_equitychequesize,",
						"          utcconversiontimezonecode,",
						"          mpe_targetbusiness_parentidname,",
						"          ts_weofferedxltmebitda,",
						"          importsequencenumber,",
						"          ts_remindertoyominame,",
						"          ts_companyid,",
						"          ts_datereminderwasset,",
						"          versionnumber,",
						"          ts_originationid,",
						"          ts_countryname,",
						"          ts_choppeddate,",
						"          mpe_posthunstatustext,",
						"          modifiedbyname,",
						"          createdbyyominame,",
						"          ts_humdate,",
						"          ts_sellmandateidtype,",
						"          ts_dateofreminder,",
						"          ts_humurl",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> OutputEnrichedOrigination",
						"EnrichedMeetingAppointments select(mapColumn(",
						"          each(match(true()))",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> select2",
						"EnrichedContacts select(mapColumn(",
						"          each(match(true()))",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> select3",
						"EnrichedSystemuser select(mapColumn(",
						"          each(match(true()))",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> select4",
						"MeetingsCleanselect, EnrichedMeetingAppointments join(MeetingsCleanselect@Id == EnrichedMeetingAppointments@Id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> AppointmentsJoinOutput",
						"contactscleanselect, EnrichedContacts join(contactscleanselect@Id == EnrichedContacts@Id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> ContactsJoin",
						"SystemUserSelect, EnrichedSystemuser join(SystemUserSelect@id == EnrichedSystemuser@Id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> SystemUserJoin",
						"AccountsSelectClean, EnrichedAccountSelect join(fuzzyCompare(AccountsSelectClean@Id, EnrichedAccountSelect@Id, 80.00),",
						"     joinType:'left',",
						"     matchType:'fuzzy',",
						"     ignoreSpaces: false,",
						"     scoreColumn:'AZlabel',",
						"     broadcast: 'off')~> AccountEnrichedJoin",
						"AccountEnrichedJoin sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     recreate:true,",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> AccountStage",
						"AppointmentsJoinOutput sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> MeetingStageClean",
						"ContactsJoin sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> ContactsStageClean",
						"Originationjoinoutput sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> OriginationSINK",
						"SystemUserJoin sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> SystemUserClean",
						"GapOptionsetSelect sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     recreate:true,",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> sinkoptionset",
						"OutputEnrichedOrigination sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     store: 'cache',",
						"     format: 'inline',",
						"     output: false,",
						"     saveOrder: 1) ~> SinkEnrichedOrigination",
						"EnrichedAccountSelect sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     store: 'cache',",
						"     format: 'inline',",
						"     output: false,",
						"     saveOrder: 1) ~> SinkAccount",
						"select2 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     store: 'cache',",
						"     format: 'inline',",
						"     output: false,",
						"     saveOrder: 1) ~> SinkMeeting",
						"select3 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     store: 'cache',",
						"     format: 'inline',",
						"     output: false,",
						"     saveOrder: 1) ~> SinkContacts",
						"select4 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     store: 'cache',",
						"     format: 'inline',",
						"     output: false,",
						"     saveOrder: 1) ~> SinkSystemUser"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/EnrichedDatabase')]",
				"[concat(variables('workspaceId'), '/datasets/AccountTable')]",
				"[concat(variables('workspaceId'), '/datasets/Appointment')]",
				"[concat(variables('workspaceId'), '/datasets/Contacttable')]",
				"[concat(variables('workspaceId'), '/datasets/OriginationOpp')]",
				"[concat(variables('workspaceId'), '/datasets/Systemusertable')]",
				"[concat(variables('workspaceId'), '/datasets/Optionsettable')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Join Choices')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "ServerLessSQL2",
								"type": "LinkedServiceReference"
							},
							"name": "RawSource"
						},
						{
							"linkedService": {
								"referenceName": "ChoiceDB DataverseEnriched",
								"type": "LinkedServiceReference"
							},
							"name": "ChoiceAnswer"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsTable2",
								"type": "DatasetReference"
							},
							"name": "FullEnriched"
						}
					],
					"transformations": [],
					"scriptLines": [
						"source(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'query',",
						"     store: 'synapseanalytics',",
						"     query: 'SELECT \\n    *\\nFROM dataverse_montagu_org5a2bcccf',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: true) ~> RawSource",
						"source(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'query',",
						"     store: 'synapseanalytics',",
						"     query: 'SELECT DISTINCT TABLE_NAME \\n    FROM INFORMATION_SCHEMA.COLUMNS\\n\\n     TABLE_SCHEMA= \\'DataverseEnriched\\';',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: true) ~> ChoiceAnswer",
						"RawSource sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> FullEnriched"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/ServerLessSQL2')]",
				"[concat(variables('workspaceId'), '/linkedServices/ChoiceDB DataverseEnriched')]",
				"[concat(variables('workspaceId'), '/datasets/AzureSynapseAnalyticsTable2')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/PH 1 FullEnrich No Cache')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"name": "AccountIn"
						},
						{
							"name": "OriginationOpportunityIn"
						},
						{
							"name": "MeetingsAppointmentsIn"
						},
						{
							"name": "ContactsIn"
						},
						{
							"linkedService": {
								"referenceName": "EnrichedDatabase",
								"type": "LinkedServiceReference"
							},
							"name": "EnrichedAccount"
						},
						{
							"linkedService": {
								"referenceName": "EnrichedDatabase",
								"type": "LinkedServiceReference"
							},
							"name": "EnrichedOriginationOpportunities"
						},
						{
							"linkedService": {
								"referenceName": "EnrichedDatabase",
								"type": "LinkedServiceReference"
							},
							"name": "EnrichedMeetingAppointments"
						},
						{
							"linkedService": {
								"referenceName": "EnrichedDatabase",
								"type": "LinkedServiceReference"
							},
							"name": "EnrichedContacts"
						},
						{
							"name": "SystemUserIn"
						},
						{
							"linkedService": {
								"referenceName": "EnrichedDatabase",
								"type": "LinkedServiceReference"
							},
							"name": "EnrichedSystemUser"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "ReportsAnalytics",
								"type": "LinkedServiceReference"
							},
							"name": "AccountCleanSink"
						},
						{
							"linkedService": {
								"referenceName": "ReportsAnalytics",
								"type": "LinkedServiceReference"
							},
							"name": "MeetingStageCleanSink"
						},
						{
							"linkedService": {
								"referenceName": "ReportsAnalytics",
								"type": "LinkedServiceReference"
							},
							"name": "ContactsStageCleanSink"
						},
						{
							"linkedService": {
								"referenceName": "ReportsAnalytics",
								"type": "LinkedServiceReference"
							},
							"name": "OriginationCleanSink"
						},
						{
							"linkedService": {
								"referenceName": "ReportsAnalytics",
								"type": "LinkedServiceReference"
							},
							"name": "SystemUserSink"
						}
					],
					"transformations": [
						{
							"name": "Originationjoinoutput"
						},
						{
							"name": "AppointmentsJoinOutput"
						},
						{
							"name": "ContactsJoin"
						},
						{
							"name": "AccountEnrichedJoin"
						},
						{
							"name": "SystemUserJoin"
						}
					],
					"scriptLines": [
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          ts_primarysecondaryfocus as long,",
						"          customertypecode as long,",
						"          address1_addresstypecode as long,",
						"          accountclassificationcode as long,",
						"          ts_easeofworking as long,",
						"          ts_ukrow as long,",
						"          preferredappointmenttimecode as long,",
						"          ts_address1addresstype as long,",
						"          xpd_relationshipstatus as long,",
						"          ts_relationship as long,",
						"          xpd_remindermonths as long,",
						"          ts_importance as long,",
						"          address2_freighttermscode as long,",
						"          ts_irrvsmomperformancemeasure as long,",
						"          ts_introducertype as long,",
						"          accountcategorycode as long,",
						"          paymenttermscode as long,",
						"          preferredappointmentdaycode as long,",
						"          businesstypecode as long,",
						"          industrycode as long,",
						"          ts_sizeoffirm as long,",
						"          ts_interaction as long,",
						"          address1_shippingmethodcode as long,",
						"          ts_portfoliocompanystatus as long,",
						"          customersizecode as long,",
						"          xpd_previousinvestorstatus as long,",
						"          ts_recommendationoffirm as long,",
						"          preferredcontactmethodcode as long,",
						"          accountratingcode as long,",
						"          ts_investorstatus as long,",
						"          ts_capabilitiesoffirm as long,",
						"          mpe_flowlastrunoutcome as long,",
						"          address2_addresstypecode as long,",
						"          address2_shippingmethodcode as long,",
						"          ts_nextoriginationmeetingarranged as long,",
						"          ownershipcode as long,",
						"          territorycode as long,",
						"          ts_investortype as long,",
						"          shippingmethodcode as long,",
						"          ts_investorregion as long,",
						"          address1_freighttermscode as long,",
						"          xpd_function as string,",
						"          ts_quickcaptureuses as string,",
						"          xpd_montagulevel as string,",
						"          ts_permanentinterim as string,",
						"          ts_quickcapturesectors as string,",
						"          ts_roletypes as string,",
						"          ts_companytype as string,",
						"          xpd_level as string,",
						"          ts_indicativeclientbase as string,",
						"          xpd_specialisms as string,",
						"          ts_vendorsummary as string,",
						"          ts_producttype as string,",
						"          ts_montaguoffice as string,",
						"          ts_quickcapturegeography as string,",
						"          xpd_roletypes as string,",
						"          mpe_livedeal as boolean,",
						"          donotbulkpostalmail as boolean,",
						"          donotpostalmail as boolean,",
						"          msdyn_gdproptout as boolean,",
						"          ts_organisationalchange as boolean,",
						"          xpd_publictoprivatetracker as boolean,",
						"          ts_auditor as boolean,",
						"          donotsendmm as boolean,",
						"          donotbulkemail as boolean,",
						"          followemail as boolean,",
						"          creditonhold as boolean,",
						"          marketingonly as boolean,",
						"          participatesinworkflow as boolean,",
						"          merged as boolean,",
						"          ts_validated as boolean,",
						"          xpd_sharepointlocationcreated as boolean,",
						"          xpd_setreminder as boolean,",
						"          ts_personnelchange as boolean,",
						"          donotfax as boolean,",
						"          isprivate as boolean,",
						"          donotphone as boolean,",
						"          xpd_rpo as boolean,",
						"          ts_trackcompany as boolean,",
						"          donotemail as boolean,",
						"          parentaccountid as string,",
						"          parentaccountid_entitytype as string,",
						"          ts_recommendedby as string,",
						"          ts_recommendedby_entitytype as string,",
						"          ts_countryofeconomicoriginforthecapital as string,",
						"          ts_countryofeconomicoriginforthecapital_entitytype as string,",
						"          xpd_reminderto as string,",
						"          xpd_reminderto_entitytype as string,",
						"          preferredserviceid as string,",
						"          preferredserviceid_entitytype as string,",
						"          msdyn_segmentid as string,",
						"          msdyn_segmentid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          createdbyexternalparty as string,",
						"          createdbyexternalparty_entitytype as string,",
						"          ts_validatedby as string,",
						"          ts_validatedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          ts_primarymperelationshipmanager as string,",
						"          ts_primarymperelationshipmanager_entitytype as string,",
						"          modifiedbyexternalparty as string,",
						"          modifiedbyexternalparty_entitytype as string,",
						"          ts_headofficeid as string,",
						"          ts_headofficeid_entitytype as string,",
						"          ts_address1country as string,",
						"          ts_address1country_entitytype as string,",
						"          ts_address1usstate as string,",
						"          ts_address1usstate_entitytype as string,",
						"          msdyn_salesaccelerationinsightid as string,",
						"          msdyn_salesaccelerationinsightid_entitytype as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          originatingleadid as string,",
						"          originatingleadid_entitytype as string,",
						"          masterid as string,",
						"          masterid_entitytype as string,",
						"          ts_originationlead1 as string,",
						"          ts_originationlead1_entitytype as string,",
						"          defaultpricelevelid as string,",
						"          defaultpricelevelid_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          ts_originationlead2 as string,",
						"          ts_originationlead2_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          mpe_coinvestquestionnaireid as string,",
						"          mpe_coinvestquestionnaireid_entitytype as string,",
						"          ts_hub as string,",
						"          ts_hub_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          ts_currentauditor as string,",
						"          ts_currentauditor_entitytype as string,",
						"          primarycontactid as string,",
						"          primarycontactid_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          preferredsystemuserid as string,",
						"          preferredsystemuserid_entitytype as string,",
						"          preferredequipmentid as string,",
						"          preferredequipmentid_entitytype as string,",
						"          xpd_fund as string,",
						"          xpd_fund_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          territoryid as string,",
						"          territoryid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          xpd_totalinstitutionalcommitments_base as decimal(38,0),",
						"          ts_minimumticketsize_base as decimal(38,4),",
						"          xpd_totalinstitutionalcommitments as decimal(38,0),",
						"          aging30 as decimal(38,0),",
						"          creditlimit as decimal(38,0),",
						"          creditlimit_base as decimal(38,0),",
						"          ts_totalcommitments_base as decimal(38,4),",
						"          aging60 as decimal(38,0),",
						"          ts_transfersin_base as decimal(38,0),",
						"          aging90 as decimal(38,0),",
						"          ts_maximumticketsize as decimal(38,4),",
						"          ts_totalaum_base as decimal(38,0),",
						"          marketcap_base as decimal(38,0),",
						"          aging60_base as decimal(38,0),",
						"          aging90_base as decimal(38,0),",
						"          ts_transfersout as decimal(38,0),",
						"          ts_maximumticketsize_base as decimal(38,4),",
						"          ts_originalcommitments_base as decimal(38,0),",
						"          revenue as decimal(38,0),",
						"          ts_totalcommitments as decimal(38,4),",
						"          ts_transfersout_base as decimal(38,0),",
						"          ts_totalaum as decimal(38,0),",
						"          ts_commitmentreductions_base as decimal(38,0),",
						"          ts_commitmentreductions as decimal(38,0),",
						"          marketcap as decimal(38,0),",
						"          ts_originalcommitments as decimal(38,0),",
						"          ts_minimumticketsize as decimal(38,4),",
						"          revenue_base as decimal(38,0),",
						"          openrevenue_base as decimal(38,0),",
						"          aging30_base as decimal(38,0),",
						"          openrevenue as decimal(38,0),",
						"          ts_transfersin as decimal(38,0),",
						"          ts_othernotes as string,",
						"          ts_transfersin_date as timestamp,",
						"          msdyn_salesaccelerationinsightidname as string,",
						"          address1_county as string,",
						"          openrevenue_date as timestamp,",
						"          ts_recommendedbyname as string,",
						"          ts_relationshipinteractioncomments as string,",
						"          ts_originationlead2yominame as string,",
						"          parentaccountidname as string,",
						"          xpd_roletypes_text as string,",
						"          address1_addressid as string,",
						"          importsequencenumber as long,",
						"          address1_longitude as double,",
						"          ts_countryofeconomicoriginforthecapitalname as string,",
						"          entityimageid as string,",
						"          telephone2 as string,",
						"          ts_lastoriginationmeeting as timestamp,",
						"          address2_utcoffset as long,",
						"          address1_upszone as string,",
						"          ts_originalcommitments_state as long,",
						"          ts_typicalcost as string,",
						"          xpd_recommendingportfoliocompaniesrecommended as string,",
						"          accountnumber as string,",
						"          ts_currentauditoryominame as string,",
						"          ts_originalcommitments_date as timestamp,",
						"          lastonholdtime as timestamp,",
						"          ts_sectorscoveredbyfirm as string,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          address2_upszone as string,",
						"          opendeals_state as long,",
						"          xpd_functionuse_text as string,",
						"          slainvokedidname as string,",
						"          address2_longitude as double,",
						"          defaultpricelevelidname as string,",
						"          stockexchange as string,",
						"          mpe_liveofferingscount_date as timestamp,",
						"          xpd_relationshipcomments as string,",
						"          originatingleadidname as string,",
						"          slaname as string,",
						"          ts_currentauditorname as string,",
						"          xpd_remindertoyominame as string,",
						"          ts_address1usstatename as string,",
						"          ts_tempcompanytype as string,",
						"          versionnumber as long,",
						"          address1_latitude as double,",
						"          ts_formername as string,",
						"          yominame as string,",
						"          createdbyyominame as string,",
						"          ts_cityofvisit as string,",
						"          address2_telephone1 as string,",
						"          ts_globalgeographiescoveredids as string,",
						"          preferredserviceidname as string,",
						"          address2_city as string,",
						"          ts_mpeapproachstrategy as string,",
						"          address2_line2 as string,",
						"          ts_lastdatestatuschanged as timestamp,",
						"          li_companyid as long,",
						"          transactioncurrencyidname as string,",
						"          entityimage_url as string,",
						"          xpd_relationshipstatuschangeddate as timestamp,",
						"          createdonbehalfbyname as string,",
						"          mpe_liveofferingscount_state as long,",
						"          xpd_numberofcoinvestinvestments_date as timestamp,",
						"          ts_validateddate as timestamp,",
						"          owneridname as string,",
						"          xpd_generalcomments as string,",
						"          ts_companylegalname as string,",
						"          description as string,",
						"          ts_validatedbyname as string,",
						"          originatingleadidyominame as string,",
						"          opendeals as long,",
						"          xpd_numberofopportunitiesshown_state as long,",
						"          address2_postalcode as string,",
						"          websiteurl as string,",
						"          xpd_fundname as string,",
						"          address1_utcoffset as long,",
						"          exchangerate as decimal(38,10),",
						"          mpe_flowlastrundate as timestamp,",
						"          fax as string,",
						"          address1_line3 as string,",
						"          ts_monthssincelastmeeting as long,",
						"          ts_hubname as string,",
						"          address2_line1 as string,",
						"          ts_capiqticket as string,",
						"          address2_stateorprovince as string,",
						"          address2_name as string,",
						"          ts_transfersout_state as long,",
						"          xpd_numberofopportunitiesshown as long,",
						"          primarytwitterid as string,",
						"          mpe_coinvestquestionnaireidname as string,",
						"          xpd_numberofopportunitiesshown_date as timestamp,",
						"          xpd_preferentialterms as string,",
						"          address1_primarycontactname as string,",
						"          territoryidname as string,",
						"          ts_processstatus as string,",
						"          address1_name as string,",
						"          address2_telephone2 as string,",
						"          address2_telephone3 as string,",
						"          xpd_recruitmentareateam_text as string,",
						"          ftpsiteurl as string,",
						"          address1_postalcode as string,",
						"          ts_companynumber as string,",
						"          createdon as string,",
						"          mpe_liveofferingscount as long,",
						"          traversedpath as string,",
						"          address1_stateorprovince as string,",
						"          ts_transfersin_state as long,",
						"          address2_addressid as string,",
						"          ts_monthlyreviewmeetingname as string,",
						"          primarysatoriid as string,",
						"          telephone3 as string,",
						"          openrevenue_state as long,",
						"          ts_usesprovidedids as string,",
						"          ts_originationcomments as string,",
						"          lastusedincampaign as timestamp,",
						"          primarycontactidname as string,",
						"          ts_originationlead1name as string,",
						"          ts_headofficeidname as string,",
						"          msdyn_segmentidname as string,",
						"          ts_montagucomments as string,",
						"          address2_fax as string,",
						"          createdbyname as string,",
						"          xpd_numberofcoinvestinvestments as long,",
						"          ts_capitaliqlink as string,",
						"          ts_primarymperelationshipmanagername as string,",
						"          mpe_relationshipstatus_text as string,",
						"          xpd_datereminderwasset as timestamp,",
						"          xpd_numberofcoinvestinvestments_state as long,",
						"          address1_postofficebox as string,",
						"          address1_city as string,",
						"          teamsfollowed as long,",
						"          ts_originationlead2name as string,",
						"          timezoneruleversionnumber as long,",
						"          modifiedonbehalfbyyominame as string,",
						"          entityimage_timestamp as long,",
						"          tickersymbol as string,",
						"          ts_theirprogrammecomments as string,",
						"          xpd_companyuse_text as string,",
						"          modifiedbyname as string,",
						"          owneridtype as string,",
						"          sic as string,",
						"          sharesoutstanding as long,",
						"          opendeals_date as timestamp,",
						"          address2_postofficebox as string,",
						"          emailaddress3 as string,",
						"          emailaddress2 as string,",
						"          emailaddress1 as string,",
						"          ts_globalgeographiescoveredbyfirm as string,",
						"          ts_recommendationoffirmupdated as timestamp,",
						"          ts_lastmet as timestamp,",
						"          ts_reminderdatesetto as timestamp,",
						"          ts_commitmentreductions_state as long,",
						"          owningbusinessunitname as string,",
						"          onholdtime as long,",
						"          ts_alias as string,",
						"          createdonbehalfbyyominame as string,",
						"          ts_transfersout_date as timestamp,",
						"          ts_address1countryname as string,",
						"          preferredsystemuseridyominame as string,",
						"          createdbyexternalpartyname as string,",
						"          mpe_documentsetid as string,",
						"          telephone1 as string,",
						"          ts_legacycompanytypes as string,",
						"          ts_validatedbyyominame as string,",
						"          address1_composite as string,",
						"          ts_investorgroupgatekeeperid as string,",
						"          primarycontactidyominame as string,",
						"          address2_country as string,",
						"          xpd_recommendationcomments as string,",
						"          owneridyominame as string,",
						"          createdbyexternalpartyyominame as string,",
						"          ts_originationlead1yominame as string,",
						"          ts_usesprovidedbyfirm as string,",
						"          xpd_recommendingportco as string,",
						"          address1_country as string,",
						"          ts_commitmentreductions_date as timestamp,",
						"          name as string,",
						"          modifiedbyexternalpartyyominame as string,",
						"          xpd_remindertoname as string,",
						"          stageid as string,",
						"          modifiedonbehalfbyname as string,",
						"          masteraccountidname as string,",
						"          timespentbymeonemailandmeetings as string,",
						"          address2_latitude as double,",
						"          overriddencreatedon as timestamp,",
						"          parentaccountidyominame as string,",
						"          ts_specificareaofexpertisecomments as string,",
						"          preferredsystemuseridname as string,",
						"          utcconversiontimezonecode as long,",
						"          address2_county as string,",
						"          address1_line1 as string,",
						"          address2_primarycontactname as string,",
						"          address1_line2 as string,",
						"          xpd_reasonaction as string,",
						"          ts_primarymperelationshipmanageryominame as string,",
						"          processid as string,",
						"          ts_sectorscoveredids as string,",
						"          ts_recommendedbyyominame as string,",
						"          modifiedbyexternalpartyname as string,",
						"          ts_relevantsituations as string,",
						"          accountid as string,",
						"          modifiedon as timestamp,",
						"          preferredequipmentidname as string,",
						"          modifiedbyyominame as string,",
						"          ts_dealstageofmostrecentopportunity as string,",
						"          address2_composite as string,",
						"          masteraccountidyominame as string,",
						"          numberofemployees as long,",
						"          address1_fax as string,",
						"          address2_line3 as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'account') ~> AccountIn",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          ts_dealannouncedreason as long,",
						"          ts_highprioritynew as long,",
						"          ts_actionstatus as long,",
						"          mpe_targetrelationshipstatus as long,",
						"          mpe_carveout as long,",
						"          ts_producttype as long,",
						"          ts_internalintermediarysource as long,",
						"          mpe_flowlastrunoutcome as long,",
						"          ts_currentactivity as long,",
						"          ts_opportunitystatus as long,",
						"          ts_montaguprimaryoffice as long,",
						"          ts_opportunitytype as long,",
						"          ts_posthumstatus as long,",
						"          ts_meetingremindermonths as long,",
						"          ts_choppedreason as string,",
						"          ts_setreminder as boolean,",
						"          ts_stagereachedfir as boolean,",
						"          ts_stagereachedipr as boolean,",
						"          ts_duplicateopportunityfordiscussion as boolean,",
						"          mpe_smalltarget as boolean,",
						"          ts_stagereachedcr as boolean,",
						"          xpd_includeonallpapers as boolean,",
						"          ts_sold as boolean,",
						"          xpd_sharepointlocationcreated as boolean,",
						"          ts_statuschangedby as string,",
						"          ts_statuschangedby_entitytype as string,",
						"          ts_buyer as string,",
						"          ts_buyer_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          ts_reminderto as string,",
						"          ts_reminderto_entitytype as string,",
						"          mpe_productid as string,",
						"          mpe_productid_entitytype as string,",
						"          ts_targetbusiness as string,",
						"          ts_targetbusiness_entitytype as string,",
						"          ts_firstreferralcompany as string,",
						"          ts_firstreferralcompany_entitytype as string,",
						"          ts_deallead as string,",
						"          ts_deallead_entitytype as string,",
						"          ts_montaguowner as string,",
						"          ts_montaguowner_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          ts_firstreferralcontact as string,",
						"          ts_firstreferralcontact_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ts_managerwedback as string,",
						"          ts_managerwedback_entitytype as string,",
						"          ts_country as string,",
						"          ts_country_entitytype as string,",
						"          mpe_targetbusiness_parentid as string,",
						"          mpe_targetbusiness_parentid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          ts_sellmandate as string,",
						"          ts_sellmandate_entitytype as string,",
						"          ts_estebitda_base as decimal(38,4),",
						"          ts_estebit_base as decimal(38,4),",
						"          ts_estebitda as decimal(38,4),",
						"          ts_estebit as decimal(38,4),",
						"          ts_estturnover_base as decimal(38,4),",
						"          ts_estdealsize as decimal(38,4),",
						"          ts_estdealsize_base as decimal(38,4),",
						"          ts_estturnover as decimal(38,4),",
						"          ts_buyeryominame as string,",
						"          modifiedon as timestamp,",
						"          ts_statuschangedbyname as string,",
						"          ts_managerwedbackyominame as string,",
						"          xpd_montaguprojectname as string,",
						"          transactioncurrencyidname as string,",
						"          ts_nextsteps as string,",
						"          ts_montaguowneryominame as string,",
						"          ts_firstreferralcontactname as string,",
						"          ts_opportunitydescription as string,",
						"          ts_buyerpaidxltmebitda as decimal(38,1),",
						"          ts_targetbusinessyominame as string,",
						"          ts_montaguownername as string,",
						"          ts_managerwedbackname as string,",
						"          ts_opportunitystage as string,",
						"          ts_otherdocumentsurl as string,",
						"          exchangerate as decimal(38,10),",
						"          mpe_documentsetid as string,",
						"          ts_buyername as string,",
						"          ts_firstreferralcontactyominame as string,",
						"          createdon as string,",
						"          ts_sellmandateyominame as string,",
						"          mpe_montaguprimaryofficestring as string,",
						"          ts_statuschangedbyyominame as string,",
						"          ts_firstreferralcompanyname as string,",
						"          owneridyominame as string,",
						"          ts_choppedcomments as string,",
						"          timezoneruleversionnumber as long,",
						"          createdbyname as string,",
						"          ts_dealleadname as string,",
						"          owningbusinessunitname as string,",
						"          ts_dealleadyominame as string,",
						"          ts_lastdatestatuschanged as timestamp,",
						"          traversedpath as string,",
						"          overriddencreatedon as timestamp,",
						"          ts_iprdocumenturl as string,",
						"          createdonbehalfbyname as string,",
						"          ts_sellmandatename as string,",
						"          owneridtype as string,",
						"          owneridname as string,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          mpe_productidname as string,",
						"          mpe_targetbusiness_parentidyominame as string,",
						"          ts_originationopportunityid as string,",
						"          ts_crdocumenturl as string,",
						"          ts_datedealannounced as timestamp,",
						"          processid as string,",
						"          mpe_montaguprimaryofficeowner as string,",
						"          ts_reason as string,",
						"          ts_targetbusinessname as string,",
						"          ts_remindertoname as string,",
						"          ts_postcompletionnoteurl as string,",
						"          ts_name as string,",
						"          stageid as string,",
						"          ts_currentopportunitystatus as string,",
						"          ts_firstreferralcompanyyominame as string,",
						"          mpe_flowlastrundate as timestamp,",
						"          ts_firdocumenturl as string,",
						"          modifiedbyyominame as string,",
						"          modifiedonbehalfbyyominame as string,",
						"          ts_movedoutofwipdate as timestamp,",
						"          ts_equitychequesize as decimal(38,2),",
						"          utcconversiontimezonecode as long,",
						"          mpe_targetbusiness_parentidname as string,",
						"          ts_weofferedxltmebitda as decimal(38,1),",
						"          importsequencenumber as long,",
						"          ts_remindertoyominame as string,",
						"          ts_companyid as long,",
						"          ts_datereminderwasset as timestamp,",
						"          versionnumber as long,",
						"          ts_originationid as long,",
						"          ts_countryname as string,",
						"          ts_choppeddate as timestamp,",
						"          mpe_posthunstatustext as string,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          ts_humdate as timestamp,",
						"          ts_sellmandateidtype as string,",
						"          ts_dateofreminder as timestamp,",
						"          ts_humurl as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'ts_originationopportunity') ~> OriginationOpportunityIn",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          ts_stageofmeetingrounds as long,",
						"          ts_talentmeetingtype as long,",
						"          instancetypecode as long,",
						"          ts_whooriginatedthemeeting as long,",
						"          onlinemeetingtype as long,",
						"          ts_meetingteam as long,",
						"          ts_othermeetingmethod as long,",
						"          ts_tone as long,",
						"          ts_meetingmethod as long,",
						"          ts_originationmeetingtype as long,",
						"          prioritycode as long,",
						"          attachmenterrors as long,",
						"          ts_eventtype as long,",
						"          ts_talentmeetingmethod as long,",
						"          ts_productsdiscussed as string,",
						"          ts_contentcovered as string,",
						"          isonlinemeeting as boolean,",
						"          isworkflowcreated as boolean,",
						"          isalldayevent as boolean,",
						"          ts_interview as boolean,",
						"          isbilled as boolean,",
						"          isdraft as boolean,",
						"          ts_keyiractivity as boolean,",
						"          ts_noninvestor as boolean,",
						"          ismapiprivate as boolean,",
						"          isregularactivity as boolean,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          ts_investorgroup as string,",
						"          ts_investorgroup_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          regardingobjectid as string,",
						"          regardingobjectid_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ts_officemet as string,",
						"          ts_officemet_entitytype as string,",
						"          ts_taskowner as string,",
						"          ts_taskowner_entitytype as string,",
						"          serviceid as string,",
						"          serviceid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          requiredattendees as string,",
						"          optionalattendees as string,",
						"          organizer as string,",
						"          scheduledend as timestamp,",
						"          ts_taskdescription as string,",
						"          modifiedon as timestamp,",
						"          ts_purpose as string,",
						"          overriddencreatedon as timestamp,",
						"          ts_taskownername as string,",
						"          activityadditionalparams as string,",
						"          ts_tonepersonalities as string,",
						"          seriesid as string,",
						"          transactioncurrencyidname as string,",
						"          activityid as string,",
						"          modifiedfieldsmask as string,",
						"          utcconversiontimezonecode as long,",
						"          ts_officemetname as string,",
						"          scheduledstart as timestamp,",
						"          outlookownerapptid as long,",
						"          ts_topicscovered as string,",
						"          ts_objective as string,",
						"          onholdtime as long,",
						"          onlinemeetingjoinurl as string,",
						"          ts_notes as string,",
						"          originalstartdate as timestamp,",
						"          ts_opportunitiesdiscussed as string,",
						"          ts_sectorscoveredbyfirm as string,",
						"          attachmentcount as long,",
						"          exchangerate as decimal(38,10),",
						"          ts_originationcommentsnotes as string,",
						"          category as string,",
						"          createdon as string,",
						"          ts_eventdescription as string,",
						"          globalobjectid as string,",
						"          onlinemeetingid as string,",
						"          serviceidname as string,",
						"          owneridyominame as string,",
						"          description as string,",
						"          subcategory as string,",
						"          owningbusinessunitname as string,",
						"          ts_taskduedate as timestamp,",
						"          traversedpath as string,",
						"          sortdate as timestamp,",
						"          createdonbehalfbyname as string,",
						"          ts_sectorscoveredids as string,",
						"          safedescription as string,",
						"          ts_taskowneryominame as string,",
						"          owneridtype as string,",
						"          isunsafe as long,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          ts_conferencename as string,",
						"          timezoneruleversionnumber as long,",
						"          actualend as timestamp,",
						"          regardingobjectidname as string,",
						"          processid as string,",
						"          activitytypecode as string,",
						"          actualstart as timestamp,",
						"          xpd_listofexternalattendees as string,",
						"          slainvokedidname as string,",
						"          location as string,",
						"          subject as string,",
						"          createdbyname as string,",
						"          actualdurationminutes as long,",
						"          modifiedbyyominame as string,",
						"          lastonholdtime as timestamp,",
						"          modifiedonbehalfbyyominame as string,",
						"          ts_attendeestoaddtocrm as string,",
						"          regardingobjectidyominame as string,",
						"          regardingobjecttypecode as string,",
						"          stageid as string,",
						"          scheduleddurationminutes as long,",
						"          ts_sourceid as string,",
						"          ts_investorgroupyominame as string,",
						"          importsequencenumber as long,",
						"          subscriptionid as string,",
						"          onlinemeetingchatid as string,",
						"          ts_lpupdates as string,",
						"          ts_executivesummary as string,",
						"          ts_investorgroupname as string,",
						"          ts_meetingcity as string,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          owneridname as string,",
						"          ts_theirprogramme as string,",
						"          ts_ifdeclinedreason as string,",
						"          slaname as string,",
						"          versionnumber as long",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'appointment') ~> MeetingsAppointmentsIn",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          haschildrencode as long,",
						"          customertypecode as long,",
						"          ts_recommendationofindividual as long,",
						"          gendercode as long,",
						"          address1_addresstypecode as long,",
						"          leadsourcecode as long,",
						"          preferredappointmenttimecode as long,",
						"          address2_freighttermscode as long,",
						"          address2_shippingmethodcode as long,",
						"          ts_debtsubtype as long,",
						"          msdyn_orgchangestatus as long,",
						"          ts_suffix as long,",
						"          xpd_gender as long,",
						"          ts_title as long,",
						"          paymenttermscode as long,",
						"          accountrolecode as long,",
						"          territorycode as long,",
						"          ts_vendortargettrackingrole as long,",
						"          address3_freighttermscode as long,",
						"          address1_shippingmethodcode as long,",
						"          preferredappointmentdaycode as long,",
						"          customersizecode as long,",
						"          preferredcontactmethodcode as long,",
						"          ts_futurecontactmethod as long,",
						"          address3_shippingmethodcode as long,",
						"          address2_addresstypecode as long,",
						"          mpe_flowlastrunoutcome as long,",
						"          ts_capabilitiesofindividual as long,",
						"          address3_addresstypecode as long,",
						"          familystatuscode as long,",
						"          shippingmethodcode as long,",
						"          xpd_availability as long,",
						"          educationcode as long,",
						"          address1_freighttermscode as long,",
						"          ts_quickcaptureuses as string,",
						"          xpd_montagulevel as string,",
						"          ts_permanentinterim as string,",
						"          ts_ircontactrole as string,",
						"          xpd_level as string,",
						"          ts_languagesspokenwritten as string,",
						"          ts_contacttype as string,",
						"          ts_montaguoffice as string,",
						"          ts_roletypes as string,",
						"          xpd_specialisms as string,",
						"          ts_quickcapturesectors as string,",
						"          xpd_function as string,",
						"          ts_producttype as string,",
						"          ts_quickcapturegeography as string,",
						"          ts_productsinterestedin as string,",
						"          ts_potentialrolecandidate as boolean,",
						"          isbackofficecustomer as boolean,",
						"          donotpostalmail as boolean,",
						"          xpd_addcontacttooutlook as boolean,",
						"          ts_centralrelationshipmanager as boolean,",
						"          msdyn_gdproptout as boolean,",
						"          xpd_hascompany as boolean,",
						"          creditonhold as boolean,",
						"          xpd_benchcandidate as boolean,",
						"          donotbulkpostalmail as boolean,",
						"          donotsendmm as boolean,",
						"          donotbulkemail as boolean,",
						"          followemail as boolean,",
						"          xpd_sharepointdocumentlocationcreated as boolean,",
						"          xpd_available as boolean,",
						"          ts_leadearlystageinteraction as boolean,",
						"          participatesinworkflow as boolean,",
						"          ts_doyouwishtotrackthiscontact as boolean,",
						"          merged as boolean,",
						"          ts_validated as boolean,",
						"          marketingonly as boolean,",
						"          donotfax as boolean,",
						"          isprivate as boolean,",
						"          donotphone as boolean,",
						"          isautocreate as boolean,",
						"          donotemail as boolean,",
						"          ts_unconfirmedemailaddress as boolean,",
						"          preferredsystemuserid as string,",
						"          preferredsystemuserid_entitytype as string,",
						"          mpe_accountid as string,",
						"          mpe_accountid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          ts_recommendedby as string,",
						"          ts_recommendedby_entitytype as string,",
						"          ts_previousemployerid as string,",
						"          ts_previousemployerid_entitytype as string,",
						"          preferredserviceid as string,",
						"          preferredserviceid_entitytype as string,",
						"          parentcontactid as string,",
						"          parentcontactid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          ts_pa as string,",
						"          ts_pa_entitytype as string,",
						"          ts_businessaddress as string,",
						"          ts_businessaddress_entitytype as string,",
						"          modifiedbyexternalparty as string,",
						"          modifiedbyexternalparty_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          originatingleadid as string,",
						"          originatingleadid_entitytype as string,",
						"          masterid as string,",
						"          masterid_entitytype as string,",
						"          defaultpricelevelid as string,",
						"          defaultpricelevelid_entitytype as string,",
						"          parent_contactid as string,",
						"          parent_contactid_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          createdbyexternalparty as string,",
						"          createdbyexternalparty_entitytype as string,",
						"          preferredequipmentid as string,",
						"          preferredequipmentid_entitytype as string,",
						"          xpd_referredbyinternal as string,",
						"          xpd_referredbyinternal_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          xpd_homecountry as string,",
						"          xpd_homecountry_entitytype as string,",
						"          ts_placementfirmintroducedby as string,",
						"          ts_placementfirmintroducedby_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          accountid as string,",
						"          accountid_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          parentcustomerid as string,",
						"          parentcustomerid_entitytype as string,",
						"          xpd_referredbyexternal as string,",
						"          xpd_referredbyexternal_entitytype as string,",
						"          aging30 as decimal(38,2),",
						"          creditlimit_base as decimal(38,4),",
						"          aging60 as decimal(38,2),",
						"          aging90 as decimal(38,2),",
						"          aging60_base as decimal(38,4),",
						"          aging90_base as decimal(38,4),",
						"          annualincome_base as decimal(38,4),",
						"          creditlimit as decimal(38,2),",
						"          annualincome as decimal(38,2),",
						"          aging30_base as decimal(38,4),",
						"          ts_othernotes as string,",
						"          xpd_referredbyinternalyominame as string,",
						"          address1_county as string,",
						"          yomilastname as string,",
						"          address3_utcoffset as long,",
						"          ts_recommendedbyname as string,",
						"          description as string,",
						"          li_membertoken as string,",
						"          department as string,",
						"          xpd_roletypes_text as string,",
						"          address1_addressid as string,",
						"          importsequencenumber as long,",
						"          address1_longitude as double,",
						"          address3_fax as string,",
						"          managername as string,",
						"          entityimageid as string,",
						"          telephone2 as string,",
						"          parentcustomeridtype as string,",
						"          address2_upszone as string,",
						"          address1_upszone as string,",
						"          xpd_recommendingportfoliocompaniesrecommended as string,",
						"          lastonholdtime as timestamp,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          address1_fax as string,",
						"          address3_telephone1 as string,",
						"          address3_telephone2 as string,",
						"          address3_telephone3 as string,",
						"          fax as string,",
						"          assistantname as string,",
						"          address2_line3 as string,",
						"          accountidyominame as string,",
						"          parentcontactidyominame as string,",
						"          mpe_accountidyominame as string,",
						"          slainvokedidname as string,",
						"          defaultpricelevelidname as string,",
						"          fullname as string,",
						"          address2_longitude as double,",
						"          subscriptionid as string,",
						"          originatingleadidname as string,",
						"          slaname as string,",
						"          versionnumber as long,",
						"          address1_latitude as double,",
						"          createdbyyominame as string,",
						"          parent_contactidname as string,",
						"          address2_telephone1 as string,",
						"          pager as string,",
						"          salutation as string,",
						"          mpe_accountidname as string,",
						"          xpd_functionuse_text as string,",
						"          accountidname as string,",
						"          mpe_companysummary as string,",
						"          parent_contactidyominame as string,",
						"          preferredserviceidname as string,",
						"          address2_city as string,",
						"          address3_postalcode as string,",
						"          address2_line2 as string,",
						"          li_companyid as long,",
						"          ts_otherphonelabel as string,",
						"          ts_reportingemail as string,",
						"          address3_upszone as string,",
						"          transactioncurrencyidname as string,",
						"          address3_county as string,",
						"          entityimage_url as string,",
						"          governmentid as string,",
						"          callback as string,",
						"          business2 as string,",
						"          createdonbehalfbyname as string,",
						"          ts_validateddate as timestamp,",
						"          address2_telephone2 as string,",
						"          owneridname as string,",
						"          originatingleadidyominame as string,",
						"          ts_otherlanguages as string,",
						"          address2_postalcode as string,",
						"          birthdate as timestamp,",
						"          parentcontactidname as string,",
						"          spousesname as string,",
						"          xpd_compensationdate as timestamp,",
						"          address1_utcoffset as long,",
						"          address3_line1 as string,",
						"          traversedpath as string,",
						"          exchangerate as decimal(38,10),",
						"          mpe_flowlastrundate as timestamp,",
						"          address1_line3 as string,",
						"          address3_country as string,",
						"          mpe_documentsetid as string,",
						"          address2_line1 as string,",
						"          ts_previousemployeridyominame as string,",
						"          middlename as string,",
						"          managerphone as string,",
						"          address2_stateorprovince as string,",
						"          childrensnames as string,",
						"          address2_name as string,",
						"          address3_addressid as string,",
						"          address3_stateorprovince as string,",
						"          ts_sectorspecialtyids as string,",
						"          businesscardattributes as string,",
						"          anniversary as timestamp,",
						"          ts_employmentstartdate as timestamp,",
						"          ts_legacycontacttypes as string,",
						"          address1_primarycontactname as string,",
						"          address2_utcoffset as long,",
						"          home2 as string,",
						"          ts_geographicspecialtyids as string,",
						"          address1_name as string,",
						"          ts_recommendationcomments as string,",
						"          address2_telephone3 as string,",
						"          address3_primarycontactname as string,",
						"          ftpsiteurl as string,",
						"          address1_postalcode as string,",
						"          createdon as string,",
						"          address1_stateorprovince as string,",
						"          yomimiddlename as string,",
						"          jobtitle as string,",
						"          telephone3 as string,",
						"          ts_usesspeciality as string,",
						"          ts_knowntouserinitials as string,",
						"          address2_fax as string,",
						"          createdbyname as string,",
						"          xpd_contactuse_text as string,",
						"          ts_sourceid as string,",
						"          address2_addressid as string,",
						"          employeeid as string,",
						"          address1_postofficebox as string,",
						"          address1_city as string,",
						"          ts_businessaddressname as string,",
						"          teamsfollowed as long,",
						"          ts_cv as string,",
						"          timezoneruleversionnumber as long,",
						"          modifiedonbehalfbyyominame as string,",
						"          xpd_hrcompensation as string,",
						"          ts_currentbonusandorupliftconsiderations as string,",
						"          modifiedbyname as string,",
						"          address3_line2 as string,",
						"          yomifullname as string,",
						"          owneridtype as string,",
						"          entityimage_timestamp as long,",
						"          ts_placementfirmintroducedbyyominame as string,",
						"          xpd_previousrole as string,",
						"          ts_compensation as string,",
						"          address2_postofficebox as string,",
						"          emailaddress3 as string,",
						"          emailaddress2 as string,",
						"          emailaddress1 as string,",
						"          ts_interactioncontactuniqueidentifier as string,",
						"          ts_investmentcafeid as string,",
						"          websiteurl as string,",
						"          nickname as string,",
						"          ts_lastmet as timestamp,",
						"          address3_name as string,",
						"          ts_usesspecialtyids as string,",
						"          ts_linkedinurl as string,",
						"          lastname as string,",
						"          address3_longitude as double,",
						"          xpd_referredbyexternalidtype as string,",
						"          parentcustomeridname as string,",
						"          owningbusinessunitname as string,",
						"          onholdtime as long,",
						"          createdonbehalfbyyominame as string,",
						"          preferredsystemuseridyominame as string,",
						"          createdbyexternalpartyname as string,",
						"          ts_tone as string,",
						"          telephone1 as string,",
						"          overriddencreatedon as timestamp,",
						"          address3_postofficebox as string,",
						"          assistantphone as string,",
						"          address1_composite as string,",
						"          address3_line3 as string,",
						"          address2_country as string,",
						"          xpd_referredbyinternalname as string,",
						"          mobilephone as string,",
						"          owneridyominame as string,",
						"          address1_line1 as string,",
						"          createdbyexternalpartyyominame as string,",
						"          xpd_referredbyexternalyominame as string,",
						"          yomifirstname as string,",
						"          mastercontactidname as string,",
						"          address3_city as string,",
						"          address1_country as string,",
						"          externaluseridentifier as string,",
						"          modifiedbyexternalpartyyominame as string,",
						"          firstname as string,",
						"          xpd_hrcurrentbonusandorupliftconsiderations as string,",
						"          stageid as string,",
						"          modifiedonbehalfbyname as string,",
						"          xpd_homecountryname as string,",
						"          mastercontactidyominame as string,",
						"          suffix as string,",
						"          ts_payominame as string,",
						"          lastusedincampaign as timestamp,",
						"          ts_geographicspeciality as string,",
						"          xpd_recruitmentareateam_text as string,",
						"          ts_retentionreviewdate as timestamp,",
						"          parentcustomeridyominame as string,",
						"          timespentbymeonemailandmeetings as string,",
						"          address2_latitude as double,",
						"          xpd_availablefrom as timestamp,",
						"          address3_composite as string,",
						"          xpd_recommendingportco as string,",
						"          preferredsystemuseridname as string,",
						"          utcconversiontimezonecode as long,",
						"          address2_county as string,",
						"          ts_paname as string,",
						"          contactid as string,",
						"          address2_primarycontactname as string,",
						"          ts_specificareasofexpertisecomments as string,",
						"          address1_line2 as string,",
						"          ts_recommendationofindividualupdated as timestamp,",
						"          xpd_referredbyexternalname as string,",
						"          ts_placementfirmintroducedbyname as string,",
						"          ts_sectorspeciality as string,",
						"          ts_previousemployeridname as string,",
						"          processid as string,",
						"          ts_recommendedbyyominame as string,",
						"          modifiedon as timestamp,",
						"          modifiedbyexternalpartyname as string,",
						"          ts_relevantsituations as string,",
						"          businesscard as string,",
						"          company as string,",
						"          preferredequipmentidname as string,",
						"          modifiedbyyominame as string,",
						"          ts_preferredname as string,",
						"          address2_composite as string,",
						"          numberofchildren as long,",
						"          address3_latitude as double,",
						"          mpe_companysearchbyemail as boolean,",
						"          msdyn_segmentid as string,",
						"          msdyn_segmentid_entitytype as string,",
						"          msdyn_segmentidname as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'contact') ~> ContactsIn",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          stateAZOption as string,",
						"          statusAZOption as string,",
						"          ts_primarysecondaryfocus as string,",
						"          customertypeAZOption as string,",
						"          address1_addresstypeAZOption as string,",
						"          accountclassificationAZOption as string,",
						"          ts_easeofworking as string,",
						"          ts_ukrow as string,",
						"          preferredappointmenttimeAZOption as string,",
						"          ts_address1addresstype as string,",
						"          xpd_relationshipstatus as string,",
						"          ts_relationship as string,",
						"          xpd_remindermonths as string,",
						"          ts_importance as string,",
						"          address2_freighttermsAZOption as string,",
						"          ts_irrvsmomperformancemeasure as string,",
						"          ts_introducertype as string,",
						"          accountcategoryAZOption as string,",
						"          paymenttermsAZOption as string,",
						"          preferredappointmentdayAZOption as string,",
						"          businesstypeAZOption as string,",
						"          industryAZOption as string,",
						"          ts_sizeoffirm as string,",
						"          ts_interaction as string,",
						"          address1_shippingmethodAZOption as string,",
						"          ts_portfoliocompanystatus as string,",
						"          customersizeAZOption as string,",
						"          xpd_previousinvestorstatus as string,",
						"          ts_recommendationoffirm as string,",
						"          preferredcontactmethodAZOption as string,",
						"          accountratingAZOption as string,",
						"          ts_investorstatus as string,",
						"          ts_capabilitiesoffirm as string,",
						"          mpe_flowlastrunoutcome as string,",
						"          address2_addresstypeAZOption as string,",
						"          address2_shippingmethodAZOption as string,",
						"          ts_nextoriginationmeetingarranged as string,",
						"          ownershipAZOption as string,",
						"          territoryAZOption as string,",
						"          ts_investortype as string,",
						"          shippingmethodAZOption as string,",
						"          ts_investorregion as string,",
						"          address1_freighttermsAZOption as string,",
						"          xpd_function as string,",
						"          ts_quickcaptureuses as string,",
						"          xpd_montagulevel as string,",
						"          ts_permanentinterim as string,",
						"          ts_quickcapturesectors as string,",
						"          ts_roletypes as string,",
						"          ts_companytype as string,",
						"          xpd_level as string,",
						"          ts_indicativeclientbase as string,",
						"          xpd_specialisms as string,",
						"          ts_vendorsummary as string,",
						"          ts_producttype as string,",
						"          ts_montaguoffice as string,",
						"          ts_quickcapturegeography as string,",
						"          xpd_roletypes as string,",
						"          mpe_livedeal as string,",
						"          donotbulkpostalmail as string,",
						"          donotpostalmail as string,",
						"          msdyn_gdproptout as string,",
						"          ts_organisationalchange as string,",
						"          xpd_publictoprivatetracker as string,",
						"          ts_auditor as string,",
						"          donotsendmm as string,",
						"          donotbulkemail as string,",
						"          followemail as string,",
						"          creditonhold as string,",
						"          marketingonly as string,",
						"          participatesinworkflow as string,",
						"          merged as string,",
						"          ts_validated as string,",
						"          xpd_sharepointlocationcreated as string,",
						"          xpd_setreminder as string,",
						"          ts_personnelchange as string,",
						"          donotfax as string,",
						"          isprivate as string,",
						"          donotphone as string,",
						"          xpd_rpo as string,",
						"          ts_trackcompany as string,",
						"          donotemail as string,",
						"          parentaccountid as string,",
						"          parentaccountid_entitytype as string,",
						"          ts_recommendedby as string,",
						"          ts_recommendedby_entitytype as string,",
						"          ts_countryofeconomicoriginforthecapital as string,",
						"          ts_countryofeconomicoriginforthecapital_entitytype as string,",
						"          xpd_reminderto as string,",
						"          xpd_reminderto_entitytype as string,",
						"          preferredserviceid as string,",
						"          preferredserviceid_entitytype as string,",
						"          msdyn_segmentid as string,",
						"          msdyn_segmentid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          createdbyexternalparty as string,",
						"          createdbyexternalparty_entitytype as string,",
						"          ts_validatedby as string,",
						"          ts_validatedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          ts_primarymperelationshipmanager as string,",
						"          ts_primarymperelationshipmanager_entitytype as string,",
						"          modifiedbyexternalparty as string,",
						"          modifiedbyexternalparty_entitytype as string,",
						"          ts_headofficeid as string,",
						"          ts_headofficeid_entitytype as string,",
						"          ts_address1country as string,",
						"          ts_address1country_entitytype as string,",
						"          ts_address1usstate as string,",
						"          ts_address1usstate_entitytype as string,",
						"          msdyn_salesaccelerationinsightid as string,",
						"          msdyn_salesaccelerationinsightid_entitytype as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          originatingleadid as string,",
						"          originatingleadid_entitytype as string,",
						"          masterid as string,",
						"          masterid_entitytype as string,",
						"          ts_originationlead1 as string,",
						"          ts_originationlead1_entitytype as string,",
						"          defaultpricelevelid as string,",
						"          defaultpricelevelid_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          ts_originationlead2 as string,",
						"          ts_originationlead2_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          mpe_coinvestquestionnaireid as string,",
						"          mpe_coinvestquestionnaireid_entitytype as string,",
						"          ts_hub as string,",
						"          ts_hub_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          ts_currentauditor as string,",
						"          ts_currentauditor_entitytype as string,",
						"          primarycontactid as string,",
						"          primarycontactid_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          preferredsystemuserid as string,",
						"          preferredsystemuserid_entitytype as string,",
						"          preferredequipmentid as string,",
						"          preferredequipmentid_entitytype as string,",
						"          xpd_fund as string,",
						"          xpd_fund_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          territoryid as string,",
						"          territoryid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          xpd_totalinstitutionalcommitments_base as decimal(38,0),",
						"          ts_minimumticketsize_base as decimal(38,4),",
						"          xpd_totalinstitutionalcommitments as decimal(38,0),",
						"          aging30 as decimal(38,0),",
						"          creditlimit as decimal(38,0),",
						"          creditlimit_base as decimal(38,0),",
						"          ts_totalcommitments_base as decimal(38,4),",
						"          aging60 as decimal(38,0),",
						"          ts_transfersin_base as decimal(38,0),",
						"          aging90 as decimal(38,0),",
						"          ts_maximumticketsize as decimal(38,4),",
						"          ts_totalaum_base as decimal(38,0),",
						"          marketcap_base as decimal(38,0),",
						"          aging60_base as decimal(38,0),",
						"          aging90_base as decimal(38,0),",
						"          ts_transfersout as decimal(38,0),",
						"          ts_maximumticketsize_base as decimal(38,4),",
						"          ts_originalcommitments_base as decimal(38,0),",
						"          revenue as decimal(38,0),",
						"          ts_totalcommitments as decimal(38,4),",
						"          ts_transfersout_base as decimal(38,0),",
						"          ts_totalaum as decimal(38,0),",
						"          ts_commitmentreductions_base as decimal(38,0),",
						"          ts_commitmentreductions as decimal(38,0),",
						"          marketcap as decimal(38,0),",
						"          ts_originalcommitments as decimal(38,0),",
						"          ts_minimumticketsize as decimal(38,4),",
						"          revenue_base as decimal(38,0),",
						"          openrevenue_base as decimal(38,0),",
						"          aging30_base as decimal(38,0),",
						"          openrevenue as decimal(38,0),",
						"          ts_transfersin as decimal(38,0),",
						"          ts_othernotes as string,",
						"          ts_transfersin_date as timestamp,",
						"          msdyn_salesaccelerationinsightidname as string,",
						"          address1_county as string,",
						"          openrevenue_date as timestamp,",
						"          ts_recommendedbyname as string,",
						"          ts_relationshipinteractioncomments as string,",
						"          ts_originationlead2yominame as string,",
						"          parentaccountidname as string,",
						"          xpd_roletypes_text as string,",
						"          address1_addressid as string,",
						"          importsequencenumber as long,",
						"          address1_longitude as double,",
						"          ts_countryofeconomicoriginforthecapitalname as string,",
						"          entityimageid as string,",
						"          telephone2 as string,",
						"          ts_lastoriginationmeeting as timestamp,",
						"          address2_utcoffset as long,",
						"          address1_upszone as string,",
						"          ts_originalcommitments_state as long,",
						"          ts_typicalcost as string,",
						"          xpd_recommendingportfoliocompaniesrecommended as string,",
						"          accountnumber as string,",
						"          ts_currentauditoryominame as string,",
						"          ts_originalcommitments_date as timestamp,",
						"          lastonholdtime as timestamp,",
						"          ts_sectorscoveredbyfirm as string,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          address2_upszone as string,",
						"          opendeals_state as long,",
						"          xpd_functionuse_text as string,",
						"          slainvokedidname as string,",
						"          address2_longitude as double,",
						"          defaultpricelevelidname as string,",
						"          stockexchange as string,",
						"          mpe_liveofferingscount_date as timestamp,",
						"          xpd_relationshipcomments as string,",
						"          originatingleadidname as string,",
						"          slaname as string,",
						"          ts_currentauditorname as string,",
						"          xpd_remindertoyominame as string,",
						"          ts_address1usstatename as string,",
						"          ts_tempcompanytype as string,",
						"          versionnumber as long,",
						"          address1_latitude as double,",
						"          ts_formername as string,",
						"          yominame as string,",
						"          createdbyyominame as string,",
						"          ts_cityofvisit as string,",
						"          address2_telephone1 as string,",
						"          ts_globalgeographiescoveredids as string,",
						"          preferredserviceidname as string,",
						"          address2_city as string,",
						"          ts_mpeapproachstrategy as string,",
						"          address2_line2 as string,",
						"          ts_lastdatestatuschanged as timestamp,",
						"          li_companyid as long,",
						"          transactioncurrencyidname as string,",
						"          entityimage_url as string,",
						"          xpd_relationshipstatuschangeddate as timestamp,",
						"          createdonbehalfbyname as string,",
						"          mpe_liveofferingscount_state as long,",
						"          xpd_numberofcoinvestinvestments_date as timestamp,",
						"          ts_validateddate as timestamp,",
						"          owneridname as string,",
						"          xpd_generalcomments as string,",
						"          ts_companylegalname as string,",
						"          description as string,",
						"          ts_validatedbyname as string,",
						"          originatingleadidyominame as string,",
						"          opendeals as long,",
						"          xpd_numberofopportunitiesshown_state as long,",
						"          address2_postalcode as string,",
						"          websiteurl as string,",
						"          xpd_fundname as string,",
						"          address1_utcoffset as long,",
						"          exchangerate as decimal(38,10),",
						"          mpe_flowlastrundate as timestamp,",
						"          fax as string,",
						"          address1_line3 as string,",
						"          ts_monthssincelastmeeting as long,",
						"          ts_hubname as string,",
						"          address2_line1 as string,",
						"          ts_capiqticket as string,",
						"          address2_stateorprovince as string,",
						"          address2_name as string,",
						"          ts_transfersout_state as long,",
						"          xpd_numberofopportunitiesshown as long,",
						"          primarytwitterid as string,",
						"          mpe_coinvestquestionnaireidname as string,",
						"          xpd_numberofopportunitiesshown_date as timestamp,",
						"          xpd_preferentialterms as string,",
						"          address1_primarycontactname as string,",
						"          territoryidname as string,",
						"          ts_processstatus as string,",
						"          address1_name as string,",
						"          address2_telephone2 as string,",
						"          address2_telephone3 as string,",
						"          xpd_recruitmentareateam_text as string,",
						"          ftpsiteurl as string,",
						"          address1_postalcode as string,",
						"          ts_companynumber as string,",
						"          createdon as string,",
						"          mpe_liveofferingscount as long,",
						"          traversedpath as string,",
						"          address1_stateorprovince as string,",
						"          ts_transfersin_state as long,",
						"          address2_addressid as string,",
						"          ts_monthlyreviewmeetingname as string,",
						"          primarysatoriid as string,",
						"          telephone3 as string,",
						"          openrevenue_state as long,",
						"          ts_usesprovidedids as string,",
						"          ts_originationcomments as string,",
						"          lastusedincampaign as timestamp,",
						"          primarycontactidname as string,",
						"          ts_originationlead1name as string,",
						"          ts_headofficeidname as string,",
						"          msdyn_segmentidname as string,",
						"          ts_montagucomments as string,",
						"          address2_fax as string,",
						"          createdbyname as string,",
						"          xpd_numberofcoinvestinvestments as long,",
						"          ts_capitaliqlink as string,",
						"          ts_primarymperelationshipmanagername as string,",
						"          mpe_relationshipstatus_text as string,",
						"          xpd_datereminderwasset as timestamp,",
						"          xpd_numberofcoinvestinvestments_state as long,",
						"          address1_postofficebox as string,",
						"          address1_city as string,",
						"          teamsfollowed as long,",
						"          ts_originationlead2name as string,",
						"          timezoneruleversionnumber as long,",
						"          modifiedonbehalfbyyominame as string,",
						"          entityimage_timestamp as long,",
						"          tickersymbol as string,",
						"          ts_theirprogrammecomments as string,",
						"          xpd_companyuse_text as string,",
						"          modifiedbyname as string,",
						"          owneridtype as string,",
						"          sic as string,",
						"          sharesoutstanding as long,",
						"          opendeals_date as timestamp,",
						"          address2_postofficebox as string,",
						"          emailaddress3 as string,",
						"          emailaddress2 as string,",
						"          emailaddress1 as string,",
						"          ts_globalgeographiescoveredbyfirm as string,",
						"          ts_recommendationoffirmupdated as timestamp,",
						"          ts_lastmet as timestamp,",
						"          ts_reminderdatesetto as timestamp,",
						"          ts_commitmentreductions_state as long,",
						"          owningbusinessunitname as string,",
						"          onholdtime as long,",
						"          ts_alias as string,",
						"          createdonbehalfbyyominame as string,",
						"          ts_transfersout_date as timestamp,",
						"          ts_address1countryname as string,",
						"          preferredsystemuseridyominame as string,",
						"          createdbyexternalpartyname as string,",
						"          mpe_documentsetid as string,",
						"          telephone1 as string,",
						"          ts_legacycompanytypes as string,",
						"          ts_validatedbyyominame as string,",
						"          address1_composite as string,",
						"          ts_investorgroupgatekeeperid as string,",
						"          primarycontactidyominame as string,",
						"          address2_country as string,",
						"          xpd_recommendationcomments as string,",
						"          owneridyominame as string,",
						"          createdbyexternalpartyyominame as string,",
						"          ts_originationlead1yominame as string,",
						"          ts_usesprovidedbyfirm as string,",
						"          xpd_recommendingportco as string,",
						"          address1_country as string,",
						"          ts_commitmentreductions_date as timestamp,",
						"          name as string,",
						"          modifiedbyexternalpartyyominame as string,",
						"          xpd_remindertoname as string,",
						"          stageid as string,",
						"          modifiedonbehalfbyname as string,",
						"          masteraccountidname as string,",
						"          timespentbymeonemailandmeetings as string,",
						"          address2_latitude as double,",
						"          overriddencreatedon as timestamp,",
						"          parentaccountidyominame as string,",
						"          ts_specificareaofexpertisecomments as string,",
						"          preferredsystemuseridname as string,",
						"          utcconversiontimezonecode as long,",
						"          address2_county as string,",
						"          address1_line1 as string,",
						"          address2_primarycontactname as string,",
						"          address1_line2 as string,",
						"          xpd_reasonaction as string,",
						"          ts_primarymperelationshipmanageryominame as string,",
						"          processid as string,",
						"          ts_sectorscoveredids as string,",
						"          ts_recommendedbyyominame as string,",
						"          modifiedbyexternalpartyname as string,",
						"          ts_relevantsituations as string,",
						"          accountid as string,",
						"          modifiedon as timestamp,",
						"          preferredequipmentidname as string,",
						"          modifiedbyyominame as string,",
						"          ts_dealstageofmostrecentopportunity as string,",
						"          address2_composite as string,",
						"          masteraccountidyominame as string,",
						"          numberofemployees as long,",
						"          address1_fax as string,",
						"          address2_line3 as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'account',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: false) ~> EnrichedAccount",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          stateAZOption as string,",
						"          statusAZOption as string,",
						"          ts_dealannouncedreason as string,",
						"          ts_highprioritynew as string,",
						"          ts_actionstatus as string,",
						"          mpe_targetrelationshipstatus as string,",
						"          mpe_carveout as string,",
						"          ts_producttype as string,",
						"          ts_internalintermediarysource as string,",
						"          mpe_flowlastrunoutcome as string,",
						"          ts_currentactivity as string,",
						"          ts_opportunitystatus as string,",
						"          ts_montaguprimaryoffice as string,",
						"          ts_opportunitytype as string,",
						"          ts_posthumstatus as string,",
						"          ts_meetingremindermonths as string,",
						"          ts_choppedreason as string,",
						"          ts_setreminder as string,",
						"          ts_stagereachedfir as string,",
						"          ts_stagereachedipr as string,",
						"          ts_duplicateopportunityfordiscussion as string,",
						"          mpe_smalltarget as string,",
						"          ts_stagereachedcr as string,",
						"          xpd_includeonallpapers as string,",
						"          ts_sold as string,",
						"          xpd_sharepointlocationcreated as string,",
						"          ts_statuschangedby as string,",
						"          ts_statuschangedby_entitytype as string,",
						"          ts_buyer as string,",
						"          ts_buyer_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          ts_reminderto as string,",
						"          ts_reminderto_entitytype as string,",
						"          mpe_productid as string,",
						"          mpe_productid_entitytype as string,",
						"          ts_targetbusiness as string,",
						"          ts_targetbusiness_entitytype as string,",
						"          ts_firstreferralcompany as string,",
						"          ts_firstreferralcompany_entitytype as string,",
						"          ts_deallead as string,",
						"          ts_deallead_entitytype as string,",
						"          ts_montaguowner as string,",
						"          ts_montaguowner_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          ts_firstreferralcontact as string,",
						"          ts_firstreferralcontact_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ts_managerwedback as string,",
						"          ts_managerwedback_entitytype as string,",
						"          ts_country as string,",
						"          ts_country_entitytype as string,",
						"          mpe_targetbusiness_parentid as string,",
						"          mpe_targetbusiness_parentid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          ts_sellmandate as string,",
						"          ts_sellmandate_entitytype as string,",
						"          ts_estebitda_base as decimal(38,4),",
						"          ts_estebit_base as decimal(38,4),",
						"          ts_estebitda as decimal(38,4),",
						"          ts_estebit as decimal(38,4),",
						"          ts_estturnover_base as decimal(38,4),",
						"          ts_estdealsize as decimal(38,4),",
						"          ts_estdealsize_base as decimal(38,4),",
						"          ts_estturnover as decimal(38,4),",
						"          ts_buyeryominame as string,",
						"          modifiedon as timestamp,",
						"          ts_statuschangedbyname as string,",
						"          ts_managerwedbackyominame as string,",
						"          xpd_montaguprojectname as string,",
						"          transactioncurrencyidname as string,",
						"          ts_nextsteps as string,",
						"          ts_montaguowneryominame as string,",
						"          ts_firstreferralcontactname as string,",
						"          ts_opportunitydescription as string,",
						"          ts_buyerpaidxltmebitda as decimal(38,1),",
						"          ts_targetbusinessyominame as string,",
						"          ts_montaguownername as string,",
						"          ts_managerwedbackname as string,",
						"          ts_opportunitystage as string,",
						"          ts_otherdocumentsurl as string,",
						"          exchangerate as decimal(38,10),",
						"          mpe_documentsetid as string,",
						"          ts_buyername as string,",
						"          ts_firstreferralcontactyominame as string,",
						"          createdon as string,",
						"          ts_sellmandateyominame as string,",
						"          mpe_montaguprimaryofficestring as string,",
						"          ts_statuschangedbyyominame as string,",
						"          ts_firstreferralcompanyname as string,",
						"          owneridyominame as string,",
						"          ts_choppedcomments as string,",
						"          timezoneruleversionnumber as long,",
						"          createdbyname as string,",
						"          ts_dealleadname as string,",
						"          owningbusinessunitname as string,",
						"          ts_dealleadyominame as string,",
						"          ts_lastdatestatuschanged as timestamp,",
						"          traversedpath as string,",
						"          overriddencreatedon as timestamp,",
						"          ts_iprdocumenturl as string,",
						"          createdonbehalfbyname as string,",
						"          ts_sellmandatename as string,",
						"          owneridtype as string,",
						"          owneridname as string,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          mpe_productidname as string,",
						"          mpe_targetbusiness_parentidyominame as string,",
						"          ts_originationopportunityid as string,",
						"          ts_crdocumenturl as string,",
						"          ts_datedealannounced as timestamp,",
						"          processid as string,",
						"          mpe_montaguprimaryofficeowner as string,",
						"          ts_reason as string,",
						"          ts_targetbusinessname as string,",
						"          ts_remindertoname as string,",
						"          ts_postcompletionnoteurl as string,",
						"          ts_name as string,",
						"          stageid as string,",
						"          ts_currentopportunitystatus as string,",
						"          ts_firstreferralcompanyyominame as string,",
						"          mpe_flowlastrundate as timestamp,",
						"          ts_firdocumenturl as string,",
						"          modifiedbyyominame as string,",
						"          modifiedonbehalfbyyominame as string,",
						"          ts_movedoutofwipdate as timestamp,",
						"          ts_equitychequesize as decimal(38,2),",
						"          utcconversiontimezonecode as long,",
						"          mpe_targetbusiness_parentidname as string,",
						"          ts_weofferedxltmebitda as decimal(38,1),",
						"          importsequencenumber as long,",
						"          ts_remindertoyominame as string,",
						"          ts_companyid as long,",
						"          ts_datereminderwasset as timestamp,",
						"          versionnumber as long,",
						"          ts_originationid as long,",
						"          ts_countryname as string,",
						"          ts_choppeddate as timestamp,",
						"          mpe_posthunstatustext as string,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          ts_humdate as timestamp,",
						"          ts_sellmandateidtype as string,",
						"          ts_dateofreminder as timestamp,",
						"          ts_humurl as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'ts_originationopportunity',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: false) ~> EnrichedOriginationOpportunities",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          stateAZOption as string,",
						"          statusAZOption as string,",
						"          ts_stageofmeetingrounds as string,",
						"          ts_talentmeetingtype as string,",
						"          instancetypeAZOption as string,",
						"          ts_whooriginatedthemeeting as string,",
						"          onlinemeetingtype as string,",
						"          ts_meetingteam as string,",
						"          ts_othermeetingmethod as string,",
						"          ts_tone as string,",
						"          ts_meetingmethod as string,",
						"          ts_originationmeetingtype as string,",
						"          priorityAZOption as string,",
						"          attachmenterrors as string,",
						"          ts_eventtype as string,",
						"          ts_talentmeetingmethod as string,",
						"          ts_productsdiscussed as string,",
						"          ts_contentcovered as string,",
						"          isonlinemeeting as string,",
						"          isworkflowcreated as string,",
						"          isalldayevent as string,",
						"          ts_interview as string,",
						"          isbilled as string,",
						"          isdraft as string,",
						"          ts_keyiractivity as string,",
						"          ts_noninvestor as string,",
						"          ismapiprivate as string,",
						"          isregularactivity as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          ts_investorgroup as string,",
						"          ts_investorgroup_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          regardingobjectid as string,",
						"          regardingobjectid_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ts_officemet as string,",
						"          ts_officemet_entitytype as string,",
						"          ts_taskowner as string,",
						"          ts_taskowner_entitytype as string,",
						"          serviceid as string,",
						"          serviceid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          requiredattendees as string,",
						"          optionalattendees as string,",
						"          organizer as string,",
						"          scheduledend as timestamp,",
						"          ts_taskdescription as string,",
						"          modifiedon as timestamp,",
						"          ts_purpose as string,",
						"          overriddencreatedon as timestamp,",
						"          ts_taskownername as string,",
						"          activityadditionalparams as string,",
						"          ts_tonepersonalities as string,",
						"          seriesid as string,",
						"          transactioncurrencyidname as string,",
						"          activityid as string,",
						"          modifiedfieldsmask as string,",
						"          utcconversiontimezonecode as long,",
						"          ts_officemetname as string,",
						"          scheduledstart as timestamp,",
						"          outlookownerapptid as long,",
						"          ts_topicscovered as string,",
						"          ts_objective as string,",
						"          onholdtime as long,",
						"          onlinemeetingjoinurl as string,",
						"          ts_notes as string,",
						"          originalstartdate as timestamp,",
						"          ts_opportunitiesdiscussed as string,",
						"          ts_sectorscoveredbyfirm as string,",
						"          attachmentcount as long,",
						"          exchangerate as decimal(38,10),",
						"          ts_originationcommentsnotes as string,",
						"          category as string,",
						"          createdon as string,",
						"          ts_eventdescription as string,",
						"          globalobjectid as string,",
						"          onlinemeetingid as string,",
						"          serviceidname as string,",
						"          owneridyominame as string,",
						"          description as string,",
						"          subcategory as string,",
						"          owningbusinessunitname as string,",
						"          ts_taskduedate as timestamp,",
						"          traversedpath as string,",
						"          sortdate as timestamp,",
						"          createdonbehalfbyname as string,",
						"          ts_sectorscoveredids as string,",
						"          safedescription as string,",
						"          ts_taskowneryominame as string,",
						"          owneridtype as string,",
						"          isunsafe as long,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          ts_conferencename as string,",
						"          timezoneruleversionnumber as long,",
						"          actualend as timestamp,",
						"          regardingobjectidname as string,",
						"          processid as string,",
						"          activitytypecode as string,",
						"          actualstart as timestamp,",
						"          xpd_listofexternalattendees as string,",
						"          slainvokedidname as string,",
						"          location as string,",
						"          subject as string,",
						"          createdbyname as string,",
						"          actualdurationminutes as long,",
						"          modifiedbyyominame as string,",
						"          lastonholdtime as timestamp,",
						"          modifiedonbehalfbyyominame as string,",
						"          ts_attendeestoaddtocrm as string,",
						"          regardingobjectidyominame as string,",
						"          regardingobjecttypecode as string,",
						"          stageid as string,",
						"          scheduleddurationminutes as long,",
						"          ts_sourceid as string,",
						"          ts_investorgroupyominame as string,",
						"          importsequencenumber as long,",
						"          subscriptionid as string,",
						"          onlinemeetingchatid as string,",
						"          ts_lpupdates as string,",
						"          ts_executivesummary as string,",
						"          ts_investorgroupname as string,",
						"          ts_meetingcity as string,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          owneridname as string,",
						"          ts_theirprogramme as string,",
						"          ts_ifdeclinedreason as string,",
						"          slaname as string,",
						"          versionnumber as long",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'appointment',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: false) ~> EnrichedMeetingAppointments",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          stateAZOption as string,",
						"          statusAZOption as string,",
						"          haschildrenAZOption as string,",
						"          customertypeAZOption as string,",
						"          ts_recommendationofindividual as string,",
						"          genderAZOption as string,",
						"          address1_addresstypeAZOption as string,",
						"          leadsourceAZOption as string,",
						"          preferredappointmenttimeAZOption as string,",
						"          address2_freighttermsAZOption as string,",
						"          address2_shippingmethodAZOption as string,",
						"          ts_debtsubtype as string,",
						"          msdyn_orgchangestatus as string,",
						"          ts_suffix as string,",
						"          xpd_gender as string,",
						"          ts_title as string,",
						"          paymenttermsAZOption as string,",
						"          accountroleAZOption as string,",
						"          territoryAZOption as string,",
						"          ts_vendortargettrackingrole as string,",
						"          address3_freighttermsAZOption as string,",
						"          address1_shippingmethodAZOption as string,",
						"          preferredappointmentdayAZOption as string,",
						"          customersizeAZOption as string,",
						"          preferredcontactmethodAZOption as string,",
						"          ts_futurecontactmethod as string,",
						"          address3_shippingmethodAZOption as string,",
						"          address2_addresstypeAZOption as string,",
						"          mpe_flowlastrunoutcome as string,",
						"          ts_capabilitiesofindividual as string,",
						"          address3_addresstypeAZOption as string,",
						"          familystatusAZOption as string,",
						"          shippingmethodAZOption as string,",
						"          xpd_availability as string,",
						"          educationAZOption as string,",
						"          address1_freighttermsAZOption as string,",
						"          ts_quickcaptureuses as string,",
						"          xpd_montagulevel as string,",
						"          ts_permanentinterim as string,",
						"          ts_ircontactrole as string,",
						"          xpd_level as string,",
						"          ts_languagesspokenwritten as string,",
						"          ts_contacttype as string,",
						"          ts_montaguoffice as string,",
						"          ts_roletypes as string,",
						"          xpd_specialisms as string,",
						"          ts_quickcapturesectors as string,",
						"          xpd_function as string,",
						"          ts_producttype as string,",
						"          ts_quickcapturegeography as string,",
						"          ts_productsinterestedin as string,",
						"          ts_potentialrolecandidate as string,",
						"          isbackofficecustomer as string,",
						"          donotpostalmail as string,",
						"          xpd_addcontacttooutlook as string,",
						"          ts_centralrelationshipmanager as string,",
						"          msdyn_gdproptout as string,",
						"          xpd_hascompany as string,",
						"          creditonhold as string,",
						"          xpd_benchcandidate as string,",
						"          donotbulkpostalmail as string,",
						"          donotsendmm as string,",
						"          donotbulkemail as string,",
						"          followemail as string,",
						"          xpd_sharepointdocumentlocationcreated as string,",
						"          xpd_available as string,",
						"          ts_leadearlystageinteraction as string,",
						"          participatesinworkflow as string,",
						"          ts_doyouwishtotrackthiscontact as string,",
						"          merged as string,",
						"          ts_validated as string,",
						"          marketingonly as string,",
						"          donotfax as string,",
						"          isprivate as string,",
						"          donotphone as string,",
						"          isautocreate as string,",
						"          donotemail as string,",
						"          ts_unconfirmedemailaddress as string,",
						"          mpe_companysearchbyemail as string,",
						"          preferredsystemuserid as string,",
						"          preferredsystemuserid_entitytype as string,",
						"          mpe_accountid as string,",
						"          mpe_accountid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          ts_recommendedby as string,",
						"          ts_recommendedby_entitytype as string,",
						"          ts_previousemployerid as string,",
						"          ts_previousemployerid_entitytype as string,",
						"          preferredserviceid as string,",
						"          preferredserviceid_entitytype as string,",
						"          msdyn_segmentid as string,",
						"          msdyn_segmentid_entitytype as string,",
						"          parentcontactid as string,",
						"          parentcontactid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          ts_pa as string,",
						"          ts_pa_entitytype as string,",
						"          ts_businessaddress as string,",
						"          ts_businessaddress_entitytype as string,",
						"          modifiedbyexternalparty as string,",
						"          modifiedbyexternalparty_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          originatingleadid as string,",
						"          originatingleadid_entitytype as string,",
						"          masterid as string,",
						"          masterid_entitytype as string,",
						"          defaultpricelevelid as string,",
						"          defaultpricelevelid_entitytype as string,",
						"          parent_contactid as string,",
						"          parent_contactid_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          createdbyexternalparty as string,",
						"          createdbyexternalparty_entitytype as string,",
						"          preferredequipmentid as string,",
						"          preferredequipmentid_entitytype as string,",
						"          xpd_referredbyinternal as string,",
						"          xpd_referredbyinternal_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          xpd_homecountry as string,",
						"          xpd_homecountry_entitytype as string,",
						"          ts_placementfirmintroducedby as string,",
						"          ts_placementfirmintroducedby_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          accountid as string,",
						"          accountid_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          parentcustomerid as string,",
						"          parentcustomerid_entitytype as string,",
						"          xpd_referredbyexternal as string,",
						"          xpd_referredbyexternal_entitytype as string,",
						"          aging30 as decimal(38,2),",
						"          creditlimit_base as decimal(38,4),",
						"          aging60 as decimal(38,2),",
						"          aging90 as decimal(38,2),",
						"          aging60_base as decimal(38,4),",
						"          aging90_base as decimal(38,4),",
						"          annualincome_base as decimal(38,4),",
						"          creditlimit as decimal(38,2),",
						"          annualincome as decimal(38,2),",
						"          aging30_base as decimal(38,4),",
						"          ts_othernotes as string,",
						"          xpd_referredbyinternalyominame as string,",
						"          address1_county as string,",
						"          yomilastname as string,",
						"          address3_utcoffset as long,",
						"          ts_recommendedbyname as string,",
						"          description as string,",
						"          li_membertoken as string,",
						"          department as string,",
						"          xpd_roletypes_text as string,",
						"          address1_addressid as string,",
						"          importsequencenumber as long,",
						"          address1_longitude as double,",
						"          address3_fax as string,",
						"          managername as string,",
						"          entityimageid as string,",
						"          telephone2 as string,",
						"          parentcustomeridtype as string,",
						"          address2_upszone as string,",
						"          address1_upszone as string,",
						"          xpd_recommendingportfoliocompaniesrecommended as string,",
						"          lastonholdtime as timestamp,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          address1_fax as string,",
						"          address3_telephone1 as string,",
						"          address3_telephone2 as string,",
						"          address3_telephone3 as string,",
						"          fax as string,",
						"          assistantname as string,",
						"          address2_line3 as string,",
						"          accountidyominame as string,",
						"          parentcontactidyominame as string,",
						"          mpe_accountidyominame as string,",
						"          slainvokedidname as string,",
						"          defaultpricelevelidname as string,",
						"          fullname as string,",
						"          address2_longitude as double,",
						"          subscriptionid as string,",
						"          originatingleadidname as string,",
						"          slaname as string,",
						"          versionnumber as long,",
						"          address1_latitude as double,",
						"          createdbyyominame as string,",
						"          parent_contactidname as string,",
						"          address2_telephone1 as string,",
						"          pager as string,",
						"          salutation as string,",
						"          mpe_accountidname as string,",
						"          xpd_functionuse_text as string,",
						"          accountidname as string,",
						"          mpe_companysummary as string,",
						"          parent_contactidyominame as string,",
						"          preferredserviceidname as string,",
						"          address2_city as string,",
						"          address3_postalcode as string,",
						"          address2_line2 as string,",
						"          li_companyid as long,",
						"          ts_otherphonelabel as string,",
						"          ts_reportingemail as string,",
						"          address3_upszone as string,",
						"          transactioncurrencyidname as string,",
						"          address3_county as string,",
						"          entityimage_url as string,",
						"          governmentid as string,",
						"          callback as string,",
						"          business2 as string,",
						"          createdonbehalfbyname as string,",
						"          ts_validateddate as timestamp,",
						"          address2_telephone2 as string,",
						"          owneridname as string,",
						"          originatingleadidyominame as string,",
						"          ts_otherlanguages as string,",
						"          address2_postalcode as string,",
						"          birthdate as timestamp,",
						"          parentcontactidname as string,",
						"          spousesname as string,",
						"          xpd_compensationdate as timestamp,",
						"          address1_utcoffset as long,",
						"          address3_line1 as string,",
						"          traversedpath as string,",
						"          exchangerate as decimal(38,10),",
						"          mpe_flowlastrundate as timestamp,",
						"          address1_line3 as string,",
						"          address3_country as string,",
						"          mpe_documentsetid as string,",
						"          address2_line1 as string,",
						"          ts_previousemployeridyominame as string,",
						"          middlename as string,",
						"          managerphone as string,",
						"          address2_stateorprovince as string,",
						"          childrensnames as string,",
						"          address2_name as string,",
						"          address3_addressid as string,",
						"          address3_stateorprovince as string,",
						"          ts_sectorspecialtyids as string,",
						"          businesscardattributes as string,",
						"          anniversary as timestamp,",
						"          ts_employmentstartdate as timestamp,",
						"          ts_legacycontacttypes as string,",
						"          address1_primarycontactname as string,",
						"          address2_utcoffset as long,",
						"          home2 as string,",
						"          ts_geographicspecialtyids as string,",
						"          address1_name as string,",
						"          ts_recommendationcomments as string,",
						"          address2_telephone3 as string,",
						"          address3_primarycontactname as string,",
						"          ftpsiteurl as string,",
						"          address1_postalcode as string,",
						"          createdon as string,",
						"          address1_stateorprovince as string,",
						"          yomimiddlename as string,",
						"          jobtitle as string,",
						"          telephone3 as string,",
						"          ts_usesspeciality as string,",
						"          msdyn_segmentidname as string,",
						"          ts_knowntouserinitials as string,",
						"          address2_fax as string,",
						"          createdbyname as string,",
						"          xpd_contactuse_text as string,",
						"          ts_sourceid as string,",
						"          address2_addressid as string,",
						"          employeeid as string,",
						"          address1_postofficebox as string,",
						"          address1_city as string,",
						"          ts_businessaddressname as string,",
						"          teamsfollowed as long,",
						"          ts_cv as string,",
						"          timezoneruleversionnumber as long,",
						"          modifiedonbehalfbyyominame as string,",
						"          xpd_hrcompensation as string,",
						"          ts_currentbonusandorupliftconsiderations as string,",
						"          modifiedbyname as string,",
						"          address3_line2 as string,",
						"          yomifullname as string,",
						"          owneridtype as string,",
						"          entityimage_timestamp as long,",
						"          ts_placementfirmintroducedbyyominame as string,",
						"          xpd_previousrole as string,",
						"          ts_compensation as string,",
						"          address2_postofficebox as string,",
						"          emailaddress3 as string,",
						"          emailaddress2 as string,",
						"          emailaddress1 as string,",
						"          ts_interactioncontactuniqueidentifier as string,",
						"          ts_investmentcafeid as string,",
						"          websiteurl as string,",
						"          nickname as string,",
						"          ts_lastmet as timestamp,",
						"          address3_name as string,",
						"          ts_usesspecialtyids as string,",
						"          ts_linkedinurl as string,",
						"          lastname as string,",
						"          address3_longitude as double,",
						"          xpd_referredbyexternalidtype as string,",
						"          parentcustomeridname as string,",
						"          owningbusinessunitname as string,",
						"          onholdtime as long,",
						"          createdonbehalfbyyominame as string,",
						"          preferredsystemuseridyominame as string,",
						"          createdbyexternalpartyname as string,",
						"          ts_tone as string,",
						"          telephone1 as string,",
						"          overriddencreatedon as timestamp,",
						"          address3_postofficebox as string,",
						"          assistantphone as string,",
						"          address1_composite as string,",
						"          address3_line3 as string,",
						"          address2_country as string,",
						"          xpd_referredbyinternalname as string,",
						"          mobilephone as string,",
						"          owneridyominame as string,",
						"          address1_line1 as string,",
						"          createdbyexternalpartyyominame as string,",
						"          xpd_referredbyexternalyominame as string,",
						"          yomifirstname as string,",
						"          mastercontactidname as string,",
						"          address3_city as string,",
						"          address1_country as string,",
						"          externaluseridentifier as string,",
						"          modifiedbyexternalpartyyominame as string,",
						"          firstname as string,",
						"          xpd_hrcurrentbonusandorupliftconsiderations as string,",
						"          stageid as string,",
						"          modifiedonbehalfbyname as string,",
						"          xpd_homecountryname as string,",
						"          mastercontactidyominame as string,",
						"          suffix as string,",
						"          ts_payominame as string,",
						"          lastusedincampaign as timestamp,",
						"          ts_geographicspeciality as string,",
						"          xpd_recruitmentareateam_text as string,",
						"          ts_retentionreviewdate as timestamp,",
						"          parentcustomeridyominame as string,",
						"          timespentbymeonemailandmeetings as string,",
						"          address2_latitude as double,",
						"          xpd_availablefrom as timestamp,",
						"          address3_composite as string,",
						"          xpd_recommendingportco as string,",
						"          preferredsystemuseridname as string,",
						"          utcconversiontimezonecode as long,",
						"          address2_county as string,",
						"          ts_paname as string,",
						"          contactid as string,",
						"          address2_primarycontactname as string,",
						"          ts_specificareasofexpertisecomments as string,",
						"          address1_line2 as string,",
						"          ts_recommendationofindividualupdated as timestamp,",
						"          xpd_referredbyexternalname as string,",
						"          ts_placementfirmintroducedbyname as string,",
						"          ts_sectorspeciality as string,",
						"          ts_previousemployeridname as string,",
						"          processid as string,",
						"          ts_recommendedbyyominame as string,",
						"          modifiedon as timestamp,",
						"          modifiedbyexternalpartyname as string,",
						"          ts_relevantsituations as string,",
						"          businesscard as string,",
						"          company as string,",
						"          preferredequipmentidname as string,",
						"          modifiedbyyominame as string,",
						"          ts_preferredname as string,",
						"          address2_composite as string,",
						"          numberofchildren as long,",
						"          address3_latitude as double,",
						"          mpe_sensitivityid as string,",
						"          mpe_sensitivityid_entitytype as string,",
						"          mpe_sensitivityidname as string,",
						"          mpe_sensitivitymessage as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'contact',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: false) ~> EnrichedContacts",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          address1_addresstypecode as long,",
						"          address1_shippingmethodcode as long,",
						"          azurestate as long,",
						"          invitestatuscode as long,",
						"          preferredaddresscode as long,",
						"          preferredemailcode as long,",
						"          outgoingemaildeliverymethod as long,",
						"          preferredphonecode as long,",
						"          emailrouteraccessapproval as long,",
						"          deletedstate as long,",
						"          incomingemaildeliverymethod as long,",
						"          accessmode as long,",
						"          caltype as long,",
						"          address2_addresstypecode as long,",
						"          address2_shippingmethodcode as long,",
						"          setupuser as boolean,",
						"          islicensed as boolean,",
						"          defaultfilterspopulated as boolean,",
						"          isactivedirectoryuser as boolean,",
						"          displayinserviceviews as boolean,",
						"          msdyn_gdproptout as boolean,",
						"          isdisabled as boolean,",
						"          isintegrationuser as boolean,",
						"          isemailaddressapprovedbyo365admin as boolean,",
						"          issyncwithdirectory as boolean,",
						"          calendarid as string,",
						"          calendarid_entitytype as string,",
						"          mobileofflineprofileid as string,",
						"          mobileofflineprofileid_entitytype as string,",
						"          queueid as string,",
						"          queueid_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          territoryid as string,",
						"          territoryid_entitytype as string,",
						"          defaultmailbox as string,",
						"          defaultmailbox_entitytype as string,",
						"          positionid as string,",
						"          positionid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          siteid as string,",
						"          siteid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          parentsystemuserid as string,",
						"          parentsystemuserid_entitytype as string,",
						"          businessunitid as string,",
						"          businessunitid_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          traversedpath as string,",
						"          azureactivedirectoryobjectid as string,",
						"          address1_line1 as string,",
						"          internalemailaddress as string,",
						"          siteidname as string,",
						"          modifiedon as timestamp,",
						"          address1_line3 as string,",
						"          skills as string,",
						"          yomifirstname as string,",
						"          address1_longitude as double,",
						"          yomifullname as string,",
						"          entityimage_timestamp as long,",
						"          parentsystemuseridname as string,",
						"          address2_county as string,",
						"          transactioncurrencyidname as string,",
						"          activedirectoryguid as string,",
						"          utcconversiontimezonecode as long,",
						"          passporthi as long,",
						"          homephone as string,",
						"          parentsystemuseridyominame as string,",
						"          address2_stateorprovince as string,",
						"          mobilephone as string,",
						"          address2_country as string,",
						"          address2_line2 as string,",
						"          disabledreason as string,",
						"          lastname as string,",
						"          address1_city as string,",
						"          address1_utcoffset as long,",
						"          userlicensetype as long,",
						"          nickname as string,",
						"          passportlo as long,",
						"          title as string,",
						"          address2_latitude as double,",
						"          applicationid as string,",
						"          address1_composite as string,",
						"          firstname as string,",
						"          address2_postalcode as string,",
						"          employeeid as string,",
						"          processid as string,",
						"          mobileofflineprofileidname as string,",
						"          governmentid as string,",
						"          entityimage_url as string,",
						"          address2_line3 as string,",
						"          azuredeletedon as timestamp,",
						"          timezoneruleversionnumber as long,",
						"          address1_county as string,",
						"          address2_telephone2 as string,",
						"          address2_postofficebox as string,",
						"          address2_telephone1 as string,",
						"          yomilastname as string,",
						"          address2_telephone3 as string,",
						"          address1_addressid as string,",
						"          territoryidname as string,",
						"          overriddencreatedon as timestamp,",
						"          userpuid as string,",
						"          createdonbehalfbyname as string,",
						"          systemuserid as string,",
						"          address2_name as string,",
						"          middlename as string,",
						"          entityimageid as string,",
						"          applicationiduri as string,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          address2_composite as string,",
						"          address1_country as string,",
						"          mobilealertemail as string,",
						"          sharepointemailaddress as string,",
						"          businessunitidname as string,",
						"          address1_stateorprovince as string,",
						"          exchangerate as decimal(38,10),",
						"          jobtitle as string,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          latestupdatetime as timestamp,",
						"          address1_postofficebox as string,",
						"          organizationid as string,",
						"          yammeremailaddress as string,",
						"          defaultmailboxname as string,",
						"          identityid as long,",
						"          yomimiddlename as string,",
						"          address2_utcoffset as long,",
						"          photourl as string,",
						"          personalemailaddress as string,",
						"          address2_addressid as string,",
						"          address2_longitude as double,",
						"          createdon as string,",
						"          createdbyname as string,",
						"          domainname as string,",
						"          modifiedbyyominame as string,",
						"          address2_fax as string,",
						"          address1_line2 as string,",
						"          modifiedonbehalfbyyominame as string,",
						"          address2_upszone as string,",
						"          salutation as string,",
						"          address1_postalcode as string,",
						"          stageid as string,",
						"          defaultodbfoldername as string,",
						"          positionidname as string,",
						"          ts_inititals as string,",
						"          yammeruserid as string,",
						"          importsequencenumber as long,",
						"          address2_city as string,",
						"          windowsliveid as string,",
						"          organizationidname as string,",
						"          versionnumber as long,",
						"          queueidname as string,",
						"          address1_name as string,",
						"          address1_fax as string,",
						"          address1_latitude as double,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          address2_line1 as string,",
						"          address1_upszone as string,",
						"          fullname as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'systemuser') ~> SystemUserIn",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          address1_addresstypeAZOption as string,",
						"          address1_shippingmethodAZOption as string,",
						"          azurestate as string,",
						"          invitestatusAZOption as string,",
						"          preferredaddressAZOption as string,",
						"          preferredemailAZOption as string,",
						"          outgoingemaildeliverymethod as string,",
						"          preferredphoneAZOption as string,",
						"          emailrouteraccessapproval as string,",
						"          deletedstate as string,",
						"          incomingemaildeliverymethod as string,",
						"          accessmode as string,",
						"          caltype as string,",
						"          address2_addresstypeAZOption as string,",
						"          address2_shippingmethodAZOption as string,",
						"          setupuser as string,",
						"          islicensed as string,",
						"          defaultfilterspopulated as string,",
						"          isactivedirectoryuser as string,",
						"          displayinserviceviews as string,",
						"          msdyn_gdproptout as string,",
						"          isdisabled as string,",
						"          isintegrationuser as string,",
						"          isemailaddressapprovedbyo365admin as string,",
						"          issyncwithdirectory as string,",
						"          calendarid as string,",
						"          calendarid_entitytype as string,",
						"          mobileofflineprofileid as string,",
						"          mobileofflineprofileid_entitytype as string,",
						"          queueid as string,",
						"          queueid_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          territoryid as string,",
						"          territoryid_entitytype as string,",
						"          defaultmailbox as string,",
						"          defaultmailbox_entitytype as string,",
						"          positionid as string,",
						"          positionid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          siteid as string,",
						"          siteid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          parentsystemuserid as string,",
						"          parentsystemuserid_entitytype as string,",
						"          businessunitid as string,",
						"          businessunitid_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          traversedpath as string,",
						"          azureactivedirectoryobjectid as string,",
						"          address1_line1 as string,",
						"          internalemailaddress as string,",
						"          siteidname as string,",
						"          modifiedon as timestamp,",
						"          address1_line3 as string,",
						"          skills as string,",
						"          yomifirstname as string,",
						"          address1_longitude as double,",
						"          yomifullname as string,",
						"          entityimage_timestamp as long,",
						"          parentsystemuseridname as string,",
						"          address2_county as string,",
						"          transactioncurrencyidname as string,",
						"          activedirectoryguid as string,",
						"          utcconversiontimezonecode as long,",
						"          passporthi as long,",
						"          homephone as string,",
						"          parentsystemuseridyominame as string,",
						"          address2_stateorprovince as string,",
						"          mobilephone as string,",
						"          address2_country as string,",
						"          address2_line2 as string,",
						"          disabledreason as string,",
						"          lastname as string,",
						"          address1_city as string,",
						"          address1_utcoffset as long,",
						"          userlicensetype as long,",
						"          nickname as string,",
						"          passportlo as long,",
						"          title as string,",
						"          address2_latitude as double,",
						"          applicationid as string,",
						"          address1_composite as string,",
						"          firstname as string,",
						"          address2_postalcode as string,",
						"          employeeid as string,",
						"          processid as string,",
						"          mobileofflineprofileidname as string,",
						"          governmentid as string,",
						"          entityimage_url as string,",
						"          address2_line3 as string,",
						"          azuredeletedon as timestamp,",
						"          timezoneruleversionnumber as long,",
						"          address1_county as string,",
						"          address2_telephone2 as string,",
						"          address2_postofficebox as string,",
						"          address2_telephone1 as string,",
						"          yomilastname as string,",
						"          address2_telephone3 as string,",
						"          address1_addressid as string,",
						"          territoryidname as string,",
						"          overriddencreatedon as timestamp,",
						"          userpuid as string,",
						"          createdonbehalfbyname as string,",
						"          systemuserid as string,",
						"          address2_name as string,",
						"          middlename as string,",
						"          entityimageid as string,",
						"          applicationiduri as string,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          address2_composite as string,",
						"          address1_country as string,",
						"          mobilealertemail as string,",
						"          sharepointemailaddress as string,",
						"          businessunitidname as string,",
						"          address1_stateorprovince as string,",
						"          exchangerate as decimal(38,10),",
						"          jobtitle as string,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          latestupdatetime as timestamp,",
						"          address1_postofficebox as string,",
						"          organizationid as string,",
						"          yammeremailaddress as string,",
						"          defaultmailboxname as string,",
						"          identityid as long,",
						"          yomimiddlename as string,",
						"          address2_utcoffset as long,",
						"          photourl as string,",
						"          personalemailaddress as string,",
						"          address2_addressid as string,",
						"          address2_longitude as double,",
						"          createdon as string,",
						"          createdbyname as string,",
						"          domainname as string,",
						"          modifiedbyyominame as string,",
						"          address2_fax as string,",
						"          address1_line2 as string,",
						"          modifiedonbehalfbyyominame as string,",
						"          address2_upszone as string,",
						"          salutation as string,",
						"          address1_postalcode as string,",
						"          stageid as string,",
						"          defaultodbfoldername as string,",
						"          positionidname as string,",
						"          ts_inititals as string,",
						"          yammeruserid as string,",
						"          importsequencenumber as long,",
						"          address2_city as string,",
						"          windowsliveid as string,",
						"          organizationidname as string,",
						"          versionnumber as long,",
						"          queueidname as string,",
						"          address1_name as string,",
						"          address1_fax as string,",
						"          address1_latitude as double,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          address2_line1 as string,",
						"          address1_upszone as string,",
						"          fullname as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'systemuser',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: false) ~> EnrichedSystemUser",
						"OriginationOpportunityIn, EnrichedOriginationOpportunities join(OriginationOpportunityIn@Id == EnrichedOriginationOpportunities@Id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> Originationjoinoutput",
						"MeetingsAppointmentsIn, EnrichedMeetingAppointments join(MeetingsAppointmentsIn@Id == EnrichedMeetingAppointments@Id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> AppointmentsJoinOutput",
						"ContactsIn, EnrichedContacts join(ContactsIn@Id == EnrichedContacts@Id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> ContactsJoin",
						"AccountIn, EnrichedAccount join(AccountIn@Id == EnrichedAccount@Id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto',",
						"     scoreColumn: 'AZlabel')~> AccountEnrichedJoin",
						"SystemUserIn, EnrichedSystemUser join(SystemUserIn@Id == EnrichedSystemUser@Id,",
						"     joinType:'inner',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> SystemUserJoin",
						"AccountEnrichedJoin sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'accountENRICHED',",
						"     insertable: true,",
						"     updateable: false,",
						"     deletable: false,",
						"     upsertable: false,",
						"     recreate: true,",
						"     allowCopyCommand: true,",
						"     staged: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> AccountCleanSink",
						"AppointmentsJoinOutput sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'appointmentENRICHED',",
						"     insertable: true,",
						"     updateable: false,",
						"     deletable: false,",
						"     upsertable: false,",
						"     recreate: true,",
						"     allowCopyCommand: true,",
						"     staged: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> MeetingStageCleanSink",
						"ContactsJoin sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'contactENRICHED',",
						"     insertable: true,",
						"     updateable: false,",
						"     deletable: false,",
						"     upsertable: false,",
						"     recreate: true,",
						"     allowCopyCommand: true,",
						"     staged: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> ContactsStageCleanSink",
						"Originationjoinoutput sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'OriginationOpportunitiesENRICHED',",
						"     insertable: true,",
						"     updateable: false,",
						"     deletable: false,",
						"     upsertable: false,",
						"     recreate: true,",
						"     allowCopyCommand: true,",
						"     staged: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> OriginationCleanSink",
						"SystemUserJoin sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'SystemUserENRICHED',",
						"     insertable: true,",
						"     updateable: false,",
						"     deletable: false,",
						"     upsertable: false,",
						"     recreate: true,",
						"     allowCopyCommand: true,",
						"     staged: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> SystemUserSink"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/EnrichedDatabase')]",
				"[concat(variables('workspaceId'), '/linkedServices/ReportsAnalytics')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/PH 1 FullEnrich Only')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"name": "AccountIn"
						},
						{
							"name": "OriginationOpportunityIn"
						},
						{
							"name": "MeetingsAppointmentsIn"
						},
						{
							"name": "ContactsIn"
						},
						{
							"linkedService": {
								"referenceName": "EnrichedDatabase",
								"type": "LinkedServiceReference"
							},
							"name": "EnrichedAccount"
						},
						{
							"linkedService": {
								"referenceName": "EnrichedDatabase",
								"type": "LinkedServiceReference"
							},
							"name": "EnrichedOriginationOpportunities"
						},
						{
							"linkedService": {
								"referenceName": "EnrichedDatabase",
								"type": "LinkedServiceReference"
							},
							"name": "EnrichedMeetingAppointments"
						},
						{
							"linkedService": {
								"referenceName": "EnrichedDatabase",
								"type": "LinkedServiceReference"
							},
							"name": "EnrichedContacts"
						},
						{
							"name": "SystemUserIn"
						},
						{
							"linkedService": {
								"referenceName": "EnrichedDatabase",
								"type": "LinkedServiceReference"
							},
							"name": "EnrichedSystemUser"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "ReportsAnalytics",
								"type": "LinkedServiceReference"
							},
							"name": "AccountCleanSink"
						},
						{
							"linkedService": {
								"referenceName": "ReportsAnalytics",
								"type": "LinkedServiceReference"
							},
							"name": "MeetingStageCleanSink"
						},
						{
							"linkedService": {
								"referenceName": "ReportsAnalytics",
								"type": "LinkedServiceReference"
							},
							"name": "ContactsStageCleanSink"
						},
						{
							"linkedService": {
								"referenceName": "ReportsAnalytics",
								"type": "LinkedServiceReference"
							},
							"name": "OriginationCleanSink"
						},
						{
							"name": "SinkEnrichedOrigination"
						},
						{
							"name": "SinkEnrichedAccount"
						},
						{
							"name": "SinkEnrichedMeeting"
						},
						{
							"name": "SinkEnrichedContacts"
						},
						{
							"linkedService": {
								"referenceName": "ReportsAnalytics",
								"type": "LinkedServiceReference"
							},
							"name": "SystemUserSink"
						}
					],
					"transformations": [
						{
							"name": "Originationjoinoutput"
						},
						{
							"name": "AppointmentsJoinOutput"
						},
						{
							"name": "ContactsJoin"
						},
						{
							"name": "AccountEnrichedJoin"
						},
						{
							"name": "SystemUserJoin"
						}
					],
					"scriptLines": [
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          ts_primarysecondaryfocus as long,",
						"          customertypecode as long,",
						"          ts_relationship as long,",
						"          address1_addresstypecode as long,",
						"          accountclassificationcode as long,",
						"          ts_easeofworking as long,",
						"          ts_ukrow as long,",
						"          preferredappointmenttimecode as long,",
						"          ts_address1addresstype as long,",
						"          xpd_relationshipstatus as long,",
						"          ts_introducertype as long,",
						"          xpd_remindermonths as long,",
						"          ts_importance as long,",
						"          address2_freighttermscode as long,",
						"          ts_irrvsmomperformancemeasure as long,",
						"          accountcategorycode as long,",
						"          paymenttermscode as long,",
						"          preferredappointmentdaycode as long,",
						"          businesstypecode as long,",
						"          industrycode as long,",
						"          ts_sizeoffirm as long,",
						"          ts_interaction as long,",
						"          address1_shippingmethodcode as long,",
						"          ts_portfoliocompanystatus as long,",
						"          customersizecode as long,",
						"          xpd_previousinvestorstatus as long,",
						"          ts_recommendationoffirm as long,",
						"          preferredcontactmethodcode as long,",
						"          accountratingcode as long,",
						"          ts_investorstatus as long,",
						"          ts_capabilitiesoffirm as long,",
						"          mpe_flowlastrunoutcome as long,",
						"          address2_addresstypecode as long,",
						"          address2_shippingmethodcode as long,",
						"          ts_nextoriginationmeetingarranged as long,",
						"          ownershipcode as long,",
						"          territorycode as long,",
						"          ts_investortype as long,",
						"          shippingmethodcode as long,",
						"          ts_investorregion as long,",
						"          address1_freighttermscode as long,",
						"          xpd_function as string,",
						"          ts_quickcaptureuses as string,",
						"          ts_permanentinterim as string,",
						"          ts_quickcapturesectors as string,",
						"          ts_roletypes as string,",
						"          ts_companytype as string,",
						"          xpd_level as string,",
						"          ts_indicativeclientbase as string,",
						"          xpd_specialisms as string,",
						"          xpd_montagulevel as string,",
						"          ts_vendorsummary as string,",
						"          ts_producttype as string,",
						"          ts_montaguoffice as string,",
						"          ts_quickcapturegeography as string,",
						"          xpd_roletypes as string,",
						"          mpe_livedeal as boolean,",
						"          donotbulkpostalmail as boolean,",
						"          donotpostalmail as boolean,",
						"          msdyn_gdproptout as boolean,",
						"          ts_organisationalchange as boolean,",
						"          xpd_publictoprivatetracker as boolean,",
						"          ts_auditor as boolean,",
						"          donotsendmm as boolean,",
						"          donotbulkemail as boolean,",
						"          followemail as boolean,",
						"          creditonhold as boolean,",
						"          marketingonly as boolean,",
						"          participatesinworkflow as boolean,",
						"          merged as boolean,",
						"          ts_validated as boolean,",
						"          xpd_sharepointlocationcreated as boolean,",
						"          xpd_setreminder as boolean,",
						"          ts_personnelchange as boolean,",
						"          donotfax as boolean,",
						"          isprivate as boolean,",
						"          donotphone as boolean,",
						"          xpd_rpo as boolean,",
						"          ts_trackcompany as boolean,",
						"          donotemail as boolean,",
						"          parentaccountid as string,",
						"          parentaccountid_entitytype as string,",
						"          ts_recommendedby as string,",
						"          ts_recommendedby_entitytype as string,",
						"          ts_countryofeconomicoriginforthecapital as string,",
						"          ts_countryofeconomicoriginforthecapital_entitytype as string,",
						"          xpd_reminderto as string,",
						"          xpd_reminderto_entitytype as string,",
						"          preferredserviceid as string,",
						"          preferredserviceid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          createdbyexternalparty as string,",
						"          createdbyexternalparty_entitytype as string,",
						"          ts_validatedby as string,",
						"          ts_validatedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          ts_primarymperelationshipmanager as string,",
						"          ts_primarymperelationshipmanager_entitytype as string,",
						"          modifiedbyexternalparty as string,",
						"          modifiedbyexternalparty_entitytype as string,",
						"          ts_headofficeid as string,",
						"          ts_headofficeid_entitytype as string,",
						"          ts_address1country as string,",
						"          ts_address1country_entitytype as string,",
						"          ts_address1usstate as string,",
						"          ts_address1usstate_entitytype as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          originatingleadid as string,",
						"          originatingleadid_entitytype as string,",
						"          masterid as string,",
						"          masterid_entitytype as string,",
						"          ts_originationlead1 as string,",
						"          ts_originationlead1_entitytype as string,",
						"          defaultpricelevelid as string,",
						"          defaultpricelevelid_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          ts_originationlead2 as string,",
						"          ts_originationlead2_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          mpe_coinvestquestionnaireid as string,",
						"          mpe_coinvestquestionnaireid_entitytype as string,",
						"          ts_hub as string,",
						"          ts_hub_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          ts_currentauditor as string,",
						"          ts_currentauditor_entitytype as string,",
						"          primarycontactid as string,",
						"          primarycontactid_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          preferredsystemuserid as string,",
						"          preferredsystemuserid_entitytype as string,",
						"          preferredequipmentid as string,",
						"          preferredequipmentid_entitytype as string,",
						"          xpd_fund as string,",
						"          xpd_fund_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          territoryid as string,",
						"          territoryid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          xpd_totalinstitutionalcommitments_base as decimal(38,0),",
						"          ts_minimumticketsize_base as decimal(38,4),",
						"          xpd_totalinstitutionalcommitments as decimal(38,0),",
						"          aging30 as decimal(38,0),",
						"          creditlimit as decimal(38,0),",
						"          creditlimit_base as decimal(38,0),",
						"          ts_totalcommitments_base as decimal(38,4),",
						"          aging60 as decimal(38,0),",
						"          ts_transfersin_base as decimal(38,0),",
						"          aging90 as decimal(38,0),",
						"          ts_maximumticketsize as decimal(38,4),",
						"          ts_totalaum_base as decimal(38,0),",
						"          marketcap_base as decimal(38,0),",
						"          aging60_base as decimal(38,0),",
						"          aging90_base as decimal(38,0),",
						"          ts_transfersout as decimal(38,0),",
						"          ts_maximumticketsize_base as decimal(38,4),",
						"          ts_originalcommitments_base as decimal(38,0),",
						"          revenue as decimal(38,0),",
						"          ts_totalcommitments as decimal(38,4),",
						"          ts_transfersout_base as decimal(38,0),",
						"          ts_totalaum as decimal(38,0),",
						"          ts_commitmentreductions_base as decimal(38,0),",
						"          ts_commitmentreductions as decimal(38,0),",
						"          marketcap as decimal(38,0),",
						"          ts_originalcommitments as decimal(38,0),",
						"          ts_minimumticketsize as decimal(38,4),",
						"          revenue_base as decimal(38,0),",
						"          openrevenue_base as decimal(38,0),",
						"          aging30_base as decimal(38,0),",
						"          openrevenue as decimal(38,0),",
						"          ts_transfersin as decimal(38,0),",
						"          ts_othernotes as string,",
						"          ts_transfersin_date as timestamp,",
						"          address1_county as string,",
						"          openrevenue_date as timestamp,",
						"          ts_recommendedbyname as string,",
						"          ts_relationshipinteractioncomments as string,",
						"          ts_originationlead2yominame as string,",
						"          parentaccountidname as string,",
						"          xpd_roletypes_text as string,",
						"          address1_addressid as string,",
						"          importsequencenumber as long,",
						"          address1_longitude as double,",
						"          ts_countryofeconomicoriginforthecapitalname as string,",
						"          entityimageid as string,",
						"          telephone2 as string,",
						"          ts_lastoriginationmeeting as timestamp,",
						"          address2_utcoffset as long,",
						"          address1_upszone as string,",
						"          ts_originalcommitments_state as long,",
						"          ts_typicalcost as string,",
						"          xpd_recommendingportfoliocompaniesrecommended as string,",
						"          accountnumber as string,",
						"          ts_currentauditoryominame as string,",
						"          ts_originalcommitments_date as timestamp,",
						"          lastonholdtime as timestamp,",
						"          ts_sectorscoveredbyfirm as string,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          address2_upszone as string,",
						"          opendeals_state as long,",
						"          xpd_functionuse_text as string,",
						"          slainvokedidname as string,",
						"          address2_longitude as double,",
						"          defaultpricelevelidname as string,",
						"          stockexchange as string,",
						"          mpe_liveofferingscount_date as timestamp,",
						"          xpd_relationshipcomments as string,",
						"          originatingleadidname as string,",
						"          slaname as string,",
						"          ts_currentauditorname as string,",
						"          xpd_remindertoyominame as string,",
						"          ts_address1usstatename as string,",
						"          ts_tempcompanytype as string,",
						"          versionnumber as long,",
						"          address1_latitude as double,",
						"          ts_formername as string,",
						"          yominame as string,",
						"          createdbyyominame as string,",
						"          ts_cityofvisit as string,",
						"          address2_telephone1 as string,",
						"          ts_globalgeographiescoveredids as string,",
						"          preferredserviceidname as string,",
						"          address2_city as string,",
						"          ts_mpeapproachstrategy as string,",
						"          address2_line2 as string,",
						"          ts_lastdatestatuschanged as timestamp,",
						"          li_companyid as long,",
						"          transactioncurrencyidname as string,",
						"          entityimage_url as string,",
						"          xpd_relationshipstatuschangeddate as timestamp,",
						"          createdonbehalfbyname as string,",
						"          mpe_liveofferingscount_state as long,",
						"          xpd_numberofcoinvestinvestments_date as timestamp,",
						"          ts_validateddate as timestamp,",
						"          owneridname as string,",
						"          xpd_generalcomments as string,",
						"          ts_companylegalname as string,",
						"          description as string,",
						"          ts_validatedbyname as string,",
						"          originatingleadidyominame as string,",
						"          opendeals as long,",
						"          xpd_numberofopportunitiesshown_state as long,",
						"          address2_postalcode as string,",
						"          websiteurl as string,",
						"          xpd_fundname as string,",
						"          address1_utcoffset as long,",
						"          exchangerate as decimal(38,10),",
						"          mpe_flowlastrundate as timestamp,",
						"          fax as string,",
						"          address1_line3 as string,",
						"          ts_monthssincelastmeeting as long,",
						"          ts_hubname as string,",
						"          address2_line1 as string,",
						"          ts_capiqticket as string,",
						"          address2_stateorprovince as string,",
						"          address2_name as string,",
						"          ts_transfersout_state as long,",
						"          xpd_numberofopportunitiesshown as long,",
						"          primarytwitterid as string,",
						"          mpe_coinvestquestionnaireidname as string,",
						"          xpd_numberofopportunitiesshown_date as timestamp,",
						"          xpd_preferentialterms as string,",
						"          address1_primarycontactname as string,",
						"          territoryidname as string,",
						"          ts_processstatus as string,",
						"          address1_name as string,",
						"          address2_telephone2 as string,",
						"          address2_telephone3 as string,",
						"          xpd_recruitmentareateam_text as string,",
						"          ftpsiteurl as string,",
						"          address1_postalcode as string,",
						"          ts_companynumber as string,",
						"          createdon as string,",
						"          mpe_liveofferingscount as long,",
						"          traversedpath as string,",
						"          address1_stateorprovince as string,",
						"          ts_transfersin_state as long,",
						"          address2_addressid as string,",
						"          ts_monthlyreviewmeetingname as string,",
						"          primarysatoriid as string,",
						"          telephone3 as string,",
						"          openrevenue_state as long,",
						"          ts_usesprovidedids as string,",
						"          ts_originationcomments as string,",
						"          lastusedincampaign as timestamp,",
						"          primarycontactidname as string,",
						"          ts_originationlead1name as string,",
						"          ts_headofficeidname as string,",
						"          ts_montagucomments as string,",
						"          address2_fax as string,",
						"          createdbyname as string,",
						"          xpd_numberofcoinvestinvestments as long,",
						"          ts_capitaliqlink as string,",
						"          ts_primarymperelationshipmanagername as string,",
						"          mpe_relationshipstatus_text as string,",
						"          xpd_datereminderwasset as timestamp,",
						"          xpd_numberofcoinvestinvestments_state as long,",
						"          address1_postofficebox as string,",
						"          address1_city as string,",
						"          teamsfollowed as long,",
						"          ts_originationlead2name as string,",
						"          timezoneruleversionnumber as long,",
						"          modifiedonbehalfbyyominame as string,",
						"          entityimage_timestamp as long,",
						"          tickersymbol as string,",
						"          ts_theirprogrammecomments as string,",
						"          xpd_companyuse_text as string,",
						"          modifiedbyname as string,",
						"          owneridtype as string,",
						"          sic as string,",
						"          sharesoutstanding as long,",
						"          opendeals_date as timestamp,",
						"          address2_postofficebox as string,",
						"          emailaddress3 as string,",
						"          emailaddress2 as string,",
						"          emailaddress1 as string,",
						"          ts_globalgeographiescoveredbyfirm as string,",
						"          ts_recommendationoffirmupdated as timestamp,",
						"          ts_lastmet as timestamp,",
						"          ts_reminderdatesetto as timestamp,",
						"          ts_commitmentreductions_state as long,",
						"          owningbusinessunitname as string,",
						"          onholdtime as long,",
						"          ts_alias as string,",
						"          createdonbehalfbyyominame as string,",
						"          ts_transfersout_date as timestamp,",
						"          ts_address1countryname as string,",
						"          preferredsystemuseridyominame as string,",
						"          createdbyexternalpartyname as string,",
						"          mpe_documentsetid as string,",
						"          telephone1 as string,",
						"          ts_legacycompanytypes as string,",
						"          ts_validatedbyyominame as string,",
						"          address1_composite as string,",
						"          ts_investorgroupgatekeeperid as string,",
						"          primarycontactidyominame as string,",
						"          address2_country as string,",
						"          xpd_recommendationcomments as string,",
						"          owneridyominame as string,",
						"          createdbyexternalpartyyominame as string,",
						"          ts_originationlead1yominame as string,",
						"          ts_usesprovidedbyfirm as string,",
						"          xpd_recommendingportco as string,",
						"          address1_country as string,",
						"          ts_commitmentreductions_date as timestamp,",
						"          name as string,",
						"          modifiedbyexternalpartyyominame as string,",
						"          xpd_remindertoname as string,",
						"          stageid as string,",
						"          modifiedonbehalfbyname as string,",
						"          masteraccountidname as string,",
						"          timespentbymeonemailandmeetings as string,",
						"          address2_latitude as double,",
						"          overriddencreatedon as timestamp,",
						"          parentaccountidyominame as string,",
						"          ts_specificareaofexpertisecomments as string,",
						"          preferredsystemuseridname as string,",
						"          utcconversiontimezonecode as long,",
						"          address2_county as string,",
						"          address1_line1 as string,",
						"          address2_primarycontactname as string,",
						"          address1_line2 as string,",
						"          xpd_reasonaction as string,",
						"          ts_primarymperelationshipmanageryominame as string,",
						"          processid as string,",
						"          ts_sectorscoveredids as string,",
						"          ts_recommendedbyyominame as string,",
						"          modifiedbyexternalpartyname as string,",
						"          ts_relevantsituations as string,",
						"          accountid as string,",
						"          modifiedon as timestamp,",
						"          preferredequipmentidname as string,",
						"          modifiedbyyominame as string,",
						"          ts_dealstageofmostrecentopportunity as string,",
						"          address2_composite as string,",
						"          masteraccountidyominame as string,",
						"          numberofemployees as long,",
						"          address1_fax as string,",
						"          address2_line3 as string,",
						"          msdyn_segmentid as string,",
						"          msdyn_segmentid_entitytype as string,",
						"          msdyn_segmentidname as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'account') ~> AccountIn",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          ts_dealannouncedreason as long,",
						"          ts_highprioritynew as long,",
						"          ts_actionstatus as long,",
						"          mpe_targetrelationshipstatus as long,",
						"          ts_producttype as long,",
						"          ts_internalintermediarysource as long,",
						"          mpe_flowlastrunoutcome as long,",
						"          ts_currentactivity as long,",
						"          ts_opportunitystatus as long,",
						"          ts_montaguprimaryoffice as long,",
						"          ts_opportunitytype as long,",
						"          ts_posthumstatus as long,",
						"          ts_meetingremindermonths as long,",
						"          ts_choppedreason as string,",
						"          ts_setreminder as boolean,",
						"          ts_stagereachedfir as boolean,",
						"          ts_stagereachedipr as boolean,",
						"          ts_duplicateopportunityfordiscussion as boolean,",
						"          mpe_smalltarget as boolean,",
						"          ts_stagereachedcr as boolean,",
						"          xpd_includeonallpapers as boolean,",
						"          ts_sold as boolean,",
						"          xpd_sharepointlocationcreated as boolean,",
						"          ts_statuschangedby as string,",
						"          ts_statuschangedby_entitytype as string,",
						"          ts_buyer as string,",
						"          ts_buyer_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          ts_reminderto as string,",
						"          ts_reminderto_entitytype as string,",
						"          mpe_productid as string,",
						"          mpe_productid_entitytype as string,",
						"          ts_targetbusiness as string,",
						"          ts_targetbusiness_entitytype as string,",
						"          ts_firstreferralcompany as string,",
						"          ts_firstreferralcompany_entitytype as string,",
						"          ts_deallead as string,",
						"          ts_deallead_entitytype as string,",
						"          ts_montaguowner as string,",
						"          ts_montaguowner_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          ts_firstreferralcontact as string,",
						"          ts_firstreferralcontact_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ts_managerwedback as string,",
						"          ts_managerwedback_entitytype as string,",
						"          ts_country as string,",
						"          ts_country_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          ts_sellmandate as string,",
						"          ts_sellmandate_entitytype as string,",
						"          ts_estebitda_base as decimal(38,4),",
						"          ts_estebit_base as decimal(38,4),",
						"          ts_estebitda as decimal(38,4),",
						"          ts_estebit as decimal(38,4),",
						"          ts_estturnover_base as decimal(38,4),",
						"          ts_estdealsize as decimal(38,4),",
						"          ts_estdealsize_base as decimal(38,4),",
						"          ts_estturnover as decimal(38,4),",
						"          ts_buyeryominame as string,",
						"          modifiedon as timestamp,",
						"          ts_statuschangedbyname as string,",
						"          ts_managerwedbackyominame as string,",
						"          xpd_montaguprojectname as string,",
						"          transactioncurrencyidname as string,",
						"          ts_nextsteps as string,",
						"          ts_montaguowneryominame as string,",
						"          ts_firstreferralcontactname as string,",
						"          ts_opportunitydescription as string,",
						"          ts_buyerpaidxltmebitda as decimal(38,1),",
						"          ts_targetbusinessyominame as string,",
						"          ts_montaguownername as string,",
						"          ts_managerwedbackname as string,",
						"          ts_opportunitystage as string,",
						"          ts_otherdocumentsurl as string,",
						"          exchangerate as decimal(38,10),",
						"          mpe_documentsetid as string,",
						"          ts_buyername as string,",
						"          ts_firstreferralcontactyominame as string,",
						"          createdon as string,",
						"          ts_sellmandateyominame as string,",
						"          mpe_montaguprimaryofficestring as string,",
						"          ts_statuschangedbyyominame as string,",
						"          ts_firstreferralcompanyname as string,",
						"          owneridyominame as string,",
						"          ts_choppedcomments as string,",
						"          timezoneruleversionnumber as long,",
						"          createdbyname as string,",
						"          ts_dealleadname as string,",
						"          owningbusinessunitname as string,",
						"          ts_dealleadyominame as string,",
						"          ts_lastdatestatuschanged as timestamp,",
						"          traversedpath as string,",
						"          overriddencreatedon as timestamp,",
						"          ts_iprdocumenturl as string,",
						"          createdonbehalfbyname as string,",
						"          ts_sellmandatename as string,",
						"          owneridtype as string,",
						"          owneridname as string,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          mpe_productidname as string,",
						"          ts_originationopportunityid as string,",
						"          ts_crdocumenturl as string,",
						"          ts_datedealannounced as timestamp,",
						"          processid as string,",
						"          mpe_montaguprimaryofficeowner as string,",
						"          ts_reason as string,",
						"          ts_targetbusinessname as string,",
						"          ts_remindertoname as string,",
						"          ts_postcompletionnoteurl as string,",
						"          ts_name as string,",
						"          stageid as string,",
						"          ts_currentopportunitystatus as string,",
						"          ts_firstreferralcompanyyominame as string,",
						"          mpe_flowlastrundate as timestamp,",
						"          ts_firdocumenturl as string,",
						"          modifiedbyyominame as string,",
						"          modifiedonbehalfbyyominame as string,",
						"          ts_movedoutofwipdate as timestamp,",
						"          ts_equitychequesize as decimal(38,2),",
						"          utcconversiontimezonecode as long,",
						"          ts_weofferedxltmebitda as decimal(38,1),",
						"          importsequencenumber as long,",
						"          ts_remindertoyominame as string,",
						"          ts_companyid as long,",
						"          ts_datereminderwasset as timestamp,",
						"          versionnumber as long,",
						"          ts_originationid as long,",
						"          ts_countryname as string,",
						"          ts_choppeddate as timestamp,",
						"          mpe_posthunstatustext as string,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          ts_humdate as timestamp,",
						"          ts_sellmandateidtype as string,",
						"          ts_dateofreminder as timestamp,",
						"          ts_humurl as string,",
						"          mpe_carveout as long,",
						"          mpe_targetbusiness_parentid as string,",
						"          mpe_targetbusiness_parentid_entitytype as string,",
						"          mpe_targetbusiness_parentidyominame as string,",
						"          mpe_targetbusiness_parentidname as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'ts_originationopportunity') ~> OriginationOpportunityIn",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          ts_stageofmeetingrounds as long,",
						"          ts_talentmeetingtype as long,",
						"          instancetypecode as long,",
						"          ts_whooriginatedthemeeting as long,",
						"          onlinemeetingtype as long,",
						"          ts_meetingteam as long,",
						"          ts_othermeetingmethod as long,",
						"          ts_tone as long,",
						"          ts_meetingmethod as long,",
						"          ts_originationmeetingtype as long,",
						"          prioritycode as long,",
						"          attachmenterrors as long,",
						"          ts_eventtype as long,",
						"          ts_talentmeetingmethod as long,",
						"          ts_productsdiscussed as string,",
						"          ts_contentcovered as string,",
						"          isonlinemeeting as boolean,",
						"          isworkflowcreated as boolean,",
						"          isalldayevent as boolean,",
						"          ts_interview as boolean,",
						"          isbilled as boolean,",
						"          isdraft as boolean,",
						"          ts_keyiractivity as boolean,",
						"          ts_noninvestor as boolean,",
						"          ismapiprivate as boolean,",
						"          isregularactivity as boolean,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          ts_investorgroup as string,",
						"          ts_investorgroup_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          regardingobjectid as string,",
						"          regardingobjectid_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ts_officemet as string,",
						"          ts_officemet_entitytype as string,",
						"          ts_taskowner as string,",
						"          ts_taskowner_entitytype as string,",
						"          serviceid as string,",
						"          serviceid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          requiredattendees as string,",
						"          optionalattendees as string,",
						"          organizer as string,",
						"          scheduledend as timestamp,",
						"          ts_taskdescription as string,",
						"          modifiedon as timestamp,",
						"          ts_purpose as string,",
						"          overriddencreatedon as timestamp,",
						"          ts_taskownername as string,",
						"          activityadditionalparams as string,",
						"          ts_tonepersonalities as string,",
						"          seriesid as string,",
						"          transactioncurrencyidname as string,",
						"          activityid as string,",
						"          modifiedfieldsmask as string,",
						"          utcconversiontimezonecode as long,",
						"          ts_officemetname as string,",
						"          scheduledstart as timestamp,",
						"          outlookownerapptid as long,",
						"          ts_topicscovered as string,",
						"          ts_objective as string,",
						"          onholdtime as long,",
						"          onlinemeetingjoinurl as string,",
						"          ts_notes as string,",
						"          originalstartdate as timestamp,",
						"          ts_opportunitiesdiscussed as string,",
						"          ts_sectorscoveredbyfirm as string,",
						"          attachmentcount as long,",
						"          exchangerate as decimal(38,10),",
						"          ts_originationcommentsnotes as string,",
						"          category as string,",
						"          createdon as string,",
						"          ts_eventdescription as string,",
						"          globalobjectid as string,",
						"          onlinemeetingid as string,",
						"          serviceidname as string,",
						"          owneridyominame as string,",
						"          description as string,",
						"          subcategory as string,",
						"          owningbusinessunitname as string,",
						"          ts_taskduedate as timestamp,",
						"          traversedpath as string,",
						"          sortdate as timestamp,",
						"          createdonbehalfbyname as string,",
						"          ts_sectorscoveredids as string,",
						"          safedescription as string,",
						"          ts_taskowneryominame as string,",
						"          owneridtype as string,",
						"          isunsafe as long,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          ts_conferencename as string,",
						"          timezoneruleversionnumber as long,",
						"          actualend as timestamp,",
						"          regardingobjectidname as string,",
						"          processid as string,",
						"          activitytypecode as string,",
						"          actualstart as timestamp,",
						"          xpd_listofexternalattendees as string,",
						"          slainvokedidname as string,",
						"          location as string,",
						"          subject as string,",
						"          createdbyname as string,",
						"          actualdurationminutes as long,",
						"          modifiedbyyominame as string,",
						"          lastonholdtime as timestamp,",
						"          modifiedonbehalfbyyominame as string,",
						"          ts_attendeestoaddtocrm as string,",
						"          regardingobjectidyominame as string,",
						"          regardingobjecttypecode as string,",
						"          stageid as string,",
						"          scheduleddurationminutes as long,",
						"          ts_sourceid as string,",
						"          ts_investorgroupyominame as string,",
						"          importsequencenumber as long,",
						"          subscriptionid as string,",
						"          onlinemeetingchatid as string,",
						"          ts_lpupdates as string,",
						"          ts_executivesummary as string,",
						"          ts_investorgroupname as string,",
						"          ts_meetingcity as string,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          owneridname as string,",
						"          ts_theirprogramme as string,",
						"          ts_ifdeclinedreason as string,",
						"          slaname as string,",
						"          versionnumber as long",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'appointment') ~> MeetingsAppointmentsIn",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          haschildrencode as long,",
						"          customertypecode as long,",
						"          ts_recommendationofindividual as long,",
						"          gendercode as long,",
						"          address1_addresstypecode as long,",
						"          leadsourcecode as long,",
						"          preferredappointmenttimecode as long,",
						"          address2_freighttermscode as long,",
						"          address2_shippingmethodcode as long,",
						"          ts_debtsubtype as long,",
						"          msdyn_orgchangestatus as long,",
						"          ts_suffix as long,",
						"          xpd_gender as long,",
						"          ts_title as long,",
						"          paymenttermscode as long,",
						"          accountrolecode as long,",
						"          territorycode as long,",
						"          ts_vendortargettrackingrole as long,",
						"          address3_freighttermscode as long,",
						"          address1_shippingmethodcode as long,",
						"          preferredappointmentdaycode as long,",
						"          customersizecode as long,",
						"          preferredcontactmethodcode as long,",
						"          ts_futurecontactmethod as long,",
						"          address3_shippingmethodcode as long,",
						"          address2_addresstypecode as long,",
						"          mpe_flowlastrunoutcome as long,",
						"          ts_capabilitiesofindividual as long,",
						"          address3_addresstypecode as long,",
						"          familystatuscode as long,",
						"          shippingmethodcode as long,",
						"          xpd_availability as long,",
						"          educationcode as long,",
						"          address1_freighttermscode as long,",
						"          ts_quickcaptureuses as string,",
						"          xpd_montagulevel as string,",
						"          ts_permanentinterim as string,",
						"          ts_ircontactrole as string,",
						"          xpd_level as string,",
						"          ts_languagesspokenwritten as string,",
						"          ts_contacttype as string,",
						"          ts_montaguoffice as string,",
						"          ts_roletypes as string,",
						"          xpd_specialisms as string,",
						"          ts_quickcapturesectors as string,",
						"          xpd_function as string,",
						"          ts_producttype as string,",
						"          ts_quickcapturegeography as string,",
						"          ts_productsinterestedin as string,",
						"          ts_potentialrolecandidate as boolean,",
						"          isbackofficecustomer as boolean,",
						"          donotpostalmail as boolean,",
						"          xpd_addcontacttooutlook as boolean,",
						"          ts_centralrelationshipmanager as boolean,",
						"          msdyn_gdproptout as boolean,",
						"          xpd_hascompany as boolean,",
						"          creditonhold as boolean,",
						"          xpd_benchcandidate as boolean,",
						"          donotbulkpostalmail as boolean,",
						"          donotsendmm as boolean,",
						"          donotbulkemail as boolean,",
						"          followemail as boolean,",
						"          xpd_sharepointdocumentlocationcreated as boolean,",
						"          xpd_available as boolean,",
						"          ts_leadearlystageinteraction as boolean,",
						"          participatesinworkflow as boolean,",
						"          ts_doyouwishtotrackthiscontact as boolean,",
						"          merged as boolean,",
						"          ts_validated as boolean,",
						"          marketingonly as boolean,",
						"          donotfax as boolean,",
						"          isprivate as boolean,",
						"          donotphone as boolean,",
						"          isautocreate as boolean,",
						"          donotemail as boolean,",
						"          ts_unconfirmedemailaddress as boolean,",
						"          preferredsystemuserid as string,",
						"          preferredsystemuserid_entitytype as string,",
						"          mpe_accountid as string,",
						"          mpe_accountid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          ts_recommendedby as string,",
						"          ts_recommendedby_entitytype as string,",
						"          ts_previousemployerid as string,",
						"          ts_previousemployerid_entitytype as string,",
						"          preferredserviceid as string,",
						"          preferredserviceid_entitytype as string,",
						"          parentcontactid as string,",
						"          parentcontactid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          ts_pa as string,",
						"          ts_pa_entitytype as string,",
						"          ts_businessaddress as string,",
						"          ts_businessaddress_entitytype as string,",
						"          modifiedbyexternalparty as string,",
						"          modifiedbyexternalparty_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          originatingleadid as string,",
						"          originatingleadid_entitytype as string,",
						"          masterid as string,",
						"          masterid_entitytype as string,",
						"          defaultpricelevelid as string,",
						"          defaultpricelevelid_entitytype as string,",
						"          parent_contactid as string,",
						"          parent_contactid_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          createdbyexternalparty as string,",
						"          createdbyexternalparty_entitytype as string,",
						"          preferredequipmentid as string,",
						"          preferredequipmentid_entitytype as string,",
						"          xpd_referredbyinternal as string,",
						"          xpd_referredbyinternal_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          xpd_homecountry as string,",
						"          xpd_homecountry_entitytype as string,",
						"          ts_placementfirmintroducedby as string,",
						"          ts_placementfirmintroducedby_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          accountid as string,",
						"          accountid_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          parentcustomerid as string,",
						"          parentcustomerid_entitytype as string,",
						"          xpd_referredbyexternal as string,",
						"          xpd_referredbyexternal_entitytype as string,",
						"          aging30 as decimal(38,2),",
						"          creditlimit_base as decimal(38,4),",
						"          aging60 as decimal(38,2),",
						"          aging90 as decimal(38,2),",
						"          aging60_base as decimal(38,4),",
						"          aging90_base as decimal(38,4),",
						"          annualincome_base as decimal(38,4),",
						"          creditlimit as decimal(38,2),",
						"          annualincome as decimal(38,2),",
						"          aging30_base as decimal(38,4),",
						"          ts_othernotes as string,",
						"          xpd_referredbyinternalyominame as string,",
						"          address1_county as string,",
						"          yomilastname as string,",
						"          address3_utcoffset as long,",
						"          ts_recommendedbyname as string,",
						"          description as string,",
						"          li_membertoken as string,",
						"          department as string,",
						"          xpd_roletypes_text as string,",
						"          address1_addressid as string,",
						"          importsequencenumber as long,",
						"          address1_longitude as double,",
						"          address3_fax as string,",
						"          managername as string,",
						"          entityimageid as string,",
						"          telephone2 as string,",
						"          parentcustomeridtype as string,",
						"          address2_upszone as string,",
						"          address1_upszone as string,",
						"          xpd_recommendingportfoliocompaniesrecommended as string,",
						"          lastonholdtime as timestamp,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          address1_fax as string,",
						"          address3_telephone1 as string,",
						"          address3_telephone2 as string,",
						"          address3_telephone3 as string,",
						"          fax as string,",
						"          assistantname as string,",
						"          address2_line3 as string,",
						"          accountidyominame as string,",
						"          parentcontactidyominame as string,",
						"          mpe_accountidyominame as string,",
						"          slainvokedidname as string,",
						"          defaultpricelevelidname as string,",
						"          fullname as string,",
						"          address2_longitude as double,",
						"          subscriptionid as string,",
						"          originatingleadidname as string,",
						"          slaname as string,",
						"          versionnumber as long,",
						"          address1_latitude as double,",
						"          createdbyyominame as string,",
						"          parent_contactidname as string,",
						"          address2_telephone1 as string,",
						"          pager as string,",
						"          salutation as string,",
						"          mpe_accountidname as string,",
						"          xpd_functionuse_text as string,",
						"          accountidname as string,",
						"          mpe_companysummary as string,",
						"          parent_contactidyominame as string,",
						"          preferredserviceidname as string,",
						"          address2_city as string,",
						"          address3_postalcode as string,",
						"          address2_line2 as string,",
						"          li_companyid as long,",
						"          ts_otherphonelabel as string,",
						"          ts_reportingemail as string,",
						"          address3_upszone as string,",
						"          transactioncurrencyidname as string,",
						"          address3_county as string,",
						"          entityimage_url as string,",
						"          governmentid as string,",
						"          callback as string,",
						"          business2 as string,",
						"          createdonbehalfbyname as string,",
						"          ts_validateddate as timestamp,",
						"          address2_telephone2 as string,",
						"          owneridname as string,",
						"          originatingleadidyominame as string,",
						"          ts_otherlanguages as string,",
						"          address2_postalcode as string,",
						"          birthdate as timestamp,",
						"          parentcontactidname as string,",
						"          spousesname as string,",
						"          xpd_compensationdate as timestamp,",
						"          address1_utcoffset as long,",
						"          address3_line1 as string,",
						"          traversedpath as string,",
						"          exchangerate as decimal(38,10),",
						"          mpe_flowlastrundate as timestamp,",
						"          address1_line3 as string,",
						"          address3_country as string,",
						"          mpe_documentsetid as string,",
						"          address2_line1 as string,",
						"          ts_previousemployeridyominame as string,",
						"          middlename as string,",
						"          managerphone as string,",
						"          address2_stateorprovince as string,",
						"          childrensnames as string,",
						"          address2_name as string,",
						"          address3_addressid as string,",
						"          address3_stateorprovince as string,",
						"          ts_sectorspecialtyids as string,",
						"          businesscardattributes as string,",
						"          anniversary as timestamp,",
						"          ts_employmentstartdate as timestamp,",
						"          ts_legacycontacttypes as string,",
						"          address1_primarycontactname as string,",
						"          address2_utcoffset as long,",
						"          home2 as string,",
						"          ts_geographicspecialtyids as string,",
						"          address1_name as string,",
						"          ts_recommendationcomments as string,",
						"          address2_telephone3 as string,",
						"          address3_primarycontactname as string,",
						"          ftpsiteurl as string,",
						"          address1_postalcode as string,",
						"          createdon as string,",
						"          address1_stateorprovince as string,",
						"          yomimiddlename as string,",
						"          jobtitle as string,",
						"          telephone3 as string,",
						"          ts_usesspeciality as string,",
						"          ts_knowntouserinitials as string,",
						"          address2_fax as string,",
						"          createdbyname as string,",
						"          xpd_contactuse_text as string,",
						"          ts_sourceid as string,",
						"          address2_addressid as string,",
						"          employeeid as string,",
						"          address1_postofficebox as string,",
						"          address1_city as string,",
						"          ts_businessaddressname as string,",
						"          teamsfollowed as long,",
						"          ts_cv as string,",
						"          timezoneruleversionnumber as long,",
						"          modifiedonbehalfbyyominame as string,",
						"          xpd_hrcompensation as string,",
						"          ts_currentbonusandorupliftconsiderations as string,",
						"          modifiedbyname as string,",
						"          address3_line2 as string,",
						"          yomifullname as string,",
						"          owneridtype as string,",
						"          entityimage_timestamp as long,",
						"          ts_placementfirmintroducedbyyominame as string,",
						"          xpd_previousrole as string,",
						"          ts_compensation as string,",
						"          address2_postofficebox as string,",
						"          emailaddress3 as string,",
						"          emailaddress2 as string,",
						"          emailaddress1 as string,",
						"          ts_interactioncontactuniqueidentifier as string,",
						"          ts_investmentcafeid as string,",
						"          websiteurl as string,",
						"          nickname as string,",
						"          ts_lastmet as timestamp,",
						"          address3_name as string,",
						"          ts_usesspecialtyids as string,",
						"          ts_linkedinurl as string,",
						"          lastname as string,",
						"          address3_longitude as double,",
						"          xpd_referredbyexternalidtype as string,",
						"          parentcustomeridname as string,",
						"          owningbusinessunitname as string,",
						"          onholdtime as long,",
						"          createdonbehalfbyyominame as string,",
						"          preferredsystemuseridyominame as string,",
						"          createdbyexternalpartyname as string,",
						"          ts_tone as string,",
						"          telephone1 as string,",
						"          overriddencreatedon as timestamp,",
						"          address3_postofficebox as string,",
						"          assistantphone as string,",
						"          address1_composite as string,",
						"          address3_line3 as string,",
						"          address2_country as string,",
						"          xpd_referredbyinternalname as string,",
						"          mobilephone as string,",
						"          owneridyominame as string,",
						"          address1_line1 as string,",
						"          createdbyexternalpartyyominame as string,",
						"          xpd_referredbyexternalyominame as string,",
						"          yomifirstname as string,",
						"          mastercontactidname as string,",
						"          address3_city as string,",
						"          address1_country as string,",
						"          externaluseridentifier as string,",
						"          modifiedbyexternalpartyyominame as string,",
						"          firstname as string,",
						"          xpd_hrcurrentbonusandorupliftconsiderations as string,",
						"          stageid as string,",
						"          modifiedonbehalfbyname as string,",
						"          xpd_homecountryname as string,",
						"          mastercontactidyominame as string,",
						"          suffix as string,",
						"          ts_payominame as string,",
						"          lastusedincampaign as timestamp,",
						"          ts_geographicspeciality as string,",
						"          xpd_recruitmentareateam_text as string,",
						"          ts_retentionreviewdate as timestamp,",
						"          parentcustomeridyominame as string,",
						"          timespentbymeonemailandmeetings as string,",
						"          address2_latitude as double,",
						"          xpd_availablefrom as timestamp,",
						"          address3_composite as string,",
						"          xpd_recommendingportco as string,",
						"          preferredsystemuseridname as string,",
						"          utcconversiontimezonecode as long,",
						"          address2_county as string,",
						"          ts_paname as string,",
						"          contactid as string,",
						"          address2_primarycontactname as string,",
						"          ts_specificareasofexpertisecomments as string,",
						"          address1_line2 as string,",
						"          ts_recommendationofindividualupdated as timestamp,",
						"          xpd_referredbyexternalname as string,",
						"          ts_placementfirmintroducedbyname as string,",
						"          ts_sectorspeciality as string,",
						"          ts_previousemployeridname as string,",
						"          processid as string,",
						"          ts_recommendedbyyominame as string,",
						"          modifiedon as timestamp,",
						"          modifiedbyexternalpartyname as string,",
						"          ts_relevantsituations as string,",
						"          businesscard as string,",
						"          company as string,",
						"          preferredequipmentidname as string,",
						"          modifiedbyyominame as string,",
						"          ts_preferredname as string,",
						"          address2_composite as string,",
						"          numberofchildren as long,",
						"          address3_latitude as double,",
						"          mpe_companysearchbyemail as boolean,",
						"          msdyn_segmentid as string,",
						"          msdyn_segmentid_entitytype as string,",
						"          msdyn_segmentidname as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'contact') ~> ContactsIn",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          stateAZlabel as string,",
						"          statusAZlabel as string,",
						"          ts_primarysecondaryfocus as string,",
						"          customertypeAZlabel as string,",
						"          address1_addresstypeAZlabel as string,",
						"          accountclassificationAZlabel as string,",
						"          ts_easeofworking as string,",
						"          ts_ukrow as string,",
						"          preferredappointmenttimeAZlabel as string,",
						"          ts_address1addresstype as string,",
						"          xpd_relationshipstatus as string,",
						"          ts_relationship as string,",
						"          xpd_remindermonths as string,",
						"          ts_importance as string,",
						"          address2_freighttermsAZlabel as string,",
						"          ts_irrvsmomperformancemeasure as string,",
						"          ts_introducertype as string,",
						"          accountcategoryAZlabel as string,",
						"          paymenttermsAZlabel as string,",
						"          preferredappointmentdayAZlabel as string,",
						"          businesstypeAZlabel as string,",
						"          industryAZlabel as string,",
						"          ts_sizeoffirm as string,",
						"          ts_interaction as string,",
						"          address1_shippingmethodAZlabel as string,",
						"          ts_portfoliocompanystatus as string,",
						"          customersizeAZlabel as string,",
						"          xpd_previousinvestorstatus as string,",
						"          ts_recommendationoffirm as string,",
						"          preferredcontactmethodAZlabel as string,",
						"          accountratingAZlabel as string,",
						"          ts_investorstatus as string,",
						"          ts_capabilitiesoffirm as string,",
						"          mpe_flowlastrunoutcome as string,",
						"          address2_addresstypeAZlabel as string,",
						"          address2_shippingmethodAZlabel as string,",
						"          ts_nextoriginationmeetingarranged as string,",
						"          ownershipAZlabel as string,",
						"          territoryAZlabel as string,",
						"          ts_investortype as string,",
						"          shippingmethodAZlabel as string,",
						"          ts_investorregion as string,",
						"          address1_freighttermsAZlabel as string,",
						"          xpd_function as string,",
						"          ts_quickcaptureuses as string,",
						"          xpd_montagulevel as string,",
						"          ts_permanentinterim as string,",
						"          ts_quickcapturesectors as string,",
						"          ts_roletypes as string,",
						"          ts_companytype as string,",
						"          xpd_level as string,",
						"          ts_indicativeclientbase as string,",
						"          xpd_specialisms as string,",
						"          ts_vendorsummary as string,",
						"          ts_producttype as string,",
						"          ts_montaguoffice as string,",
						"          ts_quickcapturegeography as string,",
						"          xpd_roletypes as string,",
						"          mpe_livedeal as string,",
						"          donotbulkpostalmail as string,",
						"          donotpostalmail as string,",
						"          msdyn_gdproptout as string,",
						"          ts_organisationalchange as string,",
						"          xpd_publictoprivatetracker as string,",
						"          ts_auditor as string,",
						"          donotsendmm as string,",
						"          donotbulkemail as string,",
						"          followemail as string,",
						"          creditonhold as string,",
						"          marketingonly as string,",
						"          participatesinworkflow as string,",
						"          merged as string,",
						"          ts_validated as string,",
						"          xpd_sharepointlocationcreated as string,",
						"          xpd_setreminder as string,",
						"          ts_personnelchange as string,",
						"          donotfax as string,",
						"          isprivate as string,",
						"          donotphone as string,",
						"          xpd_rpo as string,",
						"          ts_trackcompany as string,",
						"          donotemail as string,",
						"          parentaccountid as string,",
						"          parentaccountid_entitytype as string,",
						"          ts_recommendedby as string,",
						"          ts_recommendedby_entitytype as string,",
						"          ts_countryofeconomicoriginforthecapital as string,",
						"          ts_countryofeconomicoriginforthecapital_entitytype as string,",
						"          xpd_reminderto as string,",
						"          xpd_reminderto_entitytype as string,",
						"          preferredserviceid as string,",
						"          preferredserviceid_entitytype as string,",
						"          msdyn_segmentid as string,",
						"          msdyn_segmentid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          createdbyexternalparty as string,",
						"          createdbyexternalparty_entitytype as string,",
						"          ts_validatedby as string,",
						"          ts_validatedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          ts_primarymperelationshipmanager as string,",
						"          ts_primarymperelationshipmanager_entitytype as string,",
						"          modifiedbyexternalparty as string,",
						"          modifiedbyexternalparty_entitytype as string,",
						"          ts_headofficeid as string,",
						"          ts_headofficeid_entitytype as string,",
						"          ts_address1country as string,",
						"          ts_address1country_entitytype as string,",
						"          ts_address1usstate as string,",
						"          ts_address1usstate_entitytype as string,",
						"          msdyn_salesaccelerationinsightid as string,",
						"          msdyn_salesaccelerationinsightid_entitytype as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          originatingleadid as string,",
						"          originatingleadid_entitytype as string,",
						"          masterid as string,",
						"          masterid_entitytype as string,",
						"          ts_originationlead1 as string,",
						"          ts_originationlead1_entitytype as string,",
						"          defaultpricelevelid as string,",
						"          defaultpricelevelid_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          ts_originationlead2 as string,",
						"          ts_originationlead2_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          mpe_coinvestquestionnaireid as string,",
						"          mpe_coinvestquestionnaireid_entitytype as string,",
						"          ts_hub as string,",
						"          ts_hub_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          ts_currentauditor as string,",
						"          ts_currentauditor_entitytype as string,",
						"          primarycontactid as string,",
						"          primarycontactid_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          preferredsystemuserid as string,",
						"          preferredsystemuserid_entitytype as string,",
						"          preferredequipmentid as string,",
						"          preferredequipmentid_entitytype as string,",
						"          xpd_fund as string,",
						"          xpd_fund_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          territoryid as string,",
						"          territoryid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          xpd_totalinstitutionalcommitments_base as decimal(38,0),",
						"          ts_minimumticketsize_base as decimal(38,4),",
						"          xpd_totalinstitutionalcommitments as decimal(38,0),",
						"          aging30 as decimal(38,0),",
						"          creditlimit as decimal(38,0),",
						"          creditlimit_base as decimal(38,0),",
						"          ts_totalcommitments_base as decimal(38,4),",
						"          aging60 as decimal(38,0),",
						"          ts_transfersin_base as decimal(38,0),",
						"          aging90 as decimal(38,0),",
						"          ts_maximumticketsize as decimal(38,4),",
						"          ts_totalaum_base as decimal(38,0),",
						"          marketcap_base as decimal(38,0),",
						"          aging60_base as decimal(38,0),",
						"          aging90_base as decimal(38,0),",
						"          ts_transfersout as decimal(38,0),",
						"          ts_maximumticketsize_base as decimal(38,4),",
						"          ts_originalcommitments_base as decimal(38,0),",
						"          revenue as decimal(38,0),",
						"          ts_totalcommitments as decimal(38,4),",
						"          ts_transfersout_base as decimal(38,0),",
						"          ts_totalaum as decimal(38,0),",
						"          ts_commitmentreductions_base as decimal(38,0),",
						"          ts_commitmentreductions as decimal(38,0),",
						"          marketcap as decimal(38,0),",
						"          ts_originalcommitments as decimal(38,0),",
						"          ts_minimumticketsize as decimal(38,4),",
						"          revenue_base as decimal(38,0),",
						"          openrevenue_base as decimal(38,0),",
						"          aging30_base as decimal(38,0),",
						"          openrevenue as decimal(38,0),",
						"          ts_transfersin as decimal(38,0),",
						"          ts_othernotes as string,",
						"          ts_transfersin_date as timestamp,",
						"          msdyn_salesaccelerationinsightidname as string,",
						"          address1_county as string,",
						"          openrevenue_date as timestamp,",
						"          ts_recommendedbyname as string,",
						"          ts_relationshipinteractioncomments as string,",
						"          ts_originationlead2yominame as string,",
						"          parentaccountidname as string,",
						"          xpd_roletypes_text as string,",
						"          address1_addressid as string,",
						"          importsequencenumber as long,",
						"          address1_longitude as double,",
						"          ts_countryofeconomicoriginforthecapitalname as string,",
						"          entityimageid as string,",
						"          telephone2 as string,",
						"          ts_lastoriginationmeeting as timestamp,",
						"          address2_utcoffset as long,",
						"          address1_upszone as string,",
						"          ts_originalcommitments_state as long,",
						"          ts_typicalcost as string,",
						"          xpd_recommendingportfoliocompaniesrecommended as string,",
						"          accountnumber as string,",
						"          ts_currentauditoryominame as string,",
						"          ts_originalcommitments_date as timestamp,",
						"          lastonholdtime as timestamp,",
						"          ts_sectorscoveredbyfirm as string,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          address2_upszone as string,",
						"          opendeals_state as long,",
						"          xpd_functionuse_text as string,",
						"          slainvokedidname as string,",
						"          address2_longitude as double,",
						"          defaultpricelevelidname as string,",
						"          stockexchange as string,",
						"          mpe_liveofferingscount_date as timestamp,",
						"          xpd_relationshipcomments as string,",
						"          originatingleadidname as string,",
						"          slaname as string,",
						"          ts_currentauditorname as string,",
						"          xpd_remindertoyominame as string,",
						"          ts_address1usstatename as string,",
						"          ts_tempcompanytype as string,",
						"          versionnumber as long,",
						"          address1_latitude as double,",
						"          ts_formername as string,",
						"          yominame as string,",
						"          createdbyyominame as string,",
						"          ts_cityofvisit as string,",
						"          address2_telephone1 as string,",
						"          ts_globalgeographiescoveredids as string,",
						"          preferredserviceidname as string,",
						"          address2_city as string,",
						"          ts_mpeapproachstrategy as string,",
						"          address2_line2 as string,",
						"          ts_lastdatestatuschanged as timestamp,",
						"          li_companyid as long,",
						"          transactioncurrencyidname as string,",
						"          entityimage_url as string,",
						"          xpd_relationshipstatuschangeddate as timestamp,",
						"          createdonbehalfbyname as string,",
						"          mpe_liveofferingscount_state as long,",
						"          xpd_numberofcoinvestinvestments_date as timestamp,",
						"          ts_validateddate as timestamp,",
						"          owneridname as string,",
						"          xpd_generalcomments as string,",
						"          ts_companylegalname as string,",
						"          description as string,",
						"          ts_validatedbyname as string,",
						"          originatingleadidyominame as string,",
						"          opendeals as long,",
						"          xpd_numberofopportunitiesshown_state as long,",
						"          address2_postalcode as string,",
						"          websiteurl as string,",
						"          xpd_fundname as string,",
						"          address1_utcoffset as long,",
						"          exchangerate as decimal(38,10),",
						"          mpe_flowlastrundate as timestamp,",
						"          fax as string,",
						"          address1_line3 as string,",
						"          ts_monthssincelastmeeting as long,",
						"          ts_hubname as string,",
						"          address2_line1 as string,",
						"          ts_capiqticket as string,",
						"          address2_stateorprovince as string,",
						"          address2_name as string,",
						"          ts_transfersout_state as long,",
						"          xpd_numberofopportunitiesshown as long,",
						"          primarytwitterid as string,",
						"          mpe_coinvestquestionnaireidname as string,",
						"          xpd_numberofopportunitiesshown_date as timestamp,",
						"          xpd_preferentialterms as string,",
						"          address1_primarycontactname as string,",
						"          territoryidname as string,",
						"          ts_processstatus as string,",
						"          address1_name as string,",
						"          address2_telephone2 as string,",
						"          address2_telephone3 as string,",
						"          xpd_recruitmentareateam_text as string,",
						"          ftpsiteurl as string,",
						"          address1_postalcode as string,",
						"          ts_companynumber as string,",
						"          createdon as string,",
						"          mpe_liveofferingscount as long,",
						"          traversedpath as string,",
						"          address1_stateorprovince as string,",
						"          ts_transfersin_state as long,",
						"          address2_addressid as string,",
						"          ts_monthlyreviewmeetingname as string,",
						"          primarysatoriid as string,",
						"          telephone3 as string,",
						"          openrevenue_state as long,",
						"          ts_usesprovidedids as string,",
						"          ts_originationcomments as string,",
						"          lastusedincampaign as timestamp,",
						"          primarycontactidname as string,",
						"          ts_originationlead1name as string,",
						"          ts_headofficeidname as string,",
						"          msdyn_segmentidname as string,",
						"          ts_montagucomments as string,",
						"          address2_fax as string,",
						"          createdbyname as string,",
						"          xpd_numberofcoinvestinvestments as long,",
						"          ts_capitaliqlink as string,",
						"          ts_primarymperelationshipmanagername as string,",
						"          mpe_relationshipstatus_text as string,",
						"          xpd_datereminderwasset as timestamp,",
						"          xpd_numberofcoinvestinvestments_state as long,",
						"          address1_postofficebox as string,",
						"          address1_city as string,",
						"          teamsfollowed as long,",
						"          ts_originationlead2name as string,",
						"          timezoneruleversionnumber as long,",
						"          modifiedonbehalfbyyominame as string,",
						"          entityimage_timestamp as long,",
						"          tickersymbol as string,",
						"          ts_theirprogrammecomments as string,",
						"          xpd_companyuse_text as string,",
						"          modifiedbyname as string,",
						"          owneridtype as string,",
						"          sic as string,",
						"          sharesoutstanding as long,",
						"          opendeals_date as timestamp,",
						"          address2_postofficebox as string,",
						"          emailaddress3 as string,",
						"          emailaddress2 as string,",
						"          emailaddress1 as string,",
						"          ts_globalgeographiescoveredbyfirm as string,",
						"          ts_recommendationoffirmupdated as timestamp,",
						"          ts_lastmet as timestamp,",
						"          ts_reminderdatesetto as timestamp,",
						"          ts_commitmentreductions_state as long,",
						"          owningbusinessunitname as string,",
						"          onholdtime as long,",
						"          ts_alias as string,",
						"          createdonbehalfbyyominame as string,",
						"          ts_transfersout_date as timestamp,",
						"          ts_address1countryname as string,",
						"          preferredsystemuseridyominame as string,",
						"          createdbyexternalpartyname as string,",
						"          mpe_documentsetid as string,",
						"          telephone1 as string,",
						"          ts_legacycompanytypes as string,",
						"          ts_validatedbyyominame as string,",
						"          address1_composite as string,",
						"          ts_investorgroupgatekeeperid as string,",
						"          primarycontactidyominame as string,",
						"          address2_country as string,",
						"          xpd_recommendationcomments as string,",
						"          owneridyominame as string,",
						"          createdbyexternalpartyyominame as string,",
						"          ts_originationlead1yominame as string,",
						"          ts_usesprovidedbyfirm as string,",
						"          xpd_recommendingportco as string,",
						"          address1_country as string,",
						"          ts_commitmentreductions_date as timestamp,",
						"          name as string,",
						"          modifiedbyexternalpartyyominame as string,",
						"          xpd_remindertoname as string,",
						"          stageid as string,",
						"          modifiedonbehalfbyname as string,",
						"          masteraccountidname as string,",
						"          timespentbymeonemailandmeetings as string,",
						"          address2_latitude as double,",
						"          overriddencreatedon as timestamp,",
						"          parentaccountidyominame as string,",
						"          ts_specificareaofexpertisecomments as string,",
						"          preferredsystemuseridname as string,",
						"          utcconversiontimezonecode as long,",
						"          address2_county as string,",
						"          address1_line1 as string,",
						"          address2_primarycontactname as string,",
						"          address1_line2 as string,",
						"          xpd_reasonaction as string,",
						"          ts_primarymperelationshipmanageryominame as string,",
						"          processid as string,",
						"          ts_sectorscoveredids as string,",
						"          ts_recommendedbyyominame as string,",
						"          modifiedbyexternalpartyname as string,",
						"          ts_relevantsituations as string,",
						"          accountid as string,",
						"          modifiedon as timestamp,",
						"          preferredequipmentidname as string,",
						"          modifiedbyyominame as string,",
						"          ts_dealstageofmostrecentopportunity as string,",
						"          address2_composite as string,",
						"          masteraccountidyominame as string,",
						"          numberofemployees as long,",
						"          address1_fax as string,",
						"          address2_line3 as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'account',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: false) ~> EnrichedAccount",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          stateAZlabel as string,",
						"          statusAZlabel as string,",
						"          ts_dealannouncedreason as string,",
						"          ts_highprioritynew as string,",
						"          ts_actionstatus as string,",
						"          mpe_targetrelationshipstatus as string,",
						"          mpe_carveout as string,",
						"          ts_producttype as string,",
						"          ts_internalintermediarysource as string,",
						"          mpe_flowlastrunoutcome as string,",
						"          ts_currentactivity as string,",
						"          ts_opportunitystatus as string,",
						"          ts_montaguprimaryoffice as string,",
						"          ts_opportunitytype as string,",
						"          ts_posthumstatus as string,",
						"          ts_meetingremindermonths as string,",
						"          ts_choppedreason as string,",
						"          ts_setreminder as string,",
						"          ts_stagereachedfir as string,",
						"          ts_stagereachedipr as string,",
						"          ts_duplicateopportunityfordiscussion as string,",
						"          mpe_smalltarget as string,",
						"          ts_stagereachedcr as string,",
						"          xpd_includeonallpapers as string,",
						"          ts_sold as string,",
						"          xpd_sharepointlocationcreated as string,",
						"          ts_statuschangedby as string,",
						"          ts_statuschangedby_entitytype as string,",
						"          ts_buyer as string,",
						"          ts_buyer_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          ts_reminderto as string,",
						"          ts_reminderto_entitytype as string,",
						"          mpe_productid as string,",
						"          mpe_productid_entitytype as string,",
						"          ts_targetbusiness as string,",
						"          ts_targetbusiness_entitytype as string,",
						"          ts_firstreferralcompany as string,",
						"          ts_firstreferralcompany_entitytype as string,",
						"          ts_deallead as string,",
						"          ts_deallead_entitytype as string,",
						"          ts_montaguowner as string,",
						"          ts_montaguowner_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          ts_firstreferralcontact as string,",
						"          ts_firstreferralcontact_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ts_managerwedback as string,",
						"          ts_managerwedback_entitytype as string,",
						"          ts_country as string,",
						"          ts_country_entitytype as string,",
						"          mpe_targetbusiness_parentid as string,",
						"          mpe_targetbusiness_parentid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          ts_sellmandate as string,",
						"          ts_sellmandate_entitytype as string,",
						"          ts_estebitda_base as decimal(38,4),",
						"          ts_estebit_base as decimal(38,4),",
						"          ts_estebitda as decimal(38,4),",
						"          ts_estebit as decimal(38,4),",
						"          ts_estturnover_base as decimal(38,4),",
						"          ts_estdealsize as decimal(38,4),",
						"          ts_estdealsize_base as decimal(38,4),",
						"          ts_estturnover as decimal(38,4),",
						"          ts_buyeryominame as string,",
						"          modifiedon as timestamp,",
						"          ts_statuschangedbyname as string,",
						"          ts_managerwedbackyominame as string,",
						"          xpd_montaguprojectname as string,",
						"          transactioncurrencyidname as string,",
						"          ts_nextsteps as string,",
						"          ts_montaguowneryominame as string,",
						"          ts_firstreferralcontactname as string,",
						"          ts_opportunitydescription as string,",
						"          ts_buyerpaidxltmebitda as decimal(38,1),",
						"          ts_targetbusinessyominame as string,",
						"          ts_montaguownername as string,",
						"          ts_managerwedbackname as string,",
						"          ts_opportunitystage as string,",
						"          ts_otherdocumentsurl as string,",
						"          exchangerate as decimal(38,10),",
						"          mpe_documentsetid as string,",
						"          ts_buyername as string,",
						"          ts_firstreferralcontactyominame as string,",
						"          createdon as string,",
						"          ts_sellmandateyominame as string,",
						"          mpe_montaguprimaryofficestring as string,",
						"          ts_statuschangedbyyominame as string,",
						"          ts_firstreferralcompanyname as string,",
						"          owneridyominame as string,",
						"          ts_choppedcomments as string,",
						"          timezoneruleversionnumber as long,",
						"          createdbyname as string,",
						"          ts_dealleadname as string,",
						"          owningbusinessunitname as string,",
						"          ts_dealleadyominame as string,",
						"          ts_lastdatestatuschanged as timestamp,",
						"          traversedpath as string,",
						"          overriddencreatedon as timestamp,",
						"          ts_iprdocumenturl as string,",
						"          createdonbehalfbyname as string,",
						"          ts_sellmandatename as string,",
						"          owneridtype as string,",
						"          owneridname as string,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          mpe_productidname as string,",
						"          mpe_targetbusiness_parentidyominame as string,",
						"          ts_originationopportunityid as string,",
						"          ts_crdocumenturl as string,",
						"          ts_datedealannounced as timestamp,",
						"          processid as string,",
						"          mpe_montaguprimaryofficeowner as string,",
						"          ts_reason as string,",
						"          ts_targetbusinessname as string,",
						"          ts_remindertoname as string,",
						"          ts_postcompletionnoteurl as string,",
						"          ts_name as string,",
						"          stageid as string,",
						"          ts_currentopportunitystatus as string,",
						"          ts_firstreferralcompanyyominame as string,",
						"          mpe_flowlastrundate as timestamp,",
						"          ts_firdocumenturl as string,",
						"          modifiedbyyominame as string,",
						"          modifiedonbehalfbyyominame as string,",
						"          ts_movedoutofwipdate as timestamp,",
						"          ts_equitychequesize as decimal(38,2),",
						"          utcconversiontimezonecode as long,",
						"          mpe_targetbusiness_parentidname as string,",
						"          ts_weofferedxltmebitda as decimal(38,1),",
						"          importsequencenumber as long,",
						"          ts_remindertoyominame as string,",
						"          ts_companyid as long,",
						"          ts_datereminderwasset as timestamp,",
						"          versionnumber as long,",
						"          ts_originationid as long,",
						"          ts_countryname as string,",
						"          ts_choppeddate as timestamp,",
						"          mpe_posthunstatustext as string,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          ts_humdate as timestamp,",
						"          ts_sellmandateidtype as string,",
						"          ts_dateofreminder as timestamp,",
						"          ts_humurl as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'ts_originationopportunity',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: false) ~> EnrichedOriginationOpportunities",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          stateAZlabel as string,",
						"          statusAZlabel as string,",
						"          ts_stageofmeetingrounds as string,",
						"          ts_talentmeetingtype as string,",
						"          instancetypeAZlabel as string,",
						"          ts_whooriginatedthemeeting as string,",
						"          onlinemeetingtype as string,",
						"          ts_meetingteam as string,",
						"          ts_othermeetingmethod as string,",
						"          ts_tone as string,",
						"          ts_meetingmethod as string,",
						"          ts_originationmeetingtype as string,",
						"          priorityAZlabel as string,",
						"          attachmenterrors as string,",
						"          ts_eventtype as string,",
						"          ts_talentmeetingmethod as string,",
						"          ts_productsdiscussed as string,",
						"          ts_contentcovered as string,",
						"          isonlinemeeting as string,",
						"          isworkflowcreated as string,",
						"          isalldayevent as string,",
						"          ts_interview as string,",
						"          isbilled as string,",
						"          isdraft as string,",
						"          ts_keyiractivity as string,",
						"          ts_noninvestor as string,",
						"          ismapiprivate as string,",
						"          isregularactivity as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          ts_investorgroup as string,",
						"          ts_investorgroup_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          regardingobjectid as string,",
						"          regardingobjectid_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ts_officemet as string,",
						"          ts_officemet_entitytype as string,",
						"          ts_taskowner as string,",
						"          ts_taskowner_entitytype as string,",
						"          serviceid as string,",
						"          serviceid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          requiredattendees as string,",
						"          optionalattendees as string,",
						"          organizer as string,",
						"          scheduledend as timestamp,",
						"          ts_taskdescription as string,",
						"          modifiedon as timestamp,",
						"          ts_purpose as string,",
						"          overriddencreatedon as timestamp,",
						"          ts_taskownername as string,",
						"          activityadditionalparams as string,",
						"          ts_tonepersonalities as string,",
						"          seriesid as string,",
						"          transactioncurrencyidname as string,",
						"          activityid as string,",
						"          modifiedfieldsmask as string,",
						"          utcconversiontimezonecode as long,",
						"          ts_officemetname as string,",
						"          scheduledstart as timestamp,",
						"          outlookownerapptid as long,",
						"          ts_topicscovered as string,",
						"          ts_objective as string,",
						"          onholdtime as long,",
						"          onlinemeetingjoinurl as string,",
						"          ts_notes as string,",
						"          originalstartdate as timestamp,",
						"          ts_opportunitiesdiscussed as string,",
						"          ts_sectorscoveredbyfirm as string,",
						"          attachmentcount as long,",
						"          exchangerate as decimal(38,10),",
						"          ts_originationcommentsnotes as string,",
						"          category as string,",
						"          createdon as string,",
						"          ts_eventdescription as string,",
						"          globalobjectid as string,",
						"          onlinemeetingid as string,",
						"          serviceidname as string,",
						"          owneridyominame as string,",
						"          description as string,",
						"          subcategory as string,",
						"          owningbusinessunitname as string,",
						"          ts_taskduedate as timestamp,",
						"          traversedpath as string,",
						"          sortdate as timestamp,",
						"          createdonbehalfbyname as string,",
						"          ts_sectorscoveredids as string,",
						"          safedescription as string,",
						"          ts_taskowneryominame as string,",
						"          owneridtype as string,",
						"          isunsafe as long,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          ts_conferencename as string,",
						"          timezoneruleversionnumber as long,",
						"          actualend as timestamp,",
						"          regardingobjectidname as string,",
						"          processid as string,",
						"          activitytypecode as string,",
						"          actualstart as timestamp,",
						"          xpd_listofexternalattendees as string,",
						"          slainvokedidname as string,",
						"          location as string,",
						"          subject as string,",
						"          createdbyname as string,",
						"          actualdurationminutes as long,",
						"          modifiedbyyominame as string,",
						"          lastonholdtime as timestamp,",
						"          modifiedonbehalfbyyominame as string,",
						"          ts_attendeestoaddtocrm as string,",
						"          regardingobjectidyominame as string,",
						"          regardingobjecttypecode as string,",
						"          stageid as string,",
						"          scheduleddurationminutes as long,",
						"          ts_sourceid as string,",
						"          ts_investorgroupyominame as string,",
						"          importsequencenumber as long,",
						"          subscriptionid as string,",
						"          onlinemeetingchatid as string,",
						"          ts_lpupdates as string,",
						"          ts_executivesummary as string,",
						"          ts_investorgroupname as string,",
						"          ts_meetingcity as string,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          owneridname as string,",
						"          ts_theirprogramme as string,",
						"          ts_ifdeclinedreason as string,",
						"          slaname as string,",
						"          versionnumber as long",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'appointment',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: false) ~> EnrichedMeetingAppointments",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          stateAZlabel as string,",
						"          statusAZlabel as string,",
						"          haschildrenAZlabel as string,",
						"          customertypeAZlabel as string,",
						"          ts_recommendationofindividual as string,",
						"          genderAZlabel as string,",
						"          address1_addresstypeAZlabel as string,",
						"          leadsourceAZlabel as string,",
						"          preferredappointmenttimeAZlabel as string,",
						"          address2_freighttermsAZlabel as string,",
						"          address2_shippingmethodAZlabel as string,",
						"          ts_debtsubtype as string,",
						"          msdyn_orgchangestatus as string,",
						"          ts_suffix as string,",
						"          xpd_gender as string,",
						"          ts_title as string,",
						"          paymenttermsAZlabel as string,",
						"          accountroleAZlabel as string,",
						"          territoryAZlabel as string,",
						"          ts_vendortargettrackingrole as string,",
						"          address3_freighttermsAZlabel as string,",
						"          address1_shippingmethodAZlabel as string,",
						"          preferredappointmentdayAZlabel as string,",
						"          customersizeAZlabel as string,",
						"          preferredcontactmethodAZlabel as string,",
						"          ts_futurecontactmethod as string,",
						"          address3_shippingmethodAZlabel as string,",
						"          address2_addresstypeAZlabel as string,",
						"          mpe_flowlastrunoutcome as string,",
						"          ts_capabilitiesofindividual as string,",
						"          address3_addresstypeAZlabel as string,",
						"          familystatusAZlabel as string,",
						"          shippingmethodAZlabel as string,",
						"          xpd_availability as string,",
						"          educationAZlabel as string,",
						"          address1_freighttermsAZlabel as string,",
						"          ts_quickcaptureuses as string,",
						"          xpd_montagulevel as string,",
						"          ts_permanentinterim as string,",
						"          ts_ircontactrole as string,",
						"          xpd_level as string,",
						"          ts_languagesspokenwritten as string,",
						"          ts_contacttype as string,",
						"          ts_montaguoffice as string,",
						"          ts_roletypes as string,",
						"          xpd_specialisms as string,",
						"          ts_quickcapturesectors as string,",
						"          xpd_function as string,",
						"          ts_producttype as string,",
						"          ts_quickcapturegeography as string,",
						"          ts_productsinterestedin as string,",
						"          ts_potentialrolecandidate as string,",
						"          isbackofficecustomer as string,",
						"          donotpostalmail as string,",
						"          xpd_addcontacttooutlook as string,",
						"          ts_centralrelationshipmanager as string,",
						"          msdyn_gdproptout as string,",
						"          xpd_hascompany as string,",
						"          creditonhold as string,",
						"          xpd_benchcandidate as string,",
						"          donotbulkpostalmail as string,",
						"          donotsendmm as string,",
						"          donotbulkemail as string,",
						"          followemail as string,",
						"          xpd_sharepointdocumentlocationcreated as string,",
						"          xpd_available as string,",
						"          ts_leadearlystageinteraction as string,",
						"          participatesinworkflow as string,",
						"          ts_doyouwishtotrackthiscontact as string,",
						"          merged as string,",
						"          ts_validated as string,",
						"          marketingonly as string,",
						"          donotfax as string,",
						"          isprivate as string,",
						"          donotphone as string,",
						"          isautocreate as string,",
						"          donotemail as string,",
						"          ts_unconfirmedemailaddress as string,",
						"          mpe_companysearchbyemail as string,",
						"          preferredsystemuserid as string,",
						"          preferredsystemuserid_entitytype as string,",
						"          mpe_accountid as string,",
						"          mpe_accountid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          ts_recommendedby as string,",
						"          ts_recommendedby_entitytype as string,",
						"          ts_previousemployerid as string,",
						"          ts_previousemployerid_entitytype as string,",
						"          preferredserviceid as string,",
						"          preferredserviceid_entitytype as string,",
						"          msdyn_segmentid as string,",
						"          msdyn_segmentid_entitytype as string,",
						"          parentcontactid as string,",
						"          parentcontactid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          ts_pa as string,",
						"          ts_pa_entitytype as string,",
						"          ts_businessaddress as string,",
						"          ts_businessaddress_entitytype as string,",
						"          modifiedbyexternalparty as string,",
						"          modifiedbyexternalparty_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          originatingleadid as string,",
						"          originatingleadid_entitytype as string,",
						"          masterid as string,",
						"          masterid_entitytype as string,",
						"          defaultpricelevelid as string,",
						"          defaultpricelevelid_entitytype as string,",
						"          parent_contactid as string,",
						"          parent_contactid_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          createdbyexternalparty as string,",
						"          createdbyexternalparty_entitytype as string,",
						"          preferredequipmentid as string,",
						"          preferredequipmentid_entitytype as string,",
						"          xpd_referredbyinternal as string,",
						"          xpd_referredbyinternal_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          xpd_homecountry as string,",
						"          xpd_homecountry_entitytype as string,",
						"          ts_placementfirmintroducedby as string,",
						"          ts_placementfirmintroducedby_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          accountid as string,",
						"          accountid_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          parentcustomerid as string,",
						"          parentcustomerid_entitytype as string,",
						"          xpd_referredbyexternal as string,",
						"          xpd_referredbyexternal_entitytype as string,",
						"          aging30 as decimal(38,2),",
						"          creditlimit_base as decimal(38,4),",
						"          aging60 as decimal(38,2),",
						"          aging90 as decimal(38,2),",
						"          aging60_base as decimal(38,4),",
						"          aging90_base as decimal(38,4),",
						"          annualincome_base as decimal(38,4),",
						"          creditlimit as decimal(38,2),",
						"          annualincome as decimal(38,2),",
						"          aging30_base as decimal(38,4),",
						"          ts_othernotes as string,",
						"          xpd_referredbyinternalyominame as string,",
						"          address1_county as string,",
						"          yomilastname as string,",
						"          address3_utcoffset as long,",
						"          ts_recommendedbyname as string,",
						"          description as string,",
						"          li_membertoken as string,",
						"          department as string,",
						"          xpd_roletypes_text as string,",
						"          address1_addressid as string,",
						"          importsequencenumber as long,",
						"          address1_longitude as double,",
						"          address3_fax as string,",
						"          managername as string,",
						"          entityimageid as string,",
						"          telephone2 as string,",
						"          parentcustomeridtype as string,",
						"          address2_upszone as string,",
						"          address1_upszone as string,",
						"          xpd_recommendingportfoliocompaniesrecommended as string,",
						"          lastonholdtime as timestamp,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          address1_fax as string,",
						"          address3_telephone1 as string,",
						"          address3_telephone2 as string,",
						"          address3_telephone3 as string,",
						"          fax as string,",
						"          assistantname as string,",
						"          address2_line3 as string,",
						"          accountidyominame as string,",
						"          parentcontactidyominame as string,",
						"          mpe_accountidyominame as string,",
						"          slainvokedidname as string,",
						"          defaultpricelevelidname as string,",
						"          fullname as string,",
						"          address2_longitude as double,",
						"          subscriptionid as string,",
						"          originatingleadidname as string,",
						"          slaname as string,",
						"          versionnumber as long,",
						"          address1_latitude as double,",
						"          createdbyyominame as string,",
						"          parent_contactidname as string,",
						"          address2_telephone1 as string,",
						"          pager as string,",
						"          salutation as string,",
						"          mpe_accountidname as string,",
						"          xpd_functionuse_text as string,",
						"          accountidname as string,",
						"          mpe_companysummary as string,",
						"          parent_contactidyominame as string,",
						"          preferredserviceidname as string,",
						"          address2_city as string,",
						"          address3_postalcode as string,",
						"          address2_line2 as string,",
						"          li_companyid as long,",
						"          ts_otherphonelabel as string,",
						"          ts_reportingemail as string,",
						"          address3_upszone as string,",
						"          transactioncurrencyidname as string,",
						"          address3_county as string,",
						"          entityimage_url as string,",
						"          governmentid as string,",
						"          callback as string,",
						"          business2 as string,",
						"          createdonbehalfbyname as string,",
						"          ts_validateddate as timestamp,",
						"          address2_telephone2 as string,",
						"          owneridname as string,",
						"          originatingleadidyominame as string,",
						"          ts_otherlanguages as string,",
						"          address2_postalcode as string,",
						"          birthdate as timestamp,",
						"          parentcontactidname as string,",
						"          spousesname as string,",
						"          xpd_compensationdate as timestamp,",
						"          address1_utcoffset as long,",
						"          address3_line1 as string,",
						"          traversedpath as string,",
						"          exchangerate as decimal(38,10),",
						"          mpe_flowlastrundate as timestamp,",
						"          address1_line3 as string,",
						"          address3_country as string,",
						"          mpe_documentsetid as string,",
						"          address2_line1 as string,",
						"          ts_previousemployeridyominame as string,",
						"          middlename as string,",
						"          managerphone as string,",
						"          address2_stateorprovince as string,",
						"          childrensnames as string,",
						"          address2_name as string,",
						"          address3_addressid as string,",
						"          address3_stateorprovince as string,",
						"          ts_sectorspecialtyids as string,",
						"          businesscardattributes as string,",
						"          anniversary as timestamp,",
						"          ts_employmentstartdate as timestamp,",
						"          ts_legacycontacttypes as string,",
						"          address1_primarycontactname as string,",
						"          address2_utcoffset as long,",
						"          home2 as string,",
						"          ts_geographicspecialtyids as string,",
						"          address1_name as string,",
						"          ts_recommendationcomments as string,",
						"          address2_telephone3 as string,",
						"          address3_primarycontactname as string,",
						"          ftpsiteurl as string,",
						"          address1_postalcode as string,",
						"          createdon as string,",
						"          address1_stateorprovince as string,",
						"          yomimiddlename as string,",
						"          jobtitle as string,",
						"          telephone3 as string,",
						"          ts_usesspeciality as string,",
						"          msdyn_segmentidname as string,",
						"          ts_knowntouserinitials as string,",
						"          address2_fax as string,",
						"          createdbyname as string,",
						"          xpd_contactuse_text as string,",
						"          ts_sourceid as string,",
						"          address2_addressid as string,",
						"          employeeid as string,",
						"          address1_postofficebox as string,",
						"          address1_city as string,",
						"          ts_businessaddressname as string,",
						"          teamsfollowed as long,",
						"          ts_cv as string,",
						"          timezoneruleversionnumber as long,",
						"          modifiedonbehalfbyyominame as string,",
						"          xpd_hrcompensation as string,",
						"          ts_currentbonusandorupliftconsiderations as string,",
						"          modifiedbyname as string,",
						"          address3_line2 as string,",
						"          yomifullname as string,",
						"          owneridtype as string,",
						"          entityimage_timestamp as long,",
						"          ts_placementfirmintroducedbyyominame as string,",
						"          xpd_previousrole as string,",
						"          ts_compensation as string,",
						"          address2_postofficebox as string,",
						"          emailaddress3 as string,",
						"          emailaddress2 as string,",
						"          emailaddress1 as string,",
						"          ts_interactioncontactuniqueidentifier as string,",
						"          ts_investmentcafeid as string,",
						"          websiteurl as string,",
						"          nickname as string,",
						"          ts_lastmet as timestamp,",
						"          address3_name as string,",
						"          ts_usesspecialtyids as string,",
						"          ts_linkedinurl as string,",
						"          lastname as string,",
						"          address3_longitude as double,",
						"          xpd_referredbyexternalidtype as string,",
						"          parentcustomeridname as string,",
						"          owningbusinessunitname as string,",
						"          onholdtime as long,",
						"          createdonbehalfbyyominame as string,",
						"          preferredsystemuseridyominame as string,",
						"          createdbyexternalpartyname as string,",
						"          ts_tone as string,",
						"          telephone1 as string,",
						"          overriddencreatedon as timestamp,",
						"          address3_postofficebox as string,",
						"          assistantphone as string,",
						"          address1_composite as string,",
						"          address3_line3 as string,",
						"          address2_country as string,",
						"          xpd_referredbyinternalname as string,",
						"          mobilephone as string,",
						"          owneridyominame as string,",
						"          address1_line1 as string,",
						"          createdbyexternalpartyyominame as string,",
						"          xpd_referredbyexternalyominame as string,",
						"          yomifirstname as string,",
						"          mastercontactidname as string,",
						"          address3_city as string,",
						"          address1_country as string,",
						"          externaluseridentifier as string,",
						"          modifiedbyexternalpartyyominame as string,",
						"          firstname as string,",
						"          xpd_hrcurrentbonusandorupliftconsiderations as string,",
						"          stageid as string,",
						"          modifiedonbehalfbyname as string,",
						"          xpd_homecountryname as string,",
						"          mastercontactidyominame as string,",
						"          suffix as string,",
						"          ts_payominame as string,",
						"          lastusedincampaign as timestamp,",
						"          ts_geographicspeciality as string,",
						"          xpd_recruitmentareateam_text as string,",
						"          ts_retentionreviewdate as timestamp,",
						"          parentcustomeridyominame as string,",
						"          timespentbymeonemailandmeetings as string,",
						"          address2_latitude as double,",
						"          xpd_availablefrom as timestamp,",
						"          address3_composite as string,",
						"          xpd_recommendingportco as string,",
						"          preferredsystemuseridname as string,",
						"          utcconversiontimezonecode as long,",
						"          address2_county as string,",
						"          ts_paname as string,",
						"          contactid as string,",
						"          address2_primarycontactname as string,",
						"          ts_specificareasofexpertisecomments as string,",
						"          address1_line2 as string,",
						"          ts_recommendationofindividualupdated as timestamp,",
						"          xpd_referredbyexternalname as string,",
						"          ts_placementfirmintroducedbyname as string,",
						"          ts_sectorspeciality as string,",
						"          ts_previousemployeridname as string,",
						"          processid as string,",
						"          ts_recommendedbyyominame as string,",
						"          modifiedon as timestamp,",
						"          modifiedbyexternalpartyname as string,",
						"          ts_relevantsituations as string,",
						"          businesscard as string,",
						"          company as string,",
						"          preferredequipmentidname as string,",
						"          modifiedbyyominame as string,",
						"          ts_preferredname as string,",
						"          address2_composite as string,",
						"          numberofchildren as long,",
						"          address3_latitude as double",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'contact',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: false) ~> EnrichedContacts",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          address1_addresstypecode as long,",
						"          address1_shippingmethodcode as long,",
						"          azurestate as long,",
						"          invitestatuscode as long,",
						"          preferredaddresscode as long,",
						"          preferredemailcode as long,",
						"          outgoingemaildeliverymethod as long,",
						"          preferredphonecode as long,",
						"          emailrouteraccessapproval as long,",
						"          deletedstate as long,",
						"          incomingemaildeliverymethod as long,",
						"          accessmode as long,",
						"          caltype as long,",
						"          address2_addresstypecode as long,",
						"          address2_shippingmethodcode as long,",
						"          setupuser as boolean,",
						"          islicensed as boolean,",
						"          defaultfilterspopulated as boolean,",
						"          isactivedirectoryuser as boolean,",
						"          displayinserviceviews as boolean,",
						"          msdyn_gdproptout as boolean,",
						"          isdisabled as boolean,",
						"          isintegrationuser as boolean,",
						"          isemailaddressapprovedbyo365admin as boolean,",
						"          issyncwithdirectory as boolean,",
						"          calendarid as string,",
						"          calendarid_entitytype as string,",
						"          mobileofflineprofileid as string,",
						"          mobileofflineprofileid_entitytype as string,",
						"          queueid as string,",
						"          queueid_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          territoryid as string,",
						"          territoryid_entitytype as string,",
						"          defaultmailbox as string,",
						"          defaultmailbox_entitytype as string,",
						"          positionid as string,",
						"          positionid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          siteid as string,",
						"          siteid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          parentsystemuserid as string,",
						"          parentsystemuserid_entitytype as string,",
						"          businessunitid as string,",
						"          businessunitid_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          traversedpath as string,",
						"          azureactivedirectoryobjectid as string,",
						"          address1_line1 as string,",
						"          internalemailaddress as string,",
						"          siteidname as string,",
						"          modifiedon as timestamp,",
						"          address1_line3 as string,",
						"          skills as string,",
						"          yomifirstname as string,",
						"          address1_longitude as double,",
						"          yomifullname as string,",
						"          entityimage_timestamp as long,",
						"          parentsystemuseridname as string,",
						"          address2_county as string,",
						"          transactioncurrencyidname as string,",
						"          activedirectoryguid as string,",
						"          utcconversiontimezonecode as long,",
						"          passporthi as long,",
						"          homephone as string,",
						"          parentsystemuseridyominame as string,",
						"          address2_stateorprovince as string,",
						"          mobilephone as string,",
						"          address2_country as string,",
						"          address2_line2 as string,",
						"          disabledreason as string,",
						"          lastname as string,",
						"          address1_city as string,",
						"          address1_utcoffset as long,",
						"          userlicensetype as long,",
						"          nickname as string,",
						"          passportlo as long,",
						"          title as string,",
						"          address2_latitude as double,",
						"          applicationid as string,",
						"          address1_composite as string,",
						"          firstname as string,",
						"          address2_postalcode as string,",
						"          employeeid as string,",
						"          processid as string,",
						"          mobileofflineprofileidname as string,",
						"          governmentid as string,",
						"          entityimage_url as string,",
						"          address2_line3 as string,",
						"          azuredeletedon as timestamp,",
						"          timezoneruleversionnumber as long,",
						"          address1_county as string,",
						"          address2_telephone2 as string,",
						"          address2_postofficebox as string,",
						"          address2_telephone1 as string,",
						"          yomilastname as string,",
						"          address2_telephone3 as string,",
						"          address1_addressid as string,",
						"          territoryidname as string,",
						"          overriddencreatedon as timestamp,",
						"          userpuid as string,",
						"          createdonbehalfbyname as string,",
						"          systemuserid as string,",
						"          address2_name as string,",
						"          middlename as string,",
						"          entityimageid as string,",
						"          applicationiduri as string,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          address2_composite as string,",
						"          address1_country as string,",
						"          mobilealertemail as string,",
						"          sharepointemailaddress as string,",
						"          businessunitidname as string,",
						"          address1_stateorprovince as string,",
						"          exchangerate as decimal(38,10),",
						"          jobtitle as string,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          latestupdatetime as timestamp,",
						"          address1_postofficebox as string,",
						"          organizationid as string,",
						"          yammeremailaddress as string,",
						"          defaultmailboxname as string,",
						"          identityid as long,",
						"          yomimiddlename as string,",
						"          address2_utcoffset as long,",
						"          photourl as string,",
						"          personalemailaddress as string,",
						"          address2_addressid as string,",
						"          address2_longitude as double,",
						"          createdon as string,",
						"          createdbyname as string,",
						"          domainname as string,",
						"          modifiedbyyominame as string,",
						"          address2_fax as string,",
						"          address1_line2 as string,",
						"          modifiedonbehalfbyyominame as string,",
						"          address2_upszone as string,",
						"          salutation as string,",
						"          address1_postalcode as string,",
						"          stageid as string,",
						"          defaultodbfoldername as string,",
						"          positionidname as string,",
						"          ts_inititals as string,",
						"          yammeruserid as string,",
						"          importsequencenumber as long,",
						"          address2_city as string,",
						"          windowsliveid as string,",
						"          organizationidname as string,",
						"          versionnumber as long,",
						"          queueidname as string,",
						"          address1_name as string,",
						"          address1_fax as string,",
						"          address1_latitude as double,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          address2_line1 as string,",
						"          address1_upszone as string,",
						"          fullname as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'systemuser') ~> SystemUserIn",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          address1_addresstypeAZlabel as string,",
						"          address1_shippingmethodAZlabel as string,",
						"          azurestate as string,",
						"          invitestatusAZlabel as string,",
						"          preferredaddressAZlabel as string,",
						"          preferredemailAZlabel as string,",
						"          outgoingemaildeliverymethod as string,",
						"          preferredphoneAZlabel as string,",
						"          emailrouteraccessapproval as string,",
						"          deletedstate as string,",
						"          incomingemaildeliverymethod as string,",
						"          accessmode as string,",
						"          caltype as string,",
						"          address2_addresstypeAZlabel as string,",
						"          address2_shippingmethodAZlabel as string,",
						"          setupuser as string,",
						"          islicensed as string,",
						"          defaultfilterspopulated as string,",
						"          isactivedirectoryuser as string,",
						"          displayinserviceviews as string,",
						"          msdyn_gdproptout as string,",
						"          isdisabled as string,",
						"          isintegrationuser as string,",
						"          isemailaddressapprovedbyo365admin as string,",
						"          issyncwithdirectory as string,",
						"          calendarid as string,",
						"          calendarid_entitytype as string,",
						"          mobileofflineprofileid as string,",
						"          mobileofflineprofileid_entitytype as string,",
						"          queueid as string,",
						"          queueid_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          territoryid as string,",
						"          territoryid_entitytype as string,",
						"          defaultmailbox as string,",
						"          defaultmailbox_entitytype as string,",
						"          positionid as string,",
						"          positionid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          siteid as string,",
						"          siteid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          parentsystemuserid as string,",
						"          parentsystemuserid_entitytype as string,",
						"          businessunitid as string,",
						"          businessunitid_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          traversedpath as string,",
						"          azureactivedirectoryobjectid as string,",
						"          address1_line1 as string,",
						"          internalemailaddress as string,",
						"          siteidname as string,",
						"          modifiedon as timestamp,",
						"          address1_line3 as string,",
						"          skills as string,",
						"          yomifirstname as string,",
						"          address1_longitude as double,",
						"          yomifullname as string,",
						"          entityimage_timestamp as long,",
						"          parentsystemuseridname as string,",
						"          address2_county as string,",
						"          transactioncurrencyidname as string,",
						"          activedirectoryguid as string,",
						"          utcconversiontimezonecode as long,",
						"          passporthi as long,",
						"          homephone as string,",
						"          parentsystemuseridyominame as string,",
						"          address2_stateorprovince as string,",
						"          mobilephone as string,",
						"          address2_country as string,",
						"          address2_line2 as string,",
						"          disabledreason as string,",
						"          lastname as string,",
						"          address1_city as string,",
						"          address1_utcoffset as long,",
						"          userlicensetype as long,",
						"          nickname as string,",
						"          passportlo as long,",
						"          title as string,",
						"          address2_latitude as double,",
						"          applicationid as string,",
						"          address1_composite as string,",
						"          firstname as string,",
						"          address2_postalcode as string,",
						"          employeeid as string,",
						"          processid as string,",
						"          mobileofflineprofileidname as string,",
						"          governmentid as string,",
						"          entityimage_url as string,",
						"          address2_line3 as string,",
						"          azuredeletedon as timestamp,",
						"          timezoneruleversionnumber as long,",
						"          address1_county as string,",
						"          address2_telephone2 as string,",
						"          address2_postofficebox as string,",
						"          address2_telephone1 as string,",
						"          yomilastname as string,",
						"          address2_telephone3 as string,",
						"          address1_addressid as string,",
						"          territoryidname as string,",
						"          overriddencreatedon as timestamp,",
						"          userpuid as string,",
						"          createdonbehalfbyname as string,",
						"          systemuserid as string,",
						"          address2_name as string,",
						"          middlename as string,",
						"          entityimageid as string,",
						"          applicationiduri as string,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          address2_composite as string,",
						"          address1_country as string,",
						"          mobilealertemail as string,",
						"          sharepointemailaddress as string,",
						"          businessunitidname as string,",
						"          address1_stateorprovince as string,",
						"          exchangerate as decimal(38,10),",
						"          jobtitle as string,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          latestupdatetime as timestamp,",
						"          address1_postofficebox as string,",
						"          organizationid as string,",
						"          yammeremailaddress as string,",
						"          defaultmailboxname as string,",
						"          identityid as long,",
						"          yomimiddlename as string,",
						"          address2_utcoffset as long,",
						"          photourl as string,",
						"          personalemailaddress as string,",
						"          address2_addressid as string,",
						"          address2_longitude as double,",
						"          createdon as string,",
						"          createdbyname as string,",
						"          domainname as string,",
						"          modifiedbyyominame as string,",
						"          address2_fax as string,",
						"          address1_line2 as string,",
						"          modifiedonbehalfbyyominame as string,",
						"          address2_upszone as string,",
						"          salutation as string,",
						"          address1_postalcode as string,",
						"          stageid as string,",
						"          defaultodbfoldername as string,",
						"          positionidname as string,",
						"          ts_inititals as string,",
						"          yammeruserid as string,",
						"          importsequencenumber as long,",
						"          address2_city as string,",
						"          windowsliveid as string,",
						"          organizationidname as string,",
						"          versionnumber as long,",
						"          queueidname as string,",
						"          address1_name as string,",
						"          address1_fax as string,",
						"          address1_latitude as double,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          address2_line1 as string,",
						"          address1_upszone as string,",
						"          fullname as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'systemuser',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: false) ~> EnrichedSystemUser",
						"OriginationOpportunityIn, EnrichedOriginationOpportunities join(OriginationOpportunityIn@Id == EnrichedOriginationOpportunities@Id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'right')~> Originationjoinoutput",
						"MeetingsAppointmentsIn, EnrichedMeetingAppointments join(MeetingsAppointmentsIn@Id == EnrichedMeetingAppointments@Id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> AppointmentsJoinOutput",
						"ContactsIn, EnrichedContacts join(ContactsIn@Id == EnrichedContacts@Id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> ContactsJoin",
						"AccountIn, EnrichedAccount join(AccountIn@Id == EnrichedAccount@Id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto',",
						"     scoreColumn: 'AZlabel')~> AccountEnrichedJoin",
						"SystemUserIn, EnrichedSystemUser join(SystemUserIn@Id == EnrichedSystemUser@Id,",
						"     joinType:'inner',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> SystemUserJoin",
						"AccountEnrichedJoin sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'accountENRICHED',",
						"     insertable: true,",
						"     updateable: false,",
						"     deletable: false,",
						"     upsertable: false,",
						"     recreate: true,",
						"     allowCopyCommand: true,",
						"     staged: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> AccountCleanSink",
						"AppointmentsJoinOutput sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'appointmentENRICHED',",
						"     insertable: true,",
						"     updateable: false,",
						"     deletable: false,",
						"     upsertable: false,",
						"     recreate: true,",
						"     allowCopyCommand: true,",
						"     staged: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> MeetingStageCleanSink",
						"ContactsJoin sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'contactENRICHED',",
						"     insertable: true,",
						"     updateable: false,",
						"     deletable: false,",
						"     upsertable: false,",
						"     recreate: true,",
						"     allowCopyCommand: true,",
						"     staged: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> ContactsStageCleanSink",
						"Originationjoinoutput sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'OriginationOpportunitiesENRICHED',",
						"     insertable: true,",
						"     updateable: false,",
						"     deletable: false,",
						"     upsertable: false,",
						"     recreate: true,",
						"     allowCopyCommand: true,",
						"     staged: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> OriginationCleanSink",
						"EnrichedOriginationOpportunities sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     store: 'cache',",
						"     format: 'inline',",
						"     output: false,",
						"     saveOrder: 1) ~> SinkEnrichedOrigination",
						"EnrichedAccount sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     store: 'cache',",
						"     format: 'inline',",
						"     output: false,",
						"     saveOrder: 1) ~> SinkEnrichedAccount",
						"EnrichedMeetingAppointments sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     store: 'cache',",
						"     format: 'inline',",
						"     output: false,",
						"     saveOrder: 1) ~> SinkEnrichedMeeting",
						"EnrichedContacts sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     store: 'cache',",
						"     format: 'inline',",
						"     output: false) ~> SinkEnrichedContacts",
						"SystemUserJoin sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'SystemUserENRICHED',",
						"     insertable: true,",
						"     updateable: false,",
						"     deletable: false,",
						"     upsertable: false,",
						"     recreate: true,",
						"     allowCopyCommand: true,",
						"     staged: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> SystemUserSink"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/EnrichedDatabase')]",
				"[concat(variables('workspaceId'), '/linkedServices/ReportsAnalytics')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/PH 4 BA Activity DatasetReports')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "ReportsAnalytics",
								"type": "LinkedServiceReference"
							},
							"name": "AccountIn"
						},
						{
							"linkedService": {
								"referenceName": "ReportsAnalytics",
								"type": "LinkedServiceReference"
							},
							"name": "OriginationOpportunityIn"
						},
						{
							"linkedService": {
								"referenceName": "ReportsAnalytics",
								"type": "LinkedServiceReference"
							},
							"name": "MeetingsAppointmentsIn"
						},
						{
							"linkedService": {
								"referenceName": "ReportsAnalytics",
								"type": "LinkedServiceReference"
							},
							"name": "ContactsIn"
						},
						{
							"linkedService": {
								"referenceName": "ReportsAnalytics",
								"type": "LinkedServiceReference"
							},
							"name": "SystemuserSource"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "ReportsAnalytics",
								"type": "LinkedServiceReference"
							},
							"name": "AccountCleanSink"
						},
						{
							"linkedService": {
								"referenceName": "ReportsAnalytics",
								"type": "LinkedServiceReference"
							},
							"name": "MeetingStageCleanSink"
						},
						{
							"linkedService": {
								"referenceName": "ReportsAnalytics",
								"type": "LinkedServiceReference"
							},
							"name": "ContactsStageCleanSink"
						},
						{
							"linkedService": {
								"referenceName": "ReportsAnalytics",
								"type": "LinkedServiceReference"
							},
							"name": "OriginationCleanSink"
						},
						{
							"linkedService": {
								"referenceName": "ReportsAnalytics",
								"type": "LinkedServiceReference"
							},
							"name": "SystemUserCleanSink"
						}
					],
					"transformations": [
						{
							"name": "MeetingsCleanselect"
						},
						{
							"name": "contactscleanselect"
						},
						{
							"name": "OrigiopportCleanout"
						},
						{
							"name": "AccountsSelectClean"
						},
						{
							"name": "SystemUserSelect"
						}
					],
					"scriptLines": [
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          ts_primarysecondaryfocus as long,",
						"          customertypecode as long,",
						"          ts_relationship as long,",
						"          address1_addresstypecode as long,",
						"          accountclassificationcode as long,",
						"          ts_easeofworking as long,",
						"          ts_ukrow as long,",
						"          preferredappointmenttimecode as long,",
						"          ts_address1addresstype as long,",
						"          xpd_relationshipstatus as long,",
						"          ts_introducertype as long,",
						"          xpd_remindermonths as long,",
						"          ts_importance as long,",
						"          address2_freighttermscode as long,",
						"          ts_irrvsmomperformancemeasure as long,",
						"          accountcategorycode as long,",
						"          paymenttermscode as long,",
						"          preferredappointmentdaycode as long,",
						"          businesstypecode as long,",
						"          industrycode as long,",
						"          ts_sizeoffirm as long,",
						"          ts_interaction as long,",
						"          address1_shippingmethodcode as long,",
						"          ts_portfoliocompanystatus as long,",
						"          customersizecode as long,",
						"          xpd_previousinvestorstatus as long,",
						"          ts_recommendationoffirm as long,",
						"          preferredcontactmethodcode as long,",
						"          accountratingcode as long,",
						"          ts_investorstatus as long,",
						"          ts_capabilitiesoffirm as long,",
						"          mpe_flowlastrunoutcome as long,",
						"          address2_addresstypecode as long,",
						"          address2_shippingmethodcode as long,",
						"          ts_nextoriginationmeetingarranged as long,",
						"          ownershipcode as long,",
						"          territorycode as long,",
						"          ts_investortype as long,",
						"          shippingmethodcode as long,",
						"          ts_investorregion as long,",
						"          address1_freighttermscode as long,",
						"          xpd_function as string,",
						"          ts_quickcaptureuses as string,",
						"          ts_permanentinterim as string,",
						"          ts_quickcapturesectors as string,",
						"          ts_roletypes as string,",
						"          ts_companytype as string,",
						"          xpd_level as string,",
						"          ts_indicativeclientbase as string,",
						"          xpd_specialisms as string,",
						"          xpd_montagulevel as string,",
						"          ts_vendorsummary as string,",
						"          ts_producttype as string,",
						"          ts_montaguoffice as string,",
						"          ts_quickcapturegeography as string,",
						"          xpd_roletypes as string,",
						"          mpe_livedeal as boolean,",
						"          donotbulkpostalmail as boolean,",
						"          donotpostalmail as boolean,",
						"          msdyn_gdproptout as boolean,",
						"          ts_organisationalchange as boolean,",
						"          xpd_publictoprivatetracker as boolean,",
						"          ts_auditor as boolean,",
						"          donotsendmm as boolean,",
						"          donotbulkemail as boolean,",
						"          followemail as boolean,",
						"          creditonhold as boolean,",
						"          marketingonly as boolean,",
						"          participatesinworkflow as boolean,",
						"          merged as boolean,",
						"          ts_validated as boolean,",
						"          xpd_sharepointlocationcreated as boolean,",
						"          xpd_setreminder as boolean,",
						"          ts_personnelchange as boolean,",
						"          donotfax as boolean,",
						"          isprivate as boolean,",
						"          donotphone as boolean,",
						"          xpd_rpo as boolean,",
						"          ts_trackcompany as boolean,",
						"          donotemail as boolean,",
						"          parentaccountid as string,",
						"          parentaccountid_entitytype as string,",
						"          ts_recommendedby as string,",
						"          ts_recommendedby_entitytype as string,",
						"          ts_countryofeconomicoriginforthecapital as string,",
						"          ts_countryofeconomicoriginforthecapital_entitytype as string,",
						"          xpd_reminderto as string,",
						"          xpd_reminderto_entitytype as string,",
						"          preferredserviceid as string,",
						"          preferredserviceid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          createdbyexternalparty as string,",
						"          createdbyexternalparty_entitytype as string,",
						"          ts_validatedby as string,",
						"          ts_validatedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          ts_primarymperelationshipmanager as string,",
						"          ts_primarymperelationshipmanager_entitytype as string,",
						"          modifiedbyexternalparty as string,",
						"          modifiedbyexternalparty_entitytype as string,",
						"          ts_headofficeid as string,",
						"          ts_headofficeid_entitytype as string,",
						"          ts_address1country as string,",
						"          ts_address1country_entitytype as string,",
						"          ts_address1usstate as string,",
						"          ts_address1usstate_entitytype as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          originatingleadid as string,",
						"          originatingleadid_entitytype as string,",
						"          masterid as string,",
						"          masterid_entitytype as string,",
						"          ts_originationlead1 as string,",
						"          ts_originationlead1_entitytype as string,",
						"          defaultpricelevelid as string,",
						"          defaultpricelevelid_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          ts_originationlead2 as string,",
						"          ts_originationlead2_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          mpe_coinvestquestionnaireid as string,",
						"          mpe_coinvestquestionnaireid_entitytype as string,",
						"          ts_hub as string,",
						"          ts_hub_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          ts_currentauditor as string,",
						"          ts_currentauditor_entitytype as string,",
						"          primarycontactid as string,",
						"          primarycontactid_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          preferredsystemuserid as string,",
						"          preferredsystemuserid_entitytype as string,",
						"          preferredequipmentid as string,",
						"          preferredequipmentid_entitytype as string,",
						"          xpd_fund as string,",
						"          xpd_fund_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          territoryid as string,",
						"          territoryid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          xpd_totalinstitutionalcommitments_base as decimal(38,0),",
						"          ts_minimumticketsize_base as decimal(38,4),",
						"          xpd_totalinstitutionalcommitments as decimal(38,0),",
						"          aging30 as decimal(38,0),",
						"          creditlimit as decimal(38,0),",
						"          creditlimit_base as decimal(38,0),",
						"          ts_totalcommitments_base as decimal(38,4),",
						"          aging60 as decimal(38,0),",
						"          ts_transfersin_base as decimal(38,0),",
						"          aging90 as decimal(38,0),",
						"          ts_maximumticketsize as decimal(38,4),",
						"          ts_totalaum_base as decimal(38,0),",
						"          marketcap_base as decimal(38,0),",
						"          aging60_base as decimal(38,0),",
						"          aging90_base as decimal(38,0),",
						"          ts_transfersout as decimal(38,0),",
						"          ts_maximumticketsize_base as decimal(38,4),",
						"          ts_originalcommitments_base as decimal(38,0),",
						"          revenue as decimal(38,0),",
						"          ts_totalcommitments as decimal(38,4),",
						"          ts_transfersout_base as decimal(38,0),",
						"          ts_totalaum as decimal(38,0),",
						"          ts_commitmentreductions_base as decimal(38,0),",
						"          ts_commitmentreductions as decimal(38,0),",
						"          marketcap as decimal(38,0),",
						"          ts_originalcommitments as decimal(38,0),",
						"          ts_minimumticketsize as decimal(38,4),",
						"          revenue_base as decimal(38,0),",
						"          openrevenue_base as decimal(38,0),",
						"          aging30_base as decimal(38,0),",
						"          openrevenue as decimal(38,0),",
						"          ts_transfersin as decimal(38,0),",
						"          ts_othernotes as string,",
						"          ts_transfersin_date as timestamp,",
						"          address1_county as string,",
						"          openrevenue_date as timestamp,",
						"          ts_recommendedbyname as string,",
						"          ts_relationshipinteractioncomments as string,",
						"          ts_originationlead2yominame as string,",
						"          parentaccountidname as string,",
						"          xpd_roletypes_text as string,",
						"          address1_addressid as string,",
						"          importsequencenumber as long,",
						"          address1_longitude as double,",
						"          ts_countryofeconomicoriginforthecapitalname as string,",
						"          entityimageid as string,",
						"          telephone2 as string,",
						"          ts_lastoriginationmeeting as timestamp,",
						"          address2_utcoffset as long,",
						"          address1_upszone as string,",
						"          ts_originalcommitments_state as long,",
						"          ts_typicalcost as string,",
						"          xpd_recommendingportfoliocompaniesrecommended as string,",
						"          accountnumber as string,",
						"          ts_currentauditoryominame as string,",
						"          ts_originalcommitments_date as timestamp,",
						"          lastonholdtime as timestamp,",
						"          ts_sectorscoveredbyfirm as string,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          address2_upszone as string,",
						"          opendeals_state as long,",
						"          xpd_functionuse_text as string,",
						"          slainvokedidname as string,",
						"          address2_longitude as double,",
						"          defaultpricelevelidname as string,",
						"          stockexchange as string,",
						"          mpe_liveofferingscount_date as timestamp,",
						"          xpd_relationshipcomments as string,",
						"          originatingleadidname as string,",
						"          slaname as string,",
						"          ts_currentauditorname as string,",
						"          xpd_remindertoyominame as string,",
						"          ts_address1usstatename as string,",
						"          ts_tempcompanytype as string,",
						"          versionnumber as long,",
						"          address1_latitude as double,",
						"          ts_formername as string,",
						"          yominame as string,",
						"          createdbyyominame as string,",
						"          ts_cityofvisit as string,",
						"          address2_telephone1 as string,",
						"          ts_globalgeographiescoveredids as string,",
						"          preferredserviceidname as string,",
						"          address2_city as string,",
						"          ts_mpeapproachstrategy as string,",
						"          address2_line2 as string,",
						"          ts_lastdatestatuschanged as timestamp,",
						"          li_companyid as long,",
						"          transactioncurrencyidname as string,",
						"          entityimage_url as string,",
						"          xpd_relationshipstatuschangeddate as timestamp,",
						"          createdonbehalfbyname as string,",
						"          mpe_liveofferingscount_state as long,",
						"          xpd_numberofcoinvestinvestments_date as timestamp,",
						"          ts_validateddate as timestamp,",
						"          owneridname as string,",
						"          xpd_generalcomments as string,",
						"          ts_companylegalname as string,",
						"          description as string,",
						"          ts_validatedbyname as string,",
						"          originatingleadidyominame as string,",
						"          opendeals as long,",
						"          xpd_numberofopportunitiesshown_state as long,",
						"          address2_postalcode as string,",
						"          websiteurl as string,",
						"          xpd_fundname as string,",
						"          address1_utcoffset as long,",
						"          exchangerate as decimal(38,10),",
						"          mpe_flowlastrundate as timestamp,",
						"          fax as string,",
						"          address1_line3 as string,",
						"          ts_monthssincelastmeeting as long,",
						"          ts_hubname as string,",
						"          address2_line1 as string,",
						"          ts_capiqticket as string,",
						"          address2_stateorprovince as string,",
						"          address2_name as string,",
						"          ts_transfersout_state as long,",
						"          xpd_numberofopportunitiesshown as long,",
						"          primarytwitterid as string,",
						"          mpe_coinvestquestionnaireidname as string,",
						"          xpd_numberofopportunitiesshown_date as timestamp,",
						"          xpd_preferentialterms as string,",
						"          address1_primarycontactname as string,",
						"          territoryidname as string,",
						"          ts_processstatus as string,",
						"          address1_name as string,",
						"          address2_telephone2 as string,",
						"          address2_telephone3 as string,",
						"          xpd_recruitmentareateam_text as string,",
						"          ftpsiteurl as string,",
						"          address1_postalcode as string,",
						"          ts_companynumber as string,",
						"          createdon as string,",
						"          mpe_liveofferingscount as long,",
						"          traversedpath as string,",
						"          address1_stateorprovince as string,",
						"          ts_transfersin_state as long,",
						"          address2_addressid as string,",
						"          ts_monthlyreviewmeetingname as string,",
						"          primarysatoriid as string,",
						"          telephone3 as string,",
						"          openrevenue_state as long,",
						"          ts_usesprovidedids as string,",
						"          ts_originationcomments as string,",
						"          lastusedincampaign as timestamp,",
						"          primarycontactidname as string,",
						"          ts_originationlead1name as string,",
						"          ts_headofficeidname as string,",
						"          ts_montagucomments as string,",
						"          address2_fax as string,",
						"          createdbyname as string,",
						"          xpd_numberofcoinvestinvestments as long,",
						"          ts_capitaliqlink as string,",
						"          ts_primarymperelationshipmanagername as string,",
						"          mpe_relationshipstatus_text as string,",
						"          xpd_datereminderwasset as timestamp,",
						"          xpd_numberofcoinvestinvestments_state as long,",
						"          address1_postofficebox as string,",
						"          address1_city as string,",
						"          teamsfollowed as long,",
						"          ts_originationlead2name as string,",
						"          timezoneruleversionnumber as long,",
						"          modifiedonbehalfbyyominame as string,",
						"          entityimage_timestamp as long,",
						"          tickersymbol as string,",
						"          ts_theirprogrammecomments as string,",
						"          xpd_companyuse_text as string,",
						"          modifiedbyname as string,",
						"          owneridtype as string,",
						"          sic as string,",
						"          sharesoutstanding as long,",
						"          opendeals_date as timestamp,",
						"          address2_postofficebox as string,",
						"          emailaddress3 as string,",
						"          emailaddress2 as string,",
						"          emailaddress1 as string,",
						"          ts_globalgeographiescoveredbyfirm as string,",
						"          ts_recommendationoffirmupdated as timestamp,",
						"          ts_lastmet as timestamp,",
						"          ts_reminderdatesetto as timestamp,",
						"          ts_commitmentreductions_state as long,",
						"          owningbusinessunitname as string,",
						"          onholdtime as long,",
						"          ts_alias as string,",
						"          createdonbehalfbyyominame as string,",
						"          ts_transfersout_date as timestamp,",
						"          ts_address1countryname as string,",
						"          preferredsystemuseridyominame as string,",
						"          createdbyexternalpartyname as string,",
						"          mpe_documentsetid as string,",
						"          telephone1 as string,",
						"          ts_legacycompanytypes as string,",
						"          ts_validatedbyyominame as string,",
						"          address1_composite as string,",
						"          ts_investorgroupgatekeeperid as string,",
						"          primarycontactidyominame as string,",
						"          address2_country as string,",
						"          xpd_recommendationcomments as string,",
						"          owneridyominame as string,",
						"          createdbyexternalpartyyominame as string,",
						"          ts_originationlead1yominame as string,",
						"          ts_usesprovidedbyfirm as string,",
						"          xpd_recommendingportco as string,",
						"          address1_country as string,",
						"          ts_commitmentreductions_date as timestamp,",
						"          name as string,",
						"          modifiedbyexternalpartyyominame as string,",
						"          xpd_remindertoname as string,",
						"          stageid as string,",
						"          modifiedonbehalfbyname as string,",
						"          masteraccountidname as string,",
						"          timespentbymeonemailandmeetings as string,",
						"          address2_latitude as double,",
						"          overriddencreatedon as timestamp,",
						"          parentaccountidyominame as string,",
						"          ts_specificareaofexpertisecomments as string,",
						"          preferredsystemuseridname as string,",
						"          utcconversiontimezonecode as long,",
						"          address2_county as string,",
						"          address1_line1 as string,",
						"          address2_primarycontactname as string,",
						"          address1_line2 as string,",
						"          xpd_reasonaction as string,",
						"          ts_primarymperelationshipmanageryominame as string,",
						"          processid as string,",
						"          ts_sectorscoveredids as string,",
						"          ts_recommendedbyyominame as string,",
						"          modifiedbyexternalpartyname as string,",
						"          ts_relevantsituations as string,",
						"          accountid as string,",
						"          modifiedon as timestamp,",
						"          preferredequipmentidname as string,",
						"          modifiedbyyominame as string,",
						"          ts_dealstageofmostrecentopportunity as string,",
						"          address2_composite as string,",
						"          masteraccountidyominame as string,",
						"          numberofemployees as long,",
						"          address1_fax as string,",
						"          address2_line3 as string,",
						"          msdyn_segmentid as string,",
						"          msdyn_segmentid_entitytype as string,",
						"          msdyn_segmentidname as string,",
						"          msdyn_salesaccelerationinsightid as string,",
						"          msdyn_salesaccelerationinsightid_entitytype as string,",
						"          msdyn_salesaccelerationinsightidname as string,",
						"          state as string,",
						"          status as string,",
						"          customertype as string,",
						"          address1_addresstype as string,",
						"          accountclassification as string,",
						"          preferredappointmenttime as string,",
						"          address2_freightterms as string,",
						"          accountcategory as string,",
						"          paymentterms as string,",
						"          preferredappointmentday as string,",
						"          businesstype as string,",
						"          industry as string,",
						"          address1_shippingmethod as string,",
						"          customersize as string,",
						"          preferredcontactmethod as string,",
						"          accountrating as string,",
						"          address2_addresstype as string,",
						"          address2_shippingmethod as string,",
						"          ownership as string,",
						"          territory as string,",
						"          shippingmethod as string,",
						"          address1_freightterms as string,",
						"          stateAZOption as string,",
						"          statusAZOption as string,",
						"          customertypeAZOption as string,",
						"          address1_addresstypeAZOption as string,",
						"          accountclassificationAZOption as string,",
						"          preferredappointmenttimeAZOption as string,",
						"          address2_freighttermsAZOption as string,",
						"          accountcategoryAZOption as string,",
						"          paymenttermsAZOption as string,",
						"          preferredappointmentdayAZOption as string,",
						"          businesstypeAZOption as string,",
						"          industryAZOption as string,",
						"          address1_shippingmethodAZOption as string,",
						"          customersizeAZOption as string,",
						"          preferredcontactmethodAZOption as string,",
						"          accountratingAZOption as string,",
						"          address2_addresstypeAZOption as string,",
						"          address2_shippingmethodAZOption as string,",
						"          ownershipAZOption as string,",
						"          territoryAZOption as string,",
						"          shippingmethodAZOption as string,",
						"          address1_freighttermsAZOption as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'accountENRICHED',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: true) ~> AccountIn",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          ts_dealannouncedreason as long,",
						"          ts_highprioritynew as long,",
						"          ts_actionstatus as long,",
						"          mpe_targetrelationshipstatus as long,",
						"          ts_producttype as long,",
						"          ts_internalintermediarysource as long,",
						"          mpe_flowlastrunoutcome as long,",
						"          ts_currentactivity as long,",
						"          ts_opportunitystatus as long,",
						"          ts_montaguprimaryoffice as long,",
						"          ts_opportunitytype as long,",
						"          ts_posthumstatus as long,",
						"          ts_meetingremindermonths as long,",
						"          ts_choppedreason as string,",
						"          ts_setreminder as boolean,",
						"          ts_stagereachedfir as boolean,",
						"          ts_stagereachedipr as boolean,",
						"          ts_duplicateopportunityfordiscussion as boolean,",
						"          mpe_smalltarget as boolean,",
						"          ts_stagereachedcr as boolean,",
						"          xpd_includeonallpapers as boolean,",
						"          ts_sold as boolean,",
						"          xpd_sharepointlocationcreated as boolean,",
						"          ts_statuschangedby as string,",
						"          ts_statuschangedby_entitytype as string,",
						"          ts_buyer as string,",
						"          ts_buyer_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          ts_reminderto as string,",
						"          ts_reminderto_entitytype as string,",
						"          mpe_productid as string,",
						"          mpe_productid_entitytype as string,",
						"          ts_targetbusiness as string,",
						"          ts_targetbusiness_entitytype as string,",
						"          ts_firstreferralcompany as string,",
						"          ts_firstreferralcompany_entitytype as string,",
						"          ts_deallead as string,",
						"          ts_deallead_entitytype as string,",
						"          ts_montaguowner as string,",
						"          ts_montaguowner_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          ts_firstreferralcontact as string,",
						"          ts_firstreferralcontact_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ts_managerwedback as string,",
						"          ts_managerwedback_entitytype as string,",
						"          ts_country as string,",
						"          ts_country_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          ts_sellmandate as string,",
						"          ts_sellmandate_entitytype as string,",
						"          ts_estebitda_base as decimal(38,4),",
						"          ts_estebit_base as decimal(38,4),",
						"          ts_estebitda as decimal(38,4),",
						"          ts_estebit as decimal(38,4),",
						"          ts_estturnover_base as decimal(38,4),",
						"          ts_estdealsize as decimal(38,4),",
						"          ts_estdealsize_base as decimal(38,4),",
						"          ts_estturnover as decimal(38,4),",
						"          ts_buyeryominame as string,",
						"          modifiedon as timestamp,",
						"          ts_statuschangedbyname as string,",
						"          ts_managerwedbackyominame as string,",
						"          xpd_montaguprojectname as string,",
						"          transactioncurrencyidname as string,",
						"          ts_nextsteps as string,",
						"          ts_montaguowneryominame as string,",
						"          ts_firstreferralcontactname as string,",
						"          ts_opportunitydescription as string,",
						"          ts_buyerpaidxltmebitda as decimal(38,1),",
						"          ts_targetbusinessyominame as string,",
						"          ts_montaguownername as string,",
						"          ts_managerwedbackname as string,",
						"          ts_opportunitystage as string,",
						"          ts_otherdocumentsurl as string,",
						"          exchangerate as decimal(38,10),",
						"          mpe_documentsetid as string,",
						"          ts_buyername as string,",
						"          ts_firstreferralcontactyominame as string,",
						"          createdon as string,",
						"          ts_sellmandateyominame as string,",
						"          mpe_montaguprimaryofficestring as string,",
						"          ts_statuschangedbyyominame as string,",
						"          ts_firstreferralcompanyname as string,",
						"          owneridyominame as string,",
						"          ts_choppedcomments as string,",
						"          timezoneruleversionnumber as long,",
						"          createdbyname as string,",
						"          ts_dealleadname as string,",
						"          owningbusinessunitname as string,",
						"          ts_dealleadyominame as string,",
						"          ts_lastdatestatuschanged as timestamp,",
						"          traversedpath as string,",
						"          overriddencreatedon as timestamp,",
						"          ts_iprdocumenturl as string,",
						"          createdonbehalfbyname as string,",
						"          ts_sellmandatename as string,",
						"          owneridtype as string,",
						"          owneridname as string,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          mpe_productidname as string,",
						"          ts_originationopportunityid as string,",
						"          ts_crdocumenturl as string,",
						"          ts_datedealannounced as timestamp,",
						"          processid as string,",
						"          mpe_montaguprimaryofficeowner as string,",
						"          ts_reason as string,",
						"          ts_targetbusinessname as string,",
						"          ts_remindertoname as string,",
						"          ts_postcompletionnoteurl as string,",
						"          ts_name as string,",
						"          stageid as string,",
						"          ts_currentopportunitystatus as string,",
						"          ts_firstreferralcompanyyominame as string,",
						"          mpe_flowlastrundate as timestamp,",
						"          ts_firdocumenturl as string,",
						"          modifiedbyyominame as string,",
						"          modifiedonbehalfbyyominame as string,",
						"          ts_movedoutofwipdate as timestamp,",
						"          ts_equitychequesize as decimal(38,2),",
						"          utcconversiontimezonecode as long,",
						"          ts_weofferedxltmebitda as decimal(38,1),",
						"          importsequencenumber as long,",
						"          ts_remindertoyominame as string,",
						"          ts_companyid as long,",
						"          ts_datereminderwasset as timestamp,",
						"          versionnumber as long,",
						"          ts_originationid as long,",
						"          ts_countryname as string,",
						"          ts_choppeddate as timestamp,",
						"          mpe_posthunstatustext as string,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          ts_humdate as timestamp,",
						"          ts_sellmandateidtype as string,",
						"          ts_dateofreminder as timestamp,",
						"          ts_humurl as string,",
						"          mpe_carveout as long,",
						"          mpe_targetbusiness_parentid as string,",
						"          mpe_targetbusiness_parentid_entitytype as string,",
						"          mpe_targetbusiness_parentidyominame as string,",
						"          mpe_targetbusiness_parentidname as string,",
						"          state as string,",
						"          status as string,",
						"          stateAZOption as string,",
						"          statusAZOption as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'OriginationOpportunitiesENRICHED',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: true) ~> OriginationOpportunityIn",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          ts_stageofmeetingrounds as long,",
						"          ts_talentmeetingtype as long,",
						"          instancetypecode as long,",
						"          ts_whooriginatedthemeeting as long,",
						"          onlinemeetingtype as long,",
						"          ts_meetingteam as long,",
						"          ts_othermeetingmethod as long,",
						"          ts_tone as long,",
						"          ts_meetingmethod as long,",
						"          ts_originationmeetingtype as long,",
						"          prioritycode as long,",
						"          attachmenterrors as long,",
						"          ts_eventtype as long,",
						"          ts_talentmeetingmethod as long,",
						"          ts_productsdiscussed as string,",
						"          ts_contentcovered as string,",
						"          isonlinemeeting as boolean,",
						"          isworkflowcreated as boolean,",
						"          isalldayevent as boolean,",
						"          ts_interview as boolean,",
						"          isbilled as boolean,",
						"          isdraft as boolean,",
						"          ts_keyiractivity as boolean,",
						"          ts_noninvestor as boolean,",
						"          ismapiprivate as boolean,",
						"          isregularactivity as boolean,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          ts_investorgroup as string,",
						"          ts_investorgroup_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          regardingobjectid as string,",
						"          regardingobjectid_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ts_officemet as string,",
						"          ts_officemet_entitytype as string,",
						"          ts_taskowner as string,",
						"          ts_taskowner_entitytype as string,",
						"          serviceid as string,",
						"          serviceid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          requiredattendees as string,",
						"          optionalattendees as string,",
						"          organizer as string,",
						"          scheduledend as timestamp,",
						"          ts_taskdescription as string,",
						"          modifiedon as timestamp,",
						"          ts_purpose as string,",
						"          overriddencreatedon as timestamp,",
						"          ts_taskownername as string,",
						"          activityadditionalparams as string,",
						"          ts_tonepersonalities as string,",
						"          seriesid as string,",
						"          transactioncurrencyidname as string,",
						"          activityid as string,",
						"          modifiedfieldsmask as string,",
						"          utcconversiontimezonecode as long,",
						"          ts_officemetname as string,",
						"          scheduledstart as timestamp,",
						"          outlookownerapptid as long,",
						"          ts_topicscovered as string,",
						"          ts_objective as string,",
						"          onholdtime as long,",
						"          onlinemeetingjoinurl as string,",
						"          ts_notes as string,",
						"          originalstartdate as timestamp,",
						"          ts_opportunitiesdiscussed as string,",
						"          ts_sectorscoveredbyfirm as string,",
						"          attachmentcount as long,",
						"          exchangerate as decimal(38,10),",
						"          ts_originationcommentsnotes as string,",
						"          category as string,",
						"          createdon as string,",
						"          ts_eventdescription as string,",
						"          globalobjectid as string,",
						"          onlinemeetingid as string,",
						"          serviceidname as string,",
						"          owneridyominame as string,",
						"          description as string,",
						"          subcategory as string,",
						"          owningbusinessunitname as string,",
						"          ts_taskduedate as timestamp,",
						"          traversedpath as string,",
						"          sortdate as timestamp,",
						"          createdonbehalfbyname as string,",
						"          ts_sectorscoveredids as string,",
						"          safedescription as string,",
						"          ts_taskowneryominame as string,",
						"          owneridtype as string,",
						"          isunsafe as long,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          ts_conferencename as string,",
						"          timezoneruleversionnumber as long,",
						"          actualend as timestamp,",
						"          regardingobjectidname as string,",
						"          processid as string,",
						"          activitytypecode as string,",
						"          actualstart as timestamp,",
						"          xpd_listofexternalattendees as string,",
						"          slainvokedidname as string,",
						"          location as string,",
						"          subject as string,",
						"          createdbyname as string,",
						"          actualdurationminutes as long,",
						"          modifiedbyyominame as string,",
						"          lastonholdtime as timestamp,",
						"          modifiedonbehalfbyyominame as string,",
						"          ts_attendeestoaddtocrm as string,",
						"          regardingobjectidyominame as string,",
						"          regardingobjecttypecode as string,",
						"          stageid as string,",
						"          scheduleddurationminutes as long,",
						"          ts_sourceid as string,",
						"          ts_investorgroupyominame as string,",
						"          importsequencenumber as long,",
						"          subscriptionid as string,",
						"          onlinemeetingchatid as string,",
						"          ts_lpupdates as string,",
						"          ts_executivesummary as string,",
						"          ts_investorgroupname as string,",
						"          ts_meetingcity as string,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          owneridname as string,",
						"          ts_theirprogramme as string,",
						"          ts_ifdeclinedreason as string,",
						"          slaname as string,",
						"          versionnumber as long,",
						"          state as string,",
						"          status as string,",
						"          instancetype as string,",
						"          priority as string,",
						"          stateAZOption as string,",
						"          statusAZOption as string,",
						"          instancetypeAZOption as string,",
						"          priorityAZOption as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'appointmentENRICHED',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: true) ~> MeetingsAppointmentsIn",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          haschildrencode as long,",
						"          customertypecode as long,",
						"          ts_recommendationofindividual as long,",
						"          gendercode as long,",
						"          address1_addresstypecode as long,",
						"          leadsourcecode as long,",
						"          preferredappointmenttimecode as long,",
						"          address2_freighttermscode as long,",
						"          address2_shippingmethodcode as long,",
						"          ts_debtsubtype as long,",
						"          msdyn_orgchangestatus as long,",
						"          ts_suffix as long,",
						"          xpd_gender as long,",
						"          ts_title as long,",
						"          paymenttermscode as long,",
						"          accountrolecode as long,",
						"          territorycode as long,",
						"          ts_vendortargettrackingrole as long,",
						"          address3_freighttermscode as long,",
						"          address1_shippingmethodcode as long,",
						"          preferredappointmentdaycode as long,",
						"          customersizecode as long,",
						"          preferredcontactmethodcode as long,",
						"          ts_futurecontactmethod as long,",
						"          address3_shippingmethodcode as long,",
						"          address2_addresstypecode as long,",
						"          mpe_flowlastrunoutcome as long,",
						"          ts_capabilitiesofindividual as long,",
						"          address3_addresstypecode as long,",
						"          familystatuscode as long,",
						"          shippingmethodcode as long,",
						"          xpd_availability as long,",
						"          educationcode as long,",
						"          address1_freighttermscode as long,",
						"          ts_quickcaptureuses as string,",
						"          xpd_montagulevel as string,",
						"          ts_permanentinterim as string,",
						"          ts_ircontactrole as string,",
						"          xpd_level as string,",
						"          ts_languagesspokenwritten as string,",
						"          ts_contacttype as string,",
						"          ts_montaguoffice as string,",
						"          ts_roletypes as string,",
						"          xpd_specialisms as string,",
						"          ts_quickcapturesectors as string,",
						"          xpd_function as string,",
						"          ts_producttype as string,",
						"          ts_quickcapturegeography as string,",
						"          ts_productsinterestedin as string,",
						"          ts_potentialrolecandidate as boolean,",
						"          isbackofficecustomer as boolean,",
						"          donotpostalmail as boolean,",
						"          xpd_addcontacttooutlook as boolean,",
						"          ts_centralrelationshipmanager as boolean,",
						"          msdyn_gdproptout as boolean,",
						"          xpd_hascompany as boolean,",
						"          creditonhold as boolean,",
						"          xpd_benchcandidate as boolean,",
						"          donotbulkpostalmail as boolean,",
						"          donotsendmm as boolean,",
						"          donotbulkemail as boolean,",
						"          followemail as boolean,",
						"          xpd_sharepointdocumentlocationcreated as boolean,",
						"          xpd_available as boolean,",
						"          ts_leadearlystageinteraction as boolean,",
						"          participatesinworkflow as boolean,",
						"          ts_doyouwishtotrackthiscontact as boolean,",
						"          merged as boolean,",
						"          ts_validated as boolean,",
						"          marketingonly as boolean,",
						"          donotfax as boolean,",
						"          isprivate as boolean,",
						"          donotphone as boolean,",
						"          isautocreate as boolean,",
						"          donotemail as boolean,",
						"          ts_unconfirmedemailaddress as boolean,",
						"          preferredsystemuserid as string,",
						"          preferredsystemuserid_entitytype as string,",
						"          mpe_accountid as string,",
						"          mpe_accountid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          ts_recommendedby as string,",
						"          ts_recommendedby_entitytype as string,",
						"          ts_previousemployerid as string,",
						"          ts_previousemployerid_entitytype as string,",
						"          preferredserviceid as string,",
						"          preferredserviceid_entitytype as string,",
						"          parentcontactid as string,",
						"          parentcontactid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          ts_pa as string,",
						"          ts_pa_entitytype as string,",
						"          ts_businessaddress as string,",
						"          ts_businessaddress_entitytype as string,",
						"          modifiedbyexternalparty as string,",
						"          modifiedbyexternalparty_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          originatingleadid as string,",
						"          originatingleadid_entitytype as string,",
						"          masterid as string,",
						"          masterid_entitytype as string,",
						"          defaultpricelevelid as string,",
						"          defaultpricelevelid_entitytype as string,",
						"          parent_contactid as string,",
						"          parent_contactid_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          createdbyexternalparty as string,",
						"          createdbyexternalparty_entitytype as string,",
						"          preferredequipmentid as string,",
						"          preferredequipmentid_entitytype as string,",
						"          xpd_referredbyinternal as string,",
						"          xpd_referredbyinternal_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          xpd_homecountry as string,",
						"          xpd_homecountry_entitytype as string,",
						"          ts_placementfirmintroducedby as string,",
						"          ts_placementfirmintroducedby_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          accountid as string,",
						"          accountid_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          parentcustomerid as string,",
						"          parentcustomerid_entitytype as string,",
						"          xpd_referredbyexternal as string,",
						"          xpd_referredbyexternal_entitytype as string,",
						"          aging30 as decimal(38,2),",
						"          creditlimit_base as decimal(38,4),",
						"          aging60 as decimal(38,2),",
						"          aging90 as decimal(38,2),",
						"          aging60_base as decimal(38,4),",
						"          aging90_base as decimal(38,4),",
						"          annualincome_base as decimal(38,4),",
						"          creditlimit as decimal(38,2),",
						"          annualincome as decimal(38,2),",
						"          aging30_base as decimal(38,4),",
						"          ts_othernotes as string,",
						"          xpd_referredbyinternalyominame as string,",
						"          address1_county as string,",
						"          yomilastname as string,",
						"          address3_utcoffset as long,",
						"          ts_recommendedbyname as string,",
						"          description as string,",
						"          li_membertoken as string,",
						"          department as string,",
						"          xpd_roletypes_text as string,",
						"          address1_addressid as string,",
						"          importsequencenumber as long,",
						"          address1_longitude as double,",
						"          address3_fax as string,",
						"          managername as string,",
						"          entityimageid as string,",
						"          telephone2 as string,",
						"          parentcustomeridtype as string,",
						"          address2_upszone as string,",
						"          address1_upszone as string,",
						"          xpd_recommendingportfoliocompaniesrecommended as string,",
						"          lastonholdtime as timestamp,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          address1_fax as string,",
						"          address3_telephone1 as string,",
						"          address3_telephone2 as string,",
						"          address3_telephone3 as string,",
						"          fax as string,",
						"          assistantname as string,",
						"          address2_line3 as string,",
						"          accountidyominame as string,",
						"          parentcontactidyominame as string,",
						"          mpe_accountidyominame as string,",
						"          slainvokedidname as string,",
						"          defaultpricelevelidname as string,",
						"          fullname as string,",
						"          address2_longitude as double,",
						"          subscriptionid as string,",
						"          originatingleadidname as string,",
						"          slaname as string,",
						"          versionnumber as long,",
						"          address1_latitude as double,",
						"          createdbyyominame as string,",
						"          parent_contactidname as string,",
						"          address2_telephone1 as string,",
						"          pager as string,",
						"          salutation as string,",
						"          mpe_accountidname as string,",
						"          xpd_functionuse_text as string,",
						"          accountidname as string,",
						"          mpe_companysummary as string,",
						"          parent_contactidyominame as string,",
						"          preferredserviceidname as string,",
						"          address2_city as string,",
						"          address3_postalcode as string,",
						"          address2_line2 as string,",
						"          li_companyid as long,",
						"          ts_otherphonelabel as string,",
						"          ts_reportingemail as string,",
						"          address3_upszone as string,",
						"          transactioncurrencyidname as string,",
						"          address3_county as string,",
						"          entityimage_url as string,",
						"          governmentid as string,",
						"          callback as string,",
						"          business2 as string,",
						"          createdonbehalfbyname as string,",
						"          ts_validateddate as timestamp,",
						"          address2_telephone2 as string,",
						"          owneridname as string,",
						"          originatingleadidyominame as string,",
						"          ts_otherlanguages as string,",
						"          address2_postalcode as string,",
						"          birthdate as timestamp,",
						"          parentcontactidname as string,",
						"          spousesname as string,",
						"          xpd_compensationdate as timestamp,",
						"          address1_utcoffset as long,",
						"          address3_line1 as string,",
						"          traversedpath as string,",
						"          exchangerate as decimal(38,10),",
						"          mpe_flowlastrundate as timestamp,",
						"          address1_line3 as string,",
						"          address3_country as string,",
						"          mpe_documentsetid as string,",
						"          address2_line1 as string,",
						"          ts_previousemployeridyominame as string,",
						"          middlename as string,",
						"          managerphone as string,",
						"          address2_stateorprovince as string,",
						"          childrensnames as string,",
						"          address2_name as string,",
						"          address3_addressid as string,",
						"          address3_stateorprovince as string,",
						"          ts_sectorspecialtyids as string,",
						"          businesscardattributes as string,",
						"          anniversary as timestamp,",
						"          ts_employmentstartdate as timestamp,",
						"          ts_legacycontacttypes as string,",
						"          address1_primarycontactname as string,",
						"          address2_utcoffset as long,",
						"          home2 as string,",
						"          ts_geographicspecialtyids as string,",
						"          address1_name as string,",
						"          ts_recommendationcomments as string,",
						"          address2_telephone3 as string,",
						"          address3_primarycontactname as string,",
						"          ftpsiteurl as string,",
						"          address1_postalcode as string,",
						"          createdon as string,",
						"          address1_stateorprovince as string,",
						"          yomimiddlename as string,",
						"          jobtitle as string,",
						"          telephone3 as string,",
						"          ts_usesspeciality as string,",
						"          ts_knowntouserinitials as string,",
						"          address2_fax as string,",
						"          createdbyname as string,",
						"          xpd_contactuse_text as string,",
						"          ts_sourceid as string,",
						"          address2_addressid as string,",
						"          employeeid as string,",
						"          address1_postofficebox as string,",
						"          address1_city as string,",
						"          ts_businessaddressname as string,",
						"          teamsfollowed as long,",
						"          ts_cv as string,",
						"          timezoneruleversionnumber as long,",
						"          modifiedonbehalfbyyominame as string,",
						"          xpd_hrcompensation as string,",
						"          ts_currentbonusandorupliftconsiderations as string,",
						"          modifiedbyname as string,",
						"          address3_line2 as string,",
						"          yomifullname as string,",
						"          owneridtype as string,",
						"          entityimage_timestamp as long,",
						"          ts_placementfirmintroducedbyyominame as string,",
						"          xpd_previousrole as string,",
						"          ts_compensation as string,",
						"          address2_postofficebox as string,",
						"          emailaddress3 as string,",
						"          emailaddress2 as string,",
						"          emailaddress1 as string,",
						"          ts_interactioncontactuniqueidentifier as string,",
						"          ts_investmentcafeid as string,",
						"          websiteurl as string,",
						"          nickname as string,",
						"          ts_lastmet as timestamp,",
						"          address3_name as string,",
						"          ts_usesspecialtyids as string,",
						"          ts_linkedinurl as string,",
						"          lastname as string,",
						"          address3_longitude as double,",
						"          xpd_referredbyexternalidtype as string,",
						"          parentcustomeridname as string,",
						"          owningbusinessunitname as string,",
						"          onholdtime as long,",
						"          createdonbehalfbyyominame as string,",
						"          preferredsystemuseridyominame as string,",
						"          createdbyexternalpartyname as string,",
						"          ts_tone as string,",
						"          telephone1 as string,",
						"          overriddencreatedon as timestamp,",
						"          address3_postofficebox as string,",
						"          assistantphone as string,",
						"          address1_composite as string,",
						"          address3_line3 as string,",
						"          address2_country as string,",
						"          xpd_referredbyinternalname as string,",
						"          mobilephone as string,",
						"          owneridyominame as string,",
						"          address1_line1 as string,",
						"          createdbyexternalpartyyominame as string,",
						"          xpd_referredbyexternalyominame as string,",
						"          yomifirstname as string,",
						"          mastercontactidname as string,",
						"          address3_city as string,",
						"          address1_country as string,",
						"          externaluseridentifier as string,",
						"          modifiedbyexternalpartyyominame as string,",
						"          firstname as string,",
						"          xpd_hrcurrentbonusandorupliftconsiderations as string,",
						"          stageid as string,",
						"          modifiedonbehalfbyname as string,",
						"          xpd_homecountryname as string,",
						"          mastercontactidyominame as string,",
						"          suffix as string,",
						"          ts_payominame as string,",
						"          lastusedincampaign as timestamp,",
						"          ts_geographicspeciality as string,",
						"          xpd_recruitmentareateam_text as string,",
						"          ts_retentionreviewdate as timestamp,",
						"          parentcustomeridyominame as string,",
						"          timespentbymeonemailandmeetings as string,",
						"          address2_latitude as double,",
						"          xpd_availablefrom as timestamp,",
						"          address3_composite as string,",
						"          xpd_recommendingportco as string,",
						"          preferredsystemuseridname as string,",
						"          utcconversiontimezonecode as long,",
						"          address2_county as string,",
						"          ts_paname as string,",
						"          contactid as string,",
						"          address2_primarycontactname as string,",
						"          ts_specificareasofexpertisecomments as string,",
						"          address1_line2 as string,",
						"          ts_recommendationofindividualupdated as timestamp,",
						"          xpd_referredbyexternalname as string,",
						"          ts_placementfirmintroducedbyname as string,",
						"          ts_sectorspeciality as string,",
						"          ts_previousemployeridname as string,",
						"          processid as string,",
						"          ts_recommendedbyyominame as string,",
						"          modifiedon as timestamp,",
						"          modifiedbyexternalpartyname as string,",
						"          ts_relevantsituations as string,",
						"          businesscard as string,",
						"          company as string,",
						"          preferredequipmentidname as string,",
						"          modifiedbyyominame as string,",
						"          ts_preferredname as string,",
						"          address2_composite as string,",
						"          numberofchildren as long,",
						"          address3_latitude as double,",
						"          mpe_companysearchbyemail as boolean,",
						"          msdyn_segmentid as string,",
						"          msdyn_segmentid_entitytype as string,",
						"          msdyn_segmentidname as string,",
						"          mpe_sensitivityid as string,",
						"          mpe_sensitivityid_entitytype as string,",
						"          mpe_sensitivityidname as string,",
						"          mpe_sensitivitymessage as string,",
						"          state as string,",
						"          status as string,",
						"          haschildren as string,",
						"          customertype as string,",
						"          gender as string,",
						"          address1_addresstype as string,",
						"          leadsource as string,",
						"          preferredappointmenttime as string,",
						"          address2_freightterms as string,",
						"          address2_shippingmethod as string,",
						"          paymentterms as string,",
						"          accountrole as string,",
						"          territory as string,",
						"          address3_freightterms as string,",
						"          address1_shippingmethod as string,",
						"          preferredappointmentday as string,",
						"          customersize as string,",
						"          preferredcontactmethod as string,",
						"          address3_shippingmethod as string,",
						"          address2_addresstype as string,",
						"          address3_addresstype as string,",
						"          familystatus as string,",
						"          shippingmethod as string,",
						"          education as string,",
						"          address1_freightterms as string,",
						"          stateAZOption as string,",
						"          statusAZOption as string,",
						"          haschildrenAZOption as string,",
						"          customertypeAZOption as string,",
						"          genderAZOption as string,",
						"          address1_addresstypeAZOption as string,",
						"          leadsourceAZOption as string,",
						"          preferredappointmenttimeAZOption as string,",
						"          address2_freighttermsAZOption as string,",
						"          address2_shippingmethodAZOption as string,",
						"          paymenttermsAZOption as string,",
						"          accountroleAZOption as string,",
						"          territoryAZOption as string,",
						"          address3_freighttermsAZOption as string,",
						"          address1_shippingmethodAZOption as string,",
						"          preferredappointmentdayAZOption as string,",
						"          customersizeAZOption as string,",
						"          preferredcontactmethodAZOption as string,",
						"          address3_shippingmethodAZOption as string,",
						"          address2_addresstypeAZOption as string,",
						"          address3_addresstypeAZOption as string,",
						"          familystatusAZOption as string,",
						"          shippingmethodAZOption as string,",
						"          educationAZOption as string,",
						"          address1_freighttermsAZOption as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'contactENRICHED',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: true) ~> ContactsIn",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          address1_addresstypecode as long,",
						"          address1_shippingmethodcode as long,",
						"          azurestate as long,",
						"          invitestatuscode as long,",
						"          preferredaddresscode as long,",
						"          preferredemailcode as long,",
						"          outgoingemaildeliverymethod as long,",
						"          preferredphonecode as long,",
						"          emailrouteraccessapproval as long,",
						"          deletedstate as long,",
						"          incomingemaildeliverymethod as long,",
						"          accessmode as long,",
						"          caltype as long,",
						"          address2_addresstypecode as long,",
						"          address2_shippingmethodcode as long,",
						"          setupuser as boolean,",
						"          islicensed as boolean,",
						"          defaultfilterspopulated as boolean,",
						"          isactivedirectoryuser as boolean,",
						"          displayinserviceviews as boolean,",
						"          msdyn_gdproptout as boolean,",
						"          isdisabled as boolean,",
						"          isintegrationuser as boolean,",
						"          isemailaddressapprovedbyo365admin as boolean,",
						"          issyncwithdirectory as boolean,",
						"          calendarid as string,",
						"          calendarid_entitytype as string,",
						"          mobileofflineprofileid as string,",
						"          mobileofflineprofileid_entitytype as string,",
						"          queueid as string,",
						"          queueid_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          territoryid as string,",
						"          territoryid_entitytype as string,",
						"          defaultmailbox as string,",
						"          defaultmailbox_entitytype as string,",
						"          positionid as string,",
						"          positionid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          siteid as string,",
						"          siteid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          parentsystemuserid as string,",
						"          parentsystemuserid_entitytype as string,",
						"          businessunitid as string,",
						"          businessunitid_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          traversedpath as string,",
						"          azureactivedirectoryobjectid as string,",
						"          address1_line1 as string,",
						"          internalemailaddress as string,",
						"          siteidname as string,",
						"          modifiedon as timestamp,",
						"          address1_line3 as string,",
						"          skills as string,",
						"          yomifirstname as string,",
						"          address1_longitude as double,",
						"          yomifullname as string,",
						"          entityimage_timestamp as long,",
						"          parentsystemuseridname as string,",
						"          address2_county as string,",
						"          transactioncurrencyidname as string,",
						"          activedirectoryguid as string,",
						"          utcconversiontimezonecode as long,",
						"          passporthi as long,",
						"          homephone as string,",
						"          parentsystemuseridyominame as string,",
						"          address2_stateorprovince as string,",
						"          mobilephone as string,",
						"          address2_country as string,",
						"          address2_line2 as string,",
						"          disabledreason as string,",
						"          lastname as string,",
						"          address1_city as string,",
						"          address1_utcoffset as long,",
						"          userlicensetype as long,",
						"          nickname as string,",
						"          passportlo as long,",
						"          title as string,",
						"          address2_latitude as double,",
						"          applicationid as string,",
						"          address1_composite as string,",
						"          firstname as string,",
						"          address2_postalcode as string,",
						"          employeeid as string,",
						"          processid as string,",
						"          mobileofflineprofileidname as string,",
						"          governmentid as string,",
						"          entityimage_url as string,",
						"          address2_line3 as string,",
						"          azuredeletedon as timestamp,",
						"          timezoneruleversionnumber as long,",
						"          address1_county as string,",
						"          address2_telephone2 as string,",
						"          address2_postofficebox as string,",
						"          address2_telephone1 as string,",
						"          yomilastname as string,",
						"          address2_telephone3 as string,",
						"          address1_addressid as string,",
						"          territoryidname as string,",
						"          overriddencreatedon as timestamp,",
						"          userpuid as string,",
						"          createdonbehalfbyname as string,",
						"          systemuserid as string,",
						"          address2_name as string,",
						"          middlename as string,",
						"          entityimageid as string,",
						"          applicationiduri as string,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          address2_composite as string,",
						"          address1_country as string,",
						"          mobilealertemail as string,",
						"          sharepointemailaddress as string,",
						"          businessunitidname as string,",
						"          address1_stateorprovince as string,",
						"          exchangerate as decimal(38,10),",
						"          jobtitle as string,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          latestupdatetime as timestamp,",
						"          address1_postofficebox as string,",
						"          organizationid as string,",
						"          yammeremailaddress as string,",
						"          defaultmailboxname as string,",
						"          identityid as long,",
						"          yomimiddlename as string,",
						"          address2_utcoffset as long,",
						"          photourl as string,",
						"          personalemailaddress as string,",
						"          address2_addressid as string,",
						"          address2_longitude as double,",
						"          createdon as string,",
						"          createdbyname as string,",
						"          domainname as string,",
						"          modifiedbyyominame as string,",
						"          address2_fax as string,",
						"          address1_line2 as string,",
						"          modifiedonbehalfbyyominame as string,",
						"          address2_upszone as string,",
						"          salutation as string,",
						"          address1_postalcode as string,",
						"          stageid as string,",
						"          defaultodbfoldername as string,",
						"          positionidname as string,",
						"          ts_inititals as string,",
						"          yammeruserid as string,",
						"          importsequencenumber as long,",
						"          address2_city as string,",
						"          windowsliveid as string,",
						"          organizationidname as string,",
						"          versionnumber as long,",
						"          queueidname as string,",
						"          address1_name as string,",
						"          address1_fax as string,",
						"          address1_latitude as double,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          address2_line1 as string,",
						"          address1_upszone as string,",
						"          fullname as string,",
						"          address1_addresstype as string,",
						"          address1_shippingmethod as string,",
						"          invitestatus as string,",
						"          preferredaddress as string,",
						"          preferredemail as string,",
						"          preferredphone as string,",
						"          address2_addresstype as string,",
						"          address2_shippingmethod as string,",
						"          address1_addresstypeAZOption as string,",
						"          address1_shippingmethodAZOption as string,",
						"          invitestatusAZOption as string,",
						"          preferredaddressAZOption as string,",
						"          preferredemailAZOption as string,",
						"          preferredphoneAZOption as string,",
						"          address2_addresstypeAZOption as string,",
						"          address2_shippingmethodAZOption as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'SystemUserENRICHED',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: false) ~> SystemuserSource",
						"MeetingsAppointmentsIn select(mapColumn(",
						"          Id,",
						"          ts_meetingteam,",
						"          ts_othermeetingmethod,",
						"          isonlinemeeting,",
						"          isalldayevent,",
						"          regardingobjectid,",
						"          ts_taskowner,",
						"          scheduledend,",
						"          ts_taskdescription,",
						"          scheduledstart,",
						"          onlinemeetingjoinurl,",
						"          ts_notes,",
						"          ts_opportunitiesdiscussed,",
						"          ts_sectorscoveredbyfirm,",
						"          ts_originationcommentsnotes,",
						"          ts_taskduedate,",
						"          ts_sectorscoveredids,",
						"          location,",
						"          scheduleddurationminutes",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> MeetingsCleanselect",
						"ContactsIn select(mapColumn(",
						"          Id,",
						"          ts_recommendationofindividual,",
						"          gendercode,",
						"          paymenttermscode,",
						"          ts_vendortargettrackingrole,",
						"          address1_shippingmethodcode,",
						"          preferredcontactmethodcode,",
						"          ts_capabilitiesofindividual,",
						"          familystatuscode,",
						"          xpd_availability,",
						"          address1_freighttermscode,",
						"          xpd_montagulevel,",
						"          ts_permanentinterim,",
						"          ts_ircontactrole,",
						"          xpd_level,",
						"          ts_languagesspokenwritten,",
						"          ts_montaguoffice,",
						"          ts_roletypes,",
						"          xpd_specialisms,",
						"          xpd_function,",
						"          ts_producttype,",
						"          ts_productsinterestedin,",
						"          donotpostalmail,",
						"          ts_centralrelationshipmanager,",
						"          creditonhold,",
						"          xpd_benchcandidate,",
						"          donotsendmm,",
						"          donotbulkemail,",
						"          followemail,",
						"          xpd_available,",
						"          donotfax,",
						"          donotphone,",
						"          donotemail,",
						"          ts_recommendedby,",
						"          transactioncurrencyid,",
						"          originatingleadid,",
						"          xpd_homecountry,",
						"          creditlimit,",
						"          telephone2,",
						"          salutation,",
						"          ts_reportingemail,",
						"          ts_otherlanguages,",
						"          birthdate,",
						"          spousesname,",
						"          xpd_compensationdate,",
						"          anniversary,",
						"          ts_recommendationcomments,",
						"          ts_usesspeciality,",
						"          xpd_hrcompensation,",
						"          ts_currentbonusandorupliftconsiderations,",
						"          ts_compensation,",
						"          emailaddress2,",
						"          ts_investmentcafeid,",
						"          ts_lastmet,",
						"          ts_tone,",
						"          xpd_hrcurrentbonusandorupliftconsiderations,",
						"          lastusedincampaign,",
						"          ts_geographicspeciality,",
						"          xpd_availablefrom,",
						"          xpd_recommendingportco,",
						"          contactid,",
						"          ts_sectorspeciality",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> contactscleanselect",
						"OriginationOpportunityIn select(mapColumn(",
						"          Id,",
						"          ts_actionstatus,",
						"          ts_producttype,",
						"          ts_internalintermediarysource,",
						"          ts_currentactivity,",
						"          ts_opportunitystatus,",
						"          ts_montaguprimaryoffice,",
						"          ts_opportunitytype,",
						"          ts_posthumstatus,",
						"          ts_choppedreason,",
						"          ts_duplicateopportunityfordiscussion,",
						"          mpe_smalltarget,",
						"          xpd_includeonallpapers,",
						"          ts_sold,",
						"          xpd_sharepointlocationcreated,",
						"          ts_buyer,",
						"          mpe_productid,",
						"          ts_targetbusiness,",
						"          ts_firstreferralcompany,",
						"          ts_montaguowner,",
						"          ts_firstreferralcontact,",
						"          transactioncurrencyid,",
						"          ts_managerwedback,",
						"          ts_country,",
						"          ownerid,",
						"          ts_estebitda,",
						"          ts_estebit,",
						"          ts_estdealsize,",
						"          ts_estturnover,",
						"          ts_nextsteps,",
						"          ts_buyerpaidxltmebitda,",
						"          ts_opportunitystage,",
						"          ts_choppedcomments,",
						"          ts_datedealannounced,",
						"          ts_name,",
						"          ts_weofferedxltmebitda,",
						"          ts_companyid,",
						"          ts_choppeddate,",
						"          mpe_carveout,",
						"          mpe_targetbusiness_parentid",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> OrigiopportCleanout",
						"AccountIn select(mapColumn(",
						"          Id_YouHaveChanged = Id,",
						"          ts_primarysecondaryfocus_No_you_have = ts_primarysecondaryfocus,",
						"          xpd_relationshipstatus,",
						"          ts_introducertype,",
						"          xpd_remindermonths,",
						"          ts_portfoliocompanystatus,",
						"          ts_companytype,",
						"          ts_vendorsummary,",
						"          xpd_publictoprivatetracker,",
						"          xpd_setreminder,",
						"          ts_trackcompany,",
						"          parentaccountid,",
						"          xpd_reminderto,",
						"          ts_headofficeid,",
						"          ts_originationlead1,",
						"          ts_originationlead2,",
						"          ts_currentauditor,",
						"          ts_othernotes,",
						"          xpd_relationshipcomments,",
						"          ts_formername,",
						"          ts_mpeapproachstrategy,",
						"          ts_lastdatestatuschanged,",
						"          xpd_relationshipstatuschangeddate,",
						"          ts_companylegalname,",
						"          ts_companynumber,",
						"          ts_monthlyreviewmeetingname,",
						"          ts_originationcomments,",
						"          ts_capitaliqlink,",
						"          xpd_datereminderwasset,",
						"          ts_reminderdatesetto,",
						"          ts_alias,",
						"          xpd_reasonaction,",
						"          ts_relevantsituations,",
						"          ts_dealstageofmostrecentopportunity",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> AccountsSelectClean",
						"SystemuserSource select(mapColumn(",
						"          id = Id,",
						"          calendarid,",
						"          siteid,",
						"          azureactivedirectoryobjectid,",
						"          modifiedby,",
						"          address1_line1,",
						"          internalemailaddress,",
						"          siteidname,",
						"          yomifullname,",
						"          mobilephone,",
						"          lastname,",
						"          address1_city,",
						"          title,",
						"          address1_composite,",
						"          firstname,",
						"          address1_addressid,",
						"          userpuid,",
						"          parentsystemuserid,",
						"          entityimageid,",
						"          address1_country,",
						"          businessunitidname,",
						"          address1_telephone1,",
						"          organizationid,",
						"          defaultmailboxname,",
						"          identityid,",
						"          address2_addressid,",
						"          createdon,",
						"          domainname,",
						"          modifiedbyyominame,",
						"          address1_postalcode,",
						"          ts_inititals,",
						"          windowsliveid,",
						"          queueidname,",
						"          modifiedbyname",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SystemUserSelect",
						"AccountsSelectClean sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'accountENRICHEDFinal',",
						"     insertable: true,",
						"     updateable: false,",
						"     deletable: false,",
						"     upsertable: false,",
						"     recreate: true,",
						"     allowCopyCommand: true,",
						"     staged: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> AccountCleanSink",
						"MeetingsCleanselect sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'appointmentENRICHEDFinal',",
						"     insertable: true,",
						"     updateable: false,",
						"     deletable: false,",
						"     upsertable: false,",
						"     recreate: true,",
						"     allowCopyCommand: true,",
						"     staged: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> MeetingStageCleanSink",
						"contactscleanselect sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'contactENRICHEDFinal',",
						"     insertable: true,",
						"     updateable: false,",
						"     deletable: false,",
						"     upsertable: false,",
						"     recreate: true,",
						"     allowCopyCommand: true,",
						"     staged: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> ContactsStageCleanSink",
						"OrigiopportCleanout sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'OriginationOpportunitiesENRICHEDFinal',",
						"     insertable: true,",
						"     updateable: false,",
						"     deletable: false,",
						"     upsertable: false,",
						"     recreate: true,",
						"     allowCopyCommand: true,",
						"     staged: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> OriginationCleanSink",
						"SystemUserSelect sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'SystemUserENRICHEDFinal',",
						"     insertable: true,",
						"     updateable: false,",
						"     deletable: false,",
						"     upsertable: false,",
						"     recreate: true,",
						"     allowCopyCommand: true,",
						"     staged: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> SystemUserCleanSink"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/ReportsAnalytics')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/PH Full InputDataflow_Split Table')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"name": "AccountIn"
						},
						{
							"name": "OriginationOpportunityIn"
						},
						{
							"name": "MeetingsAppointmentsIn"
						},
						{
							"name": "ContactsIn"
						},
						{
							"name": "SystemuserSource"
						},
						{
							"linkedService": {
								"referenceName": "EnrichedDatabase",
								"type": "LinkedServiceReference"
							},
							"name": "EnrichedAccount"
						},
						{
							"linkedService": {
								"referenceName": "EnrichedDatabase",
								"type": "LinkedServiceReference"
							},
							"name": "EnrichedOriginationOpportunities"
						},
						{
							"linkedService": {
								"referenceName": "EnrichedDatabase",
								"type": "LinkedServiceReference"
							},
							"name": "EnrichedMeetingAppointments"
						},
						{
							"linkedService": {
								"referenceName": "EnrichedDatabase",
								"type": "LinkedServiceReference"
							},
							"name": "EnrichedContacts"
						},
						{
							"linkedService": {
								"referenceName": "EnrichedDatabase",
								"type": "LinkedServiceReference"
							},
							"name": "EnrichedSystemuser"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "AccountTable",
								"type": "DatasetReference"
							},
							"name": "AccountCleanSink"
						},
						{
							"dataset": {
								"referenceName": "Appointment",
								"type": "DatasetReference"
							},
							"name": "MeetingStageCleanSink"
						},
						{
							"dataset": {
								"referenceName": "Contacttable",
								"type": "DatasetReference"
							},
							"name": "ContactsStageCleanSink"
						},
						{
							"dataset": {
								"referenceName": "OriginationOpp",
								"type": "DatasetReference"
							},
							"name": "OriginationCleanSink"
						},
						{
							"dataset": {
								"referenceName": "Systemusertable",
								"type": "DatasetReference"
							},
							"name": "SystemUserCleanSink"
						},
						{
							"name": "SinkEnrichedOrigination"
						},
						{
							"name": "SinkEnrichedAccount"
						},
						{
							"name": "SinkEnrichedMeeting"
						},
						{
							"name": "SinkEnrichedContacts"
						},
						{
							"name": "SinkEnrichedSystemUser"
						}
					],
					"transformations": [
						{
							"name": "MeetingsCleanselect"
						},
						{
							"name": "contactscleanselect"
						},
						{
							"name": "OrigiopportCleanout"
						},
						{
							"name": "AccountsSelectClean"
						},
						{
							"name": "SystemUserSelect"
						},
						{
							"name": "Originationjoinoutput"
						},
						{
							"name": "EnrichedAccountSelect"
						},
						{
							"name": "OutputEnrichedOrigination"
						},
						{
							"name": "OutputEnrichedMeetingAppointments"
						},
						{
							"name": "OutputEnrichedContacts"
						},
						{
							"name": "OutputEnrichedSystemuser"
						},
						{
							"name": "AppointmentsJoinOutput"
						},
						{
							"name": "ContactsJoin"
						},
						{
							"name": "SystemUserJoin"
						},
						{
							"name": "AccountEnrichedJoin"
						}
					],
					"scriptLines": [
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          ts_primarysecondaryfocus as long,",
						"          customertypecode as long,",
						"          ts_relationship as long,",
						"          address1_addresstypecode as long,",
						"          accountclassificationcode as long,",
						"          ts_easeofworking as long,",
						"          ts_ukrow as long,",
						"          preferredappointmenttimecode as long,",
						"          ts_address1addresstype as long,",
						"          xpd_relationshipstatus as long,",
						"          ts_introducertype as long,",
						"          xpd_remindermonths as long,",
						"          ts_importance as long,",
						"          address2_freighttermscode as long,",
						"          ts_irrvsmomperformancemeasure as long,",
						"          accountcategorycode as long,",
						"          paymenttermscode as long,",
						"          preferredappointmentdaycode as long,",
						"          businesstypecode as long,",
						"          industrycode as long,",
						"          ts_sizeoffirm as long,",
						"          ts_interaction as long,",
						"          address1_shippingmethodcode as long,",
						"          ts_portfoliocompanystatus as long,",
						"          customersizecode as long,",
						"          xpd_previousinvestorstatus as long,",
						"          ts_recommendationoffirm as long,",
						"          preferredcontactmethodcode as long,",
						"          accountratingcode as long,",
						"          ts_investorstatus as long,",
						"          ts_capabilitiesoffirm as long,",
						"          mpe_flowlastrunoutcome as long,",
						"          address2_addresstypecode as long,",
						"          address2_shippingmethodcode as long,",
						"          ts_nextoriginationmeetingarranged as long,",
						"          ownershipcode as long,",
						"          territorycode as long,",
						"          ts_investortype as long,",
						"          shippingmethodcode as long,",
						"          ts_investorregion as long,",
						"          address1_freighttermscode as long,",
						"          xpd_function as string,",
						"          ts_quickcaptureuses as string,",
						"          ts_permanentinterim as string,",
						"          ts_quickcapturesectors as string,",
						"          ts_roletypes as string,",
						"          ts_companytype as string,",
						"          xpd_level as string,",
						"          ts_indicativeclientbase as string,",
						"          xpd_specialisms as string,",
						"          xpd_montagulevel as string,",
						"          ts_vendorsummary as string,",
						"          ts_producttype as string,",
						"          ts_montaguoffice as string,",
						"          ts_quickcapturegeography as string,",
						"          xpd_roletypes as string,",
						"          mpe_livedeal as boolean,",
						"          donotbulkpostalmail as boolean,",
						"          donotpostalmail as boolean,",
						"          msdyn_gdproptout as boolean,",
						"          ts_organisationalchange as boolean,",
						"          xpd_publictoprivatetracker as boolean,",
						"          ts_auditor as boolean,",
						"          donotsendmm as boolean,",
						"          donotbulkemail as boolean,",
						"          followemail as boolean,",
						"          creditonhold as boolean,",
						"          marketingonly as boolean,",
						"          participatesinworkflow as boolean,",
						"          merged as boolean,",
						"          ts_validated as boolean,",
						"          xpd_sharepointlocationcreated as boolean,",
						"          xpd_setreminder as boolean,",
						"          ts_personnelchange as boolean,",
						"          donotfax as boolean,",
						"          isprivate as boolean,",
						"          donotphone as boolean,",
						"          xpd_rpo as boolean,",
						"          ts_trackcompany as boolean,",
						"          donotemail as boolean,",
						"          parentaccountid as string,",
						"          parentaccountid_entitytype as string,",
						"          ts_recommendedby as string,",
						"          ts_recommendedby_entitytype as string,",
						"          ts_countryofeconomicoriginforthecapital as string,",
						"          ts_countryofeconomicoriginforthecapital_entitytype as string,",
						"          xpd_reminderto as string,",
						"          xpd_reminderto_entitytype as string,",
						"          preferredserviceid as string,",
						"          preferredserviceid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          createdbyexternalparty as string,",
						"          createdbyexternalparty_entitytype as string,",
						"          ts_validatedby as string,",
						"          ts_validatedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          ts_primarymperelationshipmanager as string,",
						"          ts_primarymperelationshipmanager_entitytype as string,",
						"          modifiedbyexternalparty as string,",
						"          modifiedbyexternalparty_entitytype as string,",
						"          ts_headofficeid as string,",
						"          ts_headofficeid_entitytype as string,",
						"          ts_address1country as string,",
						"          ts_address1country_entitytype as string,",
						"          ts_address1usstate as string,",
						"          ts_address1usstate_entitytype as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          originatingleadid as string,",
						"          originatingleadid_entitytype as string,",
						"          masterid as string,",
						"          masterid_entitytype as string,",
						"          ts_originationlead1 as string,",
						"          ts_originationlead1_entitytype as string,",
						"          defaultpricelevelid as string,",
						"          defaultpricelevelid_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          ts_originationlead2 as string,",
						"          ts_originationlead2_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          mpe_coinvestquestionnaireid as string,",
						"          mpe_coinvestquestionnaireid_entitytype as string,",
						"          ts_hub as string,",
						"          ts_hub_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          ts_currentauditor as string,",
						"          ts_currentauditor_entitytype as string,",
						"          primarycontactid as string,",
						"          primarycontactid_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          preferredsystemuserid as string,",
						"          preferredsystemuserid_entitytype as string,",
						"          preferredequipmentid as string,",
						"          preferredequipmentid_entitytype as string,",
						"          xpd_fund as string,",
						"          xpd_fund_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          territoryid as string,",
						"          territoryid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          xpd_totalinstitutionalcommitments_base as decimal(38,0),",
						"          ts_minimumticketsize_base as decimal(38,4),",
						"          xpd_totalinstitutionalcommitments as decimal(38,0),",
						"          aging30 as decimal(38,0),",
						"          creditlimit as decimal(38,0),",
						"          creditlimit_base as decimal(38,0),",
						"          ts_totalcommitments_base as decimal(38,4),",
						"          aging60 as decimal(38,0),",
						"          ts_transfersin_base as decimal(38,0),",
						"          aging90 as decimal(38,0),",
						"          ts_maximumticketsize as decimal(38,4),",
						"          ts_totalaum_base as decimal(38,0),",
						"          marketcap_base as decimal(38,0),",
						"          aging60_base as decimal(38,0),",
						"          aging90_base as decimal(38,0),",
						"          ts_transfersout as decimal(38,0),",
						"          ts_maximumticketsize_base as decimal(38,4),",
						"          ts_originalcommitments_base as decimal(38,0),",
						"          revenue as decimal(38,0),",
						"          ts_totalcommitments as decimal(38,4),",
						"          ts_transfersout_base as decimal(38,0),",
						"          ts_totalaum as decimal(38,0),",
						"          ts_commitmentreductions_base as decimal(38,0),",
						"          ts_commitmentreductions as decimal(38,0),",
						"          marketcap as decimal(38,0),",
						"          ts_originalcommitments as decimal(38,0),",
						"          ts_minimumticketsize as decimal(38,4),",
						"          revenue_base as decimal(38,0),",
						"          openrevenue_base as decimal(38,0),",
						"          aging30_base as decimal(38,0),",
						"          openrevenue as decimal(38,0),",
						"          ts_transfersin as decimal(38,0),",
						"          ts_othernotes as string,",
						"          ts_transfersin_date as timestamp,",
						"          address1_county as string,",
						"          openrevenue_date as timestamp,",
						"          ts_recommendedbyname as string,",
						"          ts_relationshipinteractioncomments as string,",
						"          ts_originationlead2yominame as string,",
						"          parentaccountidname as string,",
						"          xpd_roletypes_text as string,",
						"          address1_addressid as string,",
						"          importsequencenumber as long,",
						"          address1_longitude as double,",
						"          ts_countryofeconomicoriginforthecapitalname as string,",
						"          entityimageid as string,",
						"          telephone2 as string,",
						"          ts_lastoriginationmeeting as timestamp,",
						"          address2_utcoffset as long,",
						"          address1_upszone as string,",
						"          ts_originalcommitments_state as long,",
						"          ts_typicalcost as string,",
						"          xpd_recommendingportfoliocompaniesrecommended as string,",
						"          accountnumber as string,",
						"          ts_currentauditoryominame as string,",
						"          ts_originalcommitments_date as timestamp,",
						"          lastonholdtime as timestamp,",
						"          ts_sectorscoveredbyfirm as string,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          address2_upszone as string,",
						"          opendeals_state as long,",
						"          xpd_functionuse_text as string,",
						"          slainvokedidname as string,",
						"          address2_longitude as double,",
						"          defaultpricelevelidname as string,",
						"          stockexchange as string,",
						"          mpe_liveofferingscount_date as timestamp,",
						"          xpd_relationshipcomments as string,",
						"          originatingleadidname as string,",
						"          slaname as string,",
						"          ts_currentauditorname as string,",
						"          xpd_remindertoyominame as string,",
						"          ts_address1usstatename as string,",
						"          ts_tempcompanytype as string,",
						"          versionnumber as long,",
						"          address1_latitude as double,",
						"          ts_formername as string,",
						"          yominame as string,",
						"          createdbyyominame as string,",
						"          ts_cityofvisit as string,",
						"          address2_telephone1 as string,",
						"          ts_globalgeographiescoveredids as string,",
						"          preferredserviceidname as string,",
						"          address2_city as string,",
						"          ts_mpeapproachstrategy as string,",
						"          address2_line2 as string,",
						"          ts_lastdatestatuschanged as timestamp,",
						"          li_companyid as long,",
						"          transactioncurrencyidname as string,",
						"          entityimage_url as string,",
						"          xpd_relationshipstatuschangeddate as timestamp,",
						"          createdonbehalfbyname as string,",
						"          mpe_liveofferingscount_state as long,",
						"          xpd_numberofcoinvestinvestments_date as timestamp,",
						"          ts_validateddate as timestamp,",
						"          owneridname as string,",
						"          xpd_generalcomments as string,",
						"          ts_companylegalname as string,",
						"          description as string,",
						"          ts_validatedbyname as string,",
						"          originatingleadidyominame as string,",
						"          opendeals as long,",
						"          xpd_numberofopportunitiesshown_state as long,",
						"          address2_postalcode as string,",
						"          websiteurl as string,",
						"          xpd_fundname as string,",
						"          address1_utcoffset as long,",
						"          exchangerate as decimal(38,10),",
						"          mpe_flowlastrundate as timestamp,",
						"          fax as string,",
						"          address1_line3 as string,",
						"          ts_monthssincelastmeeting as long,",
						"          ts_hubname as string,",
						"          address2_line1 as string,",
						"          ts_capiqticket as string,",
						"          address2_stateorprovince as string,",
						"          address2_name as string,",
						"          ts_transfersout_state as long,",
						"          xpd_numberofopportunitiesshown as long,",
						"          primarytwitterid as string,",
						"          mpe_coinvestquestionnaireidname as string,",
						"          xpd_numberofopportunitiesshown_date as timestamp,",
						"          xpd_preferentialterms as string,",
						"          address1_primarycontactname as string,",
						"          territoryidname as string,",
						"          ts_processstatus as string,",
						"          address1_name as string,",
						"          address2_telephone2 as string,",
						"          address2_telephone3 as string,",
						"          xpd_recruitmentareateam_text as string,",
						"          ftpsiteurl as string,",
						"          address1_postalcode as string,",
						"          ts_companynumber as string,",
						"          createdon as string,",
						"          mpe_liveofferingscount as long,",
						"          traversedpath as string,",
						"          address1_stateorprovince as string,",
						"          ts_transfersin_state as long,",
						"          address2_addressid as string,",
						"          ts_monthlyreviewmeetingname as string,",
						"          primarysatoriid as string,",
						"          telephone3 as string,",
						"          openrevenue_state as long,",
						"          ts_usesprovidedids as string,",
						"          ts_originationcomments as string,",
						"          lastusedincampaign as timestamp,",
						"          primarycontactidname as string,",
						"          ts_originationlead1name as string,",
						"          ts_headofficeidname as string,",
						"          ts_montagucomments as string,",
						"          address2_fax as string,",
						"          createdbyname as string,",
						"          xpd_numberofcoinvestinvestments as long,",
						"          ts_capitaliqlink as string,",
						"          ts_primarymperelationshipmanagername as string,",
						"          mpe_relationshipstatus_text as string,",
						"          xpd_datereminderwasset as timestamp,",
						"          xpd_numberofcoinvestinvestments_state as long,",
						"          address1_postofficebox as string,",
						"          address1_city as string,",
						"          teamsfollowed as long,",
						"          ts_originationlead2name as string,",
						"          timezoneruleversionnumber as long,",
						"          modifiedonbehalfbyyominame as string,",
						"          entityimage_timestamp as long,",
						"          tickersymbol as string,",
						"          ts_theirprogrammecomments as string,",
						"          xpd_companyuse_text as string,",
						"          modifiedbyname as string,",
						"          owneridtype as string,",
						"          sic as string,",
						"          sharesoutstanding as long,",
						"          opendeals_date as timestamp,",
						"          address2_postofficebox as string,",
						"          emailaddress3 as string,",
						"          emailaddress2 as string,",
						"          emailaddress1 as string,",
						"          ts_globalgeographiescoveredbyfirm as string,",
						"          ts_recommendationoffirmupdated as timestamp,",
						"          ts_lastmet as timestamp,",
						"          ts_reminderdatesetto as timestamp,",
						"          ts_commitmentreductions_state as long,",
						"          owningbusinessunitname as string,",
						"          onholdtime as long,",
						"          ts_alias as string,",
						"          createdonbehalfbyyominame as string,",
						"          ts_transfersout_date as timestamp,",
						"          ts_address1countryname as string,",
						"          preferredsystemuseridyominame as string,",
						"          createdbyexternalpartyname as string,",
						"          mpe_documentsetid as string,",
						"          telephone1 as string,",
						"          ts_legacycompanytypes as string,",
						"          ts_validatedbyyominame as string,",
						"          address1_composite as string,",
						"          ts_investorgroupgatekeeperid as string,",
						"          primarycontactidyominame as string,",
						"          address2_country as string,",
						"          xpd_recommendationcomments as string,",
						"          owneridyominame as string,",
						"          createdbyexternalpartyyominame as string,",
						"          ts_originationlead1yominame as string,",
						"          ts_usesprovidedbyfirm as string,",
						"          xpd_recommendingportco as string,",
						"          address1_country as string,",
						"          ts_commitmentreductions_date as timestamp,",
						"          name as string,",
						"          modifiedbyexternalpartyyominame as string,",
						"          xpd_remindertoname as string,",
						"          stageid as string,",
						"          modifiedonbehalfbyname as string,",
						"          masteraccountidname as string,",
						"          timespentbymeonemailandmeetings as string,",
						"          address2_latitude as double,",
						"          overriddencreatedon as timestamp,",
						"          parentaccountidyominame as string,",
						"          ts_specificareaofexpertisecomments as string,",
						"          preferredsystemuseridname as string,",
						"          utcconversiontimezonecode as long,",
						"          address2_county as string,",
						"          address1_line1 as string,",
						"          address2_primarycontactname as string,",
						"          address1_line2 as string,",
						"          xpd_reasonaction as string,",
						"          ts_primarymperelationshipmanageryominame as string,",
						"          processid as string,",
						"          ts_sectorscoveredids as string,",
						"          ts_recommendedbyyominame as string,",
						"          modifiedbyexternalpartyname as string,",
						"          ts_relevantsituations as string,",
						"          accountid as string,",
						"          modifiedon as timestamp,",
						"          preferredequipmentidname as string,",
						"          modifiedbyyominame as string,",
						"          ts_dealstageofmostrecentopportunity as string,",
						"          address2_composite as string,",
						"          masteraccountidyominame as string,",
						"          numberofemployees as long,",
						"          address1_fax as string,",
						"          address2_line3 as string,",
						"          msdyn_segmentid as string,",
						"          msdyn_segmentid_entitytype as string,",
						"          msdyn_segmentidname as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'account') ~> AccountIn",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          ts_dealannouncedreason as long,",
						"          ts_highprioritynew as long,",
						"          ts_actionstatus as long,",
						"          mpe_targetrelationshipstatus as long,",
						"          ts_producttype as long,",
						"          ts_internalintermediarysource as long,",
						"          mpe_flowlastrunoutcome as long,",
						"          ts_currentactivity as long,",
						"          ts_opportunitystatus as long,",
						"          ts_montaguprimaryoffice as long,",
						"          ts_opportunitytype as long,",
						"          ts_posthumstatus as long,",
						"          ts_meetingremindermonths as long,",
						"          ts_choppedreason as string,",
						"          ts_setreminder as boolean,",
						"          ts_stagereachedfir as boolean,",
						"          ts_stagereachedipr as boolean,",
						"          ts_duplicateopportunityfordiscussion as boolean,",
						"          mpe_smalltarget as boolean,",
						"          ts_stagereachedcr as boolean,",
						"          xpd_includeonallpapers as boolean,",
						"          ts_sold as boolean,",
						"          xpd_sharepointlocationcreated as boolean,",
						"          ts_statuschangedby as string,",
						"          ts_statuschangedby_entitytype as string,",
						"          ts_buyer as string,",
						"          ts_buyer_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          ts_reminderto as string,",
						"          ts_reminderto_entitytype as string,",
						"          mpe_productid as string,",
						"          mpe_productid_entitytype as string,",
						"          ts_targetbusiness as string,",
						"          ts_targetbusiness_entitytype as string,",
						"          ts_firstreferralcompany as string,",
						"          ts_firstreferralcompany_entitytype as string,",
						"          ts_deallead as string,",
						"          ts_deallead_entitytype as string,",
						"          ts_montaguowner as string,",
						"          ts_montaguowner_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          ts_firstreferralcontact as string,",
						"          ts_firstreferralcontact_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ts_managerwedback as string,",
						"          ts_managerwedback_entitytype as string,",
						"          ts_country as string,",
						"          ts_country_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          ts_sellmandate as string,",
						"          ts_sellmandate_entitytype as string,",
						"          ts_estebitda_base as decimal(38,4),",
						"          ts_estebit_base as decimal(38,4),",
						"          ts_estebitda as decimal(38,4),",
						"          ts_estebit as decimal(38,4),",
						"          ts_estturnover_base as decimal(38,4),",
						"          ts_estdealsize as decimal(38,4),",
						"          ts_estdealsize_base as decimal(38,4),",
						"          ts_estturnover as decimal(38,4),",
						"          ts_buyeryominame as string,",
						"          modifiedon as timestamp,",
						"          ts_statuschangedbyname as string,",
						"          ts_managerwedbackyominame as string,",
						"          xpd_montaguprojectname as string,",
						"          transactioncurrencyidname as string,",
						"          ts_nextsteps as string,",
						"          ts_montaguowneryominame as string,",
						"          ts_firstreferralcontactname as string,",
						"          ts_opportunitydescription as string,",
						"          ts_buyerpaidxltmebitda as decimal(38,1),",
						"          ts_targetbusinessyominame as string,",
						"          ts_montaguownername as string,",
						"          ts_managerwedbackname as string,",
						"          ts_opportunitystage as string,",
						"          ts_otherdocumentsurl as string,",
						"          exchangerate as decimal(38,10),",
						"          mpe_documentsetid as string,",
						"          ts_buyername as string,",
						"          ts_firstreferralcontactyominame as string,",
						"          createdon as string,",
						"          ts_sellmandateyominame as string,",
						"          mpe_montaguprimaryofficestring as string,",
						"          ts_statuschangedbyyominame as string,",
						"          ts_firstreferralcompanyname as string,",
						"          owneridyominame as string,",
						"          ts_choppedcomments as string,",
						"          timezoneruleversionnumber as long,",
						"          createdbyname as string,",
						"          ts_dealleadname as string,",
						"          owningbusinessunitname as string,",
						"          ts_dealleadyominame as string,",
						"          ts_lastdatestatuschanged as timestamp,",
						"          traversedpath as string,",
						"          overriddencreatedon as timestamp,",
						"          ts_iprdocumenturl as string,",
						"          createdonbehalfbyname as string,",
						"          ts_sellmandatename as string,",
						"          owneridtype as string,",
						"          owneridname as string,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          mpe_productidname as string,",
						"          ts_originationopportunityid as string,",
						"          ts_crdocumenturl as string,",
						"          ts_datedealannounced as timestamp,",
						"          processid as string,",
						"          mpe_montaguprimaryofficeowner as string,",
						"          ts_reason as string,",
						"          ts_targetbusinessname as string,",
						"          ts_remindertoname as string,",
						"          ts_postcompletionnoteurl as string,",
						"          ts_name as string,",
						"          stageid as string,",
						"          ts_currentopportunitystatus as string,",
						"          ts_firstreferralcompanyyominame as string,",
						"          mpe_flowlastrundate as timestamp,",
						"          ts_firdocumenturl as string,",
						"          modifiedbyyominame as string,",
						"          modifiedonbehalfbyyominame as string,",
						"          ts_movedoutofwipdate as timestamp,",
						"          ts_equitychequesize as decimal(38,2),",
						"          utcconversiontimezonecode as long,",
						"          ts_weofferedxltmebitda as decimal(38,1),",
						"          importsequencenumber as long,",
						"          ts_remindertoyominame as string,",
						"          ts_companyid as long,",
						"          ts_datereminderwasset as timestamp,",
						"          versionnumber as long,",
						"          ts_originationid as long,",
						"          ts_countryname as string,",
						"          ts_choppeddate as timestamp,",
						"          mpe_posthunstatustext as string,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          ts_humdate as timestamp,",
						"          ts_sellmandateidtype as string,",
						"          ts_dateofreminder as timestamp,",
						"          ts_humurl as string,",
						"          mpe_carveout as long,",
						"          mpe_targetbusiness_parentid as string,",
						"          mpe_targetbusiness_parentid_entitytype as string,",
						"          mpe_targetbusiness_parentidyominame as string,",
						"          mpe_targetbusiness_parentidname as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'ts_originationopportunity') ~> OriginationOpportunityIn",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          ts_stageofmeetingrounds as long,",
						"          ts_talentmeetingtype as long,",
						"          instancetypecode as long,",
						"          ts_whooriginatedthemeeting as long,",
						"          onlinemeetingtype as long,",
						"          ts_meetingteam as long,",
						"          ts_othermeetingmethod as long,",
						"          ts_tone as long,",
						"          ts_meetingmethod as long,",
						"          ts_originationmeetingtype as long,",
						"          prioritycode as long,",
						"          attachmenterrors as long,",
						"          ts_eventtype as long,",
						"          ts_talentmeetingmethod as long,",
						"          ts_productsdiscussed as string,",
						"          ts_contentcovered as string,",
						"          isonlinemeeting as boolean,",
						"          isworkflowcreated as boolean,",
						"          isalldayevent as boolean,",
						"          ts_interview as boolean,",
						"          isbilled as boolean,",
						"          isdraft as boolean,",
						"          ts_keyiractivity as boolean,",
						"          ts_noninvestor as boolean,",
						"          ismapiprivate as boolean,",
						"          isregularactivity as boolean,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          ts_investorgroup as string,",
						"          ts_investorgroup_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          regardingobjectid as string,",
						"          regardingobjectid_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ts_officemet as string,",
						"          ts_officemet_entitytype as string,",
						"          ts_taskowner as string,",
						"          ts_taskowner_entitytype as string,",
						"          serviceid as string,",
						"          serviceid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          requiredattendees as string,",
						"          optionalattendees as string,",
						"          organizer as string,",
						"          scheduledend as timestamp,",
						"          ts_taskdescription as string,",
						"          modifiedon as timestamp,",
						"          ts_purpose as string,",
						"          overriddencreatedon as timestamp,",
						"          ts_taskownername as string,",
						"          activityadditionalparams as string,",
						"          ts_tonepersonalities as string,",
						"          seriesid as string,",
						"          transactioncurrencyidname as string,",
						"          activityid as string,",
						"          modifiedfieldsmask as string,",
						"          utcconversiontimezonecode as long,",
						"          ts_officemetname as string,",
						"          scheduledstart as timestamp,",
						"          outlookownerapptid as long,",
						"          ts_topicscovered as string,",
						"          ts_objective as string,",
						"          onholdtime as long,",
						"          onlinemeetingjoinurl as string,",
						"          ts_notes as string,",
						"          originalstartdate as timestamp,",
						"          ts_opportunitiesdiscussed as string,",
						"          ts_sectorscoveredbyfirm as string,",
						"          attachmentcount as long,",
						"          exchangerate as decimal(38,10),",
						"          ts_originationcommentsnotes as string,",
						"          category as string,",
						"          createdon as string,",
						"          ts_eventdescription as string,",
						"          globalobjectid as string,",
						"          onlinemeetingid as string,",
						"          serviceidname as string,",
						"          owneridyominame as string,",
						"          description as string,",
						"          subcategory as string,",
						"          owningbusinessunitname as string,",
						"          ts_taskduedate as timestamp,",
						"          traversedpath as string,",
						"          sortdate as timestamp,",
						"          createdonbehalfbyname as string,",
						"          ts_sectorscoveredids as string,",
						"          safedescription as string,",
						"          ts_taskowneryominame as string,",
						"          owneridtype as string,",
						"          isunsafe as long,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          ts_conferencename as string,",
						"          timezoneruleversionnumber as long,",
						"          actualend as timestamp,",
						"          regardingobjectidname as string,",
						"          processid as string,",
						"          activitytypecode as string,",
						"          actualstart as timestamp,",
						"          xpd_listofexternalattendees as string,",
						"          slainvokedidname as string,",
						"          location as string,",
						"          subject as string,",
						"          createdbyname as string,",
						"          actualdurationminutes as long,",
						"          modifiedbyyominame as string,",
						"          lastonholdtime as timestamp,",
						"          modifiedonbehalfbyyominame as string,",
						"          ts_attendeestoaddtocrm as string,",
						"          regardingobjectidyominame as string,",
						"          regardingobjecttypecode as string,",
						"          stageid as string,",
						"          scheduleddurationminutes as long,",
						"          ts_sourceid as string,",
						"          ts_investorgroupyominame as string,",
						"          importsequencenumber as long,",
						"          subscriptionid as string,",
						"          onlinemeetingchatid as string,",
						"          ts_lpupdates as string,",
						"          ts_executivesummary as string,",
						"          ts_investorgroupname as string,",
						"          ts_meetingcity as string,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          owneridname as string,",
						"          ts_theirprogramme as string,",
						"          ts_ifdeclinedreason as string,",
						"          slaname as string,",
						"          versionnumber as long",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'appointment') ~> MeetingsAppointmentsIn",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          haschildrencode as long,",
						"          customertypecode as long,",
						"          ts_recommendationofindividual as long,",
						"          gendercode as long,",
						"          address1_addresstypecode as long,",
						"          leadsourcecode as long,",
						"          preferredappointmenttimecode as long,",
						"          address2_freighttermscode as long,",
						"          address2_shippingmethodcode as long,",
						"          ts_debtsubtype as long,",
						"          msdyn_orgchangestatus as long,",
						"          ts_suffix as long,",
						"          xpd_gender as long,",
						"          ts_title as long,",
						"          paymenttermscode as long,",
						"          accountrolecode as long,",
						"          territorycode as long,",
						"          ts_vendortargettrackingrole as long,",
						"          address3_freighttermscode as long,",
						"          address1_shippingmethodcode as long,",
						"          preferredappointmentdaycode as long,",
						"          customersizecode as long,",
						"          preferredcontactmethodcode as long,",
						"          ts_futurecontactmethod as long,",
						"          address3_shippingmethodcode as long,",
						"          address2_addresstypecode as long,",
						"          mpe_flowlastrunoutcome as long,",
						"          ts_capabilitiesofindividual as long,",
						"          address3_addresstypecode as long,",
						"          familystatuscode as long,",
						"          shippingmethodcode as long,",
						"          xpd_availability as long,",
						"          educationcode as long,",
						"          address1_freighttermscode as long,",
						"          ts_quickcaptureuses as string,",
						"          xpd_montagulevel as string,",
						"          ts_permanentinterim as string,",
						"          ts_ircontactrole as string,",
						"          xpd_level as string,",
						"          ts_languagesspokenwritten as string,",
						"          ts_contacttype as string,",
						"          ts_montaguoffice as string,",
						"          ts_roletypes as string,",
						"          xpd_specialisms as string,",
						"          ts_quickcapturesectors as string,",
						"          xpd_function as string,",
						"          ts_producttype as string,",
						"          ts_quickcapturegeography as string,",
						"          ts_productsinterestedin as string,",
						"          ts_potentialrolecandidate as boolean,",
						"          isbackofficecustomer as boolean,",
						"          donotpostalmail as boolean,",
						"          xpd_addcontacttooutlook as boolean,",
						"          ts_centralrelationshipmanager as boolean,",
						"          msdyn_gdproptout as boolean,",
						"          xpd_hascompany as boolean,",
						"          creditonhold as boolean,",
						"          xpd_benchcandidate as boolean,",
						"          donotbulkpostalmail as boolean,",
						"          donotsendmm as boolean,",
						"          donotbulkemail as boolean,",
						"          followemail as boolean,",
						"          xpd_sharepointdocumentlocationcreated as boolean,",
						"          xpd_available as boolean,",
						"          ts_leadearlystageinteraction as boolean,",
						"          participatesinworkflow as boolean,",
						"          ts_doyouwishtotrackthiscontact as boolean,",
						"          merged as boolean,",
						"          ts_validated as boolean,",
						"          marketingonly as boolean,",
						"          donotfax as boolean,",
						"          isprivate as boolean,",
						"          donotphone as boolean,",
						"          isautocreate as boolean,",
						"          donotemail as boolean,",
						"          ts_unconfirmedemailaddress as boolean,",
						"          preferredsystemuserid as string,",
						"          preferredsystemuserid_entitytype as string,",
						"          mpe_accountid as string,",
						"          mpe_accountid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          ts_recommendedby as string,",
						"          ts_recommendedby_entitytype as string,",
						"          ts_previousemployerid as string,",
						"          ts_previousemployerid_entitytype as string,",
						"          preferredserviceid as string,",
						"          preferredserviceid_entitytype as string,",
						"          parentcontactid as string,",
						"          parentcontactid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          ts_pa as string,",
						"          ts_pa_entitytype as string,",
						"          ts_businessaddress as string,",
						"          ts_businessaddress_entitytype as string,",
						"          modifiedbyexternalparty as string,",
						"          modifiedbyexternalparty_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          originatingleadid as string,",
						"          originatingleadid_entitytype as string,",
						"          masterid as string,",
						"          masterid_entitytype as string,",
						"          defaultpricelevelid as string,",
						"          defaultpricelevelid_entitytype as string,",
						"          parent_contactid as string,",
						"          parent_contactid_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          createdbyexternalparty as string,",
						"          createdbyexternalparty_entitytype as string,",
						"          preferredequipmentid as string,",
						"          preferredequipmentid_entitytype as string,",
						"          xpd_referredbyinternal as string,",
						"          xpd_referredbyinternal_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          xpd_homecountry as string,",
						"          xpd_homecountry_entitytype as string,",
						"          ts_placementfirmintroducedby as string,",
						"          ts_placementfirmintroducedby_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          accountid as string,",
						"          accountid_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          parentcustomerid as string,",
						"          parentcustomerid_entitytype as string,",
						"          xpd_referredbyexternal as string,",
						"          xpd_referredbyexternal_entitytype as string,",
						"          aging30 as decimal(38,2),",
						"          creditlimit_base as decimal(38,4),",
						"          aging60 as decimal(38,2),",
						"          aging90 as decimal(38,2),",
						"          aging60_base as decimal(38,4),",
						"          aging90_base as decimal(38,4),",
						"          annualincome_base as decimal(38,4),",
						"          creditlimit as decimal(38,2),",
						"          annualincome as decimal(38,2),",
						"          aging30_base as decimal(38,4),",
						"          ts_othernotes as string,",
						"          xpd_referredbyinternalyominame as string,",
						"          address1_county as string,",
						"          yomilastname as string,",
						"          address3_utcoffset as long,",
						"          ts_recommendedbyname as string,",
						"          description as string,",
						"          li_membertoken as string,",
						"          department as string,",
						"          xpd_roletypes_text as string,",
						"          address1_addressid as string,",
						"          importsequencenumber as long,",
						"          address1_longitude as double,",
						"          address3_fax as string,",
						"          managername as string,",
						"          entityimageid as string,",
						"          telephone2 as string,",
						"          parentcustomeridtype as string,",
						"          address2_upszone as string,",
						"          address1_upszone as string,",
						"          xpd_recommendingportfoliocompaniesrecommended as string,",
						"          lastonholdtime as timestamp,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          address1_fax as string,",
						"          address3_telephone1 as string,",
						"          address3_telephone2 as string,",
						"          address3_telephone3 as string,",
						"          fax as string,",
						"          assistantname as string,",
						"          address2_line3 as string,",
						"          accountidyominame as string,",
						"          parentcontactidyominame as string,",
						"          mpe_accountidyominame as string,",
						"          slainvokedidname as string,",
						"          defaultpricelevelidname as string,",
						"          fullname as string,",
						"          address2_longitude as double,",
						"          subscriptionid as string,",
						"          originatingleadidname as string,",
						"          slaname as string,",
						"          versionnumber as long,",
						"          address1_latitude as double,",
						"          createdbyyominame as string,",
						"          parent_contactidname as string,",
						"          address2_telephone1 as string,",
						"          pager as string,",
						"          salutation as string,",
						"          mpe_accountidname as string,",
						"          xpd_functionuse_text as string,",
						"          accountidname as string,",
						"          mpe_companysummary as string,",
						"          parent_contactidyominame as string,",
						"          preferredserviceidname as string,",
						"          address2_city as string,",
						"          address3_postalcode as string,",
						"          address2_line2 as string,",
						"          li_companyid as long,",
						"          ts_otherphonelabel as string,",
						"          ts_reportingemail as string,",
						"          address3_upszone as string,",
						"          transactioncurrencyidname as string,",
						"          address3_county as string,",
						"          entityimage_url as string,",
						"          governmentid as string,",
						"          callback as string,",
						"          business2 as string,",
						"          createdonbehalfbyname as string,",
						"          ts_validateddate as timestamp,",
						"          address2_telephone2 as string,",
						"          owneridname as string,",
						"          originatingleadidyominame as string,",
						"          ts_otherlanguages as string,",
						"          address2_postalcode as string,",
						"          birthdate as timestamp,",
						"          parentcontactidname as string,",
						"          spousesname as string,",
						"          xpd_compensationdate as timestamp,",
						"          address1_utcoffset as long,",
						"          address3_line1 as string,",
						"          traversedpath as string,",
						"          exchangerate as decimal(38,10),",
						"          mpe_flowlastrundate as timestamp,",
						"          address1_line3 as string,",
						"          address3_country as string,",
						"          mpe_documentsetid as string,",
						"          address2_line1 as string,",
						"          ts_previousemployeridyominame as string,",
						"          middlename as string,",
						"          managerphone as string,",
						"          address2_stateorprovince as string,",
						"          childrensnames as string,",
						"          address2_name as string,",
						"          address3_addressid as string,",
						"          address3_stateorprovince as string,",
						"          ts_sectorspecialtyids as string,",
						"          businesscardattributes as string,",
						"          anniversary as timestamp,",
						"          ts_employmentstartdate as timestamp,",
						"          ts_legacycontacttypes as string,",
						"          address1_primarycontactname as string,",
						"          address2_utcoffset as long,",
						"          home2 as string,",
						"          ts_geographicspecialtyids as string,",
						"          address1_name as string,",
						"          ts_recommendationcomments as string,",
						"          address2_telephone3 as string,",
						"          address3_primarycontactname as string,",
						"          ftpsiteurl as string,",
						"          address1_postalcode as string,",
						"          createdon as string,",
						"          address1_stateorprovince as string,",
						"          yomimiddlename as string,",
						"          jobtitle as string,",
						"          telephone3 as string,",
						"          ts_usesspeciality as string,",
						"          ts_knowntouserinitials as string,",
						"          address2_fax as string,",
						"          createdbyname as string,",
						"          xpd_contactuse_text as string,",
						"          ts_sourceid as string,",
						"          address2_addressid as string,",
						"          employeeid as string,",
						"          address1_postofficebox as string,",
						"          address1_city as string,",
						"          ts_businessaddressname as string,",
						"          teamsfollowed as long,",
						"          ts_cv as string,",
						"          timezoneruleversionnumber as long,",
						"          modifiedonbehalfbyyominame as string,",
						"          xpd_hrcompensation as string,",
						"          ts_currentbonusandorupliftconsiderations as string,",
						"          modifiedbyname as string,",
						"          address3_line2 as string,",
						"          yomifullname as string,",
						"          owneridtype as string,",
						"          entityimage_timestamp as long,",
						"          ts_placementfirmintroducedbyyominame as string,",
						"          xpd_previousrole as string,",
						"          ts_compensation as string,",
						"          address2_postofficebox as string,",
						"          emailaddress3 as string,",
						"          emailaddress2 as string,",
						"          emailaddress1 as string,",
						"          ts_interactioncontactuniqueidentifier as string,",
						"          ts_investmentcafeid as string,",
						"          websiteurl as string,",
						"          nickname as string,",
						"          ts_lastmet as timestamp,",
						"          address3_name as string,",
						"          ts_usesspecialtyids as string,",
						"          ts_linkedinurl as string,",
						"          lastname as string,",
						"          address3_longitude as double,",
						"          xpd_referredbyexternalidtype as string,",
						"          parentcustomeridname as string,",
						"          owningbusinessunitname as string,",
						"          onholdtime as long,",
						"          createdonbehalfbyyominame as string,",
						"          preferredsystemuseridyominame as string,",
						"          createdbyexternalpartyname as string,",
						"          ts_tone as string,",
						"          telephone1 as string,",
						"          overriddencreatedon as timestamp,",
						"          address3_postofficebox as string,",
						"          assistantphone as string,",
						"          address1_composite as string,",
						"          address3_line3 as string,",
						"          address2_country as string,",
						"          xpd_referredbyinternalname as string,",
						"          mobilephone as string,",
						"          owneridyominame as string,",
						"          address1_line1 as string,",
						"          createdbyexternalpartyyominame as string,",
						"          xpd_referredbyexternalyominame as string,",
						"          yomifirstname as string,",
						"          mastercontactidname as string,",
						"          address3_city as string,",
						"          address1_country as string,",
						"          externaluseridentifier as string,",
						"          modifiedbyexternalpartyyominame as string,",
						"          firstname as string,",
						"          xpd_hrcurrentbonusandorupliftconsiderations as string,",
						"          stageid as string,",
						"          modifiedonbehalfbyname as string,",
						"          xpd_homecountryname as string,",
						"          mastercontactidyominame as string,",
						"          suffix as string,",
						"          ts_payominame as string,",
						"          lastusedincampaign as timestamp,",
						"          ts_geographicspeciality as string,",
						"          xpd_recruitmentareateam_text as string,",
						"          ts_retentionreviewdate as timestamp,",
						"          parentcustomeridyominame as string,",
						"          timespentbymeonemailandmeetings as string,",
						"          address2_latitude as double,",
						"          xpd_availablefrom as timestamp,",
						"          address3_composite as string,",
						"          xpd_recommendingportco as string,",
						"          preferredsystemuseridname as string,",
						"          utcconversiontimezonecode as long,",
						"          address2_county as string,",
						"          ts_paname as string,",
						"          contactid as string,",
						"          address2_primarycontactname as string,",
						"          ts_specificareasofexpertisecomments as string,",
						"          address1_line2 as string,",
						"          ts_recommendationofindividualupdated as timestamp,",
						"          xpd_referredbyexternalname as string,",
						"          ts_placementfirmintroducedbyname as string,",
						"          ts_sectorspeciality as string,",
						"          ts_previousemployeridname as string,",
						"          processid as string,",
						"          ts_recommendedbyyominame as string,",
						"          modifiedon as timestamp,",
						"          modifiedbyexternalpartyname as string,",
						"          ts_relevantsituations as string,",
						"          businesscard as string,",
						"          company as string,",
						"          preferredequipmentidname as string,",
						"          modifiedbyyominame as string,",
						"          ts_preferredname as string,",
						"          address2_composite as string,",
						"          numberofchildren as long,",
						"          address3_latitude as double,",
						"          mpe_companysearchbyemail as boolean,",
						"          msdyn_segmentid as string,",
						"          msdyn_segmentid_entitytype as string,",
						"          msdyn_segmentidname as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'contact') ~> ContactsIn",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          address1_addresstypecode as long,",
						"          address1_shippingmethodcode as long,",
						"          azurestate as long,",
						"          invitestatuscode as long,",
						"          preferredaddresscode as long,",
						"          preferredemailcode as long,",
						"          outgoingemaildeliverymethod as long,",
						"          preferredphonecode as long,",
						"          emailrouteraccessapproval as long,",
						"          deletedstate as long,",
						"          incomingemaildeliverymethod as long,",
						"          accessmode as long,",
						"          caltype as long,",
						"          address2_addresstypecode as long,",
						"          address2_shippingmethodcode as long,",
						"          setupuser as boolean,",
						"          islicensed as boolean,",
						"          defaultfilterspopulated as boolean,",
						"          isactivedirectoryuser as boolean,",
						"          displayinserviceviews as boolean,",
						"          msdyn_gdproptout as boolean,",
						"          isdisabled as boolean,",
						"          isintegrationuser as boolean,",
						"          isemailaddressapprovedbyo365admin as boolean,",
						"          issyncwithdirectory as boolean,",
						"          calendarid as string,",
						"          calendarid_entitytype as string,",
						"          mobileofflineprofileid as string,",
						"          mobileofflineprofileid_entitytype as string,",
						"          queueid as string,",
						"          queueid_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          territoryid as string,",
						"          territoryid_entitytype as string,",
						"          defaultmailbox as string,",
						"          defaultmailbox_entitytype as string,",
						"          positionid as string,",
						"          positionid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          siteid as string,",
						"          siteid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          parentsystemuserid as string,",
						"          parentsystemuserid_entitytype as string,",
						"          businessunitid as string,",
						"          businessunitid_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          traversedpath as string,",
						"          azureactivedirectoryobjectid as string,",
						"          address1_line1 as string,",
						"          internalemailaddress as string,",
						"          siteidname as string,",
						"          modifiedon as timestamp,",
						"          address1_line3 as string,",
						"          skills as string,",
						"          yomifirstname as string,",
						"          address1_longitude as double,",
						"          yomifullname as string,",
						"          entityimage_timestamp as long,",
						"          parentsystemuseridname as string,",
						"          address2_county as string,",
						"          transactioncurrencyidname as string,",
						"          activedirectoryguid as string,",
						"          utcconversiontimezonecode as long,",
						"          passporthi as long,",
						"          homephone as string,",
						"          parentsystemuseridyominame as string,",
						"          address2_stateorprovince as string,",
						"          mobilephone as string,",
						"          address2_country as string,",
						"          address2_line2 as string,",
						"          disabledreason as string,",
						"          lastname as string,",
						"          address1_city as string,",
						"          address1_utcoffset as long,",
						"          userlicensetype as long,",
						"          nickname as string,",
						"          passportlo as long,",
						"          title as string,",
						"          address2_latitude as double,",
						"          applicationid as string,",
						"          address1_composite as string,",
						"          firstname as string,",
						"          address2_postalcode as string,",
						"          employeeid as string,",
						"          processid as string,",
						"          mobileofflineprofileidname as string,",
						"          governmentid as string,",
						"          entityimage_url as string,",
						"          address2_line3 as string,",
						"          azuredeletedon as timestamp,",
						"          timezoneruleversionnumber as long,",
						"          address1_county as string,",
						"          address2_telephone2 as string,",
						"          address2_postofficebox as string,",
						"          address2_telephone1 as string,",
						"          yomilastname as string,",
						"          address2_telephone3 as string,",
						"          address1_addressid as string,",
						"          territoryidname as string,",
						"          overriddencreatedon as timestamp,",
						"          userpuid as string,",
						"          createdonbehalfbyname as string,",
						"          systemuserid as string,",
						"          address2_name as string,",
						"          middlename as string,",
						"          entityimageid as string,",
						"          applicationiduri as string,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          address2_composite as string,",
						"          address1_country as string,",
						"          mobilealertemail as string,",
						"          sharepointemailaddress as string,",
						"          businessunitidname as string,",
						"          address1_stateorprovince as string,",
						"          exchangerate as decimal(38,10),",
						"          jobtitle as string,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          latestupdatetime as timestamp,",
						"          address1_postofficebox as string,",
						"          organizationid as string,",
						"          yammeremailaddress as string,",
						"          defaultmailboxname as string,",
						"          identityid as long,",
						"          yomimiddlename as string,",
						"          address2_utcoffset as long,",
						"          photourl as string,",
						"          personalemailaddress as string,",
						"          address2_addressid as string,",
						"          address2_longitude as double,",
						"          createdon as string,",
						"          createdbyname as string,",
						"          domainname as string,",
						"          modifiedbyyominame as string,",
						"          address2_fax as string,",
						"          address1_line2 as string,",
						"          modifiedonbehalfbyyominame as string,",
						"          address2_upszone as string,",
						"          salutation as string,",
						"          address1_postalcode as string,",
						"          stageid as string,",
						"          defaultodbfoldername as string,",
						"          positionidname as string,",
						"          ts_inititals as string,",
						"          yammeruserid as string,",
						"          importsequencenumber as long,",
						"          address2_city as string,",
						"          windowsliveid as string,",
						"          organizationidname as string,",
						"          versionnumber as long,",
						"          queueidname as string,",
						"          address1_name as string,",
						"          address1_fax as string,",
						"          address1_latitude as double,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          address2_line1 as string,",
						"          address1_upszone as string,",
						"          fullname as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'systemuser') ~> SystemuserSource",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          stateAZlabel as string,",
						"          statusAZlabel as string,",
						"          ts_primarysecondaryfocus as string,",
						"          customertypeAZlabel as string,",
						"          address1_addresstypeAZlabel as string,",
						"          accountclassificationAZlabel as string,",
						"          ts_easeofworking as string,",
						"          ts_ukrow as string,",
						"          preferredappointmenttimeAZlabel as string,",
						"          ts_address1addresstype as string,",
						"          xpd_relationshipstatus as string,",
						"          ts_relationship as string,",
						"          xpd_remindermonths as string,",
						"          ts_importance as string,",
						"          address2_freighttermsAZlabel as string,",
						"          ts_irrvsmomperformancemeasure as string,",
						"          ts_introducertype as string,",
						"          accountcategoryAZlabel as string,",
						"          paymenttermsAZlabel as string,",
						"          preferredappointmentdayAZlabel as string,",
						"          businesstypeAZlabel as string,",
						"          industryAZlabel as string,",
						"          ts_sizeoffirm as string,",
						"          ts_interaction as string,",
						"          address1_shippingmethodAZlabel as string,",
						"          ts_portfoliocompanystatus as string,",
						"          customersizeAZlabel as string,",
						"          xpd_previousinvestorstatus as string,",
						"          ts_recommendationoffirm as string,",
						"          preferredcontactmethodAZlabel as string,",
						"          accountratingAZlabel as string,",
						"          ts_investorstatus as string,",
						"          ts_capabilitiesoffirm as string,",
						"          mpe_flowlastrunoutcome as string,",
						"          address2_addresstypeAZlabel as string,",
						"          address2_shippingmethodAZlabel as string,",
						"          ts_nextoriginationmeetingarranged as string,",
						"          ownershipAZlabel as string,",
						"          territoryAZlabel as string,",
						"          ts_investortype as string,",
						"          shippingmethodAZlabel as string,",
						"          ts_investorregion as string,",
						"          address1_freighttermsAZlabel as string,",
						"          xpd_function as string,",
						"          ts_quickcaptureuses as string,",
						"          xpd_montagulevel as string,",
						"          ts_permanentinterim as string,",
						"          ts_quickcapturesectors as string,",
						"          ts_roletypes as string,",
						"          ts_companytype as string,",
						"          xpd_level as string,",
						"          ts_indicativeclientbase as string,",
						"          xpd_specialisms as string,",
						"          ts_vendorsummary as string,",
						"          ts_producttype as string,",
						"          ts_montaguoffice as string,",
						"          ts_quickcapturegeography as string,",
						"          xpd_roletypes as string,",
						"          mpe_livedeal as string,",
						"          donotbulkpostalmail as string,",
						"          donotpostalmail as string,",
						"          msdyn_gdproptout as string,",
						"          ts_organisationalchange as string,",
						"          xpd_publictoprivatetracker as string,",
						"          ts_auditor as string,",
						"          donotsendmm as string,",
						"          donotbulkemail as string,",
						"          followemail as string,",
						"          creditonhold as string,",
						"          marketingonly as string,",
						"          participatesinworkflow as string,",
						"          merged as string,",
						"          ts_validated as string,",
						"          xpd_sharepointlocationcreated as string,",
						"          xpd_setreminder as string,",
						"          ts_personnelchange as string,",
						"          donotfax as string,",
						"          isprivate as string,",
						"          donotphone as string,",
						"          xpd_rpo as string,",
						"          ts_trackcompany as string,",
						"          donotemail as string,",
						"          parentaccountid as string,",
						"          parentaccountid_entitytype as string,",
						"          ts_recommendedby as string,",
						"          ts_recommendedby_entitytype as string,",
						"          ts_countryofeconomicoriginforthecapital as string,",
						"          ts_countryofeconomicoriginforthecapital_entitytype as string,",
						"          xpd_reminderto as string,",
						"          xpd_reminderto_entitytype as string,",
						"          preferredserviceid as string,",
						"          preferredserviceid_entitytype as string,",
						"          msdyn_segmentid as string,",
						"          msdyn_segmentid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          createdbyexternalparty as string,",
						"          createdbyexternalparty_entitytype as string,",
						"          ts_validatedby as string,",
						"          ts_validatedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          ts_primarymperelationshipmanager as string,",
						"          ts_primarymperelationshipmanager_entitytype as string,",
						"          modifiedbyexternalparty as string,",
						"          modifiedbyexternalparty_entitytype as string,",
						"          ts_headofficeid as string,",
						"          ts_headofficeid_entitytype as string,",
						"          ts_address1country as string,",
						"          ts_address1country_entitytype as string,",
						"          ts_address1usstate as string,",
						"          ts_address1usstate_entitytype as string,",
						"          msdyn_salesaccelerationinsightid as string,",
						"          msdyn_salesaccelerationinsightid_entitytype as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          originatingleadid as string,",
						"          originatingleadid_entitytype as string,",
						"          masterid as string,",
						"          masterid_entitytype as string,",
						"          ts_originationlead1 as string,",
						"          ts_originationlead1_entitytype as string,",
						"          defaultpricelevelid as string,",
						"          defaultpricelevelid_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          ts_originationlead2 as string,",
						"          ts_originationlead2_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          mpe_coinvestquestionnaireid as string,",
						"          mpe_coinvestquestionnaireid_entitytype as string,",
						"          ts_hub as string,",
						"          ts_hub_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          ts_currentauditor as string,",
						"          ts_currentauditor_entitytype as string,",
						"          primarycontactid as string,",
						"          primarycontactid_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          preferredsystemuserid as string,",
						"          preferredsystemuserid_entitytype as string,",
						"          preferredequipmentid as string,",
						"          preferredequipmentid_entitytype as string,",
						"          xpd_fund as string,",
						"          xpd_fund_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          territoryid as string,",
						"          territoryid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          xpd_totalinstitutionalcommitments_base as decimal(38,0),",
						"          ts_minimumticketsize_base as decimal(38,4),",
						"          xpd_totalinstitutionalcommitments as decimal(38,0),",
						"          aging30 as decimal(38,0),",
						"          creditlimit as decimal(38,0),",
						"          creditlimit_base as decimal(38,0),",
						"          ts_totalcommitments_base as decimal(38,4),",
						"          aging60 as decimal(38,0),",
						"          ts_transfersin_base as decimal(38,0),",
						"          aging90 as decimal(38,0),",
						"          ts_maximumticketsize as decimal(38,4),",
						"          ts_totalaum_base as decimal(38,0),",
						"          marketcap_base as decimal(38,0),",
						"          aging60_base as decimal(38,0),",
						"          aging90_base as decimal(38,0),",
						"          ts_transfersout as decimal(38,0),",
						"          ts_maximumticketsize_base as decimal(38,4),",
						"          ts_originalcommitments_base as decimal(38,0),",
						"          revenue as decimal(38,0),",
						"          ts_totalcommitments as decimal(38,4),",
						"          ts_transfersout_base as decimal(38,0),",
						"          ts_totalaum as decimal(38,0),",
						"          ts_commitmentreductions_base as decimal(38,0),",
						"          ts_commitmentreductions as decimal(38,0),",
						"          marketcap as decimal(38,0),",
						"          ts_originalcommitments as decimal(38,0),",
						"          ts_minimumticketsize as decimal(38,4),",
						"          revenue_base as decimal(38,0),",
						"          openrevenue_base as decimal(38,0),",
						"          aging30_base as decimal(38,0),",
						"          openrevenue as decimal(38,0),",
						"          ts_transfersin as decimal(38,0),",
						"          ts_othernotes as string,",
						"          ts_transfersin_date as timestamp,",
						"          msdyn_salesaccelerationinsightidname as string,",
						"          address1_county as string,",
						"          openrevenue_date as timestamp,",
						"          ts_recommendedbyname as string,",
						"          ts_relationshipinteractioncomments as string,",
						"          ts_originationlead2yominame as string,",
						"          parentaccountidname as string,",
						"          xpd_roletypes_text as string,",
						"          address1_addressid as string,",
						"          importsequencenumber as long,",
						"          address1_longitude as double,",
						"          ts_countryofeconomicoriginforthecapitalname as string,",
						"          entityimageid as string,",
						"          telephone2 as string,",
						"          ts_lastoriginationmeeting as timestamp,",
						"          address2_utcoffset as long,",
						"          address1_upszone as string,",
						"          ts_originalcommitments_state as long,",
						"          ts_typicalcost as string,",
						"          xpd_recommendingportfoliocompaniesrecommended as string,",
						"          accountnumber as string,",
						"          ts_currentauditoryominame as string,",
						"          ts_originalcommitments_date as timestamp,",
						"          lastonholdtime as timestamp,",
						"          ts_sectorscoveredbyfirm as string,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          address2_upszone as string,",
						"          opendeals_state as long,",
						"          xpd_functionuse_text as string,",
						"          slainvokedidname as string,",
						"          address2_longitude as double,",
						"          defaultpricelevelidname as string,",
						"          stockexchange as string,",
						"          mpe_liveofferingscount_date as timestamp,",
						"          xpd_relationshipcomments as string,",
						"          originatingleadidname as string,",
						"          slaname as string,",
						"          ts_currentauditorname as string,",
						"          xpd_remindertoyominame as string,",
						"          ts_address1usstatename as string,",
						"          ts_tempcompanytype as string,",
						"          versionnumber as long,",
						"          address1_latitude as double,",
						"          ts_formername as string,",
						"          yominame as string,",
						"          createdbyyominame as string,",
						"          ts_cityofvisit as string,",
						"          address2_telephone1 as string,",
						"          ts_globalgeographiescoveredids as string,",
						"          preferredserviceidname as string,",
						"          address2_city as string,",
						"          ts_mpeapproachstrategy as string,",
						"          address2_line2 as string,",
						"          ts_lastdatestatuschanged as timestamp,",
						"          li_companyid as long,",
						"          transactioncurrencyidname as string,",
						"          entityimage_url as string,",
						"          xpd_relationshipstatuschangeddate as timestamp,",
						"          createdonbehalfbyname as string,",
						"          mpe_liveofferingscount_state as long,",
						"          xpd_numberofcoinvestinvestments_date as timestamp,",
						"          ts_validateddate as timestamp,",
						"          owneridname as string,",
						"          xpd_generalcomments as string,",
						"          ts_companylegalname as string,",
						"          description as string,",
						"          ts_validatedbyname as string,",
						"          originatingleadidyominame as string,",
						"          opendeals as long,",
						"          xpd_numberofopportunitiesshown_state as long,",
						"          address2_postalcode as string,",
						"          websiteurl as string,",
						"          xpd_fundname as string,",
						"          address1_utcoffset as long,",
						"          exchangerate as decimal(38,10),",
						"          mpe_flowlastrundate as timestamp,",
						"          fax as string,",
						"          address1_line3 as string,",
						"          ts_monthssincelastmeeting as long,",
						"          ts_hubname as string,",
						"          address2_line1 as string,",
						"          ts_capiqticket as string,",
						"          address2_stateorprovince as string,",
						"          address2_name as string,",
						"          ts_transfersout_state as long,",
						"          xpd_numberofopportunitiesshown as long,",
						"          primarytwitterid as string,",
						"          mpe_coinvestquestionnaireidname as string,",
						"          xpd_numberofopportunitiesshown_date as timestamp,",
						"          xpd_preferentialterms as string,",
						"          address1_primarycontactname as string,",
						"          territoryidname as string,",
						"          ts_processstatus as string,",
						"          address1_name as string,",
						"          address2_telephone2 as string,",
						"          address2_telephone3 as string,",
						"          xpd_recruitmentareateam_text as string,",
						"          ftpsiteurl as string,",
						"          address1_postalcode as string,",
						"          ts_companynumber as string,",
						"          createdon as string,",
						"          mpe_liveofferingscount as long,",
						"          traversedpath as string,",
						"          address1_stateorprovince as string,",
						"          ts_transfersin_state as long,",
						"          address2_addressid as string,",
						"          ts_monthlyreviewmeetingname as string,",
						"          primarysatoriid as string,",
						"          telephone3 as string,",
						"          openrevenue_state as long,",
						"          ts_usesprovidedids as string,",
						"          ts_originationcomments as string,",
						"          lastusedincampaign as timestamp,",
						"          primarycontactidname as string,",
						"          ts_originationlead1name as string,",
						"          ts_headofficeidname as string,",
						"          msdyn_segmentidname as string,",
						"          ts_montagucomments as string,",
						"          address2_fax as string,",
						"          createdbyname as string,",
						"          xpd_numberofcoinvestinvestments as long,",
						"          ts_capitaliqlink as string,",
						"          ts_primarymperelationshipmanagername as string,",
						"          mpe_relationshipstatus_text as string,",
						"          xpd_datereminderwasset as timestamp,",
						"          xpd_numberofcoinvestinvestments_state as long,",
						"          address1_postofficebox as string,",
						"          address1_city as string,",
						"          teamsfollowed as long,",
						"          ts_originationlead2name as string,",
						"          timezoneruleversionnumber as long,",
						"          modifiedonbehalfbyyominame as string,",
						"          entityimage_timestamp as long,",
						"          tickersymbol as string,",
						"          ts_theirprogrammecomments as string,",
						"          xpd_companyuse_text as string,",
						"          modifiedbyname as string,",
						"          owneridtype as string,",
						"          sic as string,",
						"          sharesoutstanding as long,",
						"          opendeals_date as timestamp,",
						"          address2_postofficebox as string,",
						"          emailaddress3 as string,",
						"          emailaddress2 as string,",
						"          emailaddress1 as string,",
						"          ts_globalgeographiescoveredbyfirm as string,",
						"          ts_recommendationoffirmupdated as timestamp,",
						"          ts_lastmet as timestamp,",
						"          ts_reminderdatesetto as timestamp,",
						"          ts_commitmentreductions_state as long,",
						"          owningbusinessunitname as string,",
						"          onholdtime as long,",
						"          ts_alias as string,",
						"          createdonbehalfbyyominame as string,",
						"          ts_transfersout_date as timestamp,",
						"          ts_address1countryname as string,",
						"          preferredsystemuseridyominame as string,",
						"          createdbyexternalpartyname as string,",
						"          mpe_documentsetid as string,",
						"          telephone1 as string,",
						"          ts_legacycompanytypes as string,",
						"          ts_validatedbyyominame as string,",
						"          address1_composite as string,",
						"          ts_investorgroupgatekeeperid as string,",
						"          primarycontactidyominame as string,",
						"          address2_country as string,",
						"          xpd_recommendationcomments as string,",
						"          owneridyominame as string,",
						"          createdbyexternalpartyyominame as string,",
						"          ts_originationlead1yominame as string,",
						"          ts_usesprovidedbyfirm as string,",
						"          xpd_recommendingportco as string,",
						"          address1_country as string,",
						"          ts_commitmentreductions_date as timestamp,",
						"          name as string,",
						"          modifiedbyexternalpartyyominame as string,",
						"          xpd_remindertoname as string,",
						"          stageid as string,",
						"          modifiedonbehalfbyname as string,",
						"          masteraccountidname as string,",
						"          timespentbymeonemailandmeetings as string,",
						"          address2_latitude as double,",
						"          overriddencreatedon as timestamp,",
						"          parentaccountidyominame as string,",
						"          ts_specificareaofexpertisecomments as string,",
						"          preferredsystemuseridname as string,",
						"          utcconversiontimezonecode as long,",
						"          address2_county as string,",
						"          address1_line1 as string,",
						"          address2_primarycontactname as string,",
						"          address1_line2 as string,",
						"          xpd_reasonaction as string,",
						"          ts_primarymperelationshipmanageryominame as string,",
						"          processid as string,",
						"          ts_sectorscoveredids as string,",
						"          ts_recommendedbyyominame as string,",
						"          modifiedbyexternalpartyname as string,",
						"          ts_relevantsituations as string,",
						"          accountid as string,",
						"          modifiedon as timestamp,",
						"          preferredequipmentidname as string,",
						"          modifiedbyyominame as string,",
						"          ts_dealstageofmostrecentopportunity as string,",
						"          address2_composite as string,",
						"          masteraccountidyominame as string,",
						"          numberofemployees as long,",
						"          address1_fax as string,",
						"          address2_line3 as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'account',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: false) ~> EnrichedAccount",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          stateAZlabel as string,",
						"          statusAZlabel as string,",
						"          ts_dealannouncedreason as string,",
						"          ts_highprioritynew as string,",
						"          ts_actionstatus as string,",
						"          mpe_targetrelationshipstatus as string,",
						"          mpe_carveout as string,",
						"          ts_producttype as string,",
						"          ts_internalintermediarysource as string,",
						"          mpe_flowlastrunoutcome as string,",
						"          ts_currentactivity as string,",
						"          ts_opportunitystatus as string,",
						"          ts_montaguprimaryoffice as string,",
						"          ts_opportunitytype as string,",
						"          ts_posthumstatus as string,",
						"          ts_meetingremindermonths as string,",
						"          ts_choppedreason as string,",
						"          ts_setreminder as string,",
						"          ts_stagereachedfir as string,",
						"          ts_stagereachedipr as string,",
						"          ts_duplicateopportunityfordiscussion as string,",
						"          mpe_smalltarget as string,",
						"          ts_stagereachedcr as string,",
						"          xpd_includeonallpapers as string,",
						"          ts_sold as string,",
						"          xpd_sharepointlocationcreated as string,",
						"          ts_statuschangedby as string,",
						"          ts_statuschangedby_entitytype as string,",
						"          ts_buyer as string,",
						"          ts_buyer_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          ts_reminderto as string,",
						"          ts_reminderto_entitytype as string,",
						"          mpe_productid as string,",
						"          mpe_productid_entitytype as string,",
						"          ts_targetbusiness as string,",
						"          ts_targetbusiness_entitytype as string,",
						"          ts_firstreferralcompany as string,",
						"          ts_firstreferralcompany_entitytype as string,",
						"          ts_deallead as string,",
						"          ts_deallead_entitytype as string,",
						"          ts_montaguowner as string,",
						"          ts_montaguowner_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          ts_firstreferralcontact as string,",
						"          ts_firstreferralcontact_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ts_managerwedback as string,",
						"          ts_managerwedback_entitytype as string,",
						"          ts_country as string,",
						"          ts_country_entitytype as string,",
						"          mpe_targetbusiness_parentid as string,",
						"          mpe_targetbusiness_parentid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          ts_sellmandate as string,",
						"          ts_sellmandate_entitytype as string,",
						"          ts_estebitda_base as decimal(38,4),",
						"          ts_estebit_base as decimal(38,4),",
						"          ts_estebitda as decimal(38,4),",
						"          ts_estebit as decimal(38,4),",
						"          ts_estturnover_base as decimal(38,4),",
						"          ts_estdealsize as decimal(38,4),",
						"          ts_estdealsize_base as decimal(38,4),",
						"          ts_estturnover as decimal(38,4),",
						"          ts_buyeryominame as string,",
						"          modifiedon as timestamp,",
						"          ts_statuschangedbyname as string,",
						"          ts_managerwedbackyominame as string,",
						"          xpd_montaguprojectname as string,",
						"          transactioncurrencyidname as string,",
						"          ts_nextsteps as string,",
						"          ts_montaguowneryominame as string,",
						"          ts_firstreferralcontactname as string,",
						"          ts_opportunitydescription as string,",
						"          ts_buyerpaidxltmebitda as decimal(38,1),",
						"          ts_targetbusinessyominame as string,",
						"          ts_montaguownername as string,",
						"          ts_managerwedbackname as string,",
						"          ts_opportunitystage as string,",
						"          ts_otherdocumentsurl as string,",
						"          exchangerate as decimal(38,10),",
						"          mpe_documentsetid as string,",
						"          ts_buyername as string,",
						"          ts_firstreferralcontactyominame as string,",
						"          createdon as string,",
						"          ts_sellmandateyominame as string,",
						"          mpe_montaguprimaryofficestring as string,",
						"          ts_statuschangedbyyominame as string,",
						"          ts_firstreferralcompanyname as string,",
						"          owneridyominame as string,",
						"          ts_choppedcomments as string,",
						"          timezoneruleversionnumber as long,",
						"          createdbyname as string,",
						"          ts_dealleadname as string,",
						"          owningbusinessunitname as string,",
						"          ts_dealleadyominame as string,",
						"          ts_lastdatestatuschanged as timestamp,",
						"          traversedpath as string,",
						"          overriddencreatedon as timestamp,",
						"          ts_iprdocumenturl as string,",
						"          createdonbehalfbyname as string,",
						"          ts_sellmandatename as string,",
						"          owneridtype as string,",
						"          owneridname as string,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          mpe_productidname as string,",
						"          mpe_targetbusiness_parentidyominame as string,",
						"          ts_originationopportunityid as string,",
						"          ts_crdocumenturl as string,",
						"          ts_datedealannounced as timestamp,",
						"          processid as string,",
						"          mpe_montaguprimaryofficeowner as string,",
						"          ts_reason as string,",
						"          ts_targetbusinessname as string,",
						"          ts_remindertoname as string,",
						"          ts_postcompletionnoteurl as string,",
						"          ts_name as string,",
						"          stageid as string,",
						"          ts_currentopportunitystatus as string,",
						"          ts_firstreferralcompanyyominame as string,",
						"          mpe_flowlastrundate as timestamp,",
						"          ts_firdocumenturl as string,",
						"          modifiedbyyominame as string,",
						"          modifiedonbehalfbyyominame as string,",
						"          ts_movedoutofwipdate as timestamp,",
						"          ts_equitychequesize as decimal(38,2),",
						"          utcconversiontimezonecode as long,",
						"          mpe_targetbusiness_parentidname as string,",
						"          ts_weofferedxltmebitda as decimal(38,1),",
						"          importsequencenumber as long,",
						"          ts_remindertoyominame as string,",
						"          ts_companyid as long,",
						"          ts_datereminderwasset as timestamp,",
						"          versionnumber as long,",
						"          ts_originationid as long,",
						"          ts_countryname as string,",
						"          ts_choppeddate as timestamp,",
						"          mpe_posthunstatustext as string,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          ts_humdate as timestamp,",
						"          ts_sellmandateidtype as string,",
						"          ts_dateofreminder as timestamp,",
						"          ts_humurl as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'ts_originationopportunity',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: false) ~> EnrichedOriginationOpportunities",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          stateAZlabel as string,",
						"          statusAZlabel as string,",
						"          ts_stageofmeetingrounds as string,",
						"          ts_talentmeetingtype as string,",
						"          instancetypeAZlabel as string,",
						"          ts_whooriginatedthemeeting as string,",
						"          onlinemeetingtype as string,",
						"          ts_meetingteam as string,",
						"          ts_othermeetingmethod as string,",
						"          ts_tone as string,",
						"          ts_meetingmethod as string,",
						"          ts_originationmeetingtype as string,",
						"          priorityAZlabel as string,",
						"          attachmenterrors as string,",
						"          ts_eventtype as string,",
						"          ts_talentmeetingmethod as string,",
						"          ts_productsdiscussed as string,",
						"          ts_contentcovered as string,",
						"          isonlinemeeting as string,",
						"          isworkflowcreated as string,",
						"          isalldayevent as string,",
						"          ts_interview as string,",
						"          isbilled as string,",
						"          isdraft as string,",
						"          ts_keyiractivity as string,",
						"          ts_noninvestor as string,",
						"          ismapiprivate as string,",
						"          isregularactivity as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          ts_investorgroup as string,",
						"          ts_investorgroup_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          regardingobjectid as string,",
						"          regardingobjectid_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ts_officemet as string,",
						"          ts_officemet_entitytype as string,",
						"          ts_taskowner as string,",
						"          ts_taskowner_entitytype as string,",
						"          serviceid as string,",
						"          serviceid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          requiredattendees as string,",
						"          optionalattendees as string,",
						"          organizer as string,",
						"          scheduledend as timestamp,",
						"          ts_taskdescription as string,",
						"          modifiedon as timestamp,",
						"          ts_purpose as string,",
						"          overriddencreatedon as timestamp,",
						"          ts_taskownername as string,",
						"          activityadditionalparams as string,",
						"          ts_tonepersonalities as string,",
						"          seriesid as string,",
						"          transactioncurrencyidname as string,",
						"          activityid as string,",
						"          modifiedfieldsmask as string,",
						"          utcconversiontimezonecode as long,",
						"          ts_officemetname as string,",
						"          scheduledstart as timestamp,",
						"          outlookownerapptid as long,",
						"          ts_topicscovered as string,",
						"          ts_objective as string,",
						"          onholdtime as long,",
						"          onlinemeetingjoinurl as string,",
						"          ts_notes as string,",
						"          originalstartdate as timestamp,",
						"          ts_opportunitiesdiscussed as string,",
						"          ts_sectorscoveredbyfirm as string,",
						"          attachmentcount as long,",
						"          exchangerate as decimal(38,10),",
						"          ts_originationcommentsnotes as string,",
						"          category as string,",
						"          createdon as string,",
						"          ts_eventdescription as string,",
						"          globalobjectid as string,",
						"          onlinemeetingid as string,",
						"          serviceidname as string,",
						"          owneridyominame as string,",
						"          description as string,",
						"          subcategory as string,",
						"          owningbusinessunitname as string,",
						"          ts_taskduedate as timestamp,",
						"          traversedpath as string,",
						"          sortdate as timestamp,",
						"          createdonbehalfbyname as string,",
						"          ts_sectorscoveredids as string,",
						"          safedescription as string,",
						"          ts_taskowneryominame as string,",
						"          owneridtype as string,",
						"          isunsafe as long,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          ts_conferencename as string,",
						"          timezoneruleversionnumber as long,",
						"          actualend as timestamp,",
						"          regardingobjectidname as string,",
						"          processid as string,",
						"          activitytypecode as string,",
						"          actualstart as timestamp,",
						"          xpd_listofexternalattendees as string,",
						"          slainvokedidname as string,",
						"          location as string,",
						"          subject as string,",
						"          createdbyname as string,",
						"          actualdurationminutes as long,",
						"          modifiedbyyominame as string,",
						"          lastonholdtime as timestamp,",
						"          modifiedonbehalfbyyominame as string,",
						"          ts_attendeestoaddtocrm as string,",
						"          regardingobjectidyominame as string,",
						"          regardingobjecttypecode as string,",
						"          stageid as string,",
						"          scheduleddurationminutes as long,",
						"          ts_sourceid as string,",
						"          ts_investorgroupyominame as string,",
						"          importsequencenumber as long,",
						"          subscriptionid as string,",
						"          onlinemeetingchatid as string,",
						"          ts_lpupdates as string,",
						"          ts_executivesummary as string,",
						"          ts_investorgroupname as string,",
						"          ts_meetingcity as string,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          owneridname as string,",
						"          ts_theirprogramme as string,",
						"          ts_ifdeclinedreason as string,",
						"          slaname as string,",
						"          versionnumber as long",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'appointment',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: false) ~> EnrichedMeetingAppointments",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          stateAZlabel as string,",
						"          statusAZlabel as string,",
						"          haschildrenAZlabel as string,",
						"          customertypeAZlabel as string,",
						"          ts_recommendationofindividual as string,",
						"          genderAZlabel as string,",
						"          address1_addresstypeAZlabel as string,",
						"          leadsourceAZlabel as string,",
						"          preferredappointmenttimeAZlabel as string,",
						"          address2_freighttermsAZlabel as string,",
						"          address2_shippingmethodAZlabel as string,",
						"          ts_debtsubtype as string,",
						"          msdyn_orgchangestatus as string,",
						"          ts_suffix as string,",
						"          xpd_gender as string,",
						"          ts_title as string,",
						"          paymenttermsAZlabel as string,",
						"          accountroleAZlabel as string,",
						"          territoryAZlabel as string,",
						"          ts_vendortargettrackingrole as string,",
						"          address3_freighttermsAZlabel as string,",
						"          address1_shippingmethodAZlabel as string,",
						"          preferredappointmentdayAZlabel as string,",
						"          customersizeAZlabel as string,",
						"          preferredcontactmethodAZlabel as string,",
						"          ts_futurecontactmethod as string,",
						"          address3_shippingmethodAZlabel as string,",
						"          address2_addresstypeAZlabel as string,",
						"          mpe_flowlastrunoutcome as string,",
						"          ts_capabilitiesofindividual as string,",
						"          address3_addresstypeAZlabel as string,",
						"          familystatusAZlabel as string,",
						"          shippingmethodAZlabel as string,",
						"          xpd_availability as string,",
						"          educationAZlabel as string,",
						"          address1_freighttermsAZlabel as string,",
						"          ts_quickcaptureuses as string,",
						"          xpd_montagulevel as string,",
						"          ts_permanentinterim as string,",
						"          ts_ircontactrole as string,",
						"          xpd_level as string,",
						"          ts_languagesspokenwritten as string,",
						"          ts_contacttype as string,",
						"          ts_montaguoffice as string,",
						"          ts_roletypes as string,",
						"          xpd_specialisms as string,",
						"          ts_quickcapturesectors as string,",
						"          xpd_function as string,",
						"          ts_producttype as string,",
						"          ts_quickcapturegeography as string,",
						"          ts_productsinterestedin as string,",
						"          ts_potentialrolecandidate as string,",
						"          isbackofficecustomer as string,",
						"          donotpostalmail as string,",
						"          xpd_addcontacttooutlook as string,",
						"          ts_centralrelationshipmanager as string,",
						"          msdyn_gdproptout as string,",
						"          xpd_hascompany as string,",
						"          creditonhold as string,",
						"          xpd_benchcandidate as string,",
						"          donotbulkpostalmail as string,",
						"          donotsendmm as string,",
						"          donotbulkemail as string,",
						"          followemail as string,",
						"          xpd_sharepointdocumentlocationcreated as string,",
						"          xpd_available as string,",
						"          ts_leadearlystageinteraction as string,",
						"          participatesinworkflow as string,",
						"          ts_doyouwishtotrackthiscontact as string,",
						"          merged as string,",
						"          ts_validated as string,",
						"          marketingonly as string,",
						"          donotfax as string,",
						"          isprivate as string,",
						"          donotphone as string,",
						"          isautocreate as string,",
						"          donotemail as string,",
						"          ts_unconfirmedemailaddress as string,",
						"          mpe_companysearchbyemail as string,",
						"          preferredsystemuserid as string,",
						"          preferredsystemuserid_entitytype as string,",
						"          mpe_accountid as string,",
						"          mpe_accountid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          ts_recommendedby as string,",
						"          ts_recommendedby_entitytype as string,",
						"          ts_previousemployerid as string,",
						"          ts_previousemployerid_entitytype as string,",
						"          preferredserviceid as string,",
						"          preferredserviceid_entitytype as string,",
						"          msdyn_segmentid as string,",
						"          msdyn_segmentid_entitytype as string,",
						"          parentcontactid as string,",
						"          parentcontactid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          ts_pa as string,",
						"          ts_pa_entitytype as string,",
						"          ts_businessaddress as string,",
						"          ts_businessaddress_entitytype as string,",
						"          modifiedbyexternalparty as string,",
						"          modifiedbyexternalparty_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          originatingleadid as string,",
						"          originatingleadid_entitytype as string,",
						"          masterid as string,",
						"          masterid_entitytype as string,",
						"          defaultpricelevelid as string,",
						"          defaultpricelevelid_entitytype as string,",
						"          parent_contactid as string,",
						"          parent_contactid_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          createdbyexternalparty as string,",
						"          createdbyexternalparty_entitytype as string,",
						"          preferredequipmentid as string,",
						"          preferredequipmentid_entitytype as string,",
						"          xpd_referredbyinternal as string,",
						"          xpd_referredbyinternal_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          xpd_homecountry as string,",
						"          xpd_homecountry_entitytype as string,",
						"          ts_placementfirmintroducedby as string,",
						"          ts_placementfirmintroducedby_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          accountid as string,",
						"          accountid_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          parentcustomerid as string,",
						"          parentcustomerid_entitytype as string,",
						"          xpd_referredbyexternal as string,",
						"          xpd_referredbyexternal_entitytype as string,",
						"          aging30 as decimal(38,2),",
						"          creditlimit_base as decimal(38,4),",
						"          aging60 as decimal(38,2),",
						"          aging90 as decimal(38,2),",
						"          aging60_base as decimal(38,4),",
						"          aging90_base as decimal(38,4),",
						"          annualincome_base as decimal(38,4),",
						"          creditlimit as decimal(38,2),",
						"          annualincome as decimal(38,2),",
						"          aging30_base as decimal(38,4),",
						"          ts_othernotes as string,",
						"          xpd_referredbyinternalyominame as string,",
						"          address1_county as string,",
						"          yomilastname as string,",
						"          address3_utcoffset as long,",
						"          ts_recommendedbyname as string,",
						"          description as string,",
						"          li_membertoken as string,",
						"          department as string,",
						"          xpd_roletypes_text as string,",
						"          address1_addressid as string,",
						"          importsequencenumber as long,",
						"          address1_longitude as double,",
						"          address3_fax as string,",
						"          managername as string,",
						"          entityimageid as string,",
						"          telephone2 as string,",
						"          parentcustomeridtype as string,",
						"          address2_upszone as string,",
						"          address1_upszone as string,",
						"          xpd_recommendingportfoliocompaniesrecommended as string,",
						"          lastonholdtime as timestamp,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          address1_fax as string,",
						"          address3_telephone1 as string,",
						"          address3_telephone2 as string,",
						"          address3_telephone3 as string,",
						"          fax as string,",
						"          assistantname as string,",
						"          address2_line3 as string,",
						"          accountidyominame as string,",
						"          parentcontactidyominame as string,",
						"          mpe_accountidyominame as string,",
						"          slainvokedidname as string,",
						"          defaultpricelevelidname as string,",
						"          fullname as string,",
						"          address2_longitude as double,",
						"          subscriptionid as string,",
						"          originatingleadidname as string,",
						"          slaname as string,",
						"          versionnumber as long,",
						"          address1_latitude as double,",
						"          createdbyyominame as string,",
						"          parent_contactidname as string,",
						"          address2_telephone1 as string,",
						"          pager as string,",
						"          salutation as string,",
						"          mpe_accountidname as string,",
						"          xpd_functionuse_text as string,",
						"          accountidname as string,",
						"          mpe_companysummary as string,",
						"          parent_contactidyominame as string,",
						"          preferredserviceidname as string,",
						"          address2_city as string,",
						"          address3_postalcode as string,",
						"          address2_line2 as string,",
						"          li_companyid as long,",
						"          ts_otherphonelabel as string,",
						"          ts_reportingemail as string,",
						"          address3_upszone as string,",
						"          transactioncurrencyidname as string,",
						"          address3_county as string,",
						"          entityimage_url as string,",
						"          governmentid as string,",
						"          callback as string,",
						"          business2 as string,",
						"          createdonbehalfbyname as string,",
						"          ts_validateddate as timestamp,",
						"          address2_telephone2 as string,",
						"          owneridname as string,",
						"          originatingleadidyominame as string,",
						"          ts_otherlanguages as string,",
						"          address2_postalcode as string,",
						"          birthdate as timestamp,",
						"          parentcontactidname as string,",
						"          spousesname as string,",
						"          xpd_compensationdate as timestamp,",
						"          address1_utcoffset as long,",
						"          address3_line1 as string,",
						"          traversedpath as string,",
						"          exchangerate as decimal(38,10),",
						"          mpe_flowlastrundate as timestamp,",
						"          address1_line3 as string,",
						"          address3_country as string,",
						"          mpe_documentsetid as string,",
						"          address2_line1 as string,",
						"          ts_previousemployeridyominame as string,",
						"          middlename as string,",
						"          managerphone as string,",
						"          address2_stateorprovince as string,",
						"          childrensnames as string,",
						"          address2_name as string,",
						"          address3_addressid as string,",
						"          address3_stateorprovince as string,",
						"          ts_sectorspecialtyids as string,",
						"          businesscardattributes as string,",
						"          anniversary as timestamp,",
						"          ts_employmentstartdate as timestamp,",
						"          ts_legacycontacttypes as string,",
						"          address1_primarycontactname as string,",
						"          address2_utcoffset as long,",
						"          home2 as string,",
						"          ts_geographicspecialtyids as string,",
						"          address1_name as string,",
						"          ts_recommendationcomments as string,",
						"          address2_telephone3 as string,",
						"          address3_primarycontactname as string,",
						"          ftpsiteurl as string,",
						"          address1_postalcode as string,",
						"          createdon as string,",
						"          address1_stateorprovince as string,",
						"          yomimiddlename as string,",
						"          jobtitle as string,",
						"          telephone3 as string,",
						"          ts_usesspeciality as string,",
						"          msdyn_segmentidname as string,",
						"          ts_knowntouserinitials as string,",
						"          address2_fax as string,",
						"          createdbyname as string,",
						"          xpd_contactuse_text as string,",
						"          ts_sourceid as string,",
						"          address2_addressid as string,",
						"          employeeid as string,",
						"          address1_postofficebox as string,",
						"          address1_city as string,",
						"          ts_businessaddressname as string,",
						"          teamsfollowed as long,",
						"          ts_cv as string,",
						"          timezoneruleversionnumber as long,",
						"          modifiedonbehalfbyyominame as string,",
						"          xpd_hrcompensation as string,",
						"          ts_currentbonusandorupliftconsiderations as string,",
						"          modifiedbyname as string,",
						"          address3_line2 as string,",
						"          yomifullname as string,",
						"          owneridtype as string,",
						"          entityimage_timestamp as long,",
						"          ts_placementfirmintroducedbyyominame as string,",
						"          xpd_previousrole as string,",
						"          ts_compensation as string,",
						"          address2_postofficebox as string,",
						"          emailaddress3 as string,",
						"          emailaddress2 as string,",
						"          emailaddress1 as string,",
						"          ts_interactioncontactuniqueidentifier as string,",
						"          ts_investmentcafeid as string,",
						"          websiteurl as string,",
						"          nickname as string,",
						"          ts_lastmet as timestamp,",
						"          address3_name as string,",
						"          ts_usesspecialtyids as string,",
						"          ts_linkedinurl as string,",
						"          lastname as string,",
						"          address3_longitude as double,",
						"          xpd_referredbyexternalidtype as string,",
						"          parentcustomeridname as string,",
						"          owningbusinessunitname as string,",
						"          onholdtime as long,",
						"          createdonbehalfbyyominame as string,",
						"          preferredsystemuseridyominame as string,",
						"          createdbyexternalpartyname as string,",
						"          ts_tone as string,",
						"          telephone1 as string,",
						"          overriddencreatedon as timestamp,",
						"          address3_postofficebox as string,",
						"          assistantphone as string,",
						"          address1_composite as string,",
						"          address3_line3 as string,",
						"          address2_country as string,",
						"          xpd_referredbyinternalname as string,",
						"          mobilephone as string,",
						"          owneridyominame as string,",
						"          address1_line1 as string,",
						"          createdbyexternalpartyyominame as string,",
						"          xpd_referredbyexternalyominame as string,",
						"          yomifirstname as string,",
						"          mastercontactidname as string,",
						"          address3_city as string,",
						"          address1_country as string,",
						"          externaluseridentifier as string,",
						"          modifiedbyexternalpartyyominame as string,",
						"          firstname as string,",
						"          xpd_hrcurrentbonusandorupliftconsiderations as string,",
						"          stageid as string,",
						"          modifiedonbehalfbyname as string,",
						"          xpd_homecountryname as string,",
						"          mastercontactidyominame as string,",
						"          suffix as string,",
						"          ts_payominame as string,",
						"          lastusedincampaign as timestamp,",
						"          ts_geographicspeciality as string,",
						"          xpd_recruitmentareateam_text as string,",
						"          ts_retentionreviewdate as timestamp,",
						"          parentcustomeridyominame as string,",
						"          timespentbymeonemailandmeetings as string,",
						"          address2_latitude as double,",
						"          xpd_availablefrom as timestamp,",
						"          address3_composite as string,",
						"          xpd_recommendingportco as string,",
						"          preferredsystemuseridname as string,",
						"          utcconversiontimezonecode as long,",
						"          address2_county as string,",
						"          ts_paname as string,",
						"          contactid as string,",
						"          address2_primarycontactname as string,",
						"          ts_specificareasofexpertisecomments as string,",
						"          address1_line2 as string,",
						"          ts_recommendationofindividualupdated as timestamp,",
						"          xpd_referredbyexternalname as string,",
						"          ts_placementfirmintroducedbyname as string,",
						"          ts_sectorspeciality as string,",
						"          ts_previousemployeridname as string,",
						"          processid as string,",
						"          ts_recommendedbyyominame as string,",
						"          modifiedon as timestamp,",
						"          modifiedbyexternalpartyname as string,",
						"          ts_relevantsituations as string,",
						"          businesscard as string,",
						"          company as string,",
						"          preferredequipmentidname as string,",
						"          modifiedbyyominame as string,",
						"          ts_preferredname as string,",
						"          address2_composite as string,",
						"          numberofchildren as long,",
						"          address3_latitude as double",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'contact',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: false) ~> EnrichedContacts",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          address1_addresstypeAZlabel as string,",
						"          address1_shippingmethodAZlabel as string,",
						"          azurestate as string,",
						"          invitestatusAZlabel as string,",
						"          preferredaddressAZlabel as string,",
						"          preferredemailAZlabel as string,",
						"          outgoingemaildeliverymethod as string,",
						"          preferredphoneAZlabel as string,",
						"          emailrouteraccessapproval as string,",
						"          deletedstate as string,",
						"          incomingemaildeliverymethod as string,",
						"          accessmode as string,",
						"          caltype as string,",
						"          address2_addresstypeAZlabel as string,",
						"          address2_shippingmethodAZlabel as string,",
						"          setupuser as string,",
						"          islicensed as string,",
						"          defaultfilterspopulated as string,",
						"          isactivedirectoryuser as string,",
						"          displayinserviceviews as string,",
						"          msdyn_gdproptout as string,",
						"          isdisabled as string,",
						"          isintegrationuser as string,",
						"          isemailaddressapprovedbyo365admin as string,",
						"          issyncwithdirectory as string,",
						"          calendarid as string,",
						"          calendarid_entitytype as string,",
						"          mobileofflineprofileid as string,",
						"          mobileofflineprofileid_entitytype as string,",
						"          queueid as string,",
						"          queueid_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          territoryid as string,",
						"          territoryid_entitytype as string,",
						"          defaultmailbox as string,",
						"          defaultmailbox_entitytype as string,",
						"          positionid as string,",
						"          positionid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          siteid as string,",
						"          siteid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          parentsystemuserid as string,",
						"          parentsystemuserid_entitytype as string,",
						"          businessunitid as string,",
						"          businessunitid_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          traversedpath as string,",
						"          azureactivedirectoryobjectid as string,",
						"          address1_line1 as string,",
						"          internalemailaddress as string,",
						"          siteidname as string,",
						"          modifiedon as timestamp,",
						"          address1_line3 as string,",
						"          skills as string,",
						"          yomifirstname as string,",
						"          address1_longitude as double,",
						"          yomifullname as string,",
						"          entityimage_timestamp as long,",
						"          parentsystemuseridname as string,",
						"          address2_county as string,",
						"          transactioncurrencyidname as string,",
						"          activedirectoryguid as string,",
						"          utcconversiontimezonecode as long,",
						"          passporthi as long,",
						"          homephone as string,",
						"          parentsystemuseridyominame as string,",
						"          address2_stateorprovince as string,",
						"          mobilephone as string,",
						"          address2_country as string,",
						"          address2_line2 as string,",
						"          disabledreason as string,",
						"          lastname as string,",
						"          address1_city as string,",
						"          address1_utcoffset as long,",
						"          userlicensetype as long,",
						"          nickname as string,",
						"          passportlo as long,",
						"          title as string,",
						"          address2_latitude as double,",
						"          applicationid as string,",
						"          address1_composite as string,",
						"          firstname as string,",
						"          address2_postalcode as string,",
						"          employeeid as string,",
						"          processid as string,",
						"          mobileofflineprofileidname as string,",
						"          governmentid as string,",
						"          entityimage_url as string,",
						"          address2_line3 as string,",
						"          azuredeletedon as timestamp,",
						"          timezoneruleversionnumber as long,",
						"          address1_county as string,",
						"          address2_telephone2 as string,",
						"          address2_postofficebox as string,",
						"          address2_telephone1 as string,",
						"          yomilastname as string,",
						"          address2_telephone3 as string,",
						"          address1_addressid as string,",
						"          territoryidname as string,",
						"          overriddencreatedon as timestamp,",
						"          userpuid as string,",
						"          createdonbehalfbyname as string,",
						"          systemuserid as string,",
						"          address2_name as string,",
						"          middlename as string,",
						"          entityimageid as string,",
						"          applicationiduri as string,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          address2_composite as string,",
						"          address1_country as string,",
						"          mobilealertemail as string,",
						"          sharepointemailaddress as string,",
						"          businessunitidname as string,",
						"          address1_stateorprovince as string,",
						"          exchangerate as decimal(38,10),",
						"          jobtitle as string,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          latestupdatetime as timestamp,",
						"          address1_postofficebox as string,",
						"          organizationid as string,",
						"          yammeremailaddress as string,",
						"          defaultmailboxname as string,",
						"          identityid as long,",
						"          yomimiddlename as string,",
						"          address2_utcoffset as long,",
						"          photourl as string,",
						"          personalemailaddress as string,",
						"          address2_addressid as string,",
						"          address2_longitude as double,",
						"          createdon as string,",
						"          createdbyname as string,",
						"          domainname as string,",
						"          modifiedbyyominame as string,",
						"          address2_fax as string,",
						"          address1_line2 as string,",
						"          modifiedonbehalfbyyominame as string,",
						"          address2_upszone as string,",
						"          salutation as string,",
						"          address1_postalcode as string,",
						"          stageid as string,",
						"          defaultodbfoldername as string,",
						"          positionidname as string,",
						"          ts_inititals as string,",
						"          yammeruserid as string,",
						"          importsequencenumber as long,",
						"          address2_city as string,",
						"          windowsliveid as string,",
						"          organizationidname as string,",
						"          versionnumber as long,",
						"          queueidname as string,",
						"          address1_name as string,",
						"          address1_fax as string,",
						"          address1_latitude as double,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          address2_line1 as string,",
						"          address1_upszone as string,",
						"          fullname as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'systemuser',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: false) ~> EnrichedSystemuser",
						"MeetingsAppointmentsIn select(mapColumn(",
						"          Id,",
						"          ts_meetingteam,",
						"          ts_othermeetingmethod,",
						"          isonlinemeeting,",
						"          isalldayevent,",
						"          regardingobjectid,",
						"          ts_taskowner,",
						"          scheduledend,",
						"          ts_taskdescription,",
						"          scheduledstart,",
						"          onlinemeetingjoinurl,",
						"          ts_notes,",
						"          ts_opportunitiesdiscussed,",
						"          ts_sectorscoveredbyfirm,",
						"          ts_originationcommentsnotes,",
						"          ts_taskduedate,",
						"          ts_sectorscoveredids,",
						"          location,",
						"          scheduleddurationminutes",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> MeetingsCleanselect",
						"ContactsIn select(mapColumn(",
						"          Id,",
						"          ts_recommendationofindividual,",
						"          gendercode,",
						"          paymenttermscode,",
						"          ts_vendortargettrackingrole,",
						"          address1_shippingmethodcode,",
						"          preferredcontactmethodcode,",
						"          ts_capabilitiesofindividual,",
						"          familystatuscode,",
						"          xpd_availability,",
						"          address1_freighttermscode,",
						"          xpd_montagulevel,",
						"          ts_permanentinterim,",
						"          ts_ircontactrole,",
						"          xpd_level,",
						"          ts_languagesspokenwritten,",
						"          ts_montaguoffice,",
						"          ts_roletypes,",
						"          xpd_specialisms,",
						"          xpd_function,",
						"          ts_producttype,",
						"          ts_productsinterestedin,",
						"          donotpostalmail,",
						"          ts_centralrelationshipmanager,",
						"          creditonhold,",
						"          xpd_benchcandidate,",
						"          donotsendmm,",
						"          donotbulkemail,",
						"          followemail,",
						"          xpd_available,",
						"          donotfax,",
						"          donotphone,",
						"          donotemail,",
						"          ts_recommendedby,",
						"          transactioncurrencyid,",
						"          originatingleadid,",
						"          xpd_homecountry,",
						"          creditlimit,",
						"          telephone2,",
						"          salutation,",
						"          ts_reportingemail,",
						"          ts_otherlanguages,",
						"          birthdate,",
						"          spousesname,",
						"          xpd_compensationdate,",
						"          anniversary,",
						"          ts_recommendationcomments,",
						"          ts_usesspeciality,",
						"          xpd_hrcompensation,",
						"          ts_currentbonusandorupliftconsiderations,",
						"          ts_compensation,",
						"          emailaddress2,",
						"          ts_investmentcafeid,",
						"          ts_lastmet,",
						"          ts_tone,",
						"          xpd_hrcurrentbonusandorupliftconsiderations,",
						"          lastusedincampaign,",
						"          ts_geographicspeciality,",
						"          xpd_availablefrom,",
						"          xpd_recommendingportco,",
						"          contactid,",
						"          ts_sectorspeciality",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> contactscleanselect",
						"OriginationOpportunityIn select(mapColumn(",
						"          Id,",
						"          ts_actionstatus,",
						"          ts_producttype,",
						"          ts_internalintermediarysource,",
						"          ts_currentactivity,",
						"          ts_opportunitystatus,",
						"          ts_montaguprimaryoffice,",
						"          ts_opportunitytype,",
						"          ts_posthumstatus,",
						"          ts_choppedreason,",
						"          ts_duplicateopportunityfordiscussion,",
						"          mpe_smalltarget,",
						"          xpd_includeonallpapers,",
						"          ts_sold,",
						"          xpd_sharepointlocationcreated,",
						"          ts_buyer,",
						"          mpe_productid,",
						"          ts_targetbusiness,",
						"          ts_firstreferralcompany,",
						"          ts_montaguowner,",
						"          ts_firstreferralcontact,",
						"          transactioncurrencyid,",
						"          ts_managerwedback,",
						"          ts_country,",
						"          ownerid,",
						"          ts_estebitda,",
						"          ts_estebit,",
						"          ts_estdealsize,",
						"          ts_estturnover,",
						"          ts_nextsteps,",
						"          ts_buyerpaidxltmebitda,",
						"          ts_opportunitystage,",
						"          ts_choppedcomments,",
						"          ts_datedealannounced,",
						"          ts_name,",
						"          ts_weofferedxltmebitda,",
						"          ts_companyid,",
						"          ts_choppeddate,",
						"          mpe_carveout,",
						"          mpe_targetbusiness_parentid",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> OrigiopportCleanout",
						"AccountIn select(mapColumn(",
						"          Id,",
						"          ts_primarysecondaryfocus,",
						"          xpd_relationshipstatus,",
						"          ts_introducertype,",
						"          xpd_remindermonths,",
						"          ts_portfoliocompanystatus,",
						"          ts_companytype,",
						"          ts_vendorsummary,",
						"          xpd_publictoprivatetracker,",
						"          xpd_setreminder,",
						"          ts_trackcompany,",
						"          parentaccountid,",
						"          xpd_reminderto,",
						"          ts_headofficeid,",
						"          ts_originationlead1,",
						"          ts_originationlead2,",
						"          ts_currentauditor,",
						"          ts_othernotes,",
						"          xpd_relationshipcomments,",
						"          ts_formername,",
						"          ts_mpeapproachstrategy,",
						"          ts_lastdatestatuschanged,",
						"          xpd_relationshipstatuschangeddate,",
						"          ts_companylegalname,",
						"          ts_companynumber,",
						"          ts_monthlyreviewmeetingname,",
						"          ts_originationcomments,",
						"          ts_capitaliqlink,",
						"          xpd_datereminderwasset,",
						"          ts_reminderdatesetto,",
						"          ts_alias,",
						"          xpd_reasonaction,",
						"          ts_relevantsituations,",
						"          ts_dealstageofmostrecentopportunity",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> AccountsSelectClean",
						"SystemuserSource select(mapColumn(",
						"          id = Id,",
						"          calendarid,",
						"          siteid,",
						"          azureactivedirectoryobjectid,",
						"          modifiedby,",
						"          address1_line1,",
						"          internalemailaddress,",
						"          siteidname,",
						"          yomifullname,",
						"          mobilephone,",
						"          lastname,",
						"          address1_city,",
						"          title,",
						"          address1_composite,",
						"          firstname,",
						"          address1_addressid,",
						"          userpuid,",
						"          parentsystemuserid,",
						"          entityimageid,",
						"          address1_country,",
						"          businessunitidname,",
						"          address1_telephone1,",
						"          organizationid,",
						"          defaultmailboxname,",
						"          identityid,",
						"          address2_addressid,",
						"          createdon,",
						"          domainname,",
						"          modifiedbyyominame,",
						"          address1_postalcode,",
						"          ts_inititals,",
						"          windowsliveid,",
						"          queueidname,",
						"          modifiedbyname",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SystemUserSelect",
						"OrigiopportCleanout, OutputEnrichedOrigination join(OrigiopportCleanout@Id == OutputEnrichedOrigination@Id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'right')~> Originationjoinoutput",
						"EnrichedAccount select(mapColumn(",
						"          Id,",
						"          stateAZLabel = stateAZlabel,",
						"          statusAZLabel = statusAZlabel,",
						"          customertypeAZLabel = customertypeAZlabel,",
						"          address1_addresstypeAZLabel = address1_addresstypeAZlabel,",
						"          accountclassificationAZLabel = accountclassificationAZlabel,",
						"          preferredappointmenttimeAZLabel = preferredappointmenttimeAZlabel,",
						"          address2_freighttermsAZLabel = address2_freighttermsAZlabel,",
						"          accountcategoryAZLabel = accountcategoryAZlabel,",
						"          paymenttermsAZLabel = paymenttermsAZlabel,",
						"          preferredappointmentdayAZLabel = preferredappointmentdayAZlabel,",
						"          businesstypeAZLabel = businesstypeAZlabel,",
						"          industryAZLabel = industryAZlabel,",
						"          address1_shippingmethodAZLabel = address1_shippingmethodAZlabel,",
						"          customersizeAZLabel = customersizeAZlabel,",
						"          preferredcontactmethodAZLabel = preferredcontactmethodAZlabel,",
						"          accountratingAZlabel,",
						"          address2_addresstypeAZlabel,",
						"          address2_shippingmethodAZlabel,",
						"          ownershipAZlabel,",
						"          territoryAZlabel,",
						"          shippingmethodAZlabel,",
						"          address1_freighttermsAZlabel",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> EnrichedAccountSelect",
						"EnrichedOriginationOpportunities select(mapColumn(",
						"          Id,",
						"          stateAZlabel,",
						"          statusAZlabel",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> OutputEnrichedOrigination",
						"EnrichedMeetingAppointments select(mapColumn(",
						"          Id,",
						"          stateAZlabel,",
						"          statusAZlabel,",
						"          instancetypeAZlabel,",
						"          priorityAZlabel",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> OutputEnrichedMeetingAppointments",
						"EnrichedContacts select(mapColumn(",
						"          Id,",
						"          stateAZlabel,",
						"          statusAZlabel,",
						"          haschildrenAZlabel,",
						"          customertypeAZlabel,",
						"          genderAZlabel,",
						"          address1_addresstypeAZlabel,",
						"          leadsourceAZlabel,",
						"          preferredappointmenttimeAZlabel,",
						"          address2_freighttermsAZlabel,",
						"          address2_shippingmethodAZlabel,",
						"          paymenttermsAZlabel,",
						"          accountroleAZlabel,",
						"          territoryAZlabel,",
						"          address3_freighttermsAZlabel,",
						"          address1_shippingmethodAZlabel,",
						"          preferredappointmentdayAZlabel,",
						"          customersizeAZlabel,",
						"          preferredcontactmethodAZlabel,",
						"          address3_shippingmethodAZlabel,",
						"          address2_addresstypeAZlabel,",
						"          address3_addresstypeAZlabel,",
						"          familystatusAZlabel,",
						"          shippingmethodAZlabel,",
						"          educationAZlabel,",
						"          address1_freighttermsAZlabel",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> OutputEnrichedContacts",
						"EnrichedSystemuser select(mapColumn(",
						"          Id,",
						"          address1_addresstypeAZlabel,",
						"          address1_shippingmethodAZlabel,",
						"          invitestatusAZlabel,",
						"          preferredaddressAZlabel,",
						"          preferredemailAZlabel,",
						"          preferredphoneAZlabel,",
						"          address2_addresstypeAZlabel,",
						"          address2_shippingmethodAZlabel",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> OutputEnrichedSystemuser",
						"MeetingsCleanselect, EnrichedMeetingAppointments join(MeetingsCleanselect@Id == EnrichedMeetingAppointments@Id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> AppointmentsJoinOutput",
						"contactscleanselect, EnrichedContacts join(contactscleanselect@Id == EnrichedContacts@Id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> ContactsJoin",
						"SystemUserSelect, EnrichedSystemuser join(SystemUserSelect@id == EnrichedSystemuser@Id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> SystemUserJoin",
						"AccountsSelectClean, EnrichedAccountSelect join(fuzzyCompare(AccountsSelectClean@Id, EnrichedAccountSelect@Id, 80.00),",
						"     joinType:'left',",
						"     matchType:'fuzzy',",
						"     ignoreSpaces: false,",
						"     scoreColumn:'AZlabel',",
						"     broadcast: 'off')~> AccountEnrichedJoin",
						"AccountEnrichedJoin sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     recreate:true,",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> AccountCleanSink",
						"AppointmentsJoinOutput sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     recreate:true,",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> MeetingStageCleanSink",
						"ContactsJoin sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     recreate:true,",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> ContactsStageCleanSink",
						"Originationjoinoutput sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     recreate:true,",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> OriginationCleanSink",
						"SystemUserJoin sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     recreate:true,",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> SystemUserCleanSink",
						"OutputEnrichedOrigination sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     store: 'cache',",
						"     format: 'inline',",
						"     output: false) ~> SinkEnrichedOrigination",
						"EnrichedAccountSelect sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     store: 'cache',",
						"     format: 'inline',",
						"     output: false) ~> SinkEnrichedAccount",
						"OutputEnrichedMeetingAppointments sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     store: 'cache',",
						"     format: 'inline',",
						"     output: false) ~> SinkEnrichedMeeting",
						"OutputEnrichedContacts sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     store: 'cache',",
						"     format: 'inline',",
						"     output: false) ~> SinkEnrichedContacts",
						"OutputEnrichedSystemuser sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     store: 'cache',",
						"     format: 'inline',",
						"     output: false) ~> SinkEnrichedSystemUser"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/EnrichedDatabase')]",
				"[concat(variables('workspaceId'), '/datasets/AccountTable')]",
				"[concat(variables('workspaceId'), '/datasets/Appointment')]",
				"[concat(variables('workspaceId'), '/datasets/Contacttable')]",
				"[concat(variables('workspaceId'), '/datasets/OriginationOpp')]",
				"[concat(variables('workspaceId'), '/datasets/Systemusertable')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Reports Flow')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "Flowlet",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "prod-synapse-uks-001-WorkspaceDefaultStorage",
								"type": "LinkedServiceReference"
							},
							"name": "CDMImportAccount"
						},
						{
							"linkedService": {
								"referenceName": "prod-synapse-uks-001-WorkspaceDefaultStorage",
								"type": "LinkedServiceReference"
							},
							"name": "CDMContact"
						},
						{
							"linkedService": {
								"referenceName": "prod-synapse-uks-001-WorkspaceDefaultStorage",
								"type": "LinkedServiceReference"
							},
							"name": "CMDImportMeetings"
						},
						{
							"linkedService": {
								"referenceName": "prod-synapse-uks-001-WorkspaceDefaultStorage",
								"type": "LinkedServiceReference"
							},
							"name": "CMDImportOpportunities"
						},
						{
							"name": "CDMSystemUsers"
						}
					],
					"sinks": [],
					"transformations": [
						{
							"name": "DataOut"
						},
						{
							"name": "ContactOutput"
						},
						{
							"name": "Meeting"
						},
						{
							"name": "Opportunities"
						},
						{
							"name": "SystemUser"
						}
					],
					"scriptLines": [
						"source(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     entity: 'contact',",
						"     format: 'cdm',",
						"     manifestType: 'model',",
						"     folderPath: '',",
						"     fileSystem: 'dataverse-montagu-org5a2bcccf') ~> CDMImportAccount",
						"source(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     entity: 'Contact',",
						"     format: 'cdm',",
						"     manifestType: 'manifest',",
						"     manifestName: 'model.json',",
						"     local: true,",
						"     folderPath: '',",
						"     fileSystem: 'dataverse-montagu-org5a2bcccf') ~> CDMContact",
						"source(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     entity: 'appointment',",
						"     format: 'cdm',",
						"     manifestType: 'model',",
						"     folderPath: '',",
						"     fileSystem: 'dataverse-montagu-org5a2bcccf') ~> CMDImportMeetings",
						"source(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     entity: 'ts_originationopportunity',",
						"     format: 'cdm',",
						"     manifestType: 'model',",
						"     folderPath: '',",
						"     fileSystem: 'dataverse-montagu-org5a2bcccf') ~> CMDImportOpportunities",
						"source(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'systemuser') ~> CDMSystemUsers",
						"CDMImportAccount output() ~> DataOut",
						"CDMContact output() ~> ContactOutput",
						"CMDImportMeetings output() ~> Meeting",
						"CMDImportOpportunities output() ~> Opportunities",
						"CDMSystemUsers output() ~> SystemUser"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/prod-synapse-uks-001-WorkspaceDefaultStorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/debugInputDataflow_Split Table')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"name": "AccountIn"
						},
						{
							"name": "OriginationOpportunityIn"
						},
						{
							"name": "MeetingsAppointmentsIn"
						},
						{
							"name": "ContactsIn"
						},
						{
							"linkedService": {
								"referenceName": "EnrichedDatabase",
								"type": "LinkedServiceReference"
							},
							"name": "EnrichedAccount"
						},
						{
							"linkedService": {
								"referenceName": "EnrichedDatabase",
								"type": "LinkedServiceReference"
							},
							"name": "EnrichedOriginationOpportunities"
						},
						{
							"linkedService": {
								"referenceName": "EnrichedDatabase",
								"type": "LinkedServiceReference"
							},
							"name": "EnrichedMeetingAppointments"
						},
						{
							"linkedService": {
								"referenceName": "EnrichedDatabase",
								"type": "LinkedServiceReference"
							},
							"name": "EnrichedContacts"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "AccountTable",
								"type": "DatasetReference"
							},
							"name": "AccountCleanSink"
						},
						{
							"dataset": {
								"referenceName": "Appointment",
								"type": "DatasetReference"
							},
							"name": "MeetingStageCleanSink"
						},
						{
							"dataset": {
								"referenceName": "Contacttable",
								"type": "DatasetReference"
							},
							"name": "ContactsStageCleanSink"
						},
						{
							"dataset": {
								"referenceName": "OriginationOpp",
								"type": "DatasetReference"
							},
							"name": "OriginationCleanSink"
						},
						{
							"name": "SinkEnrichedOrigination"
						},
						{
							"name": "SinkEnrichedAccount"
						},
						{
							"name": "SinkEnrichedMeeting"
						},
						{
							"name": "SinkEnrichedContacts"
						}
					],
					"transformations": [
						{
							"name": "MeetingsCleanselect"
						},
						{
							"name": "contactscleanselect"
						},
						{
							"name": "OrigiopportCleanout"
						},
						{
							"name": "AccountsSelectClean"
						},
						{
							"name": "Originationjoinoutput"
						},
						{
							"name": "EnrichedAccountSelect"
						},
						{
							"name": "OutputEnrichedOrigination"
						},
						{
							"name": "OutputEnrichedMeetingAppointments"
						},
						{
							"name": "OutputEnrichedContacts"
						},
						{
							"name": "AppointmentsJoinOutput"
						},
						{
							"name": "ContactsJoin"
						},
						{
							"name": "AccountEnrichedJoin"
						}
					],
					"scriptLines": [
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          ts_primarysecondaryfocus as long,",
						"          customertypecode as long,",
						"          ts_relationship as long,",
						"          address1_addresstypecode as long,",
						"          accountclassificationcode as long,",
						"          ts_easeofworking as long,",
						"          ts_ukrow as long,",
						"          preferredappointmenttimecode as long,",
						"          ts_address1addresstype as long,",
						"          xpd_relationshipstatus as long,",
						"          ts_introducertype as long,",
						"          xpd_remindermonths as long,",
						"          ts_importance as long,",
						"          address2_freighttermscode as long,",
						"          ts_irrvsmomperformancemeasure as long,",
						"          accountcategorycode as long,",
						"          paymenttermscode as long,",
						"          preferredappointmentdaycode as long,",
						"          businesstypecode as long,",
						"          industrycode as long,",
						"          ts_sizeoffirm as long,",
						"          ts_interaction as long,",
						"          address1_shippingmethodcode as long,",
						"          ts_portfoliocompanystatus as long,",
						"          customersizecode as long,",
						"          xpd_previousinvestorstatus as long,",
						"          ts_recommendationoffirm as long,",
						"          preferredcontactmethodcode as long,",
						"          accountratingcode as long,",
						"          ts_investorstatus as long,",
						"          ts_capabilitiesoffirm as long,",
						"          mpe_flowlastrunoutcome as long,",
						"          address2_addresstypecode as long,",
						"          address2_shippingmethodcode as long,",
						"          ts_nextoriginationmeetingarranged as long,",
						"          ownershipcode as long,",
						"          territorycode as long,",
						"          ts_investortype as long,",
						"          shippingmethodcode as long,",
						"          ts_investorregion as long,",
						"          address1_freighttermscode as long,",
						"          xpd_function as string,",
						"          ts_quickcaptureuses as string,",
						"          ts_permanentinterim as string,",
						"          ts_quickcapturesectors as string,",
						"          ts_roletypes as string,",
						"          ts_companytype as string,",
						"          xpd_level as string,",
						"          ts_indicativeclientbase as string,",
						"          xpd_specialisms as string,",
						"          xpd_montagulevel as string,",
						"          ts_vendorsummary as string,",
						"          ts_producttype as string,",
						"          ts_montaguoffice as string,",
						"          ts_quickcapturegeography as string,",
						"          xpd_roletypes as string,",
						"          mpe_livedeal as boolean,",
						"          donotbulkpostalmail as boolean,",
						"          donotpostalmail as boolean,",
						"          msdyn_gdproptout as boolean,",
						"          ts_organisationalchange as boolean,",
						"          xpd_publictoprivatetracker as boolean,",
						"          ts_auditor as boolean,",
						"          donotsendmm as boolean,",
						"          donotbulkemail as boolean,",
						"          followemail as boolean,",
						"          creditonhold as boolean,",
						"          marketingonly as boolean,",
						"          participatesinworkflow as boolean,",
						"          merged as boolean,",
						"          ts_validated as boolean,",
						"          xpd_sharepointlocationcreated as boolean,",
						"          xpd_setreminder as boolean,",
						"          ts_personnelchange as boolean,",
						"          donotfax as boolean,",
						"          isprivate as boolean,",
						"          donotphone as boolean,",
						"          xpd_rpo as boolean,",
						"          ts_trackcompany as boolean,",
						"          donotemail as boolean,",
						"          parentaccountid as string,",
						"          parentaccountid_entitytype as string,",
						"          ts_recommendedby as string,",
						"          ts_recommendedby_entitytype as string,",
						"          ts_countryofeconomicoriginforthecapital as string,",
						"          ts_countryofeconomicoriginforthecapital_entitytype as string,",
						"          xpd_reminderto as string,",
						"          xpd_reminderto_entitytype as string,",
						"          preferredserviceid as string,",
						"          preferredserviceid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          createdbyexternalparty as string,",
						"          createdbyexternalparty_entitytype as string,",
						"          ts_validatedby as string,",
						"          ts_validatedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          ts_primarymperelationshipmanager as string,",
						"          ts_primarymperelationshipmanager_entitytype as string,",
						"          modifiedbyexternalparty as string,",
						"          modifiedbyexternalparty_entitytype as string,",
						"          ts_headofficeid as string,",
						"          ts_headofficeid_entitytype as string,",
						"          ts_address1country as string,",
						"          ts_address1country_entitytype as string,",
						"          ts_address1usstate as string,",
						"          ts_address1usstate_entitytype as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          originatingleadid as string,",
						"          originatingleadid_entitytype as string,",
						"          masterid as string,",
						"          masterid_entitytype as string,",
						"          ts_originationlead1 as string,",
						"          ts_originationlead1_entitytype as string,",
						"          defaultpricelevelid as string,",
						"          defaultpricelevelid_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          ts_originationlead2 as string,",
						"          ts_originationlead2_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          mpe_coinvestquestionnaireid as string,",
						"          mpe_coinvestquestionnaireid_entitytype as string,",
						"          ts_hub as string,",
						"          ts_hub_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          ts_currentauditor as string,",
						"          ts_currentauditor_entitytype as string,",
						"          primarycontactid as string,",
						"          primarycontactid_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          preferredsystemuserid as string,",
						"          preferredsystemuserid_entitytype as string,",
						"          preferredequipmentid as string,",
						"          preferredequipmentid_entitytype as string,",
						"          xpd_fund as string,",
						"          xpd_fund_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          territoryid as string,",
						"          territoryid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          xpd_totalinstitutionalcommitments_base as decimal(38,0),",
						"          ts_minimumticketsize_base as decimal(38,4),",
						"          xpd_totalinstitutionalcommitments as decimal(38,0),",
						"          aging30 as decimal(38,0),",
						"          creditlimit as decimal(38,0),",
						"          creditlimit_base as decimal(38,0),",
						"          ts_totalcommitments_base as decimal(38,4),",
						"          aging60 as decimal(38,0),",
						"          ts_transfersin_base as decimal(38,0),",
						"          aging90 as decimal(38,0),",
						"          ts_maximumticketsize as decimal(38,4),",
						"          ts_totalaum_base as decimal(38,0),",
						"          marketcap_base as decimal(38,0),",
						"          aging60_base as decimal(38,0),",
						"          aging90_base as decimal(38,0),",
						"          ts_transfersout as decimal(38,0),",
						"          ts_maximumticketsize_base as decimal(38,4),",
						"          ts_originalcommitments_base as decimal(38,0),",
						"          revenue as decimal(38,0),",
						"          ts_totalcommitments as decimal(38,4),",
						"          ts_transfersout_base as decimal(38,0),",
						"          ts_totalaum as decimal(38,0),",
						"          ts_commitmentreductions_base as decimal(38,0),",
						"          ts_commitmentreductions as decimal(38,0),",
						"          marketcap as decimal(38,0),",
						"          ts_originalcommitments as decimal(38,0),",
						"          ts_minimumticketsize as decimal(38,4),",
						"          revenue_base as decimal(38,0),",
						"          openrevenue_base as decimal(38,0),",
						"          aging30_base as decimal(38,0),",
						"          openrevenue as decimal(38,0),",
						"          ts_transfersin as decimal(38,0),",
						"          ts_othernotes as string,",
						"          ts_transfersin_date as timestamp,",
						"          address1_county as string,",
						"          openrevenue_date as timestamp,",
						"          ts_recommendedbyname as string,",
						"          ts_relationshipinteractioncomments as string,",
						"          ts_originationlead2yominame as string,",
						"          parentaccountidname as string,",
						"          xpd_roletypes_text as string,",
						"          address1_addressid as string,",
						"          importsequencenumber as long,",
						"          address1_longitude as double,",
						"          ts_countryofeconomicoriginforthecapitalname as string,",
						"          entityimageid as string,",
						"          telephone2 as string,",
						"          ts_lastoriginationmeeting as timestamp,",
						"          address2_utcoffset as long,",
						"          address1_upszone as string,",
						"          ts_originalcommitments_state as long,",
						"          ts_typicalcost as string,",
						"          xpd_recommendingportfoliocompaniesrecommended as string,",
						"          accountnumber as string,",
						"          ts_currentauditoryominame as string,",
						"          ts_originalcommitments_date as timestamp,",
						"          lastonholdtime as timestamp,",
						"          ts_sectorscoveredbyfirm as string,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          address2_upszone as string,",
						"          opendeals_state as long,",
						"          xpd_functionuse_text as string,",
						"          slainvokedidname as string,",
						"          address2_longitude as double,",
						"          defaultpricelevelidname as string,",
						"          stockexchange as string,",
						"          mpe_liveofferingscount_date as timestamp,",
						"          xpd_relationshipcomments as string,",
						"          originatingleadidname as string,",
						"          slaname as string,",
						"          ts_currentauditorname as string,",
						"          xpd_remindertoyominame as string,",
						"          ts_address1usstatename as string,",
						"          ts_tempcompanytype as string,",
						"          versionnumber as long,",
						"          address1_latitude as double,",
						"          ts_formername as string,",
						"          yominame as string,",
						"          createdbyyominame as string,",
						"          ts_cityofvisit as string,",
						"          address2_telephone1 as string,",
						"          ts_globalgeographiescoveredids as string,",
						"          preferredserviceidname as string,",
						"          address2_city as string,",
						"          ts_mpeapproachstrategy as string,",
						"          address2_line2 as string,",
						"          ts_lastdatestatuschanged as timestamp,",
						"          li_companyid as long,",
						"          transactioncurrencyidname as string,",
						"          entityimage_url as string,",
						"          xpd_relationshipstatuschangeddate as timestamp,",
						"          createdonbehalfbyname as string,",
						"          mpe_liveofferingscount_state as long,",
						"          xpd_numberofcoinvestinvestments_date as timestamp,",
						"          ts_validateddate as timestamp,",
						"          owneridname as string,",
						"          xpd_generalcomments as string,",
						"          ts_companylegalname as string,",
						"          description as string,",
						"          ts_validatedbyname as string,",
						"          originatingleadidyominame as string,",
						"          opendeals as long,",
						"          xpd_numberofopportunitiesshown_state as long,",
						"          address2_postalcode as string,",
						"          websiteurl as string,",
						"          xpd_fundname as string,",
						"          address1_utcoffset as long,",
						"          exchangerate as decimal(38,10),",
						"          mpe_flowlastrundate as timestamp,",
						"          fax as string,",
						"          address1_line3 as string,",
						"          ts_monthssincelastmeeting as long,",
						"          ts_hubname as string,",
						"          address2_line1 as string,",
						"          ts_capiqticket as string,",
						"          address2_stateorprovince as string,",
						"          address2_name as string,",
						"          ts_transfersout_state as long,",
						"          xpd_numberofopportunitiesshown as long,",
						"          primarytwitterid as string,",
						"          mpe_coinvestquestionnaireidname as string,",
						"          xpd_numberofopportunitiesshown_date as timestamp,",
						"          xpd_preferentialterms as string,",
						"          address1_primarycontactname as string,",
						"          territoryidname as string,",
						"          ts_processstatus as string,",
						"          address1_name as string,",
						"          address2_telephone2 as string,",
						"          address2_telephone3 as string,",
						"          xpd_recruitmentareateam_text as string,",
						"          ftpsiteurl as string,",
						"          address1_postalcode as string,",
						"          ts_companynumber as string,",
						"          createdon as string,",
						"          mpe_liveofferingscount as long,",
						"          traversedpath as string,",
						"          address1_stateorprovince as string,",
						"          ts_transfersin_state as long,",
						"          address2_addressid as string,",
						"          ts_monthlyreviewmeetingname as string,",
						"          primarysatoriid as string,",
						"          telephone3 as string,",
						"          openrevenue_state as long,",
						"          ts_usesprovidedids as string,",
						"          ts_originationcomments as string,",
						"          lastusedincampaign as timestamp,",
						"          primarycontactidname as string,",
						"          ts_originationlead1name as string,",
						"          ts_headofficeidname as string,",
						"          ts_montagucomments as string,",
						"          address2_fax as string,",
						"          createdbyname as string,",
						"          xpd_numberofcoinvestinvestments as long,",
						"          ts_capitaliqlink as string,",
						"          ts_primarymperelationshipmanagername as string,",
						"          mpe_relationshipstatus_text as string,",
						"          xpd_datereminderwasset as timestamp,",
						"          xpd_numberofcoinvestinvestments_state as long,",
						"          address1_postofficebox as string,",
						"          address1_city as string,",
						"          teamsfollowed as long,",
						"          ts_originationlead2name as string,",
						"          timezoneruleversionnumber as long,",
						"          modifiedonbehalfbyyominame as string,",
						"          entityimage_timestamp as long,",
						"          tickersymbol as string,",
						"          ts_theirprogrammecomments as string,",
						"          xpd_companyuse_text as string,",
						"          modifiedbyname as string,",
						"          owneridtype as string,",
						"          sic as string,",
						"          sharesoutstanding as long,",
						"          opendeals_date as timestamp,",
						"          address2_postofficebox as string,",
						"          emailaddress3 as string,",
						"          emailaddress2 as string,",
						"          emailaddress1 as string,",
						"          ts_globalgeographiescoveredbyfirm as string,",
						"          ts_recommendationoffirmupdated as timestamp,",
						"          ts_lastmet as timestamp,",
						"          ts_reminderdatesetto as timestamp,",
						"          ts_commitmentreductions_state as long,",
						"          owningbusinessunitname as string,",
						"          onholdtime as long,",
						"          ts_alias as string,",
						"          createdonbehalfbyyominame as string,",
						"          ts_transfersout_date as timestamp,",
						"          ts_address1countryname as string,",
						"          preferredsystemuseridyominame as string,",
						"          createdbyexternalpartyname as string,",
						"          mpe_documentsetid as string,",
						"          telephone1 as string,",
						"          ts_legacycompanytypes as string,",
						"          ts_validatedbyyominame as string,",
						"          address1_composite as string,",
						"          ts_investorgroupgatekeeperid as string,",
						"          primarycontactidyominame as string,",
						"          address2_country as string,",
						"          xpd_recommendationcomments as string,",
						"          owneridyominame as string,",
						"          createdbyexternalpartyyominame as string,",
						"          ts_originationlead1yominame as string,",
						"          ts_usesprovidedbyfirm as string,",
						"          xpd_recommendingportco as string,",
						"          address1_country as string,",
						"          ts_commitmentreductions_date as timestamp,",
						"          name as string,",
						"          modifiedbyexternalpartyyominame as string,",
						"          xpd_remindertoname as string,",
						"          stageid as string,",
						"          modifiedonbehalfbyname as string,",
						"          masteraccountidname as string,",
						"          timespentbymeonemailandmeetings as string,",
						"          address2_latitude as double,",
						"          overriddencreatedon as timestamp,",
						"          parentaccountidyominame as string,",
						"          ts_specificareaofexpertisecomments as string,",
						"          preferredsystemuseridname as string,",
						"          utcconversiontimezonecode as long,",
						"          address2_county as string,",
						"          address1_line1 as string,",
						"          address2_primarycontactname as string,",
						"          address1_line2 as string,",
						"          xpd_reasonaction as string,",
						"          ts_primarymperelationshipmanageryominame as string,",
						"          processid as string,",
						"          ts_sectorscoveredids as string,",
						"          ts_recommendedbyyominame as string,",
						"          modifiedbyexternalpartyname as string,",
						"          ts_relevantsituations as string,",
						"          accountid as string,",
						"          modifiedon as timestamp,",
						"          preferredequipmentidname as string,",
						"          modifiedbyyominame as string,",
						"          ts_dealstageofmostrecentopportunity as string,",
						"          address2_composite as string,",
						"          masteraccountidyominame as string,",
						"          numberofemployees as long,",
						"          address1_fax as string,",
						"          address2_line3 as string,",
						"          msdyn_segmentid as string,",
						"          msdyn_segmentid_entitytype as string,",
						"          msdyn_segmentidname as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'account') ~> AccountIn",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          ts_dealannouncedreason as long,",
						"          ts_highprioritynew as long,",
						"          ts_actionstatus as long,",
						"          mpe_targetrelationshipstatus as long,",
						"          ts_producttype as long,",
						"          ts_internalintermediarysource as long,",
						"          mpe_flowlastrunoutcome as long,",
						"          ts_currentactivity as long,",
						"          ts_opportunitystatus as long,",
						"          ts_montaguprimaryoffice as long,",
						"          ts_opportunitytype as long,",
						"          ts_posthumstatus as long,",
						"          ts_meetingremindermonths as long,",
						"          ts_choppedreason as string,",
						"          ts_setreminder as boolean,",
						"          ts_stagereachedfir as boolean,",
						"          ts_stagereachedipr as boolean,",
						"          ts_duplicateopportunityfordiscussion as boolean,",
						"          mpe_smalltarget as boolean,",
						"          ts_stagereachedcr as boolean,",
						"          xpd_includeonallpapers as boolean,",
						"          ts_sold as boolean,",
						"          xpd_sharepointlocationcreated as boolean,",
						"          ts_statuschangedby as string,",
						"          ts_statuschangedby_entitytype as string,",
						"          ts_buyer as string,",
						"          ts_buyer_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          ts_reminderto as string,",
						"          ts_reminderto_entitytype as string,",
						"          mpe_productid as string,",
						"          mpe_productid_entitytype as string,",
						"          ts_targetbusiness as string,",
						"          ts_targetbusiness_entitytype as string,",
						"          ts_firstreferralcompany as string,",
						"          ts_firstreferralcompany_entitytype as string,",
						"          ts_deallead as string,",
						"          ts_deallead_entitytype as string,",
						"          ts_montaguowner as string,",
						"          ts_montaguowner_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          ts_firstreferralcontact as string,",
						"          ts_firstreferralcontact_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ts_managerwedback as string,",
						"          ts_managerwedback_entitytype as string,",
						"          ts_country as string,",
						"          ts_country_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          ts_sellmandate as string,",
						"          ts_sellmandate_entitytype as string,",
						"          ts_estebitda_base as decimal(38,4),",
						"          ts_estebit_base as decimal(38,4),",
						"          ts_estebitda as decimal(38,4),",
						"          ts_estebit as decimal(38,4),",
						"          ts_estturnover_base as decimal(38,4),",
						"          ts_estdealsize as decimal(38,4),",
						"          ts_estdealsize_base as decimal(38,4),",
						"          ts_estturnover as decimal(38,4),",
						"          ts_buyeryominame as string,",
						"          modifiedon as timestamp,",
						"          ts_statuschangedbyname as string,",
						"          ts_managerwedbackyominame as string,",
						"          xpd_montaguprojectname as string,",
						"          transactioncurrencyidname as string,",
						"          ts_nextsteps as string,",
						"          ts_montaguowneryominame as string,",
						"          ts_firstreferralcontactname as string,",
						"          ts_opportunitydescription as string,",
						"          ts_buyerpaidxltmebitda as decimal(38,1),",
						"          ts_targetbusinessyominame as string,",
						"          ts_montaguownername as string,",
						"          ts_managerwedbackname as string,",
						"          ts_opportunitystage as string,",
						"          ts_otherdocumentsurl as string,",
						"          exchangerate as decimal(38,10),",
						"          mpe_documentsetid as string,",
						"          ts_buyername as string,",
						"          ts_firstreferralcontactyominame as string,",
						"          createdon as string,",
						"          ts_sellmandateyominame as string,",
						"          mpe_montaguprimaryofficestring as string,",
						"          ts_statuschangedbyyominame as string,",
						"          ts_firstreferralcompanyname as string,",
						"          owneridyominame as string,",
						"          ts_choppedcomments as string,",
						"          timezoneruleversionnumber as long,",
						"          createdbyname as string,",
						"          ts_dealleadname as string,",
						"          owningbusinessunitname as string,",
						"          ts_dealleadyominame as string,",
						"          ts_lastdatestatuschanged as timestamp,",
						"          traversedpath as string,",
						"          overriddencreatedon as timestamp,",
						"          ts_iprdocumenturl as string,",
						"          createdonbehalfbyname as string,",
						"          ts_sellmandatename as string,",
						"          owneridtype as string,",
						"          owneridname as string,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          mpe_productidname as string,",
						"          ts_originationopportunityid as string,",
						"          ts_crdocumenturl as string,",
						"          ts_datedealannounced as timestamp,",
						"          processid as string,",
						"          mpe_montaguprimaryofficeowner as string,",
						"          ts_reason as string,",
						"          ts_targetbusinessname as string,",
						"          ts_remindertoname as string,",
						"          ts_postcompletionnoteurl as string,",
						"          ts_name as string,",
						"          stageid as string,",
						"          ts_currentopportunitystatus as string,",
						"          ts_firstreferralcompanyyominame as string,",
						"          mpe_flowlastrundate as timestamp,",
						"          ts_firdocumenturl as string,",
						"          modifiedbyyominame as string,",
						"          modifiedonbehalfbyyominame as string,",
						"          ts_movedoutofwipdate as timestamp,",
						"          ts_equitychequesize as decimal(38,2),",
						"          utcconversiontimezonecode as long,",
						"          ts_weofferedxltmebitda as decimal(38,1),",
						"          importsequencenumber as long,",
						"          ts_remindertoyominame as string,",
						"          ts_companyid as long,",
						"          ts_datereminderwasset as timestamp,",
						"          versionnumber as long,",
						"          ts_originationid as long,",
						"          ts_countryname as string,",
						"          ts_choppeddate as timestamp,",
						"          mpe_posthunstatustext as string,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          ts_humdate as timestamp,",
						"          ts_sellmandateidtype as string,",
						"          ts_dateofreminder as timestamp,",
						"          ts_humurl as string,",
						"          mpe_carveout as long,",
						"          mpe_targetbusiness_parentid as string,",
						"          mpe_targetbusiness_parentid_entitytype as string,",
						"          mpe_targetbusiness_parentidyominame as string,",
						"          mpe_targetbusiness_parentidname as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'ts_originationopportunity') ~> OriginationOpportunityIn",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          ts_stageofmeetingrounds as long,",
						"          ts_talentmeetingtype as long,",
						"          instancetypecode as long,",
						"          ts_whooriginatedthemeeting as long,",
						"          onlinemeetingtype as long,",
						"          ts_meetingteam as long,",
						"          ts_othermeetingmethod as long,",
						"          ts_tone as long,",
						"          ts_meetingmethod as long,",
						"          ts_originationmeetingtype as long,",
						"          prioritycode as long,",
						"          attachmenterrors as long,",
						"          ts_eventtype as long,",
						"          ts_talentmeetingmethod as long,",
						"          ts_productsdiscussed as string,",
						"          ts_contentcovered as string,",
						"          isonlinemeeting as boolean,",
						"          isworkflowcreated as boolean,",
						"          isalldayevent as boolean,",
						"          ts_interview as boolean,",
						"          isbilled as boolean,",
						"          isdraft as boolean,",
						"          ts_keyiractivity as boolean,",
						"          ts_noninvestor as boolean,",
						"          ismapiprivate as boolean,",
						"          isregularactivity as boolean,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          ts_investorgroup as string,",
						"          ts_investorgroup_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          regardingobjectid as string,",
						"          regardingobjectid_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ts_officemet as string,",
						"          ts_officemet_entitytype as string,",
						"          ts_taskowner as string,",
						"          ts_taskowner_entitytype as string,",
						"          serviceid as string,",
						"          serviceid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          requiredattendees as string,",
						"          optionalattendees as string,",
						"          organizer as string,",
						"          scheduledend as timestamp,",
						"          ts_taskdescription as string,",
						"          modifiedon as timestamp,",
						"          ts_purpose as string,",
						"          overriddencreatedon as timestamp,",
						"          ts_taskownername as string,",
						"          activityadditionalparams as string,",
						"          ts_tonepersonalities as string,",
						"          seriesid as string,",
						"          transactioncurrencyidname as string,",
						"          activityid as string,",
						"          modifiedfieldsmask as string,",
						"          utcconversiontimezonecode as long,",
						"          ts_officemetname as string,",
						"          scheduledstart as timestamp,",
						"          outlookownerapptid as long,",
						"          ts_topicscovered as string,",
						"          ts_objective as string,",
						"          onholdtime as long,",
						"          onlinemeetingjoinurl as string,",
						"          ts_notes as string,",
						"          originalstartdate as timestamp,",
						"          ts_opportunitiesdiscussed as string,",
						"          ts_sectorscoveredbyfirm as string,",
						"          attachmentcount as long,",
						"          exchangerate as decimal(38,10),",
						"          ts_originationcommentsnotes as string,",
						"          category as string,",
						"          createdon as string,",
						"          ts_eventdescription as string,",
						"          globalobjectid as string,",
						"          onlinemeetingid as string,",
						"          serviceidname as string,",
						"          owneridyominame as string,",
						"          description as string,",
						"          subcategory as string,",
						"          owningbusinessunitname as string,",
						"          ts_taskduedate as timestamp,",
						"          traversedpath as string,",
						"          sortdate as timestamp,",
						"          createdonbehalfbyname as string,",
						"          ts_sectorscoveredids as string,",
						"          safedescription as string,",
						"          ts_taskowneryominame as string,",
						"          owneridtype as string,",
						"          isunsafe as long,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          ts_conferencename as string,",
						"          timezoneruleversionnumber as long,",
						"          actualend as timestamp,",
						"          regardingobjectidname as string,",
						"          processid as string,",
						"          activitytypecode as string,",
						"          actualstart as timestamp,",
						"          xpd_listofexternalattendees as string,",
						"          slainvokedidname as string,",
						"          location as string,",
						"          subject as string,",
						"          createdbyname as string,",
						"          actualdurationminutes as long,",
						"          modifiedbyyominame as string,",
						"          lastonholdtime as timestamp,",
						"          modifiedonbehalfbyyominame as string,",
						"          ts_attendeestoaddtocrm as string,",
						"          regardingobjectidyominame as string,",
						"          regardingobjecttypecode as string,",
						"          stageid as string,",
						"          scheduleddurationminutes as long,",
						"          ts_sourceid as string,",
						"          ts_investorgroupyominame as string,",
						"          importsequencenumber as long,",
						"          subscriptionid as string,",
						"          onlinemeetingchatid as string,",
						"          ts_lpupdates as string,",
						"          ts_executivesummary as string,",
						"          ts_investorgroupname as string,",
						"          ts_meetingcity as string,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          owneridname as string,",
						"          ts_theirprogramme as string,",
						"          ts_ifdeclinedreason as string,",
						"          slaname as string,",
						"          versionnumber as long",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'appointment') ~> MeetingsAppointmentsIn",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          statecode as long,",
						"          statuscode as long,",
						"          haschildrencode as long,",
						"          customertypecode as long,",
						"          ts_recommendationofindividual as long,",
						"          gendercode as long,",
						"          address1_addresstypecode as long,",
						"          leadsourcecode as long,",
						"          preferredappointmenttimecode as long,",
						"          address2_freighttermscode as long,",
						"          address2_shippingmethodcode as long,",
						"          ts_debtsubtype as long,",
						"          msdyn_orgchangestatus as long,",
						"          ts_suffix as long,",
						"          xpd_gender as long,",
						"          ts_title as long,",
						"          paymenttermscode as long,",
						"          accountrolecode as long,",
						"          territorycode as long,",
						"          ts_vendortargettrackingrole as long,",
						"          address3_freighttermscode as long,",
						"          address1_shippingmethodcode as long,",
						"          preferredappointmentdaycode as long,",
						"          customersizecode as long,",
						"          preferredcontactmethodcode as long,",
						"          ts_futurecontactmethod as long,",
						"          address3_shippingmethodcode as long,",
						"          address2_addresstypecode as long,",
						"          mpe_flowlastrunoutcome as long,",
						"          ts_capabilitiesofindividual as long,",
						"          address3_addresstypecode as long,",
						"          familystatuscode as long,",
						"          shippingmethodcode as long,",
						"          xpd_availability as long,",
						"          educationcode as long,",
						"          address1_freighttermscode as long,",
						"          ts_quickcaptureuses as string,",
						"          xpd_montagulevel as string,",
						"          ts_permanentinterim as string,",
						"          ts_ircontactrole as string,",
						"          xpd_level as string,",
						"          ts_languagesspokenwritten as string,",
						"          ts_contacttype as string,",
						"          ts_montaguoffice as string,",
						"          ts_roletypes as string,",
						"          xpd_specialisms as string,",
						"          ts_quickcapturesectors as string,",
						"          xpd_function as string,",
						"          ts_producttype as string,",
						"          ts_quickcapturegeography as string,",
						"          ts_productsinterestedin as string,",
						"          ts_potentialrolecandidate as boolean,",
						"          isbackofficecustomer as boolean,",
						"          donotpostalmail as boolean,",
						"          xpd_addcontacttooutlook as boolean,",
						"          ts_centralrelationshipmanager as boolean,",
						"          msdyn_gdproptout as boolean,",
						"          xpd_hascompany as boolean,",
						"          creditonhold as boolean,",
						"          xpd_benchcandidate as boolean,",
						"          donotbulkpostalmail as boolean,",
						"          donotsendmm as boolean,",
						"          donotbulkemail as boolean,",
						"          followemail as boolean,",
						"          xpd_sharepointdocumentlocationcreated as boolean,",
						"          xpd_available as boolean,",
						"          ts_leadearlystageinteraction as boolean,",
						"          participatesinworkflow as boolean,",
						"          ts_doyouwishtotrackthiscontact as boolean,",
						"          merged as boolean,",
						"          ts_validated as boolean,",
						"          marketingonly as boolean,",
						"          donotfax as boolean,",
						"          isprivate as boolean,",
						"          donotphone as boolean,",
						"          isautocreate as boolean,",
						"          donotemail as boolean,",
						"          ts_unconfirmedemailaddress as boolean,",
						"          preferredsystemuserid as string,",
						"          preferredsystemuserid_entitytype as string,",
						"          mpe_accountid as string,",
						"          mpe_accountid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          ts_recommendedby as string,",
						"          ts_recommendedby_entitytype as string,",
						"          ts_previousemployerid as string,",
						"          ts_previousemployerid_entitytype as string,",
						"          preferredserviceid as string,",
						"          preferredserviceid_entitytype as string,",
						"          parentcontactid as string,",
						"          parentcontactid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          ts_pa as string,",
						"          ts_pa_entitytype as string,",
						"          ts_businessaddress as string,",
						"          ts_businessaddress_entitytype as string,",
						"          modifiedbyexternalparty as string,",
						"          modifiedbyexternalparty_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          originatingleadid as string,",
						"          originatingleadid_entitytype as string,",
						"          masterid as string,",
						"          masterid_entitytype as string,",
						"          defaultpricelevelid as string,",
						"          defaultpricelevelid_entitytype as string,",
						"          parent_contactid as string,",
						"          parent_contactid_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          createdbyexternalparty as string,",
						"          createdbyexternalparty_entitytype as string,",
						"          preferredequipmentid as string,",
						"          preferredequipmentid_entitytype as string,",
						"          xpd_referredbyinternal as string,",
						"          xpd_referredbyinternal_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          xpd_homecountry as string,",
						"          xpd_homecountry_entitytype as string,",
						"          ts_placementfirmintroducedby as string,",
						"          ts_placementfirmintroducedby_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          accountid as string,",
						"          accountid_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          parentcustomerid as string,",
						"          parentcustomerid_entitytype as string,",
						"          xpd_referredbyexternal as string,",
						"          xpd_referredbyexternal_entitytype as string,",
						"          aging30 as decimal(38,2),",
						"          creditlimit_base as decimal(38,4),",
						"          aging60 as decimal(38,2),",
						"          aging90 as decimal(38,2),",
						"          aging60_base as decimal(38,4),",
						"          aging90_base as decimal(38,4),",
						"          annualincome_base as decimal(38,4),",
						"          creditlimit as decimal(38,2),",
						"          annualincome as decimal(38,2),",
						"          aging30_base as decimal(38,4),",
						"          ts_othernotes as string,",
						"          xpd_referredbyinternalyominame as string,",
						"          address1_county as string,",
						"          yomilastname as string,",
						"          address3_utcoffset as long,",
						"          ts_recommendedbyname as string,",
						"          description as string,",
						"          li_membertoken as string,",
						"          department as string,",
						"          xpd_roletypes_text as string,",
						"          address1_addressid as string,",
						"          importsequencenumber as long,",
						"          address1_longitude as double,",
						"          address3_fax as string,",
						"          managername as string,",
						"          entityimageid as string,",
						"          telephone2 as string,",
						"          parentcustomeridtype as string,",
						"          address2_upszone as string,",
						"          address1_upszone as string,",
						"          xpd_recommendingportfoliocompaniesrecommended as string,",
						"          lastonholdtime as timestamp,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          address1_fax as string,",
						"          address3_telephone1 as string,",
						"          address3_telephone2 as string,",
						"          address3_telephone3 as string,",
						"          fax as string,",
						"          assistantname as string,",
						"          address2_line3 as string,",
						"          accountidyominame as string,",
						"          parentcontactidyominame as string,",
						"          mpe_accountidyominame as string,",
						"          slainvokedidname as string,",
						"          defaultpricelevelidname as string,",
						"          fullname as string,",
						"          address2_longitude as double,",
						"          subscriptionid as string,",
						"          originatingleadidname as string,",
						"          slaname as string,",
						"          versionnumber as long,",
						"          address1_latitude as double,",
						"          createdbyyominame as string,",
						"          parent_contactidname as string,",
						"          address2_telephone1 as string,",
						"          pager as string,",
						"          salutation as string,",
						"          mpe_accountidname as string,",
						"          xpd_functionuse_text as string,",
						"          accountidname as string,",
						"          mpe_companysummary as string,",
						"          parent_contactidyominame as string,",
						"          preferredserviceidname as string,",
						"          address2_city as string,",
						"          address3_postalcode as string,",
						"          address2_line2 as string,",
						"          li_companyid as long,",
						"          ts_otherphonelabel as string,",
						"          ts_reportingemail as string,",
						"          address3_upszone as string,",
						"          transactioncurrencyidname as string,",
						"          address3_county as string,",
						"          entityimage_url as string,",
						"          governmentid as string,",
						"          callback as string,",
						"          business2 as string,",
						"          createdonbehalfbyname as string,",
						"          ts_validateddate as timestamp,",
						"          address2_telephone2 as string,",
						"          owneridname as string,",
						"          originatingleadidyominame as string,",
						"          ts_otherlanguages as string,",
						"          address2_postalcode as string,",
						"          birthdate as timestamp,",
						"          parentcontactidname as string,",
						"          spousesname as string,",
						"          xpd_compensationdate as timestamp,",
						"          address1_utcoffset as long,",
						"          address3_line1 as string,",
						"          traversedpath as string,",
						"          exchangerate as decimal(38,10),",
						"          mpe_flowlastrundate as timestamp,",
						"          address1_line3 as string,",
						"          address3_country as string,",
						"          mpe_documentsetid as string,",
						"          address2_line1 as string,",
						"          ts_previousemployeridyominame as string,",
						"          middlename as string,",
						"          managerphone as string,",
						"          address2_stateorprovince as string,",
						"          childrensnames as string,",
						"          address2_name as string,",
						"          address3_addressid as string,",
						"          address3_stateorprovince as string,",
						"          ts_sectorspecialtyids as string,",
						"          businesscardattributes as string,",
						"          anniversary as timestamp,",
						"          ts_employmentstartdate as timestamp,",
						"          ts_legacycontacttypes as string,",
						"          address1_primarycontactname as string,",
						"          address2_utcoffset as long,",
						"          home2 as string,",
						"          ts_geographicspecialtyids as string,",
						"          address1_name as string,",
						"          ts_recommendationcomments as string,",
						"          address2_telephone3 as string,",
						"          address3_primarycontactname as string,",
						"          ftpsiteurl as string,",
						"          address1_postalcode as string,",
						"          createdon as string,",
						"          address1_stateorprovince as string,",
						"          yomimiddlename as string,",
						"          jobtitle as string,",
						"          telephone3 as string,",
						"          ts_usesspeciality as string,",
						"          ts_knowntouserinitials as string,",
						"          address2_fax as string,",
						"          createdbyname as string,",
						"          xpd_contactuse_text as string,",
						"          ts_sourceid as string,",
						"          address2_addressid as string,",
						"          employeeid as string,",
						"          address1_postofficebox as string,",
						"          address1_city as string,",
						"          ts_businessaddressname as string,",
						"          teamsfollowed as long,",
						"          ts_cv as string,",
						"          timezoneruleversionnumber as long,",
						"          modifiedonbehalfbyyominame as string,",
						"          xpd_hrcompensation as string,",
						"          ts_currentbonusandorupliftconsiderations as string,",
						"          modifiedbyname as string,",
						"          address3_line2 as string,",
						"          yomifullname as string,",
						"          owneridtype as string,",
						"          entityimage_timestamp as long,",
						"          ts_placementfirmintroducedbyyominame as string,",
						"          xpd_previousrole as string,",
						"          ts_compensation as string,",
						"          address2_postofficebox as string,",
						"          emailaddress3 as string,",
						"          emailaddress2 as string,",
						"          emailaddress1 as string,",
						"          ts_interactioncontactuniqueidentifier as string,",
						"          ts_investmentcafeid as string,",
						"          websiteurl as string,",
						"          nickname as string,",
						"          ts_lastmet as timestamp,",
						"          address3_name as string,",
						"          ts_usesspecialtyids as string,",
						"          ts_linkedinurl as string,",
						"          lastname as string,",
						"          address3_longitude as double,",
						"          xpd_referredbyexternalidtype as string,",
						"          parentcustomeridname as string,",
						"          owningbusinessunitname as string,",
						"          onholdtime as long,",
						"          createdonbehalfbyyominame as string,",
						"          preferredsystemuseridyominame as string,",
						"          createdbyexternalpartyname as string,",
						"          ts_tone as string,",
						"          telephone1 as string,",
						"          overriddencreatedon as timestamp,",
						"          address3_postofficebox as string,",
						"          assistantphone as string,",
						"          address1_composite as string,",
						"          address3_line3 as string,",
						"          address2_country as string,",
						"          xpd_referredbyinternalname as string,",
						"          mobilephone as string,",
						"          owneridyominame as string,",
						"          address1_line1 as string,",
						"          createdbyexternalpartyyominame as string,",
						"          xpd_referredbyexternalyominame as string,",
						"          yomifirstname as string,",
						"          mastercontactidname as string,",
						"          address3_city as string,",
						"          address1_country as string,",
						"          externaluseridentifier as string,",
						"          modifiedbyexternalpartyyominame as string,",
						"          firstname as string,",
						"          xpd_hrcurrentbonusandorupliftconsiderations as string,",
						"          stageid as string,",
						"          modifiedonbehalfbyname as string,",
						"          xpd_homecountryname as string,",
						"          mastercontactidyominame as string,",
						"          suffix as string,",
						"          ts_payominame as string,",
						"          lastusedincampaign as timestamp,",
						"          ts_geographicspeciality as string,",
						"          xpd_recruitmentareateam_text as string,",
						"          ts_retentionreviewdate as timestamp,",
						"          parentcustomeridyominame as string,",
						"          timespentbymeonemailandmeetings as string,",
						"          address2_latitude as double,",
						"          xpd_availablefrom as timestamp,",
						"          address3_composite as string,",
						"          xpd_recommendingportco as string,",
						"          preferredsystemuseridname as string,",
						"          utcconversiontimezonecode as long,",
						"          address2_county as string,",
						"          ts_paname as string,",
						"          contactid as string,",
						"          address2_primarycontactname as string,",
						"          ts_specificareasofexpertisecomments as string,",
						"          address1_line2 as string,",
						"          ts_recommendationofindividualupdated as timestamp,",
						"          xpd_referredbyexternalname as string,",
						"          ts_placementfirmintroducedbyname as string,",
						"          ts_sectorspeciality as string,",
						"          ts_previousemployeridname as string,",
						"          processid as string,",
						"          ts_recommendedbyyominame as string,",
						"          modifiedon as timestamp,",
						"          modifiedbyexternalpartyname as string,",
						"          ts_relevantsituations as string,",
						"          businesscard as string,",
						"          company as string,",
						"          preferredequipmentidname as string,",
						"          modifiedbyyominame as string,",
						"          ts_preferredname as string,",
						"          address2_composite as string,",
						"          numberofchildren as long,",
						"          address3_latitude as double,",
						"          mpe_companysearchbyemail as boolean,",
						"          msdyn_segmentid as string,",
						"          msdyn_segmentid_entitytype as string,",
						"          msdyn_segmentidname as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'synapse',",
						"     databaseType: 'spark',",
						"     format: 'table',",
						"     database: 'dataverse_montagu_org5a2bcccf',",
						"     tableName: 'contact') ~> ContactsIn",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          stateAZlabel as string,",
						"          statusAZlabel as string,",
						"          ts_primarysecondaryfocus as string,",
						"          customertypeAZlabel as string,",
						"          address1_addresstypeAZlabel as string,",
						"          accountclassificationAZlabel as string,",
						"          ts_easeofworking as string,",
						"          ts_ukrow as string,",
						"          preferredappointmenttimeAZlabel as string,",
						"          ts_address1addresstype as string,",
						"          xpd_relationshipstatus as string,",
						"          ts_relationship as string,",
						"          xpd_remindermonths as string,",
						"          ts_importance as string,",
						"          address2_freighttermsAZlabel as string,",
						"          ts_irrvsmomperformancemeasure as string,",
						"          ts_introducertype as string,",
						"          accountcategoryAZlabel as string,",
						"          paymenttermsAZlabel as string,",
						"          preferredappointmentdayAZlabel as string,",
						"          businesstypeAZlabel as string,",
						"          industryAZlabel as string,",
						"          ts_sizeoffirm as string,",
						"          ts_interaction as string,",
						"          address1_shippingmethodAZlabel as string,",
						"          ts_portfoliocompanystatus as string,",
						"          customersizeAZlabel as string,",
						"          xpd_previousinvestorstatus as string,",
						"          ts_recommendationoffirm as string,",
						"          preferredcontactmethodAZlabel as string,",
						"          accountratingAZlabel as string,",
						"          ts_investorstatus as string,",
						"          ts_capabilitiesoffirm as string,",
						"          mpe_flowlastrunoutcome as string,",
						"          address2_addresstypeAZlabel as string,",
						"          address2_shippingmethodAZlabel as string,",
						"          ts_nextoriginationmeetingarranged as string,",
						"          ownershipAZlabel as string,",
						"          territoryAZlabel as string,",
						"          ts_investortype as string,",
						"          shippingmethodAZlabel as string,",
						"          ts_investorregion as string,",
						"          address1_freighttermsAZlabel as string,",
						"          xpd_function as string,",
						"          ts_quickcaptureuses as string,",
						"          xpd_montagulevel as string,",
						"          ts_permanentinterim as string,",
						"          ts_quickcapturesectors as string,",
						"          ts_roletypes as string,",
						"          ts_companytype as string,",
						"          xpd_level as string,",
						"          ts_indicativeclientbase as string,",
						"          xpd_specialisms as string,",
						"          ts_vendorsummary as string,",
						"          ts_producttype as string,",
						"          ts_montaguoffice as string,",
						"          ts_quickcapturegeography as string,",
						"          xpd_roletypes as string,",
						"          mpe_livedeal as string,",
						"          donotbulkpostalmail as string,",
						"          donotpostalmail as string,",
						"          msdyn_gdproptout as string,",
						"          ts_organisationalchange as string,",
						"          xpd_publictoprivatetracker as string,",
						"          ts_auditor as string,",
						"          donotsendmm as string,",
						"          donotbulkemail as string,",
						"          followemail as string,",
						"          creditonhold as string,",
						"          marketingonly as string,",
						"          participatesinworkflow as string,",
						"          merged as string,",
						"          ts_validated as string,",
						"          xpd_sharepointlocationcreated as string,",
						"          xpd_setreminder as string,",
						"          ts_personnelchange as string,",
						"          donotfax as string,",
						"          isprivate as string,",
						"          donotphone as string,",
						"          xpd_rpo as string,",
						"          ts_trackcompany as string,",
						"          donotemail as string,",
						"          parentaccountid as string,",
						"          parentaccountid_entitytype as string,",
						"          ts_recommendedby as string,",
						"          ts_recommendedby_entitytype as string,",
						"          ts_countryofeconomicoriginforthecapital as string,",
						"          ts_countryofeconomicoriginforthecapital_entitytype as string,",
						"          xpd_reminderto as string,",
						"          xpd_reminderto_entitytype as string,",
						"          preferredserviceid as string,",
						"          preferredserviceid_entitytype as string,",
						"          msdyn_segmentid as string,",
						"          msdyn_segmentid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          createdbyexternalparty as string,",
						"          createdbyexternalparty_entitytype as string,",
						"          ts_validatedby as string,",
						"          ts_validatedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          ts_primarymperelationshipmanager as string,",
						"          ts_primarymperelationshipmanager_entitytype as string,",
						"          modifiedbyexternalparty as string,",
						"          modifiedbyexternalparty_entitytype as string,",
						"          ts_headofficeid as string,",
						"          ts_headofficeid_entitytype as string,",
						"          ts_address1country as string,",
						"          ts_address1country_entitytype as string,",
						"          ts_address1usstate as string,",
						"          ts_address1usstate_entitytype as string,",
						"          msdyn_salesaccelerationinsightid as string,",
						"          msdyn_salesaccelerationinsightid_entitytype as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          originatingleadid as string,",
						"          originatingleadid_entitytype as string,",
						"          masterid as string,",
						"          masterid_entitytype as string,",
						"          ts_originationlead1 as string,",
						"          ts_originationlead1_entitytype as string,",
						"          defaultpricelevelid as string,",
						"          defaultpricelevelid_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          ts_originationlead2 as string,",
						"          ts_originationlead2_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          mpe_coinvestquestionnaireid as string,",
						"          mpe_coinvestquestionnaireid_entitytype as string,",
						"          ts_hub as string,",
						"          ts_hub_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          ts_currentauditor as string,",
						"          ts_currentauditor_entitytype as string,",
						"          primarycontactid as string,",
						"          primarycontactid_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          preferredsystemuserid as string,",
						"          preferredsystemuserid_entitytype as string,",
						"          preferredequipmentid as string,",
						"          preferredequipmentid_entitytype as string,",
						"          xpd_fund as string,",
						"          xpd_fund_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          territoryid as string,",
						"          territoryid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          xpd_totalinstitutionalcommitments_base as decimal(38,0),",
						"          ts_minimumticketsize_base as decimal(38,4),",
						"          xpd_totalinstitutionalcommitments as decimal(38,0),",
						"          aging30 as decimal(38,0),",
						"          creditlimit as decimal(38,0),",
						"          creditlimit_base as decimal(38,0),",
						"          ts_totalcommitments_base as decimal(38,4),",
						"          aging60 as decimal(38,0),",
						"          ts_transfersin_base as decimal(38,0),",
						"          aging90 as decimal(38,0),",
						"          ts_maximumticketsize as decimal(38,4),",
						"          ts_totalaum_base as decimal(38,0),",
						"          marketcap_base as decimal(38,0),",
						"          aging60_base as decimal(38,0),",
						"          aging90_base as decimal(38,0),",
						"          ts_transfersout as decimal(38,0),",
						"          ts_maximumticketsize_base as decimal(38,4),",
						"          ts_originalcommitments_base as decimal(38,0),",
						"          revenue as decimal(38,0),",
						"          ts_totalcommitments as decimal(38,4),",
						"          ts_transfersout_base as decimal(38,0),",
						"          ts_totalaum as decimal(38,0),",
						"          ts_commitmentreductions_base as decimal(38,0),",
						"          ts_commitmentreductions as decimal(38,0),",
						"          marketcap as decimal(38,0),",
						"          ts_originalcommitments as decimal(38,0),",
						"          ts_minimumticketsize as decimal(38,4),",
						"          revenue_base as decimal(38,0),",
						"          openrevenue_base as decimal(38,0),",
						"          aging30_base as decimal(38,0),",
						"          openrevenue as decimal(38,0),",
						"          ts_transfersin as decimal(38,0),",
						"          ts_othernotes as string,",
						"          ts_transfersin_date as timestamp,",
						"          msdyn_salesaccelerationinsightidname as string,",
						"          address1_county as string,",
						"          openrevenue_date as timestamp,",
						"          ts_recommendedbyname as string,",
						"          ts_relationshipinteractioncomments as string,",
						"          ts_originationlead2yominame as string,",
						"          parentaccountidname as string,",
						"          xpd_roletypes_text as string,",
						"          address1_addressid as string,",
						"          importsequencenumber as long,",
						"          address1_longitude as double,",
						"          ts_countryofeconomicoriginforthecapitalname as string,",
						"          entityimageid as string,",
						"          telephone2 as string,",
						"          ts_lastoriginationmeeting as timestamp,",
						"          address2_utcoffset as long,",
						"          address1_upszone as string,",
						"          ts_originalcommitments_state as long,",
						"          ts_typicalcost as string,",
						"          xpd_recommendingportfoliocompaniesrecommended as string,",
						"          accountnumber as string,",
						"          ts_currentauditoryominame as string,",
						"          ts_originalcommitments_date as timestamp,",
						"          lastonholdtime as timestamp,",
						"          ts_sectorscoveredbyfirm as string,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          address2_upszone as string,",
						"          opendeals_state as long,",
						"          xpd_functionuse_text as string,",
						"          slainvokedidname as string,",
						"          address2_longitude as double,",
						"          defaultpricelevelidname as string,",
						"          stockexchange as string,",
						"          mpe_liveofferingscount_date as timestamp,",
						"          xpd_relationshipcomments as string,",
						"          originatingleadidname as string,",
						"          slaname as string,",
						"          ts_currentauditorname as string,",
						"          xpd_remindertoyominame as string,",
						"          ts_address1usstatename as string,",
						"          ts_tempcompanytype as string,",
						"          versionnumber as long,",
						"          address1_latitude as double,",
						"          ts_formername as string,",
						"          yominame as string,",
						"          createdbyyominame as string,",
						"          ts_cityofvisit as string,",
						"          address2_telephone1 as string,",
						"          ts_globalgeographiescoveredids as string,",
						"          preferredserviceidname as string,",
						"          address2_city as string,",
						"          ts_mpeapproachstrategy as string,",
						"          address2_line2 as string,",
						"          ts_lastdatestatuschanged as timestamp,",
						"          li_companyid as long,",
						"          transactioncurrencyidname as string,",
						"          entityimage_url as string,",
						"          xpd_relationshipstatuschangeddate as timestamp,",
						"          createdonbehalfbyname as string,",
						"          mpe_liveofferingscount_state as long,",
						"          xpd_numberofcoinvestinvestments_date as timestamp,",
						"          ts_validateddate as timestamp,",
						"          owneridname as string,",
						"          xpd_generalcomments as string,",
						"          ts_companylegalname as string,",
						"          description as string,",
						"          ts_validatedbyname as string,",
						"          originatingleadidyominame as string,",
						"          opendeals as long,",
						"          xpd_numberofopportunitiesshown_state as long,",
						"          address2_postalcode as string,",
						"          websiteurl as string,",
						"          xpd_fundname as string,",
						"          address1_utcoffset as long,",
						"          exchangerate as decimal(38,10),",
						"          mpe_flowlastrundate as timestamp,",
						"          fax as string,",
						"          address1_line3 as string,",
						"          ts_monthssincelastmeeting as long,",
						"          ts_hubname as string,",
						"          address2_line1 as string,",
						"          ts_capiqticket as string,",
						"          address2_stateorprovince as string,",
						"          address2_name as string,",
						"          ts_transfersout_state as long,",
						"          xpd_numberofopportunitiesshown as long,",
						"          primarytwitterid as string,",
						"          mpe_coinvestquestionnaireidname as string,",
						"          xpd_numberofopportunitiesshown_date as timestamp,",
						"          xpd_preferentialterms as string,",
						"          address1_primarycontactname as string,",
						"          territoryidname as string,",
						"          ts_processstatus as string,",
						"          address1_name as string,",
						"          address2_telephone2 as string,",
						"          address2_telephone3 as string,",
						"          xpd_recruitmentareateam_text as string,",
						"          ftpsiteurl as string,",
						"          address1_postalcode as string,",
						"          ts_companynumber as string,",
						"          createdon as string,",
						"          mpe_liveofferingscount as long,",
						"          traversedpath as string,",
						"          address1_stateorprovince as string,",
						"          ts_transfersin_state as long,",
						"          address2_addressid as string,",
						"          ts_monthlyreviewmeetingname as string,",
						"          primarysatoriid as string,",
						"          telephone3 as string,",
						"          openrevenue_state as long,",
						"          ts_usesprovidedids as string,",
						"          ts_originationcomments as string,",
						"          lastusedincampaign as timestamp,",
						"          primarycontactidname as string,",
						"          ts_originationlead1name as string,",
						"          ts_headofficeidname as string,",
						"          msdyn_segmentidname as string,",
						"          ts_montagucomments as string,",
						"          address2_fax as string,",
						"          createdbyname as string,",
						"          xpd_numberofcoinvestinvestments as long,",
						"          ts_capitaliqlink as string,",
						"          ts_primarymperelationshipmanagername as string,",
						"          mpe_relationshipstatus_text as string,",
						"          xpd_datereminderwasset as timestamp,",
						"          xpd_numberofcoinvestinvestments_state as long,",
						"          address1_postofficebox as string,",
						"          address1_city as string,",
						"          teamsfollowed as long,",
						"          ts_originationlead2name as string,",
						"          timezoneruleversionnumber as long,",
						"          modifiedonbehalfbyyominame as string,",
						"          entityimage_timestamp as long,",
						"          tickersymbol as string,",
						"          ts_theirprogrammecomments as string,",
						"          xpd_companyuse_text as string,",
						"          modifiedbyname as string,",
						"          owneridtype as string,",
						"          sic as string,",
						"          sharesoutstanding as long,",
						"          opendeals_date as timestamp,",
						"          address2_postofficebox as string,",
						"          emailaddress3 as string,",
						"          emailaddress2 as string,",
						"          emailaddress1 as string,",
						"          ts_globalgeographiescoveredbyfirm as string,",
						"          ts_recommendationoffirmupdated as timestamp,",
						"          ts_lastmet as timestamp,",
						"          ts_reminderdatesetto as timestamp,",
						"          ts_commitmentreductions_state as long,",
						"          owningbusinessunitname as string,",
						"          onholdtime as long,",
						"          ts_alias as string,",
						"          createdonbehalfbyyominame as string,",
						"          ts_transfersout_date as timestamp,",
						"          ts_address1countryname as string,",
						"          preferredsystemuseridyominame as string,",
						"          createdbyexternalpartyname as string,",
						"          mpe_documentsetid as string,",
						"          telephone1 as string,",
						"          ts_legacycompanytypes as string,",
						"          ts_validatedbyyominame as string,",
						"          address1_composite as string,",
						"          ts_investorgroupgatekeeperid as string,",
						"          primarycontactidyominame as string,",
						"          address2_country as string,",
						"          xpd_recommendationcomments as string,",
						"          owneridyominame as string,",
						"          createdbyexternalpartyyominame as string,",
						"          ts_originationlead1yominame as string,",
						"          ts_usesprovidedbyfirm as string,",
						"          xpd_recommendingportco as string,",
						"          address1_country as string,",
						"          ts_commitmentreductions_date as timestamp,",
						"          name as string,",
						"          modifiedbyexternalpartyyominame as string,",
						"          xpd_remindertoname as string,",
						"          stageid as string,",
						"          modifiedonbehalfbyname as string,",
						"          masteraccountidname as string,",
						"          timespentbymeonemailandmeetings as string,",
						"          address2_latitude as double,",
						"          overriddencreatedon as timestamp,",
						"          parentaccountidyominame as string,",
						"          ts_specificareaofexpertisecomments as string,",
						"          preferredsystemuseridname as string,",
						"          utcconversiontimezonecode as long,",
						"          address2_county as string,",
						"          address1_line1 as string,",
						"          address2_primarycontactname as string,",
						"          address1_line2 as string,",
						"          xpd_reasonaction as string,",
						"          ts_primarymperelationshipmanageryominame as string,",
						"          processid as string,",
						"          ts_sectorscoveredids as string,",
						"          ts_recommendedbyyominame as string,",
						"          modifiedbyexternalpartyname as string,",
						"          ts_relevantsituations as string,",
						"          accountid as string,",
						"          modifiedon as timestamp,",
						"          preferredequipmentidname as string,",
						"          modifiedbyyominame as string,",
						"          ts_dealstageofmostrecentopportunity as string,",
						"          address2_composite as string,",
						"          masteraccountidyominame as string,",
						"          numberofemployees as long,",
						"          address1_fax as string,",
						"          address2_line3 as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'account',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: false) ~> EnrichedAccount",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          stateAZlabel as string,",
						"          statusAZlabel as string,",
						"          ts_dealannouncedreason as string,",
						"          ts_highprioritynew as string,",
						"          ts_actionstatus as string,",
						"          mpe_targetrelationshipstatus as string,",
						"          mpe_carveout as string,",
						"          ts_producttype as string,",
						"          ts_internalintermediarysource as string,",
						"          mpe_flowlastrunoutcome as string,",
						"          ts_currentactivity as string,",
						"          ts_opportunitystatus as string,",
						"          ts_montaguprimaryoffice as string,",
						"          ts_opportunitytype as string,",
						"          ts_posthumstatus as string,",
						"          ts_meetingremindermonths as string,",
						"          ts_choppedreason as string,",
						"          ts_setreminder as string,",
						"          ts_stagereachedfir as string,",
						"          ts_stagereachedipr as string,",
						"          ts_duplicateopportunityfordiscussion as string,",
						"          mpe_smalltarget as string,",
						"          ts_stagereachedcr as string,",
						"          xpd_includeonallpapers as string,",
						"          ts_sold as string,",
						"          xpd_sharepointlocationcreated as string,",
						"          ts_statuschangedby as string,",
						"          ts_statuschangedby_entitytype as string,",
						"          ts_buyer as string,",
						"          ts_buyer_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          ts_reminderto as string,",
						"          ts_reminderto_entitytype as string,",
						"          mpe_productid as string,",
						"          mpe_productid_entitytype as string,",
						"          ts_targetbusiness as string,",
						"          ts_targetbusiness_entitytype as string,",
						"          ts_firstreferralcompany as string,",
						"          ts_firstreferralcompany_entitytype as string,",
						"          ts_deallead as string,",
						"          ts_deallead_entitytype as string,",
						"          ts_montaguowner as string,",
						"          ts_montaguowner_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          ts_firstreferralcontact as string,",
						"          ts_firstreferralcontact_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ts_managerwedback as string,",
						"          ts_managerwedback_entitytype as string,",
						"          ts_country as string,",
						"          ts_country_entitytype as string,",
						"          mpe_targetbusiness_parentid as string,",
						"          mpe_targetbusiness_parentid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          ts_sellmandate as string,",
						"          ts_sellmandate_entitytype as string,",
						"          ts_estebitda_base as decimal(38,4),",
						"          ts_estebit_base as decimal(38,4),",
						"          ts_estebitda as decimal(38,4),",
						"          ts_estebit as decimal(38,4),",
						"          ts_estturnover_base as decimal(38,4),",
						"          ts_estdealsize as decimal(38,4),",
						"          ts_estdealsize_base as decimal(38,4),",
						"          ts_estturnover as decimal(38,4),",
						"          ts_buyeryominame as string,",
						"          modifiedon as timestamp,",
						"          ts_statuschangedbyname as string,",
						"          ts_managerwedbackyominame as string,",
						"          xpd_montaguprojectname as string,",
						"          transactioncurrencyidname as string,",
						"          ts_nextsteps as string,",
						"          ts_montaguowneryominame as string,",
						"          ts_firstreferralcontactname as string,",
						"          ts_opportunitydescription as string,",
						"          ts_buyerpaidxltmebitda as decimal(38,1),",
						"          ts_targetbusinessyominame as string,",
						"          ts_montaguownername as string,",
						"          ts_managerwedbackname as string,",
						"          ts_opportunitystage as string,",
						"          ts_otherdocumentsurl as string,",
						"          exchangerate as decimal(38,10),",
						"          mpe_documentsetid as string,",
						"          ts_buyername as string,",
						"          ts_firstreferralcontactyominame as string,",
						"          createdon as string,",
						"          ts_sellmandateyominame as string,",
						"          mpe_montaguprimaryofficestring as string,",
						"          ts_statuschangedbyyominame as string,",
						"          ts_firstreferralcompanyname as string,",
						"          owneridyominame as string,",
						"          ts_choppedcomments as string,",
						"          timezoneruleversionnumber as long,",
						"          createdbyname as string,",
						"          ts_dealleadname as string,",
						"          owningbusinessunitname as string,",
						"          ts_dealleadyominame as string,",
						"          ts_lastdatestatuschanged as timestamp,",
						"          traversedpath as string,",
						"          overriddencreatedon as timestamp,",
						"          ts_iprdocumenturl as string,",
						"          createdonbehalfbyname as string,",
						"          ts_sellmandatename as string,",
						"          owneridtype as string,",
						"          owneridname as string,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          mpe_productidname as string,",
						"          mpe_targetbusiness_parentidyominame as string,",
						"          ts_originationopportunityid as string,",
						"          ts_crdocumenturl as string,",
						"          ts_datedealannounced as timestamp,",
						"          processid as string,",
						"          mpe_montaguprimaryofficeowner as string,",
						"          ts_reason as string,",
						"          ts_targetbusinessname as string,",
						"          ts_remindertoname as string,",
						"          ts_postcompletionnoteurl as string,",
						"          ts_name as string,",
						"          stageid as string,",
						"          ts_currentopportunitystatus as string,",
						"          ts_firstreferralcompanyyominame as string,",
						"          mpe_flowlastrundate as timestamp,",
						"          ts_firdocumenturl as string,",
						"          modifiedbyyominame as string,",
						"          modifiedonbehalfbyyominame as string,",
						"          ts_movedoutofwipdate as timestamp,",
						"          ts_equitychequesize as decimal(38,2),",
						"          utcconversiontimezonecode as long,",
						"          mpe_targetbusiness_parentidname as string,",
						"          ts_weofferedxltmebitda as decimal(38,1),",
						"          importsequencenumber as long,",
						"          ts_remindertoyominame as string,",
						"          ts_companyid as long,",
						"          ts_datereminderwasset as timestamp,",
						"          versionnumber as long,",
						"          ts_originationid as long,",
						"          ts_countryname as string,",
						"          ts_choppeddate as timestamp,",
						"          mpe_posthunstatustext as string,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          ts_humdate as timestamp,",
						"          ts_sellmandateidtype as string,",
						"          ts_dateofreminder as timestamp,",
						"          ts_humurl as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'ts_originationopportunity',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: false) ~> EnrichedOriginationOpportunities",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          stateAZlabel as string,",
						"          statusAZlabel as string,",
						"          ts_stageofmeetingrounds as string,",
						"          ts_talentmeetingtype as string,",
						"          instancetypeAZlabel as string,",
						"          ts_whooriginatedthemeeting as string,",
						"          onlinemeetingtype as string,",
						"          ts_meetingteam as string,",
						"          ts_othermeetingmethod as string,",
						"          ts_tone as string,",
						"          ts_meetingmethod as string,",
						"          ts_originationmeetingtype as string,",
						"          priorityAZlabel as string,",
						"          attachmenterrors as string,",
						"          ts_eventtype as string,",
						"          ts_talentmeetingmethod as string,",
						"          ts_productsdiscussed as string,",
						"          ts_contentcovered as string,",
						"          isonlinemeeting as string,",
						"          isworkflowcreated as string,",
						"          isalldayevent as string,",
						"          ts_interview as string,",
						"          isbilled as string,",
						"          isdraft as string,",
						"          ts_keyiractivity as string,",
						"          ts_noninvestor as string,",
						"          ismapiprivate as string,",
						"          isregularactivity as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          ts_investorgroup as string,",
						"          ts_investorgroup_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          regardingobjectid as string,",
						"          regardingobjectid_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ts_officemet as string,",
						"          ts_officemet_entitytype as string,",
						"          ts_taskowner as string,",
						"          ts_taskowner_entitytype as string,",
						"          serviceid as string,",
						"          serviceid_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          requiredattendees as string,",
						"          optionalattendees as string,",
						"          organizer as string,",
						"          scheduledend as timestamp,",
						"          ts_taskdescription as string,",
						"          modifiedon as timestamp,",
						"          ts_purpose as string,",
						"          overriddencreatedon as timestamp,",
						"          ts_taskownername as string,",
						"          activityadditionalparams as string,",
						"          ts_tonepersonalities as string,",
						"          seriesid as string,",
						"          transactioncurrencyidname as string,",
						"          activityid as string,",
						"          modifiedfieldsmask as string,",
						"          utcconversiontimezonecode as long,",
						"          ts_officemetname as string,",
						"          scheduledstart as timestamp,",
						"          outlookownerapptid as long,",
						"          ts_topicscovered as string,",
						"          ts_objective as string,",
						"          onholdtime as long,",
						"          onlinemeetingjoinurl as string,",
						"          ts_notes as string,",
						"          originalstartdate as timestamp,",
						"          ts_opportunitiesdiscussed as string,",
						"          ts_sectorscoveredbyfirm as string,",
						"          attachmentcount as long,",
						"          exchangerate as decimal(38,10),",
						"          ts_originationcommentsnotes as string,",
						"          category as string,",
						"          createdon as string,",
						"          ts_eventdescription as string,",
						"          globalobjectid as string,",
						"          onlinemeetingid as string,",
						"          serviceidname as string,",
						"          owneridyominame as string,",
						"          description as string,",
						"          subcategory as string,",
						"          owningbusinessunitname as string,",
						"          ts_taskduedate as timestamp,",
						"          traversedpath as string,",
						"          sortdate as timestamp,",
						"          createdonbehalfbyname as string,",
						"          ts_sectorscoveredids as string,",
						"          safedescription as string,",
						"          ts_taskowneryominame as string,",
						"          owneridtype as string,",
						"          isunsafe as long,",
						"          modifiedonbehalfbyname as string,",
						"          createdonbehalfbyyominame as string,",
						"          ts_conferencename as string,",
						"          timezoneruleversionnumber as long,",
						"          actualend as timestamp,",
						"          regardingobjectidname as string,",
						"          processid as string,",
						"          activitytypecode as string,",
						"          actualstart as timestamp,",
						"          xpd_listofexternalattendees as string,",
						"          slainvokedidname as string,",
						"          location as string,",
						"          subject as string,",
						"          createdbyname as string,",
						"          actualdurationminutes as long,",
						"          modifiedbyyominame as string,",
						"          lastonholdtime as timestamp,",
						"          modifiedonbehalfbyyominame as string,",
						"          ts_attendeestoaddtocrm as string,",
						"          regardingobjectidyominame as string,",
						"          regardingobjecttypecode as string,",
						"          stageid as string,",
						"          scheduleddurationminutes as long,",
						"          ts_sourceid as string,",
						"          ts_investorgroupyominame as string,",
						"          importsequencenumber as long,",
						"          subscriptionid as string,",
						"          onlinemeetingchatid as string,",
						"          ts_lpupdates as string,",
						"          ts_executivesummary as string,",
						"          ts_investorgroupname as string,",
						"          ts_meetingcity as string,",
						"          modifiedbyname as string,",
						"          createdbyyominame as string,",
						"          owneridname as string,",
						"          ts_theirprogramme as string,",
						"          ts_ifdeclinedreason as string,",
						"          slaname as string,",
						"          versionnumber as long",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'appointment',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: false) ~> EnrichedMeetingAppointments",
						"source(output(",
						"          Id as string,",
						"          SinkCreatedOn as timestamp,",
						"          SinkModifiedOn as timestamp,",
						"          stateAZlabel as string,",
						"          statusAZlabel as string,",
						"          haschildrenAZlabel as string,",
						"          customertypeAZlabel as string,",
						"          ts_recommendationofindividual as string,",
						"          genderAZlabel as string,",
						"          address1_addresstypeAZlabel as string,",
						"          leadsourceAZlabel as string,",
						"          preferredappointmenttimeAZlabel as string,",
						"          address2_freighttermsAZlabel as string,",
						"          address2_shippingmethodAZlabel as string,",
						"          ts_debtsubtype as string,",
						"          msdyn_orgchangestatus as string,",
						"          ts_suffix as string,",
						"          xpd_gender as string,",
						"          ts_title as string,",
						"          paymenttermsAZlabel as string,",
						"          accountroleAZlabel as string,",
						"          territoryAZlabel as string,",
						"          ts_vendortargettrackingrole as string,",
						"          address3_freighttermsAZlabel as string,",
						"          address1_shippingmethodAZlabel as string,",
						"          preferredappointmentdayAZlabel as string,",
						"          customersizeAZlabel as string,",
						"          preferredcontactmethodAZlabel as string,",
						"          ts_futurecontactmethod as string,",
						"          address3_shippingmethodAZlabel as string,",
						"          address2_addresstypeAZlabel as string,",
						"          mpe_flowlastrunoutcome as string,",
						"          ts_capabilitiesofindividual as string,",
						"          address3_addresstypeAZlabel as string,",
						"          familystatusAZlabel as string,",
						"          shippingmethodAZlabel as string,",
						"          xpd_availability as string,",
						"          educationAZlabel as string,",
						"          address1_freighttermsAZlabel as string,",
						"          ts_quickcaptureuses as string,",
						"          xpd_montagulevel as string,",
						"          ts_permanentinterim as string,",
						"          ts_ircontactrole as string,",
						"          xpd_level as string,",
						"          ts_languagesspokenwritten as string,",
						"          ts_contacttype as string,",
						"          ts_montaguoffice as string,",
						"          ts_roletypes as string,",
						"          xpd_specialisms as string,",
						"          ts_quickcapturesectors as string,",
						"          xpd_function as string,",
						"          ts_producttype as string,",
						"          ts_quickcapturegeography as string,",
						"          ts_productsinterestedin as string,",
						"          ts_potentialrolecandidate as string,",
						"          isbackofficecustomer as string,",
						"          donotpostalmail as string,",
						"          xpd_addcontacttooutlook as string,",
						"          ts_centralrelationshipmanager as string,",
						"          msdyn_gdproptout as string,",
						"          xpd_hascompany as string,",
						"          creditonhold as string,",
						"          xpd_benchcandidate as string,",
						"          donotbulkpostalmail as string,",
						"          donotsendmm as string,",
						"          donotbulkemail as string,",
						"          followemail as string,",
						"          xpd_sharepointdocumentlocationcreated as string,",
						"          xpd_available as string,",
						"          ts_leadearlystageinteraction as string,",
						"          participatesinworkflow as string,",
						"          ts_doyouwishtotrackthiscontact as string,",
						"          merged as string,",
						"          ts_validated as string,",
						"          marketingonly as string,",
						"          donotfax as string,",
						"          isprivate as string,",
						"          donotphone as string,",
						"          isautocreate as string,",
						"          donotemail as string,",
						"          ts_unconfirmedemailaddress as string,",
						"          mpe_companysearchbyemail as string,",
						"          preferredsystemuserid as string,",
						"          preferredsystemuserid_entitytype as string,",
						"          mpe_accountid as string,",
						"          mpe_accountid_entitytype as string,",
						"          owningbusinessunit as string,",
						"          owningbusinessunit_entitytype as string,",
						"          ts_recommendedby as string,",
						"          ts_recommendedby_entitytype as string,",
						"          ts_previousemployerid as string,",
						"          ts_previousemployerid_entitytype as string,",
						"          preferredserviceid as string,",
						"          preferredserviceid_entitytype as string,",
						"          msdyn_segmentid as string,",
						"          msdyn_segmentid_entitytype as string,",
						"          parentcontactid as string,",
						"          parentcontactid_entitytype as string,",
						"          transactioncurrencyid as string,",
						"          transactioncurrencyid_entitytype as string,",
						"          ts_pa as string,",
						"          ts_pa_entitytype as string,",
						"          ts_businessaddress as string,",
						"          ts_businessaddress_entitytype as string,",
						"          modifiedbyexternalparty as string,",
						"          modifiedbyexternalparty_entitytype as string,",
						"          slainvokedid as string,",
						"          slainvokedid_entitytype as string,",
						"          slaid as string,",
						"          slaid_entitytype as string,",
						"          originatingleadid as string,",
						"          originatingleadid_entitytype as string,",
						"          masterid as string,",
						"          masterid_entitytype as string,",
						"          defaultpricelevelid as string,",
						"          defaultpricelevelid_entitytype as string,",
						"          parent_contactid as string,",
						"          parent_contactid_entitytype as string,",
						"          owninguser as string,",
						"          owninguser_entitytype as string,",
						"          createdbyexternalparty as string,",
						"          createdbyexternalparty_entitytype as string,",
						"          preferredequipmentid as string,",
						"          preferredequipmentid_entitytype as string,",
						"          xpd_referredbyinternal as string,",
						"          xpd_referredbyinternal_entitytype as string,",
						"          modifiedonbehalfby as string,",
						"          modifiedonbehalfby_entitytype as string,",
						"          owningteam as string,",
						"          owningteam_entitytype as string,",
						"          xpd_homecountry as string,",
						"          xpd_homecountry_entitytype as string,",
						"          ts_placementfirmintroducedby as string,",
						"          ts_placementfirmintroducedby_entitytype as string,",
						"          modifiedby as string,",
						"          modifiedby_entitytype as string,",
						"          accountid as string,",
						"          accountid_entitytype as string,",
						"          createdonbehalfby as string,",
						"          createdonbehalfby_entitytype as string,",
						"          createdby as string,",
						"          createdby_entitytype as string,",
						"          ownerid as string,",
						"          ownerid_entitytype as string,",
						"          parentcustomerid as string,",
						"          parentcustomerid_entitytype as string,",
						"          xpd_referredbyexternal as string,",
						"          xpd_referredbyexternal_entitytype as string,",
						"          aging30 as decimal(38,2),",
						"          creditlimit_base as decimal(38,4),",
						"          aging60 as decimal(38,2),",
						"          aging90 as decimal(38,2),",
						"          aging60_base as decimal(38,4),",
						"          aging90_base as decimal(38,4),",
						"          annualincome_base as decimal(38,4),",
						"          creditlimit as decimal(38,2),",
						"          annualincome as decimal(38,2),",
						"          aging30_base as decimal(38,4),",
						"          ts_othernotes as string,",
						"          xpd_referredbyinternalyominame as string,",
						"          address1_county as string,",
						"          yomilastname as string,",
						"          address3_utcoffset as long,",
						"          ts_recommendedbyname as string,",
						"          description as string,",
						"          li_membertoken as string,",
						"          department as string,",
						"          xpd_roletypes_text as string,",
						"          address1_addressid as string,",
						"          importsequencenumber as long,",
						"          address1_longitude as double,",
						"          address3_fax as string,",
						"          managername as string,",
						"          entityimageid as string,",
						"          telephone2 as string,",
						"          parentcustomeridtype as string,",
						"          address2_upszone as string,",
						"          address1_upszone as string,",
						"          xpd_recommendingportfoliocompaniesrecommended as string,",
						"          lastonholdtime as timestamp,",
						"          address1_telephone1 as string,",
						"          address1_telephone2 as string,",
						"          address1_telephone3 as string,",
						"          address1_fax as string,",
						"          address3_telephone1 as string,",
						"          address3_telephone2 as string,",
						"          address3_telephone3 as string,",
						"          fax as string,",
						"          assistantname as string,",
						"          address2_line3 as string,",
						"          accountidyominame as string,",
						"          parentcontactidyominame as string,",
						"          mpe_accountidyominame as string,",
						"          slainvokedidname as string,",
						"          defaultpricelevelidname as string,",
						"          fullname as string,",
						"          address2_longitude as double,",
						"          subscriptionid as string,",
						"          originatingleadidname as string,",
						"          slaname as string,",
						"          versionnumber as long,",
						"          address1_latitude as double,",
						"          createdbyyominame as string,",
						"          parent_contactidname as string,",
						"          address2_telephone1 as string,",
						"          pager as string,",
						"          salutation as string,",
						"          mpe_accountidname as string,",
						"          xpd_functionuse_text as string,",
						"          accountidname as string,",
						"          mpe_companysummary as string,",
						"          parent_contactidyominame as string,",
						"          preferredserviceidname as string,",
						"          address2_city as string,",
						"          address3_postalcode as string,",
						"          address2_line2 as string,",
						"          li_companyid as long,",
						"          ts_otherphonelabel as string,",
						"          ts_reportingemail as string,",
						"          address3_upszone as string,",
						"          transactioncurrencyidname as string,",
						"          address3_county as string,",
						"          entityimage_url as string,",
						"          governmentid as string,",
						"          callback as string,",
						"          business2 as string,",
						"          createdonbehalfbyname as string,",
						"          ts_validateddate as timestamp,",
						"          address2_telephone2 as string,",
						"          owneridname as string,",
						"          originatingleadidyominame as string,",
						"          ts_otherlanguages as string,",
						"          address2_postalcode as string,",
						"          birthdate as timestamp,",
						"          parentcontactidname as string,",
						"          spousesname as string,",
						"          xpd_compensationdate as timestamp,",
						"          address1_utcoffset as long,",
						"          address3_line1 as string,",
						"          traversedpath as string,",
						"          exchangerate as decimal(38,10),",
						"          mpe_flowlastrundate as timestamp,",
						"          address1_line3 as string,",
						"          address3_country as string,",
						"          mpe_documentsetid as string,",
						"          address2_line1 as string,",
						"          ts_previousemployeridyominame as string,",
						"          middlename as string,",
						"          managerphone as string,",
						"          address2_stateorprovince as string,",
						"          childrensnames as string,",
						"          address2_name as string,",
						"          address3_addressid as string,",
						"          address3_stateorprovince as string,",
						"          ts_sectorspecialtyids as string,",
						"          businesscardattributes as string,",
						"          anniversary as timestamp,",
						"          ts_employmentstartdate as timestamp,",
						"          ts_legacycontacttypes as string,",
						"          address1_primarycontactname as string,",
						"          address2_utcoffset as long,",
						"          home2 as string,",
						"          ts_geographicspecialtyids as string,",
						"          address1_name as string,",
						"          ts_recommendationcomments as string,",
						"          address2_telephone3 as string,",
						"          address3_primarycontactname as string,",
						"          ftpsiteurl as string,",
						"          address1_postalcode as string,",
						"          createdon as string,",
						"          address1_stateorprovince as string,",
						"          yomimiddlename as string,",
						"          jobtitle as string,",
						"          telephone3 as string,",
						"          ts_usesspeciality as string,",
						"          msdyn_segmentidname as string,",
						"          ts_knowntouserinitials as string,",
						"          address2_fax as string,",
						"          createdbyname as string,",
						"          xpd_contactuse_text as string,",
						"          ts_sourceid as string,",
						"          address2_addressid as string,",
						"          employeeid as string,",
						"          address1_postofficebox as string,",
						"          address1_city as string,",
						"          ts_businessaddressname as string,",
						"          teamsfollowed as long,",
						"          ts_cv as string,",
						"          timezoneruleversionnumber as long,",
						"          modifiedonbehalfbyyominame as string,",
						"          xpd_hrcompensation as string,",
						"          ts_currentbonusandorupliftconsiderations as string,",
						"          modifiedbyname as string,",
						"          address3_line2 as string,",
						"          yomifullname as string,",
						"          owneridtype as string,",
						"          entityimage_timestamp as long,",
						"          ts_placementfirmintroducedbyyominame as string,",
						"          xpd_previousrole as string,",
						"          ts_compensation as string,",
						"          address2_postofficebox as string,",
						"          emailaddress3 as string,",
						"          emailaddress2 as string,",
						"          emailaddress1 as string,",
						"          ts_interactioncontactuniqueidentifier as string,",
						"          ts_investmentcafeid as string,",
						"          websiteurl as string,",
						"          nickname as string,",
						"          ts_lastmet as timestamp,",
						"          address3_name as string,",
						"          ts_usesspecialtyids as string,",
						"          ts_linkedinurl as string,",
						"          lastname as string,",
						"          address3_longitude as double,",
						"          xpd_referredbyexternalidtype as string,",
						"          parentcustomeridname as string,",
						"          owningbusinessunitname as string,",
						"          onholdtime as long,",
						"          createdonbehalfbyyominame as string,",
						"          preferredsystemuseridyominame as string,",
						"          createdbyexternalpartyname as string,",
						"          ts_tone as string,",
						"          telephone1 as string,",
						"          overriddencreatedon as timestamp,",
						"          address3_postofficebox as string,",
						"          assistantphone as string,",
						"          address1_composite as string,",
						"          address3_line3 as string,",
						"          address2_country as string,",
						"          xpd_referredbyinternalname as string,",
						"          mobilephone as string,",
						"          owneridyominame as string,",
						"          address1_line1 as string,",
						"          createdbyexternalpartyyominame as string,",
						"          xpd_referredbyexternalyominame as string,",
						"          yomifirstname as string,",
						"          mastercontactidname as string,",
						"          address3_city as string,",
						"          address1_country as string,",
						"          externaluseridentifier as string,",
						"          modifiedbyexternalpartyyominame as string,",
						"          firstname as string,",
						"          xpd_hrcurrentbonusandorupliftconsiderations as string,",
						"          stageid as string,",
						"          modifiedonbehalfbyname as string,",
						"          xpd_homecountryname as string,",
						"          mastercontactidyominame as string,",
						"          suffix as string,",
						"          ts_payominame as string,",
						"          lastusedincampaign as timestamp,",
						"          ts_geographicspeciality as string,",
						"          xpd_recruitmentareateam_text as string,",
						"          ts_retentionreviewdate as timestamp,",
						"          parentcustomeridyominame as string,",
						"          timespentbymeonemailandmeetings as string,",
						"          address2_latitude as double,",
						"          xpd_availablefrom as timestamp,",
						"          address3_composite as string,",
						"          xpd_recommendingportco as string,",
						"          preferredsystemuseridname as string,",
						"          utcconversiontimezonecode as long,",
						"          address2_county as string,",
						"          ts_paname as string,",
						"          contactid as string,",
						"          address2_primarycontactname as string,",
						"          ts_specificareasofexpertisecomments as string,",
						"          address1_line2 as string,",
						"          ts_recommendationofindividualupdated as timestamp,",
						"          xpd_referredbyexternalname as string,",
						"          ts_placementfirmintroducedbyname as string,",
						"          ts_sectorspeciality as string,",
						"          ts_previousemployeridname as string,",
						"          processid as string,",
						"          ts_recommendedbyyominame as string,",
						"          modifiedon as timestamp,",
						"          modifiedbyexternalpartyname as string,",
						"          ts_relevantsituations as string,",
						"          businesscard as string,",
						"          company as string,",
						"          preferredequipmentidname as string,",
						"          modifiedbyyominame as string,",
						"          ts_preferredname as string,",
						"          address2_composite as string,",
						"          numberofchildren as long,",
						"          address3_latitude as double",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'contact',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: false) ~> EnrichedContacts",
						"MeetingsAppointmentsIn select(mapColumn(",
						"          Id,",
						"          ts_meetingteam,",
						"          ts_othermeetingmethod,",
						"          isonlinemeeting,",
						"          isalldayevent,",
						"          regardingobjectid,",
						"          ts_taskowner,",
						"          scheduledend,",
						"          ts_taskdescription,",
						"          scheduledstart,",
						"          onlinemeetingjoinurl,",
						"          ts_notes,",
						"          ts_opportunitiesdiscussed,",
						"          ts_sectorscoveredbyfirm,",
						"          ts_originationcommentsnotes,",
						"          ts_taskduedate,",
						"          ts_sectorscoveredids,",
						"          location,",
						"          scheduleddurationminutes",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> MeetingsCleanselect",
						"ContactsIn select(mapColumn(",
						"          Id,",
						"          ts_recommendationofindividual,",
						"          gendercode,",
						"          paymenttermscode,",
						"          ts_vendortargettrackingrole,",
						"          address1_shippingmethodcode,",
						"          preferredcontactmethodcode,",
						"          ts_capabilitiesofindividual,",
						"          familystatuscode,",
						"          xpd_availability,",
						"          address1_freighttermscode,",
						"          xpd_montagulevel,",
						"          ts_permanentinterim,",
						"          ts_ircontactrole,",
						"          xpd_level,",
						"          ts_languagesspokenwritten,",
						"          ts_montaguoffice,",
						"          ts_roletypes,",
						"          xpd_specialisms,",
						"          xpd_function,",
						"          ts_producttype,",
						"          ts_productsinterestedin,",
						"          donotpostalmail,",
						"          ts_centralrelationshipmanager,",
						"          creditonhold,",
						"          xpd_benchcandidate,",
						"          donotsendmm,",
						"          donotbulkemail,",
						"          followemail,",
						"          xpd_available,",
						"          donotfax,",
						"          donotphone,",
						"          donotemail,",
						"          ts_recommendedby,",
						"          transactioncurrencyid,",
						"          originatingleadid,",
						"          xpd_homecountry,",
						"          creditlimit,",
						"          telephone2,",
						"          salutation,",
						"          ts_reportingemail,",
						"          ts_otherlanguages,",
						"          birthdate,",
						"          spousesname,",
						"          xpd_compensationdate,",
						"          anniversary,",
						"          ts_recommendationcomments,",
						"          ts_usesspeciality,",
						"          xpd_hrcompensation,",
						"          ts_currentbonusandorupliftconsiderations,",
						"          ts_compensation,",
						"          emailaddress2,",
						"          ts_investmentcafeid,",
						"          ts_lastmet,",
						"          ts_tone,",
						"          xpd_hrcurrentbonusandorupliftconsiderations,",
						"          lastusedincampaign,",
						"          ts_geographicspeciality,",
						"          xpd_availablefrom,",
						"          xpd_recommendingportco,",
						"          contactid,",
						"          ts_sectorspeciality",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> contactscleanselect",
						"OriginationOpportunityIn select(mapColumn(",
						"          Id,",
						"          ts_actionstatus,",
						"          ts_producttype,",
						"          ts_internalintermediarysource,",
						"          ts_currentactivity,",
						"          ts_opportunitystatus,",
						"          ts_montaguprimaryoffice,",
						"          ts_opportunitytype,",
						"          ts_posthumstatus,",
						"          ts_choppedreason,",
						"          ts_duplicateopportunityfordiscussion,",
						"          mpe_smalltarget,",
						"          xpd_includeonallpapers,",
						"          ts_sold,",
						"          xpd_sharepointlocationcreated,",
						"          ts_buyer,",
						"          mpe_productid,",
						"          ts_targetbusiness,",
						"          ts_firstreferralcompany,",
						"          ts_montaguowner,",
						"          ts_firstreferralcontact,",
						"          transactioncurrencyid,",
						"          ts_managerwedback,",
						"          ts_country,",
						"          ownerid,",
						"          ts_estebitda,",
						"          ts_estebit,",
						"          ts_estdealsize,",
						"          ts_estturnover,",
						"          ts_nextsteps,",
						"          ts_buyerpaidxltmebitda,",
						"          ts_opportunitystage,",
						"          ts_choppedcomments,",
						"          ts_datedealannounced,",
						"          ts_name,",
						"          ts_weofferedxltmebitda,",
						"          ts_companyid,",
						"          ts_choppeddate,",
						"          mpe_carveout,",
						"          mpe_targetbusiness_parentid",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> OrigiopportCleanout",
						"AccountIn select(mapColumn(",
						"          Id,",
						"          ts_primarysecondaryfocus,",
						"          xpd_relationshipstatus,",
						"          ts_introducertype,",
						"          xpd_remindermonths,",
						"          ts_portfoliocompanystatus,",
						"          ts_companytype,",
						"          ts_vendorsummary,",
						"          xpd_publictoprivatetracker,",
						"          xpd_setreminder,",
						"          ts_trackcompany,",
						"          parentaccountid,",
						"          xpd_reminderto,",
						"          ts_headofficeid,",
						"          ts_originationlead1,",
						"          ts_originationlead2,",
						"          ts_currentauditor,",
						"          ts_othernotes,",
						"          xpd_relationshipcomments,",
						"          ts_formername,",
						"          ts_mpeapproachstrategy,",
						"          ts_lastdatestatuschanged,",
						"          xpd_relationshipstatuschangeddate,",
						"          ts_companylegalname,",
						"          ts_companynumber,",
						"          ts_monthlyreviewmeetingname,",
						"          ts_originationcomments,",
						"          ts_capitaliqlink,",
						"          xpd_datereminderwasset,",
						"          ts_reminderdatesetto,",
						"          ts_alias,",
						"          xpd_reasonaction,",
						"          ts_relevantsituations,",
						"          ts_dealstageofmostrecentopportunity",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> AccountsSelectClean",
						"OriginationOpportunityIn, OutputEnrichedOrigination join(OriginationOpportunityIn@Id == OutputEnrichedOrigination@Id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'right')~> Originationjoinoutput",
						"EnrichedAccount select(mapColumn(",
						"          Id,",
						"          stateAZLabel = stateAZlabel,",
						"          statusAZLabel = statusAZlabel,",
						"          customertypeAZLabel = customertypeAZlabel,",
						"          address1_addresstypeAZLabel = address1_addresstypeAZlabel,",
						"          accountclassificationAZLabel = accountclassificationAZlabel,",
						"          preferredappointmenttimeAZLabel = preferredappointmenttimeAZlabel,",
						"          address2_freighttermsAZLabel = address2_freighttermsAZlabel,",
						"          accountcategoryAZLabel = accountcategoryAZlabel,",
						"          paymenttermsAZLabel = paymenttermsAZlabel,",
						"          preferredappointmentdayAZLabel = preferredappointmentdayAZlabel,",
						"          businesstypeAZLabel = businesstypeAZlabel,",
						"          industryAZLabel = industryAZlabel,",
						"          address1_shippingmethodAZLabel = address1_shippingmethodAZlabel,",
						"          customersizeAZLabel = customersizeAZlabel,",
						"          preferredcontactmethodAZLabel = preferredcontactmethodAZlabel,",
						"          accountratingAZlabel,",
						"          address2_addresstypeAZlabel,",
						"          address2_shippingmethodAZlabel,",
						"          ownershipAZlabel,",
						"          territoryAZlabel,",
						"          shippingmethodAZlabel,",
						"          address1_freighttermsAZlabel",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> EnrichedAccountSelect",
						"EnrichedOriginationOpportunities select(mapColumn(",
						"          Id,",
						"          stateAZlabel,",
						"          statusAZlabel",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> OutputEnrichedOrigination",
						"EnrichedMeetingAppointments select(mapColumn(",
						"          Id,",
						"          stateAZlabel,",
						"          statusAZlabel,",
						"          instancetypeAZlabel,",
						"          priorityAZlabel",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> OutputEnrichedMeetingAppointments",
						"EnrichedContacts select(mapColumn(",
						"          Id,",
						"          stateAZlabel,",
						"          statusAZlabel,",
						"          haschildrenAZlabel,",
						"          customertypeAZlabel,",
						"          genderAZlabel,",
						"          address1_addresstypeAZlabel,",
						"          leadsourceAZlabel,",
						"          preferredappointmenttimeAZlabel,",
						"          address2_freighttermsAZlabel,",
						"          address2_shippingmethodAZlabel,",
						"          paymenttermsAZlabel,",
						"          accountroleAZlabel,",
						"          territoryAZlabel,",
						"          address3_freighttermsAZlabel,",
						"          address1_shippingmethodAZlabel,",
						"          preferredappointmentdayAZlabel,",
						"          customersizeAZlabel,",
						"          preferredcontactmethodAZlabel,",
						"          address3_shippingmethodAZlabel,",
						"          address2_addresstypeAZlabel,",
						"          address3_addresstypeAZlabel,",
						"          familystatusAZlabel,",
						"          shippingmethodAZlabel,",
						"          educationAZlabel,",
						"          address1_freighttermsAZlabel",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> OutputEnrichedContacts",
						"MeetingsAppointmentsIn, EnrichedMeetingAppointments join(MeetingsAppointmentsIn@Id == EnrichedMeetingAppointments@Id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> AppointmentsJoinOutput",
						"ContactsIn, EnrichedContacts join(ContactsIn@Id == EnrichedContacts@Id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> ContactsJoin",
						"AccountIn, EnrichedAccountSelect join(AccountIn@Id == EnrichedAccountSelect@Id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'off',",
						"     scoreColumn: 'AZlabel')~> AccountEnrichedJoin",
						"AccountEnrichedJoin sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     recreate:true,",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> AccountCleanSink",
						"AppointmentsJoinOutput sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     recreate:true,",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> MeetingStageCleanSink",
						"ContactsJoin sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     recreate:true,",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> ContactsStageCleanSink",
						"Originationjoinoutput sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     recreate:true,",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> OriginationCleanSink",
						"OutputEnrichedOrigination sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     store: 'cache',",
						"     format: 'inline',",
						"     output: false) ~> SinkEnrichedOrigination",
						"EnrichedAccountSelect sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     store: 'cache',",
						"     format: 'inline',",
						"     output: false) ~> SinkEnrichedAccount",
						"OutputEnrichedMeetingAppointments sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     store: 'cache',",
						"     format: 'inline',",
						"     output: false) ~> SinkEnrichedMeeting",
						"OutputEnrichedContacts sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     store: 'cache',",
						"     format: 'inline',",
						"     output: false) ~> SinkEnrichedContacts"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/EnrichedDatabase')]",
				"[concat(variables('workspaceId'), '/datasets/AccountTable')]",
				"[concat(variables('workspaceId'), '/datasets/Appointment')]",
				"[concat(variables('workspaceId'), '/datasets/Contacttable')]",
				"[concat(variables('workspaceId'), '/datasets/OriginationOpp')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/test')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "EnrichedDatabase",
								"type": "LinkedServiceReference"
							},
							"name": "Accounts"
						}
					],
					"sinks": [
						{
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "select1"
						}
					],
					"scriptLines": [
						"source(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'table',",
						"     store: 'synapseanalytics',",
						"     schemaName: 'dbo',",
						"     tableName: 'systemuser',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     staged: false) ~> Accounts",
						"Accounts select(skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> select1",
						"select1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     store: 'cache',",
						"     format: 'inline',",
						"     output: false,",
						"     saveOrder: 1) ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/EnrichedDatabase')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/WorkspaceSystemIdentity')]",
			"type": "Microsoft.Synapse/workspaces/credentials",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "ManagedIdentity",
				"typeProperties": {}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ChoiceTablebuild')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT [EntityName], [OptionSetName], [Option], [IsUserLocalizedLabel], [LocalizedLabelLanguageCode], [LocalizedLabel]\n    FROM OPENROWSET (\n        BULK 'https://prodlakeaccuks01.dfs.core.windows.net/dataverse-montagu-org5a2bcccf/Microsoft.Athena.TrickleFeedService/*-EntityMetadata.json', \n        FORMAT = 'csv',\n        FIELDTERMINATOR ='0x0b',\n        FIELDQUOTE = '0x0b',\n        ROWTERMINATOR = '0x0b'\n    ) WITH (doc nvarchar(max)) AS rows\n    CROSS APPLY OPENJSON(doc, '$.OptionSetMetadata')\n    WITH (\n            [EntityName] nvarchar(4000) '$.EntityName',\n            [OptionSetName] nvarchar(4000) '$.OptionSetName',\n            [Option] int '$.Option',\n            [IsUserLocalizedLabel] nvarchar(4000) '$.IsUserLocalizedLabel',\n            [LocalizedLabelLanguageCode] int '$.LocalizedLabelLanguageCode',\n            [LocalizedLabel] nvarchar(4000) '$.LocalizedLabel'\n    )\n\n    ",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "dataverse_montagu_org5a2bcccf",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Clear Views')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "DECLARE @sql VARCHAR(MAX) = ''\n        , @crlf VARCHAR(2) = CHAR(13) + CHAR(10) ;\n\nSELECT @sql = @sql + 'DROP VIEW ' + QUOTENAME(SCHEMA_NAME(schema_id)) + '.' + QUOTENAME(v.name) +';' + @crlf\nFROM   sys.views v\n\nPRINT @sql;\nEXEC(@sql);",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "DataverseEnriched",
						"poolName": "Built-in"
					},
					"resultLimit": -1
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Create DB')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "CREATE DATABASE DataverseEnriched",
				"content": {
					"query": "CREATE DATABASE DataverseEnriched",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "master",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CreateOptionsetSLView')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "CREATE VIEW [dbo].[optionview]\nAS SELECT [EntityName], [OptionSetName], [Option], [IsUserLocalizedLabel], [LocalizedLabelLanguageCode], [LocalizedLabel]\n    FROM OPENROWSET (\n        BULK 'https://prodlakeaccuks01.dfs.core.windows.net/dataverse-montagu-org5a2bcccf/Microsoft.Athena.TrickleFeedService/*-EntityMetadata.json', \n        FORMAT = 'csv',\n        FIELDTERMINATOR ='0x0b',\n        FIELDQUOTE = '0x0b',\n        ROWTERMINATOR = '0x0b'\n    ) WITH (doc nvarchar(max)) AS rows\n    CROSS APPLY OPENJSON(doc, '$.OptionSetMetadata')\n    WITH (\n            [EntityName] nvarchar(4000) '$.EntityName',\n            [OptionSetName] nvarchar(4000) '$.OptionSetName',\n            [Option] int '$.Option',\n            [IsUserLocalizedLabel] nvarchar(4000) '$.IsUserLocalizedLabel',\n            [LocalizedLabelLanguageCode] int '$.LocalizedLabelLanguageCode',\n            [LocalizedLabel] nvarchar(4000) '$.LocalizedLabel'\n    )\n\n\n    ",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "ReportsSL",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Createview')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "\n--CREATE OR ALTER VIEW report_account AS\nSELECT\n[accountid]\n,[parentaccountid]\n,[primarycontactid]\n,[ts_currentauditor]\n,[ts_headofficeid]\n,[ts_originationlead1]\n,[ts_originationlead2]\n,[ts_recommendedby]\n,[ts_validatedby]\n\n\n\n FROM [dataverse_montagu_org5a2bcccf].[dbo].[account]\n\nWHERE statecode = 0\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "ReportsSL",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Enrich SynapseLink')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "\nUSE [dataverse_montagu_org5a2bcccf] --Specify the name of the database corresponding to your Synapse Link for Dataverse\n\n--=================================================================================================\n--PROVIDE INPUT PARAMETERS:\n--=================================================================================================\nDECLARE\n\t@EnrichedViewDatabase sysname, --Specify the name of the database in which views with enriched entities will be created\n\t@EnrichedViewSchema sysname, --Specify the name of the database schema in which views with enriched entities will be created\n\t@EnrichedColumnSuffix varchar(50), \t--Specify the suffix for columns enriched with human-readable descriptions. For example, the suffix of \"label\" will change a statecode column in the base table to a statelabel column in the enriched view.\n\t@LanguageCode varchar(10), --Specify the language code for localized labels. For example, English - United States is 1033 (https://docs.microsoft.com/en-us/openspecs/office_standards/ms-oe376/6c085406-a698-4e12-9d4d-c3b0ee3dbc4a)\n\t@BaseTableSuffix varchar(50), --If applicable, specify the suffix in the names of the base tables or views (e.g., '_partitiond'). The default is an empty string.\n\t@PreviewOnly bit --Indicate whether to preview the SQL Script (without creating the views) = 1 ; Create views = 0;\n\nSET @EnrichedViewDatabase = 'DataverseEnriched'\nSET @EnrichedViewSchema = 'dbo'\nSET @EnrichedColumnSuffix = 'AZlabel'\nSET @LanguageCode = 1033\nSET @BaseTableSuffix = ''\nSET @PreviewOnly = 0\n\n--=================================================================================================\n-- Do not edit the script below this point\n--=================================================================================================\n\n--Get column metadata from the Lake Database managed by Synapse Link for Dataverse\n--The column metadata will be stored as a JSON document in a scalar variable\n--This is needed as a workaround for the limitation of not allowing system objects to be used in distributed queries\nDECLARE @ColumnMetadata nvarchar(MAX), @ColumnMetadataSQL nvarchar(MAX)\n\n--Define the SQL statement to retrieve column metadata from the Lake Database managed by Synapse Link for Dataverse\n--Results will be stored as a JSON document in a variable\nSET @ColumnMetadataSQL = 'SET @ColumnMetadataOUT = (\nSELECT TABLE_SCHEMA, \n\tTABLE_NAME, \n\tCOLUMN_NAME, \n\tORDINAL_POSITION, \n\tDATA_TYPE\nFROM INFORMATION_SCHEMA.COLUMNS \nWHERE TABLE_SCHEMA = ''dbo''\n\tAND TABLE_NAME NOT IN (''OptionsetMetadata'', ''GlobalOptionsetMetadata'',''StateMetadata'',''StatusMetadata'', ''TargetMetadata'')\n\tAND TABLE_NAME LIKE ''%' + @BaseTableSuffix + '''\nFOR JSON AUTO)'\nDECLARE @ParmDefinition NVARCHAR(MAX);  \nSET @ParmDefinition = N'@ColumnMetadataOUT NVARCHAR(MAX) OUTPUT';  \nEXECUTE sp_executesql @ColumnMetadataSQL, @ParmDefinition, @ColumnMetadataOUT=@ColumnMetadata OUTPUT;  \n\n--Declare a variable to store a SQL statement for creating enriched views\nDECLARE @SQL nvarchar(MAX) = ''\n\n; WITH CM AS (\n--Parse column metadata variable and construct a table based on its content\nSELECT JSON_VALUE(CM.value, '$.TABLE_SCHEMA') AS TableSchema,\n\t JSON_VALUE(CM.value, '$.TABLE_NAME') AS TableName,\n\t LEFT(JSON_VALUE(CM.value, '$.TABLE_NAME'), LEN(JSON_VALUE(CM.value, '$.TABLE_NAME'))-LEN(@BaseTableSuffix)) AS EntityName,\n\t JSON_VALUE(CM.value, '$.COLUMN_NAME') AS ColumnName,\n\t CAST(JSON_VALUE(CM.value, '$.ORDINAL_POSITION') AS INT) AS OrdinalPosition,\n\t JSON_VALUE(CM.value, '$.DATA_TYPE') AS DataType\nFROM OPENJSON (@ColumnMetadata) AS CM\n)\n\n, OSM AS (\n--Get Option Set Metadata\nSELECT DISTINCT \n\tEntityName, \n\tOptionSetName, \n\tQUOTENAME(EntityName + '_' + OptionSetName) AS Alias\nFROM dbo.[OptionsetMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, GOSM AS (\n--Get Global Option Set Metadata\nSELECT DISTINCT \n\tOptionSetName, \n\tQUOTENAME('Global_' + OptionSetName) AS Alias\nFROM dbo.[GlobalOptionsetMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, StateM AS (\n--Get State Metadata\nSELECT DISTINCT \n\tEntityName, \n\tQUOTENAME(EntityName + '_State') AS Alias\nFROM dbo.[StateMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, StatusM AS (\n--Get Status Metadata\nSELECT DISTINCT \n\tEntityName,\n\tQUOTENAME(EntityName + '_Status') AS Alias\nFROM dbo.[StatusMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, SQLStatement AS (\n--Enumerate all lines in the source table and replace codes with labels where applicable\nSELECT CM.EntityName,\n\t--Before the first column of each table, construct a CREATE OR ALTER VIEW statement\n\tCASE WHEN CM.OrdinalPosition = 1\n\t\tTHEN 'CREATE OR ALTER VIEW ' + QUOTENAME(@EnrichedViewSchema) + '.' + CM.EntityName + '\n\t\tAS\n\t\tSELECT '\n\t\tELSE '\t,'\n\t\tEND\n\t--For each column, check if it needs to be replaced with a suitable localized label\n\t+ CASE \n\t\tWHEN OSM.OptionSetName IS NOT NULL THEN OSM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tWHEN GOSM.OptionSetName IS NOT NULL THEN GOSM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tWHEN StateM.EntityName IS NOT NULL THEN StateM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tWHEN StatusM.EntityName IS NOT NULL THEN StatusM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tELSE '[Base].' + QUOTENAME(CM.ColumnName)\n\t\tEND AS [SQLLine],\n\tCM.OrdinalPosition\nFROM CM \n\tLEFT JOIN OSM\n\t\tON CM.EntityName = OSM.EntityName\n\t\tAND CM.ColumnName = OSM.OptionSetName\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\tLEFT JOIN GOSM\n\t\tON CM.ColumnName = GOSM.OptionSetName\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\tLEFT JOIN StateM\n\t\tON CM.EntityName = StateM.EntityName\n\t\tAND CM.ColumnName = 'statecode'\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\tLEFT JOIN StatusM\n\t\tON CM.EntityName = StatusM.EntityName\n\t\tAND CM.ColumnName = 'statuscode'\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\nUNION ALL\n--Construct the first line of the FROM clause, referencing external tables created by Synapse Link for Dataverse\nSELECT DISTINCT\nCM.EntityName,\n'FROM ' + QUOTENAME(DB_NAME()) + '.' + QUOTENAME(CM.TableSchema) + '.' + QUOTENAME(CM.TableName) + ' AS Base' AS SQLLine,\n10000 AS OrdinalPosition\nFROM CM\n\nUNION ALL \n--Construct LEFT JOIN statements for each relevant OptionSetMetadata field\nSELECT DISTINCT OSM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[OptionSetMetadata] AS ' + OSM.Alias + ' \n\t\tON ' + OSM.Alias + '.EntityName = ''' + OSM.EntityName + ''' \n\t\tAND ' + OSM.Alias + '.OptionSetName = ''' +  OSM.OptionSetName + '''\n\t\tAND [Base].' + QUOTENAME(OSM.OptionSetName) + ' = ' + OSM.Alias + '.[Option]\n\t\tAND ' + OSM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n20000 AS OrdinalPosition\nFROM OSM\n\tJOIN CM\n\t\tON CM.EntityName = OSM.EntityName\n\t\tAND CM.ColumnName = OSM.OptionSetName\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL \n--Construct LEFT JOIN statements for each relevant GlobalOptionSetMetadata field\nSELECT DISTINCT CM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[GlobalOptionSetMetadata] AS ' + Alias + ' \n\t\tON ' + Alias + '.OptionSetName = ''' +  OptionSetName + '''\n\t\tAND [Base].' + QUOTENAME(OptionSetName) + ' = ' + Alias + '.[Option]\n\t\tAND ' + Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n30000 AS OrdinalPosition\nFROM GOSM\n\tJOIN CM\n\t\tON CM.ColumnName = GOSM.OptionSetName\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL \n--Construct LEFT JOIN statements for each relevant State Metadata field\nSELECT DISTINCT CM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[StateMetadata] AS ' + StateM.Alias + ' \n\t\tON ' + StateM.Alias + '.EntityName = ''' + StateM.EntityName + ''' \n\t\tAND [Base].statecode' + ' = ' + StateM.Alias + '.[State]\n\t\tAND ' + StateM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n40000 AS OrdinalPosition\nFROM StateM\n\tJOIN CM\n\t\tON CM.EntityName = StateM.EntityName\n\t\tAND CM.ColumnName = 'statecode'\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL\n--Construct LEFT JOIN statements for each relevant Status Metadata field\nSELECT DISTINCT CM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[StatusMetadata] AS ' + StatusM.Alias + ' \n\t\tON ' + StatusM.Alias + '.EntityName = ''' + StatusM.EntityName + ''' \n\t\tAND [Base].statuscode' + ' = ' + StatusM.Alias + '.[Status]\n\t\tAND ' + StatusM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n40000 AS OrdinalPosition\nFROM StatusM\n\tJOIN CM\n\t\tON CM.EntityName = StatusM.EntityName\n\t\tAND CM.ColumnName = 'statuscode'\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL\n--Add statement terminator\nSELECT DISTINCT\nEntityName,\n'; ' + CHAR(10) AS SQLLine,\n100000 AS OrdinalPosition\nFROM CM\n)\n\n--Construct individual statements to create views (1 view per row)\n--Since CREATE VIEW statement must be the first statement in a batch, assign each view definition to a variable \n--and use the EXEC(@variable) command to create view as part of its own, separate batch.\n, ViewDefinitions AS (\nSELECT 'DECLARE @' + EntityName + ' NVARCHAR(MAX) = ''\n\t' + REPLACE(STRING_AGG(CAST(SQLLine as varchar(MAX)), CHAR(10)) WITHIN GROUP (ORDER BY EntityName, OrdinalPosition, SQLLine), '''', '''''') + ''' ' + CHAR(10) + 'EXEC [' + @EnrichedViewDatabase + '].dbo.sp_executesql @' + EntityName + CHAR(10) AS ViewDefinition\nFROM SQLStatement\nGROUP BY EntityName\n)\n\n--Construct a comprehensive SQL statement to create all views\nSELECT @SQL = STRING_AGG(ViewDefinition, ';' + CHAR(10) + CHAR(10))\nFROM ViewDefinitions\n\n--Return a preview of the SQL Script to be generated or go ahead and create the views.\nIF @PreviewOnly = 1\nBEGIN\n\t--Return the final SQL statement\n\tSELECT '--================================================================================================='+ CHAR(10) +' ' + CHAR(10) AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '-- A preview of the script to generate enriched views is provided below.'  AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '-- No database objects have been created.' AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '-- Re-run this script with the @PreviewOnly parameter set to 0 to actually create the views.' AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '--================================================================================================='+ CHAR(10) +' ' + CHAR(10) AS [--SQL Statement]\n\tUNION ALL \n\tSELECT VALUE AS [--SQL Statement] FROM STRING_SPLIT(@SQL, CHAR(10))\nEND\nELSE\nBEGIN\n\t--Execute the SQL statement\n\tPRINT 'Beginning view creation'\n\tEXEC sp_executesql @SQL\n\tPRINT 'Completed view creation'\nEND",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "dataverse_montagu_org5a2bcccf",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Enrichment Script A')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "\nUSE [dataverse_montagu_org5a2bcccf] --\n\n--=================================================================================================\n--PROVIDE INPUT PARAMETERS:\n--=================================================================================================\nDECLARE\n\t@EnrichedViewDatabase sysname,\n\t@EnrichedViewSchema sysname, \n\t@EnrichedColumnSuffix varchar(50), \t\n\t@LanguageCode varchar(10), --Specify the language code for localized labels. For example, English - United States is 1033 (https://docs.microsoft.com/en-us/openspecs/office_standards/ms-oe376/6c085406-a698-4e12-9d4d-c3b0ee3dbc4a)\n\t@BaseTableSuffix varchar(50), --If applicable, specify the suffix in the names of the base tables or views (e.g., '_partitiond'). The default is an empty string.\n\t@PreviewOnly bit --Indicate whether to preview the SQL Script (without creating the views) = 1 ; Create views = 0;\n\nSET @EnrichedViewDatabase = 'DataverseEnrched'\nSET @EnrichedViewSchema = 'dbo'\nSET @EnrichedColumnSuffix = ''\nSET @LanguageCode = 1033\nSET @BaseTableSuffix = ''\nSET @PreviewOnly = 0\n\n--=================================================================================================\n-- Do not edit the script below this point\n--=================================================================================================\n\n--Get column metadata from the Lake Database managed by Synapse Link for Dataverse\n--The column metadata will be stored as a JSON document in a scalar variable\n--This is needed as a workaround for the limitation of not allowing system objects to be used in distributed queries\nDECLARE @ColumnMetadata nvarchar(MAX), @ColumnMetadataSQL nvarchar(MAX)\n\n--Define the SQL statement to retrieve column metadata from the Lake Database managed by Synapse Link for Dataverse\n--Results will be stored as a JSON document in a variable\nSET @ColumnMetadataSQL = 'SET @ColumnMetadataOUT = (\nSELECT TABLE_SCHEMA, \n\tTABLE_NAME, \n\tCOLUMN_NAME, \n\tORDINAL_POSITION, \n\tDATA_TYPE\nFROM INFORMATION_SCHEMA.COLUMNS \nWHERE TABLE_SCHEMA = ''dbo''\n\tAND TABLE_NAME NOT IN (''OptionsetMetadata'', ''GlobalOptionsetMetadata'',''StateMetadata'',''StatusMetadata'', ''TargetMetadata'')\n\tAND TABLE_NAME LIKE ''%' + @BaseTableSuffix + '''\nFOR JSON AUTO)'\nDECLARE @ParmDefinition NVARCHAR(MAX);  \nSET @ParmDefinition = N'@ColumnMetadataOUT NVARCHAR(MAX) OUTPUT';  \nEXECUTE sp_executesql @ColumnMetadataSQL, @ParmDefinition, @ColumnMetadataOUT=@ColumnMetadata OUTPUT;  \n\n--Declare a variable to store a SQL statement for creating enriched views\nDECLARE @SQL nvarchar(MAX) = ''\n\n; WITH CM AS (\n--Parse column metadata variable and construct a table based on its content\nSELECT JSON_VALUE(CM.value, '$.TABLE_SCHEMA') AS TableSchema,\n\t JSON_VALUE(CM.value, '$.TABLE_NAME') AS TableName,\n\t LEFT(JSON_VALUE(CM.value, '$.TABLE_NAME'), LEN(JSON_VALUE(CM.value, '$.TABLE_NAME'))-LEN(@BaseTableSuffix)) AS EntityName,\n\t JSON_VALUE(CM.value, '$.COLUMN_NAME') AS ColumnName,\n\t CAST(JSON_VALUE(CM.value, '$.ORDINAL_POSITION') AS INT) AS OrdinalPosition,\n\t JSON_VALUE(CM.value, '$.DATA_TYPE') AS DataType\nFROM OPENJSON (@ColumnMetadata) AS CM\n)\n\n, OSM AS (\n--Get Option Set Metadata\nSELECT DISTINCT \n\tEntityName, \n\tOptionSetName, \n\tQUOTENAME(EntityName + '_' + OptionSetName) AS Alias\nFROM dbo.[OptionsetMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, GOSM AS (\n--Get Global Option Set Metadata\nSELECT DISTINCT \n\tOptionSetName, \n\tQUOTENAME('Global_' + OptionSetName) AS Alias\nFROM dbo.[GlobalOptionsetMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, StateM AS (\n--Get State Metadata\nSELECT DISTINCT \n\tEntityName, \n\tQUOTENAME(EntityName + '_State') AS Alias\nFROM dbo.[StateMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, StatusM AS (\n--Get Status Metadata\nSELECT DISTINCT \n\tEntityName,\n\tQUOTENAME(EntityName + '_Status') AS Alias\nFROM dbo.[StatusMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, SQLStatement AS (\n--Enumerate all lines in the source table and replace codes with labels where applicable\nSELECT CM.EntityName,\n\t--Before the first column of each table, construct a CREATE OR ALTER VIEW statement\n\tCASE WHEN CM.OrdinalPosition = 1\n\t\tTHEN 'CREATE OR ALTER VIEW ' + QUOTENAME(@EnrichedViewSchema) + '.' + CM.EntityName + '\n\t\tAS\n\t\tSELECT '\n\t\tELSE '\t,'\n\t\tEND\n\t--For each column, check if it needs to be replaced with a suitable localized label\n\t+ CASE \n\t\tWHEN OSM.OptionSetName IS NOT NULL THEN OSM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tWHEN GOSM.OptionSetName IS NOT NULL THEN GOSM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tWHEN StateM.EntityName IS NOT NULL THEN StateM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tWHEN StatusM.EntityName IS NOT NULL THEN StatusM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tELSE '[Base].' + QUOTENAME(CM.ColumnName)\n\t\tEND AS [SQLLine],\n\tCM.OrdinalPosition\nFROM CM \n\tLEFT JOIN OSM\n\t\tON CM.EntityName = OSM.EntityName\n\t\tAND CM.ColumnName = OSM.OptionSetName\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\tLEFT JOIN GOSM\n\t\tON CM.ColumnName = GOSM.OptionSetName\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\tLEFT JOIN StateM\n\t\tON CM.EntityName = StateM.EntityName\n\t\tAND CM.ColumnName = 'statecode'\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\tLEFT JOIN StatusM\n\t\tON CM.EntityName = StatusM.EntityName\n\t\tAND CM.ColumnName = 'statuscode'\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\nUNION ALL\n--Construct the first line of the FROM clause, referencing external tables created by Synapse Link for Dataverse\nSELECT DISTINCT\nCM.EntityName,\n'FROM ' + QUOTENAME(DB_NAME()) + '.' + QUOTENAME(CM.TableSchema) + '.' + QUOTENAME(CM.TableName) + ' AS Base' AS SQLLine,\n10000 AS OrdinalPosition\nFROM CM\n\nUNION ALL \n--Construct LEFT JOIN statements for each relevant OptionSetMetadata field\nSELECT DISTINCT OSM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[OptionSetMetadata] AS ' + OSM.Alias + ' \n\t\tON ' + OSM.Alias + '.EntityName = ''' + OSM.EntityName + ''' \n\t\tAND ' + OSM.Alias + '.OptionSetName = ''' +  OSM.OptionSetName + '''\n\t\tAND [Base].' + QUOTENAME(OSM.OptionSetName) + ' = ' + OSM.Alias + '.[Option]\n\t\tAND ' + OSM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n20000 AS OrdinalPosition\nFROM OSM\n\tJOIN CM\n\t\tON CM.EntityName = OSM.EntityName\n\t\tAND CM.ColumnName = OSM.OptionSetName\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL \n--Construct LEFT JOIN statements for each relevant GlobalOptionSetMetadata field\nSELECT DISTINCT CM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[GlobalOptionSetMetadata] AS ' + Alias + ' \n\t\tON ' + Alias + '.OptionSetName = ''' +  OptionSetName + '''\n\t\tAND [Base].' + QUOTENAME(OptionSetName) + ' = ' + Alias + '.[Option]\n\t\tAND ' + Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n30000 AS OrdinalPosition\nFROM GOSM\n\tJOIN CM\n\t\tON CM.ColumnName = GOSM.OptionSetName\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL \n--Construct LEFT JOIN statements for each relevant State Metadata field\nSELECT DISTINCT CM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[StateMetadata] AS ' + StateM.Alias + ' \n\t\tON ' + StateM.Alias + '.EntityName = ''' + StateM.EntityName + ''' \n\t\tAND [Base].statecode' + ' = ' + StateM.Alias + '.[State]\n\t\tAND ' + StateM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n40000 AS OrdinalPosition\nFROM StateM\n\tJOIN CM\n\t\tON CM.EntityName = StateM.EntityName\n\t\tAND CM.ColumnName = 'statecode'\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL\n--Construct LEFT JOIN statements for each relevant Status Metadata field\nSELECT DISTINCT CM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[StatusMetadata] AS ' + StatusM.Alias + ' \n\t\tON ' + StatusM.Alias + '.EntityName = ''' + StatusM.EntityName + ''' \n\t\tAND [Base].statuscode' + ' = ' + StatusM.Alias + '.[Status]\n\t\tAND ' + StatusM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n40000 AS OrdinalPosition\nFROM StatusM\n\tJOIN CM\n\t\tON CM.EntityName = StatusM.EntityName\n\t\tAND CM.ColumnName = 'statuscode'\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL\n--Add statement terminator\nSELECT DISTINCT\nEntityName,\n'; ' + CHAR(10) AS SQLLine,\n100000 AS OrdinalPosition\nFROM CM\n)\n\n--Construct individual statements to create views (1 view per row)\n--Since CREATE VIEW statement must be the first statement in a batch, assign each view definition to a variable \n--and use the EXEC(@variable) command to create view as part of its own, separate batch.\n, ViewDefinitions AS (\nSELECT 'DECLARE @' + EntityName + ' NVARCHAR(MAX) = ''\n\t' + REPLACE(STRING_AGG(CAST(SQLLine as varchar(MAX)), CHAR(10)) WITHIN GROUP (ORDER BY EntityName, OrdinalPosition, SQLLine), '''', '''''') + ''' ' + CHAR(10) + 'EXEC [' + @EnrichedViewDatabase + '].dbo.sp_executesql @' + EntityName + CHAR(10) AS ViewDefinition\nFROM SQLStatement\nGROUP BY EntityName\n)\n\n--Construct a comprehensive SQL statement to create all views\nSELECT @SQL = STRING_AGG(ViewDefinition, ';' + CHAR(10) + CHAR(10))\nFROM ViewDefinitions\n\n--Return a preview of the SQL Script to be generated or go ahead and create the views.\nIF @PreviewOnly = 1\nBEGIN\n\t--Return the final SQL statement\n\tSELECT '--================================================================================================='+ CHAR(10) +' ' + CHAR(10) AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '-- A preview of the script to generate enriched views is provided below.'  AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '-- No database objects have been created.' AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '-- Re-run this script with the @PreviewOnly parameter set to 0 to actually create the views.' AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '--================================================================================================='+ CHAR(10) +' ' + CHAR(10) AS [--SQL Statement]\n\tUNION ALL \n\tSELECT VALUE AS [--SQL Statement] FROM STRING_SPLIT(@SQL, CHAR(10))\nEND\nELSE\nBEGIN\n\t--Execute the SQL statement\n\tPRINT 'Beginning view creation'\n\tEXEC sp_executesql @SQL\n\tPRINT 'Completed view creation'\nEND",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "dataverse_montagu_org5a2bcccf",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Enrichment Script')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "\nUSE [dataverse_montagu_org5a2bcccf] --Specify the name of the database corresponding to your Synapse Link for Dataverse\n\n--=================================================================================================\n--PROVIDE INPUT PARAMETERS:\n--=================================================================================================\nDECLARE\n\t@EnrichedViewDatabase sysname, --Specify the name of the database in which views with enriched entities will be created\n\t@EnrichedViewSchema sysname, --Specify the name of the database schema in which views with enriched entities will be created\n\t@EnrichedColumnSuffix varchar(50), \t--Specify the suffix for columns enriched with human-readable descriptions. For example, the suffix of \"label\" will change a statecode column in the base table to a statelabel column in the enriched view.\n\t@LanguageCode varchar(10), --Specify the language code for localized labels. For example, English - United States is 1033 (https://docs.microsoft.com/en-us/openspecs/office_standards/ms-oe376/6c085406-a698-4e12-9d4d-c3b0ee3dbc4a)\n\t@BaseTableSuffix varchar(50), --If applicable, specify the suffix in the names of the base tables or views (e.g., '_partitiond'). The default is an empty string.\n\t@PreviewOnly bit --Indicate whether to preview the SQL Script (without creating the views) = 1 ; Create views = 0;\n\nSET @EnrichedViewDatabase = 'DataverseEnriched'\nSET @EnrichedViewSchema = 'dbo'\nSET @EnrichedColumnSuffix = ''\nSET @LanguageCode = 1033\nSET @BaseTableSuffix = ''\nSET @PreviewOnly = 0\n\n--=================================================================================================\n-- Do not edit the script below this point\n--=================================================================================================\n\n--Get column metadata from the Lake Database managed by Synapse Link for Dataverse\n--The column metadata will be stored as a JSON document in a scalar variable\n--This is needed as a workaround for the limitation of not allowing system objects to be used in distributed queries\nDECLARE @ColumnMetadata nvarchar(MAX), @ColumnMetadataSQL nvarchar(MAX)\n\n--Define the SQL statement to retrieve column metadata from the Lake Database managed by Synapse Link for Dataverse\n--Results will be stored as a JSON document in a variable\nSET @ColumnMetadataSQL = 'SET @ColumnMetadataOUT = (\nSELECT TABLE_SCHEMA, \n\tTABLE_NAME, \n\tCOLUMN_NAME, \n\tORDINAL_POSITION, \n\tDATA_TYPE\nFROM INFORMATION_SCHEMA.COLUMNS \nWHERE TABLE_SCHEMA = ''dbo''\n\tAND TABLE_NAME NOT IN (''OptionsetMetadata'', ''GlobalOptionsetMetadata'',''StateMetadata'',''StatusMetadata'', ''TargetMetadata'')\n\tAND TABLE_NAME LIKE ''%' + @BaseTableSuffix + '''\nFOR JSON AUTO)'\nDECLARE @ParmDefinition NVARCHAR(MAX);  \nSET @ParmDefinition = N'@ColumnMetadataOUT NVARCHAR(MAX) OUTPUT';  \nEXECUTE sp_executesql @ColumnMetadataSQL, @ParmDefinition, @ColumnMetadataOUT=@ColumnMetadata OUTPUT;  \n\n--Declare a variable to store a SQL statement for creating enriched views\nDECLARE @SQL nvarchar(MAX) = ''\n\n; WITH CM AS (\n--Parse column metadata variable and construct a table based on its content\nSELECT JSON_VALUE(CM.value, '$.TABLE_SCHEMA') AS TableSchema,\n\t JSON_VALUE(CM.value, '$.TABLE_NAME') AS TableName,\n\t LEFT(JSON_VALUE(CM.value, '$.TABLE_NAME'), LEN(JSON_VALUE(CM.value, '$.TABLE_NAME'))-LEN(@BaseTableSuffix)) AS EntityName,\n\t JSON_VALUE(CM.value, '$.COLUMN_NAME') AS ColumnName,\n\t CAST(JSON_VALUE(CM.value, '$.ORDINAL_POSITION') AS INT) AS OrdinalPosition,\n\t JSON_VALUE(CM.value, '$.DATA_TYPE') AS DataType\nFROM OPENJSON (@ColumnMetadata) AS CM\n)\n\n, OSM AS (\n--Get Option Set Metadata\nSELECT DISTINCT \n\tEntityName, \n\tOptionSetName, \n\tQUOTENAME(EntityName + '_' + OptionSetName) AS Alias\nFROM dbo.[OptionsetMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, GOSM AS (\n--Get Global Option Set Metadata\nSELECT DISTINCT \n\tOptionSetName, \n\tQUOTENAME('Global_' + OptionSetName) AS Alias\nFROM dbo.[GlobalOptionsetMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, StateM AS (\n--Get State Metadata\nSELECT DISTINCT \n\tEntityName, \n\tQUOTENAME(EntityName + '_State') AS Alias\nFROM dbo.[StateMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, StatusM AS (\n--Get Status Metadata\nSELECT DISTINCT \n\tEntityName,\n\tQUOTENAME(EntityName + '_Status') AS Alias\nFROM dbo.[StatusMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, SQLStatement AS (\n--Enumerate all lines in the source table and replace codes with labels where applicable\nSELECT CM.EntityName,\n\t--Before the first column of each table, construct a CREATE OR ALTER VIEW statement\n\tCASE WHEN CM.OrdinalPosition = 1\n\t\tTHEN 'CREATE OR ALTER VIEW ' + QUOTENAME(@EnrichedViewSchema) + '.' + CM.EntityName + '\n\t\tAS\n\t\tSELECT '\n\t\tELSE '\t,'\n\t\tEND\n\t--For each column, check if it needs to be replaced with a suitable localized label\n\t+ CASE \n\t\tWHEN OSM.OptionSetName IS NOT NULL THEN OSM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tWHEN GOSM.OptionSetName IS NOT NULL THEN GOSM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tWHEN StateM.EntityName IS NOT NULL THEN StateM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tWHEN StatusM.EntityName IS NOT NULL THEN StatusM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tELSE '[Base].' + QUOTENAME(CM.ColumnName)\n\t\tEND AS [SQLLine],\n\tCM.OrdinalPosition\nFROM CM \n\tLEFT JOIN OSM\n\t\tON CM.EntityName = OSM.EntityName\n\t\tAND CM.ColumnName = OSM.OptionSetName\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\tLEFT JOIN GOSM\n\t\tON CM.ColumnName = GOSM.OptionSetName\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\tLEFT JOIN StateM\n\t\tON CM.EntityName = StateM.EntityName\n\t\tAND CM.ColumnName = 'statecode'\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\tLEFT JOIN StatusM\n\t\tON CM.EntityName = StatusM.EntityName\n\t\tAND CM.ColumnName = 'statuscode'\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\nUNION ALL\n--Construct the first line of the FROM clause, referencing external tables created by Synapse Link for Dataverse\nSELECT DISTINCT\nCM.EntityName,\n'FROM ' + QUOTENAME(DB_NAME()) + '.' + QUOTENAME(CM.TableSchema) + '.' + QUOTENAME(CM.TableName) + ' AS Base' AS SQLLine,\n10000 AS OrdinalPosition\nFROM CM\n\nUNION ALL \n--Construct LEFT JOIN statements for each relevant OptionSetMetadata field\nSELECT DISTINCT OSM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[OptionSetMetadata] AS ' + OSM.Alias + ' \n\t\tON ' + OSM.Alias + '.EntityName = ''' + OSM.EntityName + ''' \n\t\tAND ' + OSM.Alias + '.OptionSetName = ''' +  OSM.OptionSetName + '''\n\t\tAND [Base].' + QUOTENAME(OSM.OptionSetName) + ' = ' + OSM.Alias + '.[Option]\n\t\tAND ' + OSM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n20000 AS OrdinalPosition\nFROM OSM\n\tJOIN CM\n\t\tON CM.EntityName = OSM.EntityName\n\t\tAND CM.ColumnName = OSM.OptionSetName\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL \n--Construct LEFT JOIN statements for each relevant GlobalOptionSetMetadata field\nSELECT DISTINCT CM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[GlobalOptionSetMetadata] AS ' + Alias + ' \n\t\tON ' + Alias + '.OptionSetName = ''' +  OptionSetName + '''\n\t\tAND [Base].' + QUOTENAME(OptionSetName) + ' = ' + Alias + '.[Option]\n\t\tAND ' + Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n30000 AS OrdinalPosition\nFROM GOSM\n\tJOIN CM\n\t\tON CM.ColumnName = GOSM.OptionSetName\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL \n--Construct LEFT JOIN statements for each relevant State Metadata field\nSELECT DISTINCT CM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[StateMetadata] AS ' + StateM.Alias + ' \n\t\tON ' + StateM.Alias + '.EntityName = ''' + StateM.EntityName + ''' \n\t\tAND [Base].statecode' + ' = ' + StateM.Alias + '.[State]\n\t\tAND ' + StateM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n40000 AS OrdinalPosition\nFROM StateM\n\tJOIN CM\n\t\tON CM.EntityName = StateM.EntityName\n\t\tAND CM.ColumnName = 'statecode'\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL\n--Construct LEFT JOIN statements for each relevant Status Metadata field\nSELECT DISTINCT CM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[StatusMetadata] AS ' + StatusM.Alias + ' \n\t\tON ' + StatusM.Alias + '.EntityName = ''' + StatusM.EntityName + ''' \n\t\tAND [Base].statuscode' + ' = ' + StatusM.Alias + '.[Status]\n\t\tAND ' + StatusM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n40000 AS OrdinalPosition\nFROM StatusM\n\tJOIN CM\n\t\tON CM.EntityName = StatusM.EntityName\n\t\tAND CM.ColumnName = 'statuscode'\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL\n--Add statement terminator\nSELECT DISTINCT\nEntityName,\n'; ' + CHAR(10) AS SQLLine,\n100000 AS OrdinalPosition\nFROM CM\n)\n\n--Construct individual statements to create views (1 view per row)\n--Since CREATE VIEW statement must be the first statement in a batch, assign each view definition to a variable \n--and use the EXEC(@variable) command to create view as part of its own, separate batch.\n, ViewDefinitions AS (\nSELECT 'DECLARE @' + EntityName + ' NVARCHAR(MAX) = ''\n\t' + REPLACE(STRING_AGG(CAST(SQLLine as varchar(MAX)), CHAR(10)) WITHIN GROUP (ORDER BY EntityName, OrdinalPosition, SQLLine), '''', '''''') + ''' ' + CHAR(10) + 'EXEC [' + @EnrichedViewDatabase + '].dbo.sp_executesql @' + EntityName + CHAR(10) AS ViewDefinition\nFROM SQLStatement\nGROUP BY EntityName\n)\n\n--Construct a comprehensive SQL statement to create all views\nSELECT @SQL = STRING_AGG(ViewDefinition, ';' + CHAR(10) + CHAR(10))\nFROM ViewDefinitions\n\n--Return a preview of the SQL Script to be generated or go ahead and create the views.\nIF @PreviewOnly = 1\nBEGIN\n\t--Return the final SQL statement\n\tSELECT '--================================================================================================='+ CHAR(10) +' ' + CHAR(10) AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '-- A preview of the script to generate enriched views is provided below.'  AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '-- No database objects have been created.' AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '-- Re-run this script with the @PreviewOnly parameter set to 0 to actually create the views.' AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '--================================================================================================='+ CHAR(10) +' ' + CHAR(10) AS [--SQL Statement]\n\tUNION ALL \n\tSELECT VALUE AS [--SQL Statement] FROM STRING_SPLIT(@SQL, CHAR(10))\nEND\nELSE\nBEGIN\n\t--Execute the SQL statement\n\tPRINT 'Beginning view creation'\n\tEXEC sp_executesql @SQL\n\tPRINT 'Completed view creation'\nEND",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "dataverse_montagu_org5a2bcccf",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Grant access to a user to a single serverless SQL pool database')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "--1.a Create LOGIN for an Azure AD account.To create a login, you must be connected to the master database.\n\nCREATE USER [alias@domain.com] FROM EXTERNAL PROVIDER;\n\n\n--1.b Create a Login for a SQL authuser. To create a login, you must be connected to the master database.\nCREATE LOGIN <login_alias> WITH PASSWORD = 'enter_your_password';\nCREATE USER <user_alias> FROM LOGIN <login_alias>\n\n--2.a Create USER for the Azure AD account\n\nuse yourdb -- Use your DB name\nCREATE USER <user_alias> FROM LOGIN [alias@domain.com]\n\n--2.b Create USER for the SQL Auth account\nuse yourdb -- Use your DB name\nCREATE USER <user_alias> FROM LOGIN <login_alias>\n\n--3.Add USER to members of the specified role\n\nuse yourdb -- Use your DB name\ngo\nalter role db_owner Add MEMBER <user_alias> -- Type user alias from step 2\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "Insights",
						"poolName": "Insights"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Grant access to a user to a single serverless SQL pool database_1ks')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "--1.a Create LOGIN for an Azure AD account.To create a login, you must be connected to the master database.\n\nCREATE USER [johannes.barth@montagu.com] FROM EXTERNAL PROVIDER;\n\n\n--1.b Create a Login for a SQL authuser. To create a login, you must be connected to the master database.\n--CREATE LOGIN <johannes.Barth@montagu.com> WITH PASSWORD = 'Welcome1011';\n--CREATE USER <johannes.Barth@montagu.com> FROM LOGIN <johannes.Barth@montagu.com>\n\n--2.a Create USER for the Azure AD account\n\nuse dataverse_montagu_org5a2bcccf -- Use your DB name\nCREATE USER [johannes.barth@montagu.com] FROM LOGIN [johannes.Barth@montagu.com]\n\n--2.b Create USER for the SQL Auth account\n--use yourdb -- Use your DB name\n--CREATE USER <user_alias> FROM LOGIN <login_alias>\n\n--3.Add USER to members of the specified role\n\nuse dataverse_montagu_org5a2bcccf -- Use your DB name\ngo\nalter role db_owner Add MEMBER [johannes.Barth@montagu.com] -- Type user alias from step 2\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "master",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Join')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "CREATE VIEW joined_AddressView AS\n\nSELECT\nid\nFROM dbo.testAccountView v1\nINNER JOIN dbo.tests_AddressView v2\nON v1.id = v2.ts_addressid\n\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "ServerlessP1",
						"poolName": "Built-in"
					},
					"resultLimit": -1
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Master Key Dataverse')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "CREATE MASTER KEY ENCRYPTION BY PASSWORD = 'checkmont101aguxzc@'\n\n\n\n-- create credentials for containers in our demo storage account\nCREATE DATABASE SCOPED CREDENTIAL sqlondemand\nWITH IDENTITY='SHARED ACCESS SIGNATURE',  \nSECRET = 'sv=2018-03-28&ss=bf&srt=sco&sp=rl&st=20222ww29-10-14T12%3A10%3A25Z&se=2061-12-31T12%3A10%3A00Z&sig=KlSU2ullCscyTS0An0nozEpo4tO5JAgGBvw%2FJX2lguw%3D'\nGO\nCREATE EXTERNAL DATA SOURCE SqlOnDemandSource WITH (\n    LOCATION = '//https://prodlakeaccuks01.dfs.core.windows.net/dataverse_montagu_org5a2bcccf',\n    CREDENTIAL = sqlondemand\n);",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "ReportsSL",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Master Key Dataverse_Enriched')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "CREATE MASTER KEY ENCRYPTION BY PASSWORD = 'checkmont101aguxzc@'\n\n\n\n-- create credentials for containers in our demo storage account\nCREATE DATABASE SCOPED CREDENTIAL sqlondemand\nWITH IDENTITY='SHARED ACCESS SIGNATURE',  \nSECRET = 'sv=2018-03-28&ss=bf&srt=sco&sp=rl&st=20222ww29-10-14T12%3A10%3A25Z&se=2061-12-31T12%3A10%3A00Z&sig=KlSU2ullCscyTS0An0nozEpo4tO5JAgGBvw%2FJX2lguw%3D'\nGO\nCREATE EXTERNAL DATA SOURCE SqlOnDemandSource WITH (\n    LOCATION = '//https://prodlakeaccuks01.dfs.core.windows.net/DataverseEnriched',\n    CREDENTIAL = sqlondemand\n);",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "DataverseEnriched",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/OptionSetResult')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT\n   ts_primarysecondaryfocus\n  ,ts_easeofworking\n  ,ts_ukrow,donotphone\n  ,businesstypecode\n  ,industrycode\n  ,preferredappointmenttimecode\n  ,address2_freighttermscode\n  ,ts_introducertype\n  ,accountcategorycode\n  ,paymenttermscode\n  ,preferredappointmentdaycode\n  ,donotemail\n  ,ts_primarysecondaryfocus\n  ,customertypecode\n  ,address1_addresstypecode\n  ,accountclassificationcode\n  ,ts_ukrow\nFROM dbo.account\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "ServerlessP1",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/OptionsSet_Semi_Working')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "--=================================================================================================\n-- DESCRIPTION\n--=================================================================================================\n--  The purpose of this script is to create a set of database views in a database within your Synapse Analytics Serverless SQL Pool that will \n--  translate numeric codes for Option Sets, Status and States into human-readable descriptions for tables exported using Synapse Link for Dataverse.\n--  See the following article for background: https://docs.microsoft.com/en-us/power-apps/maker/data-platform/azure-synapse-link-choice-labels\n--\n-- PREREQUISITES\n-- 1. You have configured Synapse Link for Dataverse to export to a Synapse Analytics Workspace\n-- 2. You have sufficient read access to the lake database created by Synapse Link for Dataverse\n-- 3. You have created an additional database in which views with enriched entities will be created\n-- 4. You have sufficient permissions to create database objects in your newly-created database\n--\n-- IMPORTANT: please execute this script in the context of the Lake Database corresponding to your Synapse Link for Dataverse!\nUSE [dataverse_montagu_org5a2bcccf] --Specify the name of the database corresponding to your Synapse Link for Dataverse\n\n--=================================================================================================\n--PROVIDE INPUT PARAMETERS:\n--=================================================================================================\nDECLARE\n\t@EnrichedViewDatabase sysname, --Specify the name of the database in which views with enriched entities will be created\n\t@EnrichedViewSchema sysname, --Specify the name of the database schema in which views with enriched entities will be created\n\t@EnrichedColumnSuffix varchar(50), \t--Specify the suffix for columns enriched with human-readable descriptions. For example, the suffix of \"label\" will change a statecode column in the base table to a statelabel column in the enriched view.\n\t@LanguageCode varchar(10), --Specify the language code for localized labels. For example, English - United States is 1033 (https://docs.microsoft.com/en-us/openspecs/office_standards/ms-oe376/6c085406-a698-4e12-9d4d-c3b0ee3dbc4a)\n\t@BaseTableSuffix varchar(50), --If applicable, specify the suffix in the names of the base tables or views (e.g., '_partitiond'). The default is an empty string.\n\t@PreviewOnly bit --Indicate whether to preview the SQL Script (without creating the views) = 1 ; Create views = 0;\n\nSET @EnrichedViewDatabase = 'DataverseEnriched'\nSET @EnrichedViewSchema = 'dbo'\nSET @EnrichedColumnSuffix = 'label'\nSET @LanguageCode = 1033\nSET @BaseTableSuffix = ''\nSET @PreviewOnly = 0\n\n--=================================================================================================\n-- Do not edit the script below this point\n--=================================================================================================\n\n--Get column metadata from the Lake Database managed by Synapse Link for Dataverse\n--The column metadata will be stored as a JSON document in a scalar variable\n--This is needed as a workaround for the limitation of not allowing system objects to be used in distributed queries\nDECLARE @ColumnMetadata nvarchar(MAX), @ColumnMetadataSQL nvarchar(MAX)\n\n--Define the SQL statement to retrieve column metadata from the Lake Database managed by Synapse Link for Dataverse\n--Results will be stored as a JSON document in a variable\nSET @ColumnMetadataSQL = 'SET @ColumnMetadataOUT = (\nSELECT TABLE_SCHEMA, \n\tTABLE_NAME, \n\tCOLUMN_NAME, \n\tORDINAL_POSITION, \n\tDATA_TYPE\nFROM INFORMATION_SCHEMA.COLUMNS \nWHERE TABLE_SCHEMA = ''dbo''\n\tAND TABLE_NAME NOT IN (''OptionsetMetadata'', ''GlobalOptionsetMetadata'',''StateMetadata'',''StatusMetadata'', ''TargetMetadata'')\n\tAND TABLE_NAME LIKE ''%' + @BaseTableSuffix + '''\nFOR JSON AUTO)'\nDECLARE @ParmDefinition NVARCHAR(MAX);  \nSET @ParmDefinition = N'@ColumnMetadataOUT NVARCHAR(MAX) OUTPUT';  \nEXECUTE sp_executesql @ColumnMetadataSQL, @ParmDefinition, @ColumnMetadataOUT=@ColumnMetadata OUTPUT;  \n\n--Declare a variable to store a SQL statement for creating enriched views\nDECLARE @SQL nvarchar(MAX) = ''\n\n; WITH CM AS (\n--Parse column metadata variable and construct a table based on its content\nSELECT JSON_VALUE(CM.value, '$.TABLE_SCHEMA') AS TableSchema,\n\t JSON_VALUE(CM.value, '$.TABLE_NAME') AS TableName,\n\t LEFT(JSON_VALUE(CM.value, '$.TABLE_NAME'), LEN(JSON_VALUE(CM.value, '$.TABLE_NAME'))-LEN(@BaseTableSuffix)) AS EntityName,\n\t JSON_VALUE(CM.value, '$.COLUMN_NAME') AS ColumnName,\n\t CAST(JSON_VALUE(CM.value, '$.ORDINAL_POSITION') AS INT) AS OrdinalPosition,\n\t JSON_VALUE(CM.value, '$.DATA_TYPE') AS DataType\nFROM OPENJSON (@ColumnMetadata) AS CM\n)\n\n, OSM AS (\n--Get Option Set Metadata\nSELECT DISTINCT \n\tEntityName, \n\tOptionSetName, \n\tQUOTENAME(EntityName + '_' + OptionSetName) AS Alias\nFROM dbo.[OptionsetMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, GOSM AS (\n--Get Global Option Set Metadata\nSELECT DISTINCT \n\tOptionSetName, \n\tQUOTENAME('Global_' + OptionSetName) AS Alias\nFROM dbo.[GlobalOptionsetMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, StateM AS (\n--Get State Metadata\nSELECT DISTINCT \n\tEntityName, \n\tQUOTENAME(EntityName + '_State') AS Alias\nFROM dbo.[StateMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, StatusM AS (\n--Get Status Metadata\nSELECT DISTINCT \n\tEntityName,\n\tQUOTENAME(EntityName + '_Status') AS Alias\nFROM dbo.[StatusMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, SQLStatement AS (\n--Enumerate all lines in the source table and replace codes with labels where applicable\nSELECT CM.EntityName,\n\t--Before the first column of each table, construct a CREATE OR ALTER VIEW statement\n\tCASE WHEN CM.OrdinalPosition = 1\n\t\tTHEN 'CREATE OR ALTER VIEW ' + QUOTENAME(@EnrichedViewSchema) + '.' + CM.EntityName + '\n\t\tAS\n\t\tSELECT '\n\t\tELSE '\t,'\n\t\tEND\n\t--For each column, check if it needs to be replaced with a suitable localized label\n\t+ CASE \n\t\tWHEN OSM.OptionSetName IS NOT NULL THEN OSM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tWHEN GOSM.OptionSetName IS NOT NULL THEN GOSM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tWHEN StateM.EntityName IS NOT NULL THEN StateM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tWHEN StatusM.EntityName IS NOT NULL THEN StatusM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tELSE '[Base].' + QUOTENAME(CM.ColumnName)\n\t\tEND AS [SQLLine],\n\tCM.OrdinalPosition\nFROM CM \n\tLEFT JOIN OSM\n\t\tON CM.EntityName = OSM.EntityName\n\t\tAND CM.ColumnName = OSM.OptionSetName\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\tLEFT JOIN GOSM\n\t\tON CM.ColumnName = GOSM.OptionSetName\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\tLEFT JOIN StateM\n\t\tON CM.EntityName = StateM.EntityName\n\t\tAND CM.ColumnName = 'statecode'\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\tLEFT JOIN StatusM\n\t\tON CM.EntityName = StatusM.EntityName\n\t\tAND CM.ColumnName = 'statuscode'\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\nUNION ALL\n--Construct the first line of the FROM clause, referencing external tables created by Synapse Link for Dataverse\nSELECT DISTINCT\nCM.EntityName,\n'FROM ' + QUOTENAME(DB_NAME()) + '.' + QUOTENAME(CM.TableSchema) + '.' + QUOTENAME(CM.TableName) + ' AS Base' AS SQLLine,\n10000 AS OrdinalPosition\nFROM CM\n\nUNION ALL \n--Construct LEFT JOIN statements for each relevant OptionSetMetadata field\nSELECT DISTINCT OSM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[OptionSetMetadata] AS ' + OSM.Alias + ' \n\t\tON ' + OSM.Alias + '.EntityName = ''' + OSM.EntityName + ''' \n\t\tAND ' + OSM.Alias + '.OptionSetName = ''' +  OSM.OptionSetName + '''\n\t\tAND [Base].' + QUOTENAME(OSM.OptionSetName) + ' = ' + OSM.Alias + '.[Option]\n\t\tAND ' + OSM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n20000 AS OrdinalPosition\nFROM OSM\n\tJOIN CM\n\t\tON CM.EntityName = OSM.EntityName\n\t\tAND CM.ColumnName = OSM.OptionSetName\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL \n--Construct LEFT JOIN statements for each relevant GlobalOptionSetMetadata field\nSELECT DISTINCT CM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[GlobalOptionSetMetadata] AS ' + Alias + ' \n\t\tON ' + Alias + '.OptionSetName = ''' +  OptionSetName + '''\n\t\tAND [Base].' + QUOTENAME(OptionSetName) + ' = ' + Alias + '.[Option]\n\t\tAND ' + Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n30000 AS OrdinalPosition\nFROM GOSM\n\tJOIN CM\n\t\tON CM.ColumnName = GOSM.OptionSetName\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL \n--Construct LEFT JOIN statements for each relevant State Metadata field\nSELECT DISTINCT CM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[StateMetadata] AS ' + StateM.Alias + ' \n\t\tON ' + StateM.Alias + '.EntityName = ''' + StateM.EntityName + ''' \n\t\tAND [Base].statecode' + ' = ' + StateM.Alias + '.[State]\n\t\tAND ' + StateM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n40000 AS OrdinalPosition\nFROM StateM\n\tJOIN CM\n\t\tON CM.EntityName = StateM.EntityName\n\t\tAND CM.ColumnName = 'statecode'\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL\n--Construct LEFT JOIN statements for each relevant Status Metadata field\nSELECT DISTINCT CM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[StatusMetadata] AS ' + StatusM.Alias + ' \n\t\tON ' + StatusM.Alias + '.EntityName = ''' + StatusM.EntityName + ''' \n\t\tAND [Base].statuscode' + ' = ' + StatusM.Alias + '.[Status]\n\t\tAND ' + StatusM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n40000 AS OrdinalPosition\nFROM StatusM\n\tJOIN CM\n\t\tON CM.EntityName = StatusM.EntityName\n\t\tAND CM.ColumnName = 'statuscode'\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL\n--Add statement terminator\nSELECT DISTINCT\nEntityName,\n'; ' + CHAR(10) AS SQLLine,\n100000 AS OrdinalPosition\nFROM CM\n)\n\n--Construct individual statements to create views (1 view per row)\n--Since CREATE VIEW statement must be the first statement in a batch, assign each view definition to a variable \n--and use the EXEC(@variable) command to create view as part of its own, separate batch.\n, ViewDefinitions AS (\nSELECT 'DECLARE @' + EntityName + ' NVARCHAR(MAX) = ''\n\t' + REPLACE(STRING_AGG(CAST(SQLLine as varchar(MAX)), CHAR(10)) WITHIN GROUP (ORDER BY EntityName, OrdinalPosition, SQLLine), '''', '''''') + ''' ' + CHAR(10) + 'EXEC [' + @EnrichedViewDatabase + '].dbo.sp_executesql @' + EntityName + CHAR(10) AS ViewDefinition\nFROM SQLStatement\nGROUP BY EntityName\n)\n\n--Construct a comprehensive SQL statement to create all views\nSELECT @SQL = STRING_AGG(ViewDefinition, ';' + CHAR(10) + CHAR(10))\nFROM ViewDefinitions\n\n--Return a preview of the SQL Script to be generated or go ahead and create the views.\nIF @PreviewOnly = 1\nBEGIN\n\t--Return the final SQL statement\n\tSELECT '--================================================================================================='+ CHAR(10) +' ' + CHAR(10) AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '-- A preview of the script to generate enriched views is provided below.'  AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '-- No database objects have been created.' AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '-- Re-run this script with the @PreviewOnly parameter set to 0 to actually create the views.' AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '--================================================================================================='+ CHAR(10) +' ' + CHAR(10) AS [--SQL Statement]\n\tUNION ALL \n\tSELECT VALUE AS [--SQL Statement] FROM STRING_SPLIT(@SQL, CHAR(10))\nEND\nELSE\nBEGIN\n\t--Execute the SQL statement\n\tPRINT 'Beginning view creation'\n\tEXEC sp_executesql @SQL\n\tPRINT 'Completed view creation'\nEND",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "dataverse_montagu_org5a2bcccf",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Optionsetcreateandbuildview')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "--CREATE VIEW [dbo].[optionview]\nSELECT [EntityName], [OptionSetName], [Option], [IsUserLocalizedLabel], [LocalizedLabelLanguageCode], [LocalizedLabel]\n    FROM OPENROWSET (\n        BULK 'https://prodlakeaccuks01.dfs.core.windows.net/dataverse-montagu-org5a2bcccf/Microsoft.Athena.TrickleFeedService/ts_productprofile*.json', \n        FORMAT = 'csv',\n        FIELDTERMINATOR ='0x0b',\n        FIELDQUOTE = '0x0b',\n        ROWTERMINATOR = '0x0b'\n    ) WITH (doc nvarchar(max)) AS rows\n    CROSS APPLY OPENJSON(doc, '$.OptionSetMetadata')\n    WITH (\n            [EntityName] nvarchar(4000) '$.EntityName',\n            [OptionSetName] nvarchar(4000) '$.OptionSetName',\n            [Option] int '$.Option',\n            [IsUserLocalizedLabel] nvarchar(4000) '$.IsUserLocalizedLabel',\n            [LocalizedLabelLanguageCode] int '$.LocalizedLabelLanguageCode',\n            [LocalizedLabel] nvarchar(4000) '$.LocalizedLabel'\n    )\n\n\n    ",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "dataverse_montagu_org5a2bcccf",
						"poolName": "Built-in"
					},
					"resultLimit": -1
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Purview add to Dedicated')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "CREATE USER [MontaguPurview] FROM EXTERNAL PROVIDER\nGO\n\nEXEC sp_addrolemember 'db_datareader', [MontaguPurview]\nGO",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "dataverse_montagu_org5a2bcccf",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 21')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "select OptionSetName, OptionId, IsUserLocalizedLabel, LocalizedLabelLanguageCode, LocalizedLabel\nfrom openrowset(bulk 'https://prodlakeaccuks01.dfs.core.windows.net/dataverse_montagu_org5a2bcccf/Microsoft.Athena.TrickleFeedService/*-EntityMetadata.json', \n       FORMAT = 'csv',\n        fieldterminator ='0x0b',\n        fieldquote = '0x0b',\n        rowterminator = '0x0b'\n    ) with (doc nvarchar(max)) AS rows\n    cross apply openjson(doc, '$.OptionSetMetadata')\n    with (\n            OptionSetName nvarchar(4000) '$.OptionSetName',\n            OptionId int '$.Option',\n            IsUserLocalizedLabel nvarchar(4000) '$.IsUserLocalizedLabel',\n            LocalizedLabelLanguageCode int '$.LocalizedLabelLanguageCode',\n            LocalizedLabel nvarchar(4000) '$.LocalizedLabel'\n    )",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "dataverse_montagu_org5a2bcccf",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 22')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "Select * from OriginationOpportunities\n\n\n\nSelect Id, [3dd01a2e-b203-e911-a983-00224800cdc2], [0cc815fa-8759-ea11-a811-000d3a86d68d]\n\n\n\nfrom\n\n\n\n(Select Id as sId, ts_actionstatus, ts_producttype\n\n\n\nfrom OriginationOpportunities as Source_Table)\n\n\n\nPIVOT\n\n\n\n(Max(Id)\n\n\n\nFor\n\n\n\nsId in ([Id], [3dd01a2e-b203-e911-a983-00224800cdc2], [0cc815fa-8759-ea11-a811-000d3a86d68d])\n\n\n\nas Pivot_table",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "dataverse_montagu_org5a2bcccf",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 29')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT [EntityName], [OptionSetName], [Option], [IsUserLocalizedLabel], [LocalizedLabelLanguageCode], [LocalizedLabel]\n    FROM OPENROWSET (\n        BULK 'https://prodlakeaccuks01.dfs.core.windows.net/dataverse-montagu-org5a2bcccf/Microsoft.Athena.TrickleFeedService/*-EntityMetadata.json', \n        FORMAT = 'csv',\n        FIELDTERMINATOR ='0x0b',\n        FIELDQUOTE = '0x0b',\n        ROWTERMINATOR = '0x0b'\n    ) WITH (doc nvarchar(max)) AS rows\n    CROSS APPLY OPENJSON(doc, '$.OptionSetMetadata')\n    WITH (\n            [EntityName] nvarchar(4000) '$.EntityName',\n            [OptionSetName] nvarchar(4000) '$.OptionSetName',\n            [Option] int '$.Option',\n            [IsUserLocalizedLabel] nvarchar(4000) '$.IsUserLocalizedLabel',\n            [LocalizedLabelLanguageCode] int '$.LocalizedLabelLanguageCode',\n            [LocalizedLabel] nvarchar(4000) '$.LocalizedLabel'\n    )",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "dataverse_montagu_org5a2bcccf",
						"poolName": "Built-in"
					},
					"resultLimit": -1
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 3')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT TOP (100) [AccountStatusId]\n,[AccountStatusName]\n,[AccountStatusDescription]\n FROM [testlakedbtest].[dbo].[AccountStatus]",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "testlakedbtest",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 30')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT TOP (100) [Id]\n,[SinkCreatedOn]\n,[SinkModifiedOn]\n,[statecode]\n,[statuscode]\n,[modifiedonbehalfby]\n,[modifiedonbehalfby_entitytype]\n,[createdonbehalfby]\n,[createdonbehalfby_entitytype]\n,[modifiedby]\n,[modifiedby_entitytype]\n,[createdby]\n,[createdby_entitytype]\n,[organizationid]\n,[organizationid_entitytype]\n,[createdonbehalfbyyominame]\n,[gap_language]\n,[importsequencenumber]\n,[organizationidname]\n,[utcconversiontimezonecode]\n,[createdbyyominame]\n,[gap_entityname]\n,[modifiedbyname]\n,[versionnumber]\n,[modifiedbyyominame]\n,[timezoneruleversionnumber]\n,[gap_entityschemaname]\n,[modifiedon]\n,[gap_powerbioptionsetrefid]\n,[gap_optionsetschemaname]\n,[modifiedonbehalfbyyominame]\n,[createdbyname]\n,[createdon]\n,[gap_value]\n,[createdonbehalfbyname]\n,[modifiedonbehalfbyname]\n,[gap_label]\n,[overriddencreatedon]\n,[gap_imageurl]\n FROM [dataverse_montagu_org5a2bcccf].[dbo].[gap_powerbioptionsetref]",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "dataverse_montagu_org5a2bcccf",
						"poolName": "Built-in"
					},
					"resultLimit": -1
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 31')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT [EntityName]\n,[OptionSetName]\n,[Option]\n,[IsUserLocalizedLabel]\n,[LocalizedLabelLanguageCode]\n,[LocalizedLabel]\n FROM [dbo].[optionview]",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "ReportsSL",
						"poolName": "Built-in"
					},
					"resultLimit": -1
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 32')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "CREATE TABLE [dbo].[duedil]\n(\n    col1 int NOT NULL\n)\nWITH\n(\n    DISTRIBUTION = HASH (col1),\n    CLUSTERED COLUMNSTORE INDEX\n)\nGO\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "DedicatedSQLPool",
						"poolName": "DedicatedSQLPool"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 33')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT TOP (100) [EntityName]\n,[OptionSetName]\n,[Option]\n,[IsUserLocalizedLabel]\n,[LocalizedLabelLanguageCode]\n,[LocalizedLabel]\n FROM [dbo].[optionview]",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "ReportsSL",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 34')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "CREATE EXTERNAL TABLE [dbo].[ExternalTable]\n(\n\t [Id] INT\n)\nWITH\n(\n\tLOCATION = '/folder/file',\n\tDATA_SOURCE = [DataSource1],\n\tFILE_FORMAT = [FileFormat1]\n)\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "DataverseEnriched",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 35')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT TOP (100) [Id]\n,[SinkCreatedOn]\n,[SinkModifiedOn]\n,[stateAZlabel]\n,[statusAZlabel]\n,[ts_primarysecondaryfocus]\n,[customertypeAZlabel]\n,[address1_addresstypeAZlabel]\n,[accountclassificationAZlabel]\n,[ts_easeofworking]\n,[ts_ukrow]\n,[preferredappointmenttimeAZlabel]\n,[ts_address1addresstype]\n,[xpd_relationshipstatus]\n,[ts_relationship]\n,[xpd_remindermonths]\n,[ts_importance]\n,[address2_freighttermsAZlabel]\n,[ts_irrvsmomperformancemeasure]\n,[ts_introducertype]\n,[accountcategoryAZlabel]\n,[paymenttermsAZlabel]\n,[preferredappointmentdayAZlabel]\n,[businesstypeAZlabel]\n,[industryAZlabel]\n,[ts_sizeoffirm]\n,[ts_interaction]\n,[address1_shippingmethodAZlabel]\n,[ts_portfoliocompanystatus]\n,[customersizeAZlabel]\n,[xpd_previousinvestorstatus]\n,[ts_recommendationoffirm]\n,[preferredcontactmethodAZlabel]\n,[accountratingAZlabel]\n,[ts_investorstatus]\n,[ts_capabilitiesoffirm]\n,[mpe_flowlastrunoutcome]\n,[address2_addresstypeAZlabel]\n,[address2_shippingmethodAZlabel]\n,[ts_nextoriginationmeetingarranged]\n,[ownershipAZlabel]\n,[territoryAZlabel]\n,[ts_investortype]\n,[shippingmethodAZlabel]\n,[ts_investorregion]\n,[address1_freighttermsAZlabel]\n,[xpd_function]\n,[ts_quickcaptureuses]\n,[xpd_montagulevel]\n,[ts_permanentinterim]\n,[ts_quickcapturesectors]\n,[ts_roletypes]\n,[ts_companytype]\n,[xpd_level]\n,[ts_indicativeclientbase]\n,[xpd_specialisms]\n,[ts_vendorsummary]\n,[ts_producttype]\n,[ts_montaguoffice]\n,[ts_quickcapturegeography]\n,[xpd_roletypes]\n,[mpe_livedeal]\n,[donotbulkpostalmail]\n,[donotpostalmail]\n,[msdyn_gdproptout]\n,[ts_organisationalchange]\n,[xpd_publictoprivatetracker]\n,[ts_auditor]\n,[donotsendmm]\n,[donotbulkemail]\n,[followemail]\n,[creditonhold]\n,[marketingonly]\n,[participatesinworkflow]\n,[merged]\n,[ts_validated]\n,[xpd_sharepointlocationcreated]\n,[xpd_setreminder]\n,[ts_personnelchange]\n,[donotfax]\n,[isprivate]\n,[donotphone]\n,[xpd_rpo]\n,[ts_trackcompany]\n,[donotemail]\n,[parentaccountid]\n,[parentaccountid_entitytype]\n,[ts_recommendedby]\n,[ts_recommendedby_entitytype]\n,[ts_countryofeconomicoriginforthecapital]\n,[ts_countryofeconomicoriginforthecapital_entitytype]\n,[xpd_reminderto]\n,[xpd_reminderto_entitytype]\n,[preferredserviceid]\n,[preferredserviceid_entitytype]\n,[msdyn_segmentid]\n,[msdyn_segmentid_entitytype]\n,[owningbusinessunit]\n,[owningbusinessunit_entitytype]\n,[createdbyexternalparty]\n,[createdbyexternalparty_entitytype]\n,[ts_validatedby]\n,[ts_validatedby_entitytype]\n,[modifiedonbehalfby]\n,[modifiedonbehalfby_entitytype]\n,[transactioncurrencyid]\n,[transactioncurrencyid_entitytype]\n,[ts_primarymperelationshipmanager]\n,[ts_primarymperelationshipmanager_entitytype]\n,[modifiedbyexternalparty]\n,[modifiedbyexternalparty_entitytype]\n,[ts_headofficeid]\n,[ts_headofficeid_entitytype]\n,[ts_address1country]\n,[ts_address1country_entitytype]\n,[ts_address1usstate]\n,[ts_address1usstate_entitytype]\n,[msdyn_salesaccelerationinsightid]\n,[msdyn_salesaccelerationinsightid_entitytype]\n,[slaid]\n,[slaid_entitytype]\n,[originatingleadid]\n,[originatingleadid_entitytype]\n,[masterid]\n,[masterid_entitytype]\n,[ts_originationlead1]\n,[ts_originationlead1_entitytype]\n,[defaultpricelevelid]\n,[defaultpricelevelid_entitytype]\n,[owninguser]\n,[owninguser_entitytype]\n,[ts_originationlead2]\n,[ts_originationlead2_entitytype]\n,[slainvokedid]\n,[slainvokedid_entitytype]\n,[mpe_coinvestquestionnaireid]\n,[mpe_coinvestquestionnaireid_entitytype]\n,[ts_hub]\n,[ts_hub_entitytype]\n,[owningteam]\n,[owningteam_entitytype]\n,[ts_currentauditor]\n,[ts_currentauditor_entitytype]\n,[primarycontactid]\n,[primarycontactid_entitytype]\n,[modifiedby]\n,[modifiedby_entitytype]\n,[preferredsystemuserid]\n,[preferredsystemuserid_entitytype]\n,[preferredequipmentid]\n,[preferredequipmentid_entitytype]\n,[xpd_fund]\n,[xpd_fund_entitytype]\n,[createdonbehalfby]\n,[createdonbehalfby_entitytype]\n,[createdby]\n,[createdby_entitytype]\n,[territoryid]\n,[territoryid_entitytype]\n,[ownerid]\n,[ownerid_entitytype]\n,[xpd_totalinstitutionalcommitments_base]\n,[ts_minimumticketsize_base]\n,[xpd_totalinstitutionalcommitments]\n,[aging30]\n,[creditlimit]\n,[creditlimit_base]\n,[ts_totalcommitments_base]\n,[aging60]\n,[ts_transfersin_base]\n,[aging90]\n,[ts_maximumticketsize]\n,[ts_totalaum_base]\n,[marketcap_base]\n,[aging60_base]\n,[aging90_base]\n,[ts_transfersout]\n,[ts_maximumticketsize_base]\n,[ts_originalcommitments_base]\n,[revenue]\n,[ts_totalcommitments]\n,[ts_transfersout_base]\n,[ts_totalaum]\n,[ts_commitmentreductions_base]\n,[ts_commitmentreductions]\n,[marketcap]\n,[ts_originalcommitments]\n,[ts_minimumticketsize]\n,[revenue_base]\n,[openrevenue_base]\n,[aging30_base]\n,[openrevenue]\n,[ts_transfersin]\n,[ts_othernotes]\n,[ts_transfersin_date]\n,[msdyn_salesaccelerationinsightidname]\n,[address1_county]\n,[openrevenue_date]\n,[ts_recommendedbyname]\n,[ts_relationshipinteractioncomments]\n,[ts_originationlead2yominame]\n,[parentaccountidname]\n,[xpd_roletypes_text]\n,[address1_addressid]\n,[importsequencenumber]\n,[address1_longitude]\n,[ts_countryofeconomicoriginforthecapitalname]\n,[entityimageid]\n,[telephone2]\n,[ts_lastoriginationmeeting]\n,[address2_utcoffset]\n,[address1_upszone]\n,[ts_originalcommitments_state]\n,[ts_typicalcost]\n,[xpd_recommendingportfoliocompaniesrecommended]\n,[accountnumber]\n,[ts_currentauditoryominame]\n,[ts_originalcommitments_date]\n,[lastonholdtime]\n,[ts_sectorscoveredbyfirm]\n,[address1_telephone1]\n,[address1_telephone2]\n,[address1_telephone3]\n,[address2_upszone]\n,[opendeals_state]\n,[xpd_functionuse_text]\n,[slainvokedidname]\n,[address2_longitude]\n,[defaultpricelevelidname]\n,[stockexchange]\n,[mpe_liveofferingscount_date]\n,[xpd_relationshipcomments]\n,[originatingleadidname]\n,[slaname]\n,[ts_currentauditorname]\n,[xpd_remindertoyominame]\n,[ts_address1usstatename]\n,[ts_tempcompanytype]\n,[versionnumber]\n,[address1_latitude]\n,[ts_formername]\n,[yominame]\n,[createdbyyominame]\n,[ts_cityofvisit]\n,[address2_telephone1]\n,[ts_globalgeographiescoveredids]\n,[preferredserviceidname]\n,[address2_city]\n,[ts_mpeapproachstrategy]\n,[address2_line2]\n,[ts_lastdatestatuschanged]\n,[li_companyid]\n,[transactioncurrencyidname]\n,[entityimage_url]\n,[xpd_relationshipstatuschangeddate]\n,[createdonbehalfbyname]\n,[mpe_liveofferingscount_state]\n,[xpd_numberofcoinvestinvestments_date]\n,[ts_validateddate]\n,[owneridname]\n,[xpd_generalcomments]\n,[ts_companylegalname]\n,[description]\n,[ts_validatedbyname]\n,[originatingleadidyominame]\n,[opendeals]\n,[xpd_numberofopportunitiesshown_state]\n,[address2_postalcode]\n,[websiteurl]\n,[xpd_fundname]\n,[address1_utcoffset]\n,[exchangerate]\n,[mpe_flowlastrundate]\n,[fax]\n,[address1_line3]\n,[ts_monthssincelastmeeting]\n,[ts_hubname]\n,[address2_line1]\n,[ts_capiqticket]\n,[address2_stateorprovince]\n,[address2_name]\n,[ts_transfersout_state]\n,[xpd_numberofopportunitiesshown]\n,[primarytwitterid]\n,[mpe_coinvestquestionnaireidname]\n,[xpd_numberofopportunitiesshown_date]\n,[xpd_preferentialterms]\n,[address1_primarycontactname]\n,[territoryidname]\n,[ts_processstatus]\n,[address1_name]\n,[address2_telephone2]\n,[address2_telephone3]\n,[xpd_recruitmentareateam_text]\n,[ftpsiteurl]\n,[address1_postalcode]\n,[ts_companynumber]\n,[createdon]\n,[mpe_liveofferingscount]\n,[traversedpath]\n,[address1_stateorprovince]\n,[ts_transfersin_state]\n,[address2_addressid]\n,[ts_monthlyreviewmeetingname]\n,[primarysatoriid]\n,[telephone3]\n,[openrevenue_state]\n,[ts_usesprovidedids]\n,[ts_originationcomments]\n,[lastusedincampaign]\n,[primarycontactidname]\n,[ts_originationlead1name]\n,[ts_headofficeidname]\n,[msdyn_segmentidname]\n,[ts_montagucomments]\n,[address2_fax]\n,[createdbyname]\n,[xpd_numberofcoinvestinvestments]\n,[ts_capitaliqlink]\n,[ts_primarymperelationshipmanagername]\n,[mpe_relationshipstatus_text]\n,[xpd_datereminderwasset]\n,[xpd_numberofcoinvestinvestments_state]\n,[address1_postofficebox]\n,[address1_city]\n,[teamsfollowed]\n,[ts_originationlead2name]\n,[timezoneruleversionnumber]\n,[modifiedonbehalfbyyominame]\n,[entityimage_timestamp]\n,[tickersymbol]\n,[ts_theirprogrammecomments]\n,[xpd_companyuse_text]\n,[modifiedbyname]\n,[owneridtype]\n,[sic]\n,[sharesoutstanding]\n,[opendeals_date]\n,[address2_postofficebox]\n,[emailaddress3]\n,[emailaddress2]\n,[emailaddress1]\n,[ts_globalgeographiescoveredbyfirm]\n,[ts_recommendationoffirmupdated]\n,[ts_lastmet]\n,[ts_reminderdatesetto]\n,[ts_commitmentreductions_state]\n,[owningbusinessunitname]\n,[onholdtime]\n,[ts_alias]\n,[createdonbehalfbyyominame]\n,[ts_transfersout_date]\n,[ts_address1countryname]\n,[preferredsystemuseridyominame]\n,[createdbyexternalpartyname]\n,[mpe_documentsetid]\n,[telephone1]\n,[ts_legacycompanytypes]\n,[ts_validatedbyyominame]\n,[address1_composite]\n,[ts_investorgroupgatekeeperid]\n,[primarycontactidyominame]\n,[address2_country]\n,[xpd_recommendationcomments]\n,[owneridyominame]\n,[createdbyexternalpartyyominame]\n,[ts_originationlead1yominame]\n,[ts_usesprovidedbyfirm]\n,[xpd_recommendingportco]\n,[address1_country]\n,[ts_commitmentreductions_date]\n,[name]\n,[modifiedbyexternalpartyyominame]\n,[xpd_remindertoname]\n,[stageid]\n,[modifiedonbehalfbyname]\n,[masteraccountidname]\n,[timespentbymeonemailandmeetings]\n,[address2_latitude]\n,[overriddencreatedon]\n,[parentaccountidyominame]\n,[ts_specificareaofexpertisecomments]\n,[preferredsystemuseridname]\n,[utcconversiontimezonecode]\n,[address2_county]\n,[address1_line1]\n,[address2_primarycontactname]\n,[address1_line2]\n,[xpd_reasonaction]\n,[ts_primarymperelationshipmanageryominame]\n,[processid]\n,[ts_sectorscoveredids]\n,[ts_recommendedbyyominame]\n,[modifiedbyexternalpartyname]\n,[ts_relevantsituations]\n,[accountid]\n,[modifiedon]\n,[preferredequipmentidname]\n,[modifiedbyyominame]\n,[ts_dealstageofmostrecentopportunity]\n,[address2_composite]\n,[masteraccountidyominame]\n,[numberofemployees]\n,[address1_fax]\n,[address2_line3]\n FROM [dbo].[account]",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "DataverseEnriched",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 36')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "select count(*) from systemuser",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "dataverse_montagu_org5a2bcccf",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 37')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT TOP (100) [EntityName]\n,[OptionSetName]\n,[Option]\n,[IsUserLocalizedLabel]\n,[LocalizedLabelLanguageCode]\n,[LocalizedLabel]\n FROM [dataverse_montagu_org5a2bcccf].[dbo].[OptionsetMetadata]",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "dataverse_montagu_org5a2bcccf",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 38')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT TOP (100) [OptionSetName]\n,[Option]\n,[IsUserLocalizedLabel]\n,[LocalizedLabelLanguageCode]\n,[LocalizedLabel]\n,[GlobalOptionSetName]\n,[EntityName]\n FROM [dataverse_montagu_org5a2bcccf].[dbo].[GlobalOptionsetMetadata]",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "dataverse_montagu_org5a2bcccf",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 39')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT TOP (100) [Id]\n,[SinkCreatedOn]\n,[SinkModifiedOn]\n,[statecode]\n,[statuscode]\n,[modifiedonbehalfby]\n,[modifiedonbehalfby_entitytype]\n,[createdby]\n,[createdby_entitytype]\n,[organizationid]\n,[organizationid_entitytype]\n,[modifiedby]\n,[modifiedby_entitytype]\n,[createdonbehalfby]\n,[createdonbehalfby_entitytype]\n,[createdbyyominame]\n,[gap_imageurl]\n,[organizationidname]\n,[modifiedbyname]\n,[createdonbehalfbyyominame]\n,[modifiedonbehalfbyyominame]\n,[modifiedbyyominame]\n,[gap_entityschemaname]\n,[createdbyname]\n,[versionnumber]\n,[timezoneruleversionnumber]\n,[gap_powerbioptionsetrefid]\n,[importsequencenumber]\n,[modifiedonbehalfbyname]\n,[gap_optionsetschemaname]\n,[gap_entityname]\n,[gap_language]\n,[gap_value]\n,[modifiedon]\n,[overriddencreatedon]\n,[utcconversiontimezonecode]\n,[createdonbehalfbyname]\n,[createdon]\n,[gap_label]\n FROM [dataverse_montagu_org5a2bcccf].[dbo].[gap_powerbioptionsetref]",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "dataverse_montagu_org5a2bcccf",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 40')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT TOP (100) [Id]\n,[ts_primarysecondaryfocus]\n,[xpd_relationshipstatus]\n,[ts_introducertype]\n,[xpd_remindermonths]\n,[ts_portfoliocompanystatus]\n,[ts_companytype]\n,[ts_vendorsummary]\n,[xpd_publictoprivatetracker]\n,[xpd_setreminder]\n,[ts_trackcompany]\n,[parentaccountid]\n,[xpd_reminderto]\n,[ts_headofficeid]\n,[ts_originationlead1]\n,[ts_originationlead2]\n,[ts_currentauditor]\n,[ts_othernotes]\n,[xpd_relationshipcomments]\n,[ts_formername]\n,[ts_mpeapproachstrategy]\n,[ts_lastdatestatuschanged]\n,[xpd_relationshipstatuschangeddate]\n,[ts_companylegalname]\n,[ts_companynumber]\n,[ts_monthlyreviewmeetingname]\n,[ts_originationcomments]\n,[ts_capitaliqlink]\n,[xpd_datereminderwasset]\n,[ts_reminderdatesetto]\n,[ts_alias]\n,[xpd_reasonaction]\n,[ts_relevantsituations]\n,[ts_dealstageofmostrecentopportunity]\n,[stateAZLabel]\n,[statusAZLabel]\n,[customertypeAZLabel]\n,[address1_addresstypeAZLabel]\n,[accountclassificationAZLabel]\n,[preferredappointmenttimeAZLabel]\n,[address2_freighttermsAZLabel]\n,[accountcategoryAZLabel]\n,[paymenttermsAZLabel]\n,[preferredappointmentdayAZLabel]\n,[businesstypeAZLabel]\n,[industryAZLabel]\n,[address1_shippingmethodAZLabel]\n,[customersizeAZLabel]\n,[preferredcontactmethodAZLabel]\n,[accountratingAZlabel]\n,[address2_addresstypeAZlabel]\n,[address2_shippingmethodAZlabel]\n,[ownershipAZlabel]\n,[territoryAZlabel]\n,[shippingmethodAZlabel]\n,[address1_freighttermsAZlabel]\n,[AZlabel]\n FROM [dbo].[account]",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "ReportsDW",
						"poolName": "ReportsDW"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 41')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT TOP (100) [Id]\n,[ts_meetingteam]\n,[ts_othermeetingmethod]\n,[isonlinemeeting]\n,[isalldayevent]\n,[regardingobjectid]\n,[ts_taskowner]\n,[scheduledend]\n,[ts_taskdescription]\n,[scheduledstart]\n,[onlinemeetingjoinurl]\n,[ts_notes]\n,[ts_opportunitiesdiscussed]\n,[ts_sectorscoveredbyfirm]\n,[ts_originationcommentsnotes]\n,[ts_taskduedate]\n,[ts_sectorscoveredids]\n,[location]\n,[scheduleddurationminutes]\n,[SinkCreatedOn]\n,[SinkModifiedOn]\n,[stateAZlabel]\n,[statusAZlabel]\n,[ts_stageofmeetingrounds]\n,[ts_talentmeetingtype]\n,[instancetypeAZlabel]\n,[ts_whooriginatedthemeeting]\n,[onlinemeetingtype]\n,[ts_tone]\n,[ts_meetingmethod]\n,[ts_originationmeetingtype]\n,[priorityAZlabel]\n,[attachmenterrors]\n,[ts_eventtype]\n,[ts_talentmeetingmethod]\n,[ts_productsdiscussed]\n,[ts_contentcovered]\n,[isworkflowcreated]\n,[ts_interview]\n,[isbilled]\n,[isdraft]\n,[ts_keyiractivity]\n,[ts_noninvestor]\n,[ismapiprivate]\n,[isregularactivity]\n,[slaid]\n,[slaid_entitytype]\n,[owningbusinessunit]\n,[owningbusinessunit_entitytype]\n,[createdonbehalfby]\n,[createdonbehalfby_entitytype]\n,[ts_investorgroup]\n,[ts_investorgroup_entitytype]\n,[modifiedby]\n,[modifiedby_entitytype]\n,[modifiedonbehalfby]\n,[modifiedonbehalfby_entitytype]\n,[owningteam]\n,[owningteam_entitytype]\n,[owninguser]\n,[owninguser_entitytype]\n,[regardingobjectid_entitytype]\n,[slainvokedid]\n,[slainvokedid_entitytype]\n,[transactioncurrencyid]\n,[transactioncurrencyid_entitytype]\n,[createdby]\n,[createdby_entitytype]\n,[ts_officemet]\n,[ts_officemet_entitytype]\n,[ts_taskowner_entitytype]\n,[serviceid]\n,[serviceid_entitytype]\n,[ownerid]\n,[ownerid_entitytype]\n,[requiredattendees]\n,[optionalattendees]\n,[organizer]\n,[modifiedon]\n,[ts_purpose]\n,[overriddencreatedon]\n,[ts_taskownername]\n,[activityadditionalparams]\n,[ts_tonepersonalities]\n,[seriesid]\n,[transactioncurrencyidname]\n,[activityid]\n,[modifiedfieldsmask]\n,[utcconversiontimezonecode]\n,[ts_officemetname]\n,[outlookownerapptid]\n,[ts_topicscovered]\n,[ts_objective]\n,[onholdtime]\n,[originalstartdate]\n,[attachmentcount]\n,[exchangerate]\n,[category]\n,[createdon]\n,[ts_eventdescription]\n,[globalobjectid]\n,[onlinemeetingid]\n,[serviceidname]\n,[owneridyominame]\n,[description]\n,[subcategory]\n,[owningbusinessunitname]\n,[traversedpath]\n,[sortdate]\n,[createdonbehalfbyname]\n,[safedescription]\n,[ts_taskowneryominame]\n,[owneridtype]\n,[isunsafe]\n,[modifiedonbehalfbyname]\n,[createdonbehalfbyyominame]\n,[ts_conferencename]\n,[timezoneruleversionnumber]\n,[actualend]\n,[regardingobjectidname]\n,[processid]\n,[activitytypecode]\n,[actualstart]\n,[xpd_listofexternalattendees]\n,[slainvokedidname]\n,[subject]\n,[createdbyname]\n,[actualdurationminutes]\n,[modifiedbyyominame]\n,[lastonholdtime]\n,[modifiedonbehalfbyyominame]\n,[ts_attendeestoaddtocrm]\n,[regardingobjectidyominame]\n,[regardingobjecttypecode]\n,[stageid]\n,[ts_sourceid]\n,[ts_investorgroupyominame]\n,[importsequencenumber]\n,[subscriptionid]\n,[onlinemeetingchatid]\n,[ts_lpupdates]\n,[ts_executivesummary]\n,[ts_investorgroupname]\n,[ts_meetingcity]\n,[modifiedbyname]\n,[createdbyyominame]\n,[owneridname]\n,[ts_theirprogramme]\n,[ts_ifdeclinedreason]\n,[slaname]\n,[versionnumber]\n FROM [dbo].[appointment]",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "ReportsDW",
						"poolName": "ReportsDW"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 42')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT TOP (100) [Id]\n,[ts_actionstatus]\n,[ts_producttype]\n,[ts_internalintermediarysource]\n,[ts_currentactivity]\n,[ts_opportunitystatus]\n,[ts_montaguprimaryoffice]\n,[ts_opportunitytype]\n,[ts_posthumstatus]\n,[ts_choppedreason]\n,[ts_duplicateopportunityfordiscussion]\n,[mpe_smalltarget]\n,[xpd_includeonallpapers]\n,[ts_sold]\n,[xpd_sharepointlocationcreated]\n,[ts_buyer]\n,[mpe_productid]\n,[ts_targetbusiness]\n,[ts_firstreferralcompany]\n,[ts_montaguowner]\n,[ts_firstreferralcontact]\n,[transactioncurrencyid]\n,[ts_managerwedback]\n,[ts_country]\n,[ownerid]\n,[ts_estebitda]\n,[ts_estebit]\n,[ts_estdealsize]\n,[ts_estturnover]\n,[ts_nextsteps]\n,[ts_buyerpaidxltmebitda]\n,[ts_opportunitystage]\n,[ts_choppedcomments]\n,[ts_datedealannounced]\n,[ts_name]\n,[ts_weofferedxltmebitda]\n,[ts_companyid]\n,[ts_choppeddate]\n,[mpe_carveout]\n,[mpe_targetbusiness_parentid]\n,[stateAZlabel]\n,[statusAZlabel]\n FROM [dbo].[OriginationOpportunities]",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "ReportsDW",
						"poolName": "ReportsDW"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 43')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT TOP (100) [Id]\n,[SinkCreatedOn]\n,[SinkModifiedOn]\n,[statecode]\n,[statuscode]\n,[ts_stageofmeetingrounds]\n,[ts_talentmeetingtype]\n,[instancetypecode]\n,[ts_whooriginatedthemeeting]\n,[onlinemeetingtype]\n,[ts_meetingteam]\n,[ts_othermeetingmethod]\n,[ts_tone]\n,[ts_meetingmethod]\n,[ts_originationmeetingtype]\n,[prioritycode]\n,[attachmenterrors]\n,[ts_eventtype]\n,[ts_talentmeetingmethod]\n,[ts_productsdiscussed]\n,[ts_contentcovered]\n,[isonlinemeeting]\n,[isworkflowcreated]\n,[isalldayevent]\n,[ts_interview]\n,[isbilled]\n,[isdraft]\n,[ts_keyiractivity]\n,[ts_noninvestor]\n,[ismapiprivate]\n,[isregularactivity]\n,[slaid]\n,[slaid_entitytype]\n,[owningbusinessunit]\n,[owningbusinessunit_entitytype]\n,[createdonbehalfby]\n,[createdonbehalfby_entitytype]\n,[ts_investorgroup]\n,[ts_investorgroup_entitytype]\n,[modifiedby]\n,[modifiedby_entitytype]\n,[modifiedonbehalfby]\n,[modifiedonbehalfby_entitytype]\n,[owningteam]\n,[owningteam_entitytype]\n,[owninguser]\n,[owninguser_entitytype]\n,[regardingobjectid]\n,[regardingobjectid_entitytype]\n,[slainvokedid]\n,[slainvokedid_entitytype]\n,[transactioncurrencyid]\n,[transactioncurrencyid_entitytype]\n,[createdby]\n,[createdby_entitytype]\n,[ts_officemet]\n,[ts_officemet_entitytype]\n,[ts_taskowner]\n,[ts_taskowner_entitytype]\n,[serviceid]\n,[serviceid_entitytype]\n,[ownerid]\n,[ownerid_entitytype]\n,[requiredattendees]\n,[optionalattendees]\n,[organizer]\n,[scheduledend]\n,[ts_taskdescription]\n,[modifiedon]\n,[ts_purpose]\n,[overriddencreatedon]\n,[ts_taskownername]\n,[activityadditionalparams]\n,[ts_tonepersonalities]\n,[seriesid]\n,[transactioncurrencyidname]\n,[activityid]\n,[modifiedfieldsmask]\n,[utcconversiontimezonecode]\n,[ts_officemetname]\n,[scheduledstart]\n,[outlookownerapptid]\n,[ts_topicscovered]\n,[ts_objective]\n,[onholdtime]\n,[onlinemeetingjoinurl]\n,[ts_notes]\n,[originalstartdate]\n,[ts_opportunitiesdiscussed]\n,[ts_sectorscoveredbyfirm]\n,[attachmentcount]\n,[exchangerate]\n,[ts_originationcommentsnotes]\n,[category]\n,[createdon]\n,[ts_eventdescription]\n,[globalobjectid]\n,[onlinemeetingid]\n,[serviceidname]\n,[owneridyominame]\n,[description]\n,[subcategory]\n,[owningbusinessunitname]\n,[ts_taskduedate]\n,[traversedpath]\n,[sortdate]\n,[createdonbehalfbyname]\n,[ts_sectorscoveredids]\n,[safedescription]\n,[ts_taskowneryominame]\n,[owneridtype]\n,[isunsafe]\n,[modifiedonbehalfbyname]\n,[createdonbehalfbyyominame]\n,[ts_conferencename]\n,[timezoneruleversionnumber]\n,[actualend]\n,[regardingobjectidname]\n,[processid]\n,[activitytypecode]\n,[actualstart]\n,[xpd_listofexternalattendees]\n,[slainvokedidname]\n,[location]\n,[subject]\n,[createdbyname]\n,[actualdurationminutes]\n,[modifiedbyyominame]\n,[lastonholdtime]\n,[modifiedonbehalfbyyominame]\n,[ts_attendeestoaddtocrm]\n,[regardingobjectidyominame]\n,[regardingobjecttypecode]\n,[stageid]\n,[scheduleddurationminutes]\n,[ts_sourceid]\n,[ts_investorgroupyominame]\n,[importsequencenumber]\n,[subscriptionid]\n,[onlinemeetingchatid]\n,[ts_lpupdates]\n,[ts_executivesummary]\n,[ts_investorgroupname]\n,[ts_meetingcity]\n,[modifiedbyname]\n,[createdbyyominame]\n,[owneridname]\n,[ts_theirprogramme]\n,[ts_ifdeclinedreason]\n,[slaname]\n,[versionnumber]\n,[stateAZlabel]\n,[statusAZlabel]\n,[instancetypeAZlabel]\n,[priorityAZlabel]\n FROM [dbo].[appointmentENRICHED]",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "ReportsDW",
						"poolName": "ReportsDW"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 44')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT TOP (100) [Id]\n,[SinkCreatedOn]\n,[SinkModifiedOn]\n,[statecode]\n,[statuscode]\n,[ts_primarysecondaryfocus]\n,[customertypecode]\n,[address1_addresstypecode]\n,[accountclassificationcode]\n,[ts_easeofworking]\n,[ts_ukrow]\n,[preferredappointmenttimecode]\n,[ts_address1addresstype]\n,[xpd_relationshipstatus]\n,[ts_relationship]\n,[xpd_remindermonths]\n,[ts_importance]\n,[address2_freighttermscode]\n,[ts_irrvsmomperformancemeasure]\n,[ts_introducertype]\n,[accountcategorycode]\n,[paymenttermscode]\n,[preferredappointmentdaycode]\n,[businesstypecode]\n,[industrycode]\n,[ts_sizeoffirm]\n,[ts_interaction]\n,[address1_shippingmethodcode]\n,[ts_portfoliocompanystatus]\n,[customersizecode]\n,[xpd_previousinvestorstatus]\n,[ts_recommendationoffirm]\n,[preferredcontactmethodcode]\n,[accountratingcode]\n,[ts_investorstatus]\n,[ts_capabilitiesoffirm]\n,[mpe_flowlastrunoutcome]\n,[address2_addresstypecode]\n,[address2_shippingmethodcode]\n,[ts_nextoriginationmeetingarranged]\n,[ownershipcode]\n,[territorycode]\n,[ts_investortype]\n,[shippingmethodcode]\n,[ts_investorregion]\n,[address1_freighttermscode]\n,[xpd_function]\n,[ts_quickcaptureuses]\n,[xpd_montagulevel]\n,[ts_permanentinterim]\n,[ts_quickcapturesectors]\n,[ts_roletypes]\n,[ts_companytype]\n,[xpd_level]\n,[ts_indicativeclientbase]\n,[xpd_specialisms]\n,[ts_vendorsummary]\n,[ts_producttype]\n,[ts_montaguoffice]\n,[ts_quickcapturegeography]\n,[xpd_roletypes]\n,[mpe_livedeal]\n,[donotbulkpostalmail]\n,[donotpostalmail]\n,[msdyn_gdproptout]\n,[ts_organisationalchange]\n,[xpd_publictoprivatetracker]\n,[ts_auditor]\n,[donotsendmm]\n,[donotbulkemail]\n,[followemail]\n,[creditonhold]\n,[marketingonly]\n,[participatesinworkflow]\n,[merged]\n,[ts_validated]\n,[xpd_sharepointlocationcreated]\n,[xpd_setreminder]\n,[ts_personnelchange]\n,[donotfax]\n,[isprivate]\n,[donotphone]\n,[xpd_rpo]\n,[ts_trackcompany]\n,[donotemail]\n,[parentaccountid]\n,[parentaccountid_entitytype]\n,[ts_recommendedby]\n,[ts_recommendedby_entitytype]\n,[ts_countryofeconomicoriginforthecapital]\n,[ts_countryofeconomicoriginforthecapital_entitytype]\n,[xpd_reminderto]\n,[xpd_reminderto_entitytype]\n,[preferredserviceid]\n,[preferredserviceid_entitytype]\n,[msdyn_segmentid]\n,[msdyn_segmentid_entitytype]\n,[owningbusinessunit]\n,[owningbusinessunit_entitytype]\n,[createdbyexternalparty]\n,[createdbyexternalparty_entitytype]\n,[ts_validatedby]\n,[ts_validatedby_entitytype]\n,[modifiedonbehalfby]\n,[modifiedonbehalfby_entitytype]\n,[transactioncurrencyid]\n,[transactioncurrencyid_entitytype]\n,[ts_primarymperelationshipmanager]\n,[ts_primarymperelationshipmanager_entitytype]\n,[modifiedbyexternalparty]\n,[modifiedbyexternalparty_entitytype]\n,[ts_headofficeid]\n,[ts_headofficeid_entitytype]\n,[ts_address1country]\n,[ts_address1country_entitytype]\n,[ts_address1usstate]\n,[ts_address1usstate_entitytype]\n,[msdyn_salesaccelerationinsightid]\n,[msdyn_salesaccelerationinsightid_entitytype]\n,[slaid]\n,[slaid_entitytype]\n,[originatingleadid]\n,[originatingleadid_entitytype]\n,[masterid]\n,[masterid_entitytype]\n,[ts_originationlead1]\n,[ts_originationlead1_entitytype]\n,[defaultpricelevelid]\n,[defaultpricelevelid_entitytype]\n,[owninguser]\n,[owninguser_entitytype]\n,[ts_originationlead2]\n,[ts_originationlead2_entitytype]\n,[slainvokedid]\n,[slainvokedid_entitytype]\n,[mpe_coinvestquestionnaireid]\n,[mpe_coinvestquestionnaireid_entitytype]\n,[ts_hub]\n,[ts_hub_entitytype]\n,[owningteam]\n,[owningteam_entitytype]\n,[ts_currentauditor]\n,[ts_currentauditor_entitytype]\n,[primarycontactid]\n,[primarycontactid_entitytype]\n,[modifiedby]\n,[modifiedby_entitytype]\n,[preferredsystemuserid]\n,[preferredsystemuserid_entitytype]\n,[preferredequipmentid]\n,[preferredequipmentid_entitytype]\n,[xpd_fund]\n,[xpd_fund_entitytype]\n,[createdonbehalfby]\n,[createdonbehalfby_entitytype]\n,[createdby]\n,[createdby_entitytype]\n,[territoryid]\n,[territoryid_entitytype]\n,[ownerid]\n,[ownerid_entitytype]\n,[xpd_totalinstitutionalcommitments_base]\n,[ts_minimumticketsize_base]\n,[xpd_totalinstitutionalcommitments]\n,[aging30]\n,[creditlimit]\n,[creditlimit_base]\n,[ts_totalcommitments_base]\n,[aging60]\n,[ts_transfersin_base]\n,[aging90]\n,[ts_maximumticketsize]\n,[ts_totalaum_base]\n,[marketcap_base]\n,[aging60_base]\n,[aging90_base]\n,[ts_transfersout]\n,[ts_maximumticketsize_base]\n,[ts_originalcommitments_base]\n,[revenue]\n,[ts_totalcommitments]\n,[ts_transfersout_base]\n,[ts_totalaum]\n,[ts_commitmentreductions_base]\n,[ts_commitmentreductions]\n,[marketcap]\n,[ts_originalcommitments]\n,[ts_minimumticketsize]\n,[revenue_base]\n,[openrevenue_base]\n,[aging30_base]\n,[openrevenue]\n,[ts_transfersin]\n,[ts_othernotes]\n,[ts_transfersin_date]\n,[msdyn_salesaccelerationinsightidname]\n,[address1_county]\n,[openrevenue_date]\n,[ts_recommendedbyname]\n,[ts_relationshipinteractioncomments]\n,[ts_originationlead2yominame]\n,[parentaccountidname]\n,[xpd_roletypes_text]\n,[address1_addressid]\n,[importsequencenumber]\n,[address1_longitude]\n,[ts_countryofeconomicoriginforthecapitalname]\n,[entityimageid]\n,[telephone2]\n,[ts_lastoriginationmeeting]\n,[address2_utcoffset]\n,[address1_upszone]\n,[ts_originalcommitments_state]\n,[ts_typicalcost]\n,[xpd_recommendingportfoliocompaniesrecommended]\n,[accountnumber]\n,[ts_currentauditoryominame]\n,[ts_originalcommitments_date]\n,[lastonholdtime]\n,[ts_sectorscoveredbyfirm]\n,[address1_telephone1]\n,[address1_telephone2]\n,[address1_telephone3]\n,[address2_upszone]\n,[opendeals_state]\n,[xpd_functionuse_text]\n,[slainvokedidname]\n,[address2_longitude]\n,[defaultpricelevelidname]\n,[stockexchange]\n,[mpe_liveofferingscount_date]\n,[xpd_relationshipcomments]\n,[originatingleadidname]\n,[slaname]\n,[ts_currentauditorname]\n,[xpd_remindertoyominame]\n,[ts_address1usstatename]\n,[ts_tempcompanytype]\n,[versionnumber]\n,[address1_latitude]\n,[ts_formername]\n,[yominame]\n,[createdbyyominame]\n,[ts_cityofvisit]\n,[address2_telephone1]\n,[ts_globalgeographiescoveredids]\n,[preferredserviceidname]\n,[address2_city]\n,[ts_mpeapproachstrategy]\n,[address2_line2]\n,[ts_lastdatestatuschanged]\n,[li_companyid]\n,[transactioncurrencyidname]\n,[entityimage_url]\n,[xpd_relationshipstatuschangeddate]\n,[createdonbehalfbyname]\n,[mpe_liveofferingscount_state]\n,[xpd_numberofcoinvestinvestments_date]\n,[ts_validateddate]\n,[owneridname]\n,[xpd_generalcomments]\n,[ts_companylegalname]\n,[description]\n,[ts_validatedbyname]\n,[originatingleadidyominame]\n,[opendeals]\n,[xpd_numberofopportunitiesshown_state]\n,[address2_postalcode]\n,[websiteurl]\n,[xpd_fundname]\n,[address1_utcoffset]\n,[exchangerate]\n,[mpe_flowlastrundate]\n,[fax]\n,[address1_line3]\n,[ts_monthssincelastmeeting]\n,[ts_hubname]\n,[address2_line1]\n,[ts_capiqticket]\n,[address2_stateorprovince]\n,[address2_name]\n,[ts_transfersout_state]\n,[xpd_numberofopportunitiesshown]\n,[primarytwitterid]\n,[mpe_coinvestquestionnaireidname]\n,[xpd_numberofopportunitiesshown_date]\n,[xpd_preferentialterms]\n,[address1_primarycontactname]\n,[territoryidname]\n,[ts_processstatus]\n,[address1_name]\n,[address2_telephone2]\n,[address2_telephone3]\n,[xpd_recruitmentareateam_text]\n,[ftpsiteurl]\n,[address1_postalcode]\n,[ts_companynumber]\n,[createdon]\n,[mpe_liveofferingscount]\n,[traversedpath]\n,[address1_stateorprovince]\n,[ts_transfersin_state]\n,[address2_addressid]\n,[ts_monthlyreviewmeetingname]\n,[primarysatoriid]\n,[telephone3]\n,[openrevenue_state]\n,[ts_usesprovidedids]\n,[ts_originationcomments]\n,[lastusedincampaign]\n,[primarycontactidname]\n,[ts_originationlead1name]\n,[ts_headofficeidname]\n,[msdyn_segmentidname]\n,[ts_montagucomments]\n,[address2_fax]\n,[createdbyname]\n,[xpd_numberofcoinvestinvestments]\n,[ts_capitaliqlink]\n,[ts_primarymperelationshipmanagername]\n,[mpe_relationshipstatus_text]\n,[xpd_datereminderwasset]\n,[xpd_numberofcoinvestinvestments_state]\n,[address1_postofficebox]\n,[address1_city]\n,[teamsfollowed]\n,[ts_originationlead2name]\n,[timezoneruleversionnumber]\n,[modifiedonbehalfbyyominame]\n,[entityimage_timestamp]\n,[tickersymbol]\n,[ts_theirprogrammecomments]\n,[xpd_companyuse_text]\n,[modifiedbyname]\n,[owneridtype]\n,[sic]\n,[sharesoutstanding]\n,[opendeals_date]\n,[address2_postofficebox]\n,[emailaddress3]\n,[emailaddress2]\n,[emailaddress1]\n,[ts_globalgeographiescoveredbyfirm]\n,[ts_recommendationoffirmupdated]\n,[ts_lastmet]\n,[ts_reminderdatesetto]\n,[ts_commitmentreductions_state]\n,[owningbusinessunitname]\n,[onholdtime]\n,[ts_alias]\n,[createdonbehalfbyyominame]\n,[ts_transfersout_date]\n,[ts_address1countryname]\n,[preferredsystemuseridyominame]\n,[createdbyexternalpartyname]\n,[mpe_documentsetid]\n,[telephone1]\n,[ts_legacycompanytypes]\n,[ts_validatedbyyominame]\n,[address1_composite]\n,[ts_investorgroupgatekeeperid]\n,[primarycontactidyominame]\n,[address2_country]\n,[xpd_recommendationcomments]\n,[owneridyominame]\n,[createdbyexternalpartyyominame]\n,[ts_originationlead1yominame]\n,[ts_usesprovidedbyfirm]\n,[xpd_recommendingportco]\n,[address1_country]\n,[ts_commitmentreductions_date]\n,[name]\n,[modifiedbyexternalpartyyominame]\n,[xpd_remindertoname]\n,[stageid]\n,[modifiedonbehalfbyname]\n,[masteraccountidname]\n,[timespentbymeonemailandmeetings]\n,[address2_latitude]\n,[overriddencreatedon]\n,[parentaccountidyominame]\n,[ts_specificareaofexpertisecomments]\n,[preferredsystemuseridname]\n,[utcconversiontimezonecode]\n,[address2_county]\n,[address1_line1]\n,[address2_primarycontactname]\n,[address1_line2]\n,[xpd_reasonaction]\n,[ts_primarymperelationshipmanageryominame]\n,[processid]\n,[ts_sectorscoveredids]\n,[ts_recommendedbyyominame]\n,[modifiedbyexternalpartyname]\n,[ts_relevantsituations]\n,[accountid]\n,[modifiedon]\n,[preferredequipmentidname]\n,[modifiedbyyominame]\n,[ts_dealstageofmostrecentopportunity]\n,[address2_composite]\n,[masteraccountidyominame]\n,[numberofemployees]\n,[address1_fax]\n,[address2_line3]\n FROM [dataverse_montagu_org5a2bcccf].[dbo].[account]",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "dataverse_montagu_org5a2bcccf",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 45')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT TOP (100) [Id]\n,[SinkCreatedOn]\n,[SinkModifiedOn]\n,[state]\n,[status]\n,[ts_primarysecondaryfocus]\n,[customertype]\n,[address1_addresstype]\n,[accountclassification]\n,[ts_easeofworking]\n,[ts_ukrow]\n,[preferredappointmenttime]\n,[ts_address1addresstype]\n,[xpd_relationshipstatus]\n,[ts_relationship]\n,[xpd_remindermonths]\n,[ts_importance]\n,[address2_freightterms]\n,[ts_irrvsmomperformancemeasure]\n,[ts_introducertype]\n,[accountcategory]\n,[paymentterms]\n,[preferredappointmentday]\n,[businesstype]\n,[industry]\n,[ts_sizeoffirm]\n,[ts_interaction]\n,[address1_shippingmethod]\n,[ts_portfoliocompanystatus]\n,[customersize]\n,[xpd_previousinvestorstatus]\n,[ts_recommendationoffirm]\n,[preferredcontactmethod]\n,[accountrating]\n,[ts_investorstatus]\n,[ts_capabilitiesoffirm]\n,[mpe_flowlastrunoutcome]\n,[address2_addresstype]\n,[address2_shippingmethod]\n,[ts_nextoriginationmeetingarranged]\n,[ownership]\n,[territory]\n,[ts_investortype]\n,[shippingmethod]\n,[ts_investorregion]\n,[address1_freightterms]\n,[xpd_function]\n,[ts_quickcaptureuses]\n,[xpd_montagulevel]\n,[ts_permanentinterim]\n,[ts_quickcapturesectors]\n,[ts_roletypes]\n,[ts_companytype]\n,[xpd_level]\n,[ts_indicativeclientbase]\n,[xpd_specialisms]\n,[ts_vendorsummary]\n,[ts_producttype]\n,[ts_montaguoffice]\n,[ts_quickcapturegeography]\n,[xpd_roletypes]\n,[mpe_livedeal]\n,[donotbulkpostalmail]\n,[donotpostalmail]\n,[msdyn_gdproptout]\n,[ts_organisationalchange]\n,[xpd_publictoprivatetracker]\n,[ts_auditor]\n,[donotsendmm]\n,[donotbulkemail]\n,[followemail]\n,[creditonhold]\n,[marketingonly]\n,[participatesinworkflow]\n,[merged]\n,[ts_validated]\n,[xpd_sharepointlocationcreated]\n,[xpd_setreminder]\n,[ts_personnelchange]\n,[donotfax]\n,[isprivate]\n,[donotphone]\n,[xpd_rpo]\n,[ts_trackcompany]\n,[donotemail]\n,[parentaccountid]\n,[parentaccountid_entitytype]\n,[ts_recommendedby]\n,[ts_recommendedby_entitytype]\n,[ts_countryofeconomicoriginforthecapital]\n,[ts_countryofeconomicoriginforthecapital_entitytype]\n,[xpd_reminderto]\n,[xpd_reminderto_entitytype]\n,[preferredserviceid]\n,[preferredserviceid_entitytype]\n,[msdyn_segmentid]\n,[msdyn_segmentid_entitytype]\n,[owningbusinessunit]\n,[owningbusinessunit_entitytype]\n,[createdbyexternalparty]\n,[createdbyexternalparty_entitytype]\n,[ts_validatedby]\n,[ts_validatedby_entitytype]\n,[modifiedonbehalfby]\n,[modifiedonbehalfby_entitytype]\n,[transactioncurrencyid]\n,[transactioncurrencyid_entitytype]\n,[ts_primarymperelationshipmanager]\n,[ts_primarymperelationshipmanager_entitytype]\n,[modifiedbyexternalparty]\n,[modifiedbyexternalparty_entitytype]\n,[ts_headofficeid]\n,[ts_headofficeid_entitytype]\n,[ts_address1country]\n,[ts_address1country_entitytype]\n,[ts_address1usstate]\n,[ts_address1usstate_entitytype]\n,[msdyn_salesaccelerationinsightid]\n,[msdyn_salesaccelerationinsightid_entitytype]\n,[slaid]\n,[slaid_entitytype]\n,[originatingleadid]\n,[originatingleadid_entitytype]\n,[masterid]\n,[masterid_entitytype]\n,[ts_originationlead1]\n,[ts_originationlead1_entitytype]\n,[defaultpricelevelid]\n,[defaultpricelevelid_entitytype]\n,[owninguser]\n,[owninguser_entitytype]\n,[ts_originationlead2]\n,[ts_originationlead2_entitytype]\n,[slainvokedid]\n,[slainvokedid_entitytype]\n,[mpe_coinvestquestionnaireid]\n,[mpe_coinvestquestionnaireid_entitytype]\n,[ts_hub]\n,[ts_hub_entitytype]\n,[owningteam]\n,[owningteam_entitytype]\n,[ts_currentauditor]\n,[ts_currentauditor_entitytype]\n,[primarycontactid]\n,[primarycontactid_entitytype]\n,[modifiedby]\n,[modifiedby_entitytype]\n,[preferredsystemuserid]\n,[preferredsystemuserid_entitytype]\n,[preferredequipmentid]\n,[preferredequipmentid_entitytype]\n,[xpd_fund]\n,[xpd_fund_entitytype]\n,[createdonbehalfby]\n,[createdonbehalfby_entitytype]\n,[createdby]\n,[createdby_entitytype]\n,[territoryid]\n,[territoryid_entitytype]\n,[ownerid]\n,[ownerid_entitytype]\n,[xpd_totalinstitutionalcommitments_base]\n,[ts_minimumticketsize_base]\n,[xpd_totalinstitutionalcommitments]\n,[aging30]\n,[creditlimit]\n,[creditlimit_base]\n,[ts_totalcommitments_base]\n,[aging60]\n,[ts_transfersin_base]\n,[aging90]\n,[ts_maximumticketsize]\n,[ts_totalaum_base]\n,[marketcap_base]\n,[aging60_base]\n,[aging90_base]\n,[ts_transfersout]\n,[ts_maximumticketsize_base]\n,[ts_originalcommitments_base]\n,[revenue]\n,[ts_totalcommitments]\n,[ts_transfersout_base]\n,[ts_totalaum]\n,[ts_commitmentreductions_base]\n,[ts_commitmentreductions]\n,[marketcap]\n,[ts_originalcommitments]\n,[ts_minimumticketsize]\n,[revenue_base]\n,[openrevenue_base]\n,[aging30_base]\n,[openrevenue]\n,[ts_transfersin]\n,[ts_othernotes]\n,[ts_transfersin_date]\n,[msdyn_salesaccelerationinsightidname]\n,[address1_county]\n,[openrevenue_date]\n,[ts_recommendedbyname]\n,[ts_relationshipinteractioncomments]\n,[ts_originationlead2yominame]\n,[parentaccountidname]\n,[xpd_roletypes_text]\n,[address1_addressid]\n,[importsequencenumber]\n,[address1_longitude]\n,[ts_countryofeconomicoriginforthecapitalname]\n,[entityimageid]\n,[telephone2]\n,[ts_lastoriginationmeeting]\n,[address2_utcoffset]\n,[address1_upszone]\n,[ts_originalcommitments_state]\n,[ts_typicalcost]\n,[xpd_recommendingportfoliocompaniesrecommended]\n,[accountnumber]\n,[ts_currentauditoryominame]\n,[ts_originalcommitments_date]\n,[lastonholdtime]\n,[ts_sectorscoveredbyfirm]\n,[address1_telephone1]\n,[address1_telephone2]\n,[address1_telephone3]\n,[address2_upszone]\n,[opendeals_state]\n,[xpd_functionuse_text]\n,[slainvokedidname]\n,[address2_longitude]\n,[defaultpricelevelidname]\n,[stockexchange]\n,[mpe_liveofferingscount_date]\n,[xpd_relationshipcomments]\n,[originatingleadidname]\n,[slaname]\n,[ts_currentauditorname]\n,[xpd_remindertoyominame]\n,[ts_address1usstatename]\n,[ts_tempcompanytype]\n,[versionnumber]\n,[address1_latitude]\n,[ts_formername]\n,[yominame]\n,[createdbyyominame]\n,[ts_cityofvisit]\n,[address2_telephone1]\n,[ts_globalgeographiescoveredids]\n,[preferredserviceidname]\n,[address2_city]\n,[ts_mpeapproachstrategy]\n,[address2_line2]\n,[ts_lastdatestatuschanged]\n,[li_companyid]\n,[transactioncurrencyidname]\n,[entityimage_url]\n,[xpd_relationshipstatuschangeddate]\n,[createdonbehalfbyname]\n,[mpe_liveofferingscount_state]\n,[xpd_numberofcoinvestinvestments_date]\n,[ts_validateddate]\n,[owneridname]\n,[xpd_generalcomments]\n,[ts_companylegalname]\n,[description]\n,[ts_validatedbyname]\n,[originatingleadidyominame]\n,[opendeals]\n,[xpd_numberofopportunitiesshown_state]\n,[address2_postalcode]\n,[websiteurl]\n,[xpd_fundname]\n,[address1_utcoffset]\n,[exchangerate]\n,[mpe_flowlastrundate]\n,[fax]\n,[address1_line3]\n,[ts_monthssincelastmeeting]\n,[ts_hubname]\n,[address2_line1]\n,[ts_capiqticket]\n,[address2_stateorprovince]\n,[address2_name]\n,[ts_transfersout_state]\n,[xpd_numberofopportunitiesshown]\n,[primarytwitterid]\n,[mpe_coinvestquestionnaireidname]\n,[xpd_numberofopportunitiesshown_date]\n,[xpd_preferentialterms]\n,[address1_primarycontactname]\n,[territoryidname]\n,[ts_processstatus]\n,[address1_name]\n,[address2_telephone2]\n,[address2_telephone3]\n,[xpd_recruitmentareateam_text]\n,[ftpsiteurl]\n,[address1_postalcode]\n,[ts_companynumber]\n,[createdon]\n,[mpe_liveofferingscount]\n,[traversedpath]\n,[address1_stateorprovince]\n,[ts_transfersin_state]\n,[address2_addressid]\n,[ts_monthlyreviewmeetingname]\n,[primarysatoriid]\n,[telephone3]\n,[openrevenue_state]\n,[ts_usesprovidedids]\n,[ts_originationcomments]\n,[lastusedincampaign]\n,[primarycontactidname]\n,[ts_originationlead1name]\n,[ts_headofficeidname]\n,[msdyn_segmentidname]\n,[ts_montagucomments]\n,[address2_fax]\n,[createdbyname]\n,[xpd_numberofcoinvestinvestments]\n,[ts_capitaliqlink]\n,[ts_primarymperelationshipmanagername]\n,[mpe_relationshipstatus_text]\n,[xpd_datereminderwasset]\n,[xpd_numberofcoinvestinvestments_state]\n,[address1_postofficebox]\n,[address1_city]\n,[teamsfollowed]\n,[ts_originationlead2name]\n,[timezoneruleversionnumber]\n,[modifiedonbehalfbyyominame]\n,[entityimage_timestamp]\n,[tickersymbol]\n,[ts_theirprogrammecomments]\n,[xpd_companyuse_text]\n,[modifiedbyname]\n,[owneridtype]\n,[sic]\n,[sharesoutstanding]\n,[opendeals_date]\n,[address2_postofficebox]\n,[emailaddress3]\n,[emailaddress2]\n,[emailaddress1]\n,[ts_globalgeographiescoveredbyfirm]\n,[ts_recommendationoffirmupdated]\n,[ts_lastmet]\n,[ts_reminderdatesetto]\n,[ts_commitmentreductions_state]\n,[owningbusinessunitname]\n,[onholdtime]\n,[ts_alias]\n,[createdonbehalfbyyominame]\n,[ts_transfersout_date]\n,[ts_address1countryname]\n,[preferredsystemuseridyominame]\n,[createdbyexternalpartyname]\n,[mpe_documentsetid]\n,[telephone1]\n,[ts_legacycompanytypes]\n,[ts_validatedbyyominame]\n,[address1_composite]\n,[ts_investorgroupgatekeeperid]\n,[primarycontactidyominame]\n,[address2_country]\n,[xpd_recommendationcomments]\n,[owneridyominame]\n,[createdbyexternalpartyyominame]\n,[ts_originationlead1yominame]\n,[ts_usesprovidedbyfirm]\n,[xpd_recommendingportco]\n,[address1_country]\n,[ts_commitmentreductions_date]\n,[name]\n,[modifiedbyexternalpartyyominame]\n,[xpd_remindertoname]\n,[stageid]\n,[modifiedonbehalfbyname]\n,[masteraccountidname]\n,[timespentbymeonemailandmeetings]\n,[address2_latitude]\n,[overriddencreatedon]\n,[parentaccountidyominame]\n,[ts_specificareaofexpertisecomments]\n,[preferredsystemuseridname]\n,[utcconversiontimezonecode]\n,[address2_county]\n,[address1_line1]\n,[address2_primarycontactname]\n,[address1_line2]\n,[xpd_reasonaction]\n,[ts_primarymperelationshipmanageryominame]\n,[processid]\n,[ts_sectorscoveredids]\n,[ts_recommendedbyyominame]\n,[modifiedbyexternalpartyname]\n,[ts_relevantsituations]\n,[accountid]\n,[modifiedon]\n,[preferredequipmentidname]\n,[modifiedbyyominame]\n,[ts_dealstageofmostrecentopportunity]\n,[address2_composite]\n,[masteraccountidyominame]\n,[numberofemployees]\n,[address1_fax]\n,[address2_line3]\n FROM [dbo].[account]",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "DataverseEnriched",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 46')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT TOP (100) [Id]\n,[SinkCreatedOn]\n,[SinkModifiedOn]\n,[state]\n,[status]\n,[ts_primarysecondaryfocus]\n,[customertype]\n,[address1_addresstype]\n,[accountclassification]\n,[ts_easeofworking]\n,[ts_ukrow]\n,[preferredappointmenttime]\n,[ts_address1addresstype]\n,[xpd_relationshipstatus]\n,[ts_relationship]\n,[xpd_remindermonths]\n,[ts_importance]\n,[address2_freightterms]\n,[ts_irrvsmomperformancemeasure]\n,[ts_introducertype]\n,[accountcategory]\n,[paymentterms]\n,[preferredappointmentday]\n,[businesstype]\n,[industry]\n,[ts_sizeoffirm]\n,[ts_interaction]\n,[address1_shippingmethod]\n,[ts_portfoliocompanystatus]\n,[customersize]\n,[xpd_previousinvestorstatus]\n,[ts_recommendationoffirm]\n,[preferredcontactmethod]\n,[accountrating]\n,[ts_investorstatus]\n,[ts_capabilitiesoffirm]\n,[mpe_flowlastrunoutcome]\n,[address2_addresstype]\n,[address2_shippingmethod]\n,[ts_nextoriginationmeetingarranged]\n,[ownership]\n,[territory]\n,[ts_investortype]\n,[shippingmethod]\n,[ts_investorregion]\n,[address1_freightterms]\n,[xpd_function]\n,[ts_quickcaptureuses]\n,[xpd_montagulevel]\n,[ts_permanentinterim]\n,[ts_quickcapturesectors]\n,[ts_roletypes]\n,[ts_companytype]\n,[xpd_level]\n,[ts_indicativeclientbase]\n,[xpd_specialisms]\n,[ts_vendorsummary]\n,[ts_producttype]\n,[ts_montaguoffice]\n,[ts_quickcapturegeography]\n,[xpd_roletypes]\n,[mpe_livedeal]\n,[donotbulkpostalmail]\n,[donotpostalmail]\n,[msdyn_gdproptout]\n,[ts_organisationalchange]\n,[xpd_publictoprivatetracker]\n,[ts_auditor]\n,[donotsendmm]\n,[donotbulkemail]\n,[followemail]\n,[creditonhold]\n,[marketingonly]\n,[participatesinworkflow]\n,[merged]\n,[ts_validated]\n,[xpd_sharepointlocationcreated]\n,[xpd_setreminder]\n,[ts_personnelchange]\n,[donotfax]\n,[isprivate]\n,[donotphone]\n,[xpd_rpo]\n,[ts_trackcompany]\n,[donotemail]\n,[parentaccountid]\n,[parentaccountid_entitytype]\n,[ts_recommendedby]\n,[ts_recommendedby_entitytype]\n,[ts_countryofeconomicoriginforthecapital]\n,[ts_countryofeconomicoriginforthecapital_entitytype]\n,[xpd_reminderto]\n,[xpd_reminderto_entitytype]\n,[preferredserviceid]\n,[preferredserviceid_entitytype]\n,[msdyn_segmentid]\n,[msdyn_segmentid_entitytype]\n,[owningbusinessunit]\n,[owningbusinessunit_entitytype]\n,[createdbyexternalparty]\n,[createdbyexternalparty_entitytype]\n,[ts_validatedby]\n,[ts_validatedby_entitytype]\n,[modifiedonbehalfby]\n,[modifiedonbehalfby_entitytype]\n,[transactioncurrencyid]\n,[transactioncurrencyid_entitytype]\n,[ts_primarymperelationshipmanager]\n,[ts_primarymperelationshipmanager_entitytype]\n,[modifiedbyexternalparty]\n,[modifiedbyexternalparty_entitytype]\n,[ts_headofficeid]\n,[ts_headofficeid_entitytype]\n,[ts_address1country]\n,[ts_address1country_entitytype]\n,[ts_address1usstate]\n,[ts_address1usstate_entitytype]\n,[msdyn_salesaccelerationinsightid]\n,[msdyn_salesaccelerationinsightid_entitytype]\n,[slaid]\n,[slaid_entitytype]\n,[originatingleadid]\n,[originatingleadid_entitytype]\n,[masterid]\n,[masterid_entitytype]\n,[ts_originationlead1]\n,[ts_originationlead1_entitytype]\n,[defaultpricelevelid]\n,[defaultpricelevelid_entitytype]\n,[owninguser]\n,[owninguser_entitytype]\n,[ts_originationlead2]\n,[ts_originationlead2_entitytype]\n,[slainvokedid]\n,[slainvokedid_entitytype]\n,[mpe_coinvestquestionnaireid]\n,[mpe_coinvestquestionnaireid_entitytype]\n,[ts_hub]\n,[ts_hub_entitytype]\n,[owningteam]\n,[owningteam_entitytype]\n,[ts_currentauditor]\n,[ts_currentauditor_entitytype]\n,[primarycontactid]\n,[primarycontactid_entitytype]\n,[modifiedby]\n,[modifiedby_entitytype]\n,[preferredsystemuserid]\n,[preferredsystemuserid_entitytype]\n,[preferredequipmentid]\n,[preferredequipmentid_entitytype]\n,[xpd_fund]\n,[xpd_fund_entitytype]\n,[createdonbehalfby]\n,[createdonbehalfby_entitytype]\n,[createdby]\n,[createdby_entitytype]\n,[territoryid]\n,[territoryid_entitytype]\n,[ownerid]\n,[ownerid_entitytype]\n,[xpd_totalinstitutionalcommitments_base]\n,[ts_minimumticketsize_base]\n,[xpd_totalinstitutionalcommitments]\n,[aging30]\n,[creditlimit]\n,[creditlimit_base]\n,[ts_totalcommitments_base]\n,[aging60]\n,[ts_transfersin_base]\n,[aging90]\n,[ts_maximumticketsize]\n,[ts_totalaum_base]\n,[marketcap_base]\n,[aging60_base]\n,[aging90_base]\n,[ts_transfersout]\n,[ts_maximumticketsize_base]\n,[ts_originalcommitments_base]\n,[revenue]\n,[ts_totalcommitments]\n,[ts_transfersout_base]\n,[ts_totalaum]\n,[ts_commitmentreductions_base]\n,[ts_commitmentreductions]\n,[marketcap]\n,[ts_originalcommitments]\n,[ts_minimumticketsize]\n,[revenue_base]\n,[openrevenue_base]\n,[aging30_base]\n,[openrevenue]\n,[ts_transfersin]\n,[ts_othernotes]\n,[ts_transfersin_date]\n,[msdyn_salesaccelerationinsightidname]\n,[address1_county]\n,[openrevenue_date]\n,[ts_recommendedbyname]\n,[ts_relationshipinteractioncomments]\n,[ts_originationlead2yominame]\n,[parentaccountidname]\n,[xpd_roletypes_text]\n,[address1_addressid]\n,[importsequencenumber]\n,[address1_longitude]\n,[ts_countryofeconomicoriginforthecapitalname]\n,[entityimageid]\n,[telephone2]\n,[ts_lastoriginationmeeting]\n,[address2_utcoffset]\n,[address1_upszone]\n,[ts_originalcommitments_state]\n,[ts_typicalcost]\n,[xpd_recommendingportfoliocompaniesrecommended]\n,[accountnumber]\n,[ts_currentauditoryominame]\n,[ts_originalcommitments_date]\n,[lastonholdtime]\n,[ts_sectorscoveredbyfirm]\n,[address1_telephone1]\n,[address1_telephone2]\n,[address1_telephone3]\n,[address2_upszone]\n,[opendeals_state]\n,[xpd_functionuse_text]\n,[slainvokedidname]\n,[address2_longitude]\n,[defaultpricelevelidname]\n,[stockexchange]\n,[mpe_liveofferingscount_date]\n,[xpd_relationshipcomments]\n,[originatingleadidname]\n,[slaname]\n,[ts_currentauditorname]\n,[xpd_remindertoyominame]\n,[ts_address1usstatename]\n,[ts_tempcompanytype]\n,[versionnumber]\n,[address1_latitude]\n,[ts_formername]\n,[yominame]\n,[createdbyyominame]\n,[ts_cityofvisit]\n,[address2_telephone1]\n,[ts_globalgeographiescoveredids]\n,[preferredserviceidname]\n,[address2_city]\n,[ts_mpeapproachstrategy]\n,[address2_line2]\n,[ts_lastdatestatuschanged]\n,[li_companyid]\n,[transactioncurrencyidname]\n,[entityimage_url]\n,[xpd_relationshipstatuschangeddate]\n,[createdonbehalfbyname]\n,[mpe_liveofferingscount_state]\n,[xpd_numberofcoinvestinvestments_date]\n,[ts_validateddate]\n,[owneridname]\n,[xpd_generalcomments]\n,[ts_companylegalname]\n,[description]\n,[ts_validatedbyname]\n,[originatingleadidyominame]\n,[opendeals]\n,[xpd_numberofopportunitiesshown_state]\n,[address2_postalcode]\n,[websiteurl]\n,[xpd_fundname]\n,[address1_utcoffset]\n,[exchangerate]\n,[mpe_flowlastrundate]\n,[fax]\n,[address1_line3]\n,[ts_monthssincelastmeeting]\n,[ts_hubname]\n,[address2_line1]\n,[ts_capiqticket]\n,[address2_stateorprovince]\n,[address2_name]\n,[ts_transfersout_state]\n,[xpd_numberofopportunitiesshown]\n,[primarytwitterid]\n,[mpe_coinvestquestionnaireidname]\n,[xpd_numberofopportunitiesshown_date]\n,[xpd_preferentialterms]\n,[address1_primarycontactname]\n,[territoryidname]\n,[ts_processstatus]\n,[address1_name]\n,[address2_telephone2]\n,[address2_telephone3]\n,[xpd_recruitmentareateam_text]\n,[ftpsiteurl]\n,[address1_postalcode]\n,[ts_companynumber]\n,[createdon]\n,[mpe_liveofferingscount]\n,[traversedpath]\n,[address1_stateorprovince]\n,[ts_transfersin_state]\n,[address2_addressid]\n,[ts_monthlyreviewmeetingname]\n,[primarysatoriid]\n,[telephone3]\n,[openrevenue_state]\n,[ts_usesprovidedids]\n,[ts_originationcomments]\n,[lastusedincampaign]\n,[primarycontactidname]\n,[ts_originationlead1name]\n,[ts_headofficeidname]\n,[msdyn_segmentidname]\n,[ts_montagucomments]\n,[address2_fax]\n,[createdbyname]\n,[xpd_numberofcoinvestinvestments]\n,[ts_capitaliqlink]\n,[ts_primarymperelationshipmanagername]\n,[mpe_relationshipstatus_text]\n,[xpd_datereminderwasset]\n,[xpd_numberofcoinvestinvestments_state]\n,[address1_postofficebox]\n,[address1_city]\n,[teamsfollowed]\n,[ts_originationlead2name]\n,[timezoneruleversionnumber]\n,[modifiedonbehalfbyyominame]\n,[entityimage_timestamp]\n,[tickersymbol]\n,[ts_theirprogrammecomments]\n,[xpd_companyuse_text]\n,[modifiedbyname]\n,[owneridtype]\n,[sic]\n,[sharesoutstanding]\n,[opendeals_date]\n,[address2_postofficebox]\n,[emailaddress3]\n,[emailaddress2]\n,[emailaddress1]\n,[ts_globalgeographiescoveredbyfirm]\n,[ts_recommendationoffirmupdated]\n,[ts_lastmet]\n,[ts_reminderdatesetto]\n,[ts_commitmentreductions_state]\n,[owningbusinessunitname]\n,[onholdtime]\n,[ts_alias]\n,[createdonbehalfbyyominame]\n,[ts_transfersout_date]\n,[ts_address1countryname]\n,[preferredsystemuseridyominame]\n,[createdbyexternalpartyname]\n,[mpe_documentsetid]\n,[telephone1]\n,[ts_legacycompanytypes]\n,[ts_validatedbyyominame]\n,[address1_composite]\n,[ts_investorgroupgatekeeperid]\n,[primarycontactidyominame]\n,[address2_country]\n,[xpd_recommendationcomments]\n,[owneridyominame]\n,[createdbyexternalpartyyominame]\n,[ts_originationlead1yominame]\n,[ts_usesprovidedbyfirm]\n,[xpd_recommendingportco]\n,[address1_country]\n,[ts_commitmentreductions_date]\n,[name]\n,[modifiedbyexternalpartyyominame]\n,[xpd_remindertoname]\n,[stageid]\n,[modifiedonbehalfbyname]\n,[masteraccountidname]\n,[timespentbymeonemailandmeetings]\n,[address2_latitude]\n,[overriddencreatedon]\n,[parentaccountidyominame]\n,[ts_specificareaofexpertisecomments]\n,[preferredsystemuseridname]\n,[utcconversiontimezonecode]\n,[address2_county]\n,[address1_line1]\n,[address2_primarycontactname]\n,[address1_line2]\n,[xpd_reasonaction]\n,[ts_primarymperelationshipmanageryominame]\n,[processid]\n,[ts_sectorscoveredids]\n,[ts_recommendedbyyominame]\n,[modifiedbyexternalpartyname]\n,[ts_relevantsituations]\n,[accountid]\n,[modifiedon]\n,[preferredequipmentidname]\n,[modifiedbyyominame]\n,[ts_dealstageofmostrecentopportunity]\n,[address2_composite]\n,[masteraccountidyominame]\n,[numberofemployees]\n,[address1_fax]\n,[address2_line3]\n FROM [dbo].[account]",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "DataverseEnriched",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 47')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT TOP (100) [Id_YouHaveChanged]\n,[ts_primarysecondaryfocus_No_you_have]\n,[xpd_relationshipstatus]\n,[ts_introducertype]\n,[xpd_remindermonths]\n,[ts_portfoliocompanystatus]\n,[ts_companytype]\n,[ts_vendorsummary]\n,[xpd_publictoprivatetracker]\n,[xpd_setreminder]\n,[ts_trackcompany]\n,[parentaccountid]\n,[xpd_reminderto]\n,[ts_headofficeid]\n,[ts_originationlead1]\n,[ts_originationlead2]\n,[ts_currentauditor]\n,[ts_othernotes]\n,[xpd_relationshipcomments]\n,[ts_formername]\n,[ts_mpeapproachstrategy]\n,[ts_lastdatestatuschanged]\n,[xpd_relationshipstatuschangeddate]\n,[ts_companylegalname]\n,[ts_companynumber]\n,[ts_monthlyreviewmeetingname]\n,[ts_originationcomments]\n,[ts_capitaliqlink]\n,[xpd_datereminderwasset]\n,[ts_reminderdatesetto]\n,[ts_alias]\n,[xpd_reasonaction]\n,[ts_relevantsituations]\n,[ts_dealstageofmostrecentopportunity]\n FROM [dbo].[accountENRICHEDFinal]",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "DedicatedSQLPool",
						"poolName": "DedicatedSQLPool"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 48')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "LakeDatabaseEnriched",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 49')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "--=================================================================================================\n-- DESCRIPTION\n--=================================================================================================\n--  The purpose of this script is to create a set of database views in a database within your Synapse Analytics Serverless SQL Pool that will \n--  translate numeric codes for Option Sets, Status and States into human-readable descriptions for tables exported using Synapse Link for Dataverse.\n--  See the following article for background: https://docs.microsoft.com/en-us/power-apps/maker/data-platform/azure-synapse-link-choice-labels\n--\n-- PREREQUISITES\n-- 1. You have configured Synapse Link for Dataverse to export to a Synapse Analytics Workspace\n-- 2. You have sufficient read access to the lake database created by Synapse Link for Dataverse\n-- 3. You have created an additional database in which views with enriched entities will be created\n-- 4. You have sufficient permissions to create database objects in your newly-created database\n--\n-- IMPORTANT: please execute this script in the context of the Lake Database corresponding to your Synapse Link for Dataverse!\nUSE [dataverse_montagu_org5a2bcccf] --Specify the name of the database corresponding to your Synapse Link for Dataverse\n\n--=================================================================================================\n--PROVIDE INPUT PARAMETERS:\n--=================================================================================================\nDECLARE\n\t@EnrichedViewDatabase sysname, --Specify the name of the database in which views with enriched entities will be created\n\t@EnrichedViewSchema sysname, --Specify the name of the database schema in which views with enriched entities will be created\n\t@EnrichedColumnSuffix varchar(50), \t--Specify the suffix for columns enriched with human-readable descriptions. For example, the suffix of \"label\" will change a statecode column in the base table to a statelabel column in the enriched view.\n\t@LanguageCode varchar(10), --Specify the language code for localized labels. For example, English - United States is 1033 (https://docs.microsoft.com/en-us/openspecs/office_standards/ms-oe376/6c085406-a698-4e12-9d4d-c3b0ee3dbc4a)\n\t@BaseTableSuffix varchar(50), --If applicable, specify the suffix in the names of the base tables or views (e.g., '_partitiond'). The default is an empty string.\n\t@PreviewOnly bit --Indicate whether to preview the SQL Script (without creating the views) = 1 ; Create views = 0;\n\nSET @EnrichedViewDatabase = 'DataverseEnriched'\nSET @EnrichedViewSchema = 'dbo'\nSET @EnrichedColumnSuffix = 'label'\nSET @LanguageCode = 1033\nSET @BaseTableSuffix = ''\nSET @PreviewOnly = 1 \n\n--=================================================================================================\n-- Do not edit the script below this point\n--=================================================================================================\n\n--Get column metadata from the Lake Database managed by Synapse Link for Dataverse\n--The column metadata will be stored as a JSON document in a scalar variable\n--This is needed as a workaround for the limitation of not allowing system objects to be used in distributed queries\nDECLARE @ColumnMetadata nvarchar(MAX), @ColumnMetadataSQL nvarchar(MAX)\n\n--Define the SQL statement to retrieve column metadata from the Lake Database managed by Synapse Link for Dataverse\n--Results will be stored as a JSON document in a variable\nSET @ColumnMetadataSQL = 'SET @ColumnMetadataOUT = (\nSELECT TABLE_SCHEMA, \n\tTABLE_NAME, \n\tCOLUMN_NAME, \n\tORDINAL_POSITION, \n\tDATA_TYPE\nFROM INFORMATION_SCHEMA.COLUMNS \nWHERE TABLE_SCHEMA = ''dbo''\n\tAND TABLE_NAME NOT IN (''OptionsetMetadata'', ''GlobalOptionsetMetadata'',''StateMetadata'',''StatusMetadata'', ''TargetMetadata'')\n\tAND TABLE_NAME LIKE ''%' + @BaseTableSuffix + '''\nFOR JSON AUTO)'\nDECLARE @ParmDefinition NVARCHAR(MAX);  \nSET @ParmDefinition = N'@ColumnMetadataOUT NVARCHAR(MAX) OUTPUT';  \nEXECUTE sp_executesql @ColumnMetadataSQL, @ParmDefinition, @ColumnMetadataOUT=@ColumnMetadata OUTPUT;  \n\n--Declare a variable to store a SQL statement for creating enriched views\nDECLARE @SQL nvarchar(MAX) = ''\n\n; WITH CM AS (\n--Parse column metadata variable and construct a table based on its content\nSELECT JSON_VALUE(CM.value, '$.TABLE_SCHEMA') AS TableSchema,\n\t JSON_VALUE(CM.value, '$.TABLE_NAME') AS TableName,\n\t LEFT(JSON_VALUE(CM.value, '$.TABLE_NAME'), LEN(JSON_VALUE(CM.value, '$.TABLE_NAME'))-LEN(@BaseTableSuffix)) AS EntityName,\n\t JSON_VALUE(CM.value, '$.COLUMN_NAME') AS ColumnName,\n\t CAST(JSON_VALUE(CM.value, '$.ORDINAL_POSITION') AS INT) AS OrdinalPosition,\n\t JSON_VALUE(CM.value, '$.DATA_TYPE') AS DataType\nFROM OPENJSON (@ColumnMetadata) AS CM\n)\n\n, OSM AS (\n--Get Option Set Metadata\nSELECT DISTINCT \n\tEntityName, \n\tOptionSetName, \n\tQUOTENAME(EntityName + '_' + OptionSetName) AS Alias\nFROM dbo.[OptionsetMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, GOSM AS (\n--Get Global Option Set Metadata\nSELECT DISTINCT \n\tOptionSetName, \n\tQUOTENAME('Global_' + OptionSetName) AS Alias\nFROM dbo.[GlobalOptionsetMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, StateM AS (\n--Get State Metadata\nSELECT DISTINCT \n\tEntityName, \n\tQUOTENAME(EntityName + '_State') AS Alias\nFROM dbo.[StateMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, StatusM AS (\n--Get Status Metadata\nSELECT DISTINCT \n\tEntityName,\n\tQUOTENAME(EntityName + '_Status') AS Alias\nFROM dbo.[StatusMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, SQLStatement AS (\n--Enumerate all lines in the source table and replace codes with labels where applicable\nSELECT CM.EntityName,\n\t--Before the first column of each table, construct a CREATE OR ALTER VIEW statement\n\tCASE WHEN CM.OrdinalPosition = 1\n\t\tTHEN 'CREATE OR ALTER VIEW ' + QUOTENAME(@EnrichedViewSchema) + '.' + CM.EntityName + '\n\t\tAS\n\t\tSELECT '\n\t\tELSE '\t,'\n\t\tEND\n\t--For each column, check if it needs to be replaced with a suitable localized label\n\t+ CASE \n\t\tWHEN OSM.OptionSetName IS NOT NULL THEN OSM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tWHEN GOSM.OptionSetName IS NOT NULL THEN GOSM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tWHEN StateM.EntityName IS NOT NULL THEN StateM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tWHEN StatusM.EntityName IS NOT NULL THEN StatusM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tELSE '[Base].' + QUOTENAME(CM.ColumnName)\n\t\tEND AS [SQLLine],\n\tCM.OrdinalPosition\nFROM CM \n\tLEFT JOIN OSM\n\t\tON CM.EntityName = OSM.EntityName\n\t\tAND CM.ColumnName = OSM.OptionSetName\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\tLEFT JOIN GOSM\n\t\tON CM.ColumnName = GOSM.OptionSetName\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\tLEFT JOIN StateM\n\t\tON CM.EntityName = StateM.EntityName\n\t\tAND CM.ColumnName = 'statecode'\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\tLEFT JOIN StatusM\n\t\tON CM.EntityName = StatusM.EntityName\n\t\tAND CM.ColumnName = 'statuscode'\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\nUNION ALL\n--Construct the first line of the FROM clause, referencing external tables created by Synapse Link for Dataverse\nSELECT DISTINCT\nCM.EntityName,\n'FROM ' + QUOTENAME(DB_NAME()) + '.' + QUOTENAME(CM.TableSchema) + '.' + QUOTENAME(CM.TableName) + ' AS Base' AS SQLLine,\n10000 AS OrdinalPosition\nFROM CM\n\nUNION ALL \n--Construct LEFT JOIN statements for each relevant OptionSetMetadata field\nSELECT DISTINCT OSM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[OptionSetMetadata] AS ' + OSM.Alias + ' \n\t\tON ' + OSM.Alias + '.EntityName = ''' + OSM.EntityName + ''' \n\t\tAND ' + OSM.Alias + '.OptionSetName = ''' +  OSM.OptionSetName + '''\n\t\tAND [Base].' + QUOTENAME(OSM.OptionSetName) + ' = ' + OSM.Alias + '.[Option]\n\t\tAND ' + OSM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n20000 AS OrdinalPosition\nFROM OSM\n\tJOIN CM\n\t\tON CM.EntityName = OSM.EntityName\n\t\tAND CM.ColumnName = OSM.OptionSetName\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL \n--Construct LEFT JOIN statements for each relevant GlobalOptionSetMetadata field\nSELECT DISTINCT CM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[GlobalOptionSetMetadata] AS ' + Alias + ' \n\t\tON ' + Alias + '.OptionSetName = ''' +  OptionSetName + '''\n\t\tAND [Base].' + QUOTENAME(OptionSetName) + ' = ' + Alias + '.[Option]\n\t\tAND ' + Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n30000 AS OrdinalPosition\nFROM GOSM\n\tJOIN CM\n\t\tON CM.ColumnName = GOSM.OptionSetName\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL \n--Construct LEFT JOIN statements for each relevant State Metadata field\nSELECT DISTINCT CM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[StateMetadata] AS ' + StateM.Alias + ' \n\t\tON ' + StateM.Alias + '.EntityName = ''' + StateM.EntityName + ''' \n\t\tAND [Base].statecode' + ' = ' + StateM.Alias + '.[State]\n\t\tAND ' + StateM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n40000 AS OrdinalPosition\nFROM StateM\n\tJOIN CM\n\t\tON CM.EntityName = StateM.EntityName\n\t\tAND CM.ColumnName = 'statecode'\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL\n--Construct LEFT JOIN statements for each relevant Status Metadata field\nSELECT DISTINCT CM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[StatusMetadata] AS ' + StatusM.Alias + ' \n\t\tON ' + StatusM.Alias + '.EntityName = ''' + StatusM.EntityName + ''' \n\t\tAND [Base].statuscode' + ' = ' + StatusM.Alias + '.[Status]\n\t\tAND ' + StatusM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n40000 AS OrdinalPosition\nFROM StatusM\n\tJOIN CM\n\t\tON CM.EntityName = StatusM.EntityName\n\t\tAND CM.ColumnName = 'statuscode'\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL\n--Add statement terminator\nSELECT DISTINCT\nEntityName,\n'; ' + CHAR(10) AS SQLLine,\n100000 AS OrdinalPosition\nFROM CM\n)\n\n--Construct individual statements to create views (1 view per row)\n--Since CREATE VIEW statement must be the first statement in a batch, assign each view definition to a variable \n--and use the EXEC(@variable) command to create view as part of its own, separate batch.\n, ViewDefinitions AS (\nSELECT 'DECLARE @' + EntityName + ' NVARCHAR(MAX) = ''\n\t' + REPLACE(STRING_AGG(CAST(SQLLine as varchar(MAX)), CHAR(10)) WITHIN GROUP (ORDER BY EntityName, OrdinalPosition, SQLLine), '''', '''''') + ''' ' + CHAR(10) + 'EXEC [' + @EnrichedViewDatabase + '].dbo.sp_executesql @' + EntityName + CHAR(10) AS ViewDefinition\nFROM SQLStatement\nGROUP BY EntityName\n)\n\n--Construct a comprehensive SQL statement to create all views\nSELECT @SQL = STRING_AGG(ViewDefinition, ';' + CHAR(10) + CHAR(10))\nFROM ViewDefinitions\n\n--Return a preview of the SQL Script to be generated or go ahead and create the views.\nIF @PreviewOnly = 0\nBEGIN\n\t--Return the final SQL statement\n\tSELECT '--================================================================================================='+ CHAR(10) +' ' + CHAR(10) AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '-- A preview of the script to generate enriched views is provided below.'  AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '-- No database objects have been created.' AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '-- Re-run this script with the @PreviewOnly parameter set to 0 to actually create the views.' AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '--================================================================================================='+ CHAR(10) +' ' + CHAR(10) AS [--SQL Statement]\n\tUNION ALL \n\tSELECT VALUE AS [--SQL Statement] FROM STRING_SPLIT(@SQL, CHAR(10))\nEND\nELSE\nBEGIN\n\t--Execute the SQL statement\n\tPRINT 'Beginning view creation'\n\tEXEC sp_executesql @SQL\n\tPRINT 'Completed view creation'\nEND",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "dataverse_montagu_org5a2bcccf",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL_OptionSet_Test')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "select top 50\naccountid\n,ts_easeofworking\n,ts_companytype\nfrom account\nwhere ts_easeofworking is not NULL",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "DataverseEnriched",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL_Option_Original')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "--=================================================================================================\n-- DESCRIPTION\n--=================================================================================================\n--  The purpose of this script is to create a set of database views in a database within your Synapse Analytics Serverless SQL Pool that will \n--  translate numeric codes for Option Sets, Status and States into human-readable descriptions for tables exported using Synapse Link for Dataverse.\n--  See the following article for background: https://docs.microsoft.com/en-us/power-apps/maker/data-platform/azure-synapse-link-choice-labels\n--\n-- PREREQUISITES\n-- 1. You have configured Synapse Link for Dataverse to export to a Synapse Analytics Workspace\n-- 2. You have sufficient read access to the lake database created by Synapse Link for Dataverse\n-- 3. You have created an additional database in which views with enriched entities will be created\n-- 4. You have sufficient permissions to create database objects in your newly-created database\n--\n-- IMPORTANT: please execute this script in the context of the Lake Database corresponding to your Synapse Link for Dataverse!\nUSE [dataverse_montagu_org5a2bcccf] --Specify the name of the database corresponding to your Synapse Link for Dataverse\n\n--=================================================================================================\n--PROVIDE INPUT PARAMETERS:\n--=================================================================================================\nDECLARE\n\t@EnrichedViewDatabase sysname, --Specify the name of the database in which views with enriched entities will be created\n\t@EnrichedViewSchema sysname, --Specify the name of the database schema in which views with enriched entities will be created\n\t@EnrichedColumnSuffix varchar(50), \t--Specify the suffix for columns enriched with human-readable descriptions. For example, the suffix of \"label\" will change a statecode column in the base table to a statelabel column in the enriched view.\n\t@LanguageCode varchar(10), --Specify the language code for localized labels. For example, English - United States is 1033 (https://docs.microsoft.com/en-us/openspecs/office_standards/ms-oe376/6c085406-a698-4e12-9d4d-c3b0ee3dbc4a)\n\t@BaseTableSuffix varchar(50), --If applicable, specify the suffix in the names of the base tables or views (e.g., '_partitiond'). The default is an empty string.\n\t@PreviewOnly bit --Indicate whether to preview the SQL Script (without creating the views) = 1 ; Create views = 0;\n\nSET @EnrichedViewDatabase = 'DataverseEnriched'\nSET @EnrichedViewSchema = 'dbo'\nSET @EnrichedColumnSuffix = 'label'\nSET @LanguageCode = 1033\nSET @BaseTableSuffix = ''\nSET @PreviewOnly = 0\n\n--=================================================================================================\n-- Do not edit the script below this point\n--=================================================================================================\n\n--Get column metadata from the Lake Database managed by Synapse Link for Dataverse\n--The column metadata will be stored as a JSON document in a scalar variable\n--This is needed as a workaround for the limitation of not allowing system objects to be used in distributed queries\nDECLARE @ColumnMetadata nvarchar(MAX), @ColumnMetadataSQL nvarchar(MAX)\n\n--Define the SQL statement to retrieve column metadata from the Lake Database managed by Synapse Link for Dataverse\n--Results will be stored as a JSON document in a variable\nSET @ColumnMetadataSQL = 'SET @ColumnMetadataOUT = (\nSELECT TABLE_SCHEMA, \n\tTABLE_NAME, \n\tCOLUMN_NAME, \n\tORDINAL_POSITION, \n\tDATA_TYPE\nFROM INFORMATION_SCHEMA.COLUMNS \nWHERE TABLE_SCHEMA = ''dbo''\n\tAND TABLE_NAME NOT IN (''OptionsetMetadata'', ''GlobalOptionsetMetadata'',''StateMetadata'',''StatusMetadata'', ''TargetMetadata'')\n\tAND TABLE_NAME LIKE ''%' + @BaseTableSuffix + '''\nFOR JSON AUTO)'\nDECLARE @ParmDefinition NVARCHAR(MAX);  \nSET @ParmDefinition = N'@ColumnMetadataOUT NVARCHAR(MAX) OUTPUT';  \nEXECUTE sp_executesql @ColumnMetadataSQL, @ParmDefinition, @ColumnMetadataOUT=@ColumnMetadata OUTPUT;  \n\n--Declare a variable to store a SQL statement for creating enriched views\nDECLARE @SQL nvarchar(MAX) = ''\n\n; WITH CM AS (\n--Parse column metadata variable and construct a table based on its content\nSELECT JSON_VALUE(CM.value, '$.TABLE_SCHEMA') AS TableSchema,\n\t JSON_VALUE(CM.value, '$.TABLE_NAME') AS TableName,\n\t LEFT(JSON_VALUE(CM.value, '$.TABLE_NAME'), LEN(JSON_VALUE(CM.value, '$.TABLE_NAME'))-LEN(@BaseTableSuffix)) AS EntityName,\n\t JSON_VALUE(CM.value, '$.COLUMN_NAME') AS ColumnName,\n\t CAST(JSON_VALUE(CM.value, '$.ORDINAL_POSITION') AS INT) AS OrdinalPosition,\n\t JSON_VALUE(CM.value, '$.DATA_TYPE') AS DataType\nFROM OPENJSON (@ColumnMetadata) AS CM\n)\n\n, OSM AS (\n--Get Option Set Metadata\nSELECT DISTINCT \n\tEntityName, \n\tOptionSetName, \n\tQUOTENAME(EntityName + '_' + OptionSetName) AS Alias\nFROM dbo.[OptionsetMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, GOSM AS (\n--Get Global Option Set Metadata\nSELECT DISTINCT \n\tOptionSetName, \n\tQUOTENAME('Global_' + OptionSetName) AS Alias\nFROM dbo.[GlobalOptionsetMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, StateM AS (\n--Get State Metadata\nSELECT DISTINCT \n\tEntityName, \n\tQUOTENAME(EntityName + '_State') AS Alias\nFROM dbo.[StateMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, StatusM AS (\n--Get Status Metadata\nSELECT DISTINCT \n\tEntityName,\n\tQUOTENAME(EntityName + '_Status') AS Alias\nFROM dbo.[StatusMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, SQLStatement AS (\n--Enumerate all lines in the source table and replace codes with labels where applicable\nSELECT CM.EntityName,\n\t--Before the first column of each table, construct a CREATE OR ALTER VIEW statement\n\tCASE WHEN CM.OrdinalPosition = 1\n\t\tTHEN 'CREATE OR ALTER VIEW ' + QUOTENAME(@EnrichedViewSchema) + '.' + CM.EntityName + '\n\t\tAS\n\t\tSELECT '\n\t\tELSE '\t,'\n\t\tEND\n\t--For each column, check if it needs to be replaced with a suitable localized label\n\t+ CASE \n\t\tWHEN OSM.OptionSetName IS NOT NULL THEN OSM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tWHEN GOSM.OptionSetName IS NOT NULL THEN GOSM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tWHEN StateM.EntityName IS NOT NULL THEN StateM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tWHEN StatusM.EntityName IS NOT NULL THEN StatusM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tELSE '[Base].' + QUOTENAME(CM.ColumnName)\n\t\tEND AS [SQLLine],\n\tCM.OrdinalPosition\nFROM CM \n\tLEFT JOIN OSM\n\t\tON CM.EntityName = OSM.EntityName\n\t\tAND CM.ColumnName = OSM.OptionSetName\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\tLEFT JOIN GOSM\n\t\tON CM.ColumnName = GOSM.OptionSetName\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\tLEFT JOIN StateM\n\t\tON CM.EntityName = StateM.EntityName\n\t\tAND CM.ColumnName = 'statecode'\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\tLEFT JOIN StatusM\n\t\tON CM.EntityName = StatusM.EntityName\n\t\tAND CM.ColumnName = 'statuscode'\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\nUNION ALL\n--Construct the first line of the FROM clause, referencing external tables created by Synapse Link for Dataverse\nSELECT DISTINCT\nCM.EntityName,\n'FROM ' + QUOTENAME(DB_NAME()) + '.' + QUOTENAME(CM.TableSchema) + '.' + QUOTENAME(CM.TableName) + ' AS Base' AS SQLLine,\n10000 AS OrdinalPosition\nFROM CM\n\nUNION ALL \n--Construct LEFT JOIN statements for each relevant OptionSetMetadata field\nSELECT DISTINCT OSM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[OptionSetMetadata] AS ' + OSM.Alias + ' \n\t\tON ' + OSM.Alias + '.EntityName = ''' + OSM.EntityName + ''' \n\t\tAND ' + OSM.Alias + '.OptionSetName = ''' +  OSM.OptionSetName + '''\n\t\tAND [Base].' + QUOTENAME(OSM.OptionSetName) + ' = ' + OSM.Alias + '.[Option]\n\t\tAND ' + OSM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n20000 AS OrdinalPosition\nFROM OSM\n\tJOIN CM\n\t\tON CM.EntityName = OSM.EntityName\n\t\tAND CM.ColumnName = OSM.OptionSetName\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL \n--Construct LEFT JOIN statements for each relevant GlobalOptionSetMetadata field\nSELECT DISTINCT CM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[GlobalOptionSetMetadata] AS ' + Alias + ' \n\t\tON ' + Alias + '.OptionSetName = ''' +  OptionSetName + '''\n\t\tAND [Base].' + QUOTENAME(OptionSetName) + ' = ' + Alias + '.[Option]\n\t\tAND ' + Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n30000 AS OrdinalPosition\nFROM GOSM\n\tJOIN CM\n\t\tON CM.ColumnName = GOSM.OptionSetName\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL \n--Construct LEFT JOIN statements for each relevant State Metadata field\nSELECT DISTINCT CM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[StateMetadata] AS ' + StateM.Alias + ' \n\t\tON ' + StateM.Alias + '.EntityName = ''' + StateM.EntityName + ''' \n\t\tAND [Base].statecode' + ' = ' + StateM.Alias + '.[State]\n\t\tAND ' + StateM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n40000 AS OrdinalPosition\nFROM StateM\n\tJOIN CM\n\t\tON CM.EntityName = StateM.EntityName\n\t\tAND CM.ColumnName = 'statecode'\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL\n--Construct LEFT JOIN statements for each relevant Status Metadata field\nSELECT DISTINCT CM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[StatusMetadata] AS ' + StatusM.Alias + ' \n\t\tON ' + StatusM.Alias + '.EntityName = ''' + StatusM.EntityName + ''' \n\t\tAND [Base].statuscode' + ' = ' + StatusM.Alias + '.[Status]\n\t\tAND ' + StatusM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n40000 AS OrdinalPosition\nFROM StatusM\n\tJOIN CM\n\t\tON CM.EntityName = StatusM.EntityName\n\t\tAND CM.ColumnName = 'statuscode'\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL\n--Add statement terminator\nSELECT DISTINCT\nEntityName,\n'; ' + CHAR(10) AS SQLLine,\n100000 AS OrdinalPosition\nFROM CM\n)\n\n--Construct individual statements to create views (1 view per row)\n--Since CREATE VIEW statement must be the first statement in a batch, assign each view definition to a variable \n--and use the EXEC(@variable) command to create view as part of its own, separate batch.\n, ViewDefinitions AS (\nSELECT 'DECLARE @' + EntityName + ' NVARCHAR(MAX) = ''\n\t' + REPLACE(STRING_AGG(CAST(SQLLine as varchar(MAX)), CHAR(10)) WITHIN GROUP (ORDER BY EntityName, OrdinalPosition, SQLLine), '''', '''''') + ''' ' + CHAR(10) + 'EXEC [' + @EnrichedViewDatabase + '].dbo.sp_executesql @' + EntityName + CHAR(10) AS ViewDefinition\nFROM SQLStatement\nGROUP BY EntityName\n)\n\n--Construct a comprehensive SQL statement to create all views\nSELECT @SQL = STRING_AGG(ViewDefinition, ';' + CHAR(10) + CHAR(10))\nFROM ViewDefinitions\n\n--Return a preview of the SQL Script to be generated or go ahead and create the views.\nIF @PreviewOnly = 1\nBEGIN\n\t--Return the final SQL statement\n\tSELECT '--================================================================================================='+ CHAR(10) +' ' + CHAR(10) AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '-- A preview of the script to generate enriched views is provided below.'  AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '-- No database objects have been created.' AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '-- Re-run this script with the @PreviewOnly parameter set to 0 to actually create the views.' AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '--================================================================================================='+ CHAR(10) +' ' + CHAR(10) AS [--SQL Statement]\n\tUNION ALL \n\tSELECT VALUE AS [--SQL Statement] FROM STRING_SPLIT(@SQL, CHAR(10))\nEND\nELSE\nBEGIN\n\t--Execute the SQL statement\n\tPRINT 'Beginning view creation'\n\tEXEC sp_executesql @SQL\n\tPRINT 'Completed view creation'\nEND",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "dataverse_montagu_org5a2bcccf",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/add Purview to Serverless')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "CREATE LOGIN [MontaguPurview] FROM EXTERNAL PROVIDER;\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "default",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/collationname')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "select CONVERT(varchar(256), DATABASEPROPERTYEX(DB_NAME(), 'collation'))\n\nSELECT name, collation_name FROM sys.columns WHERE name = N'dbo.[OptionsetMetadata].EntityName';\n\nSELECT t.name OptionsetMetadata, c.name EntityName, collation_name  \nFROM sys.columns c  \ninner join sys.tables t on c.object_id = t.object_id;",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "dataverse_montagu_org5a2bcccf",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/optionssetcodeLeftJoin')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "CREATE VIEW account\n\nAS\n\nSELECT\n  C1.Id\n ,C1.SinkCreatedOn\n ,C1.SinkModifiedOn\n ,C1.statecode\n ,C1.statuscode\n ,CASE\n    WHEN ISNULL(CAST(C1.ts_primarysecondaryfocus AS VARCHAR(50)), '') <> ISNULL(CAST(C2.ts_primarysecondaryfocus AS VARCHAR(50)), '') THEN CAST(C2.ts_primarysecondaryfocus AS VARCHAR(50))\n    ELSE CAST(C1.ts_primarysecondaryfocus AS VARCHAR(50))\n  END AS ts_primarysecondaryfocus\n ,C1.customertypecode\n ,C1.address1_addresstypecode\n ,C1.accountclassificationcode\n ,C1.ts_easeofworking\n ,CASE\n    WHEN ISNULL(CAST(C1.ts_ukrow AS VARCHAR(50)), '') <> ISNULL(CAST(C2.ts_ukrow AS VARCHAR(50)), '') THEN CAST(C2.ts_ukrow AS VARCHAR(50))\n    ELSE CAST(C1.ts_ukrow AS VARCHAR(50))\n  END AS ts_ukrow\n ,CASE\n    WHEN ISNULL(CAST(C1.preferredappointmenttimecode AS VARCHAR(50)), '') <> ISNULL(CAST(C2.preferredappointmenttimecode AS VARCHAR(50)), '') THEN CAST(C2.preferredappointmenttimecode AS VARCHAR(50))\n    ELSE CAST(C1.preferredappointmenttimecode AS VARCHAR(50))\n  END AS preferredappointmenttimecode\n ,C1.ts_address1addresstype\n ,C1.xpd_relationshipstatus\n ,C1.ts_relationship\n ,C1.xpd_remindermonths\n ,C1.ts_importance\n ,CASE\n    WHEN ISNULL(CAST(C1.address2_freighttermscode AS VARCHAR(50)), '') <> ISNULL(CAST(C2.address2_freighttermscode AS VARCHAR(50)), '') THEN CAST(C2.address2_freighttermscode AS VARCHAR(50))\n    ELSE CAST(C1.address2_freighttermscode AS VARCHAR(50))\n  END AS address2_freighttermscode\n ,C1.ts_irrvsmomperformancemeasure\n ,CASE\n    WHEN ISNULL(CAST(C1.ts_introducertype AS VARCHAR(50)), '') <> ISNULL(CAST(C2.ts_introducertype AS VARCHAR(50)), '') THEN CAST(C2.ts_introducertype AS VARCHAR(50))\n    ELSE CAST(C1.ts_introducertype AS VARCHAR(50))\n  END AS ts_introducertype\n ,CASE\n    WHEN ISNULL(CAST(C1.accountcategorycode AS VARCHAR(50)), '') <> ISNULL(CAST(C2.accountcategorycode AS VARCHAR(50)), '') THEN CAST(C2.accountcategorycode AS VARCHAR(50))\n    ELSE CAST(C1.accountcategorycode AS VARCHAR(50))\n  END AS accountcategorycode\n ,CASE\n    WHEN ISNULL(CAST(C1.paymenttermscode AS VARCHAR(50)), '') <> ISNULL(CAST(C2.paymenttermscode AS VARCHAR(50)), '') THEN CAST(C2.paymenttermscode AS VARCHAR(50))\n    ELSE CAST(C1.paymenttermscode AS VARCHAR(50))\n  END AS paymenttermscode\n ,CASE\n    WHEN ISNULL(CAST(C1.preferredappointmentdaycode AS VARCHAR(50)), '') <> ISNULL(CAST(C2.preferredappointmentdaycode AS VARCHAR(50)), '') THEN CAST(C2.preferredappointmentdaycode AS VARCHAR(50))\n    ELSE CAST(C1.preferredappointmentdaycode AS VARCHAR(50))\n  END AS preferredappointmentdaycode\n ,CASE\n    WHEN ISNULL(CAST(C1.businesstypecode AS VARCHAR(50)), '') <> ISNULL(CAST(C2.businesstypecode AS VARCHAR(50)), '') THEN CAST(C2.businesstypecode AS VARCHAR(50))\n    ELSE CAST(C1.businesstypecode AS VARCHAR(50))\n  END AS businesstypecode\n ,CASE\n    WHEN ISNULL(CAST(C1.industrycode AS VARCHAR(50)), '') <> ISNULL(CAST(C2.industrycode AS VARCHAR(50)), '') THEN CAST(C2.industrycode AS VARCHAR(50))\n    ELSE CAST(C1.industrycode AS VARCHAR(50))\n  END AS industrycode\n ,C1.ts_sizeoffirm\n ,C1.ts_interaction\n ,C1.address1_shippingmethodcode\n ,C1.ts_portfoliocompanystatus\n ,C1.customersizecode\n ,C1.xpd_previousinvestorstatus\n ,C1.ts_recommendationoffirm\n ,C1.preferredcontactmethodcode\n ,C1.accountratingcode\n ,C1.ts_investorstatus\n ,C1.ts_capabilitiesoffirm\n ,C1.mpe_flowlastrunoutcome\n ,C1.address2_addresstypecode\n ,C1.address2_shippingmethodcode\n ,C1.ts_nextoriginationmeetingarranged\n ,C1.ownershipcode\n ,C1.territorycode\n ,C1.ts_investortype\n ,C1.shippingmethodcode\n ,C1.ts_investorregion\n ,C1.address1_freighttermscode\n ,C1.xpd_function\n ,C1.ts_quickcaptureuses\n ,C1.xpd_montagulevel\n ,C1.ts_permanentinterim\n ,C1.ts_quickcapturesectors\n ,C1.ts_roletypes\n ,C1.ts_companytype\n ,C1.xpd_level\n ,C1.ts_indicativeclientbase\n ,C1.xpd_specialisms\n ,C1.ts_vendorsummary\n ,C1.ts_producttype\n ,C1.ts_montaguoffice\n ,C1.ts_quickcapturegeography\n ,C1.xpd_roletypes\n ,C1.mpe_livedeal\n ,C1.donotbulkpostalmail\n ,CASE\n    WHEN ISNULL(CAST(C1.donotpostalmail AS VARCHAR(50)), '') <> ISNULL(CAST(C2.donotpostalmail AS VARCHAR(50)), '') THEN CAST(C2.donotpostalmail AS VARCHAR(50))\n    ELSE CAST(C1.donotpostalmail AS VARCHAR(50))\n  END AS donotpostalmail\n ,C1.msdyn_gdproptout\n ,C1.ts_organisationalchange\n ,C1.xpd_publictoprivatetracker\n ,C1.ts_auditor\n ,C1.donotsendmm\n ,C1.donotbulkemail\n ,C1.followemail\n ,C1.creditonhold\n ,C1.marketingonly\n ,C1.participatesinworkflow\n ,C1.merged\n ,C1.ts_validated\n ,C1.xpd_sharepointlocationcreated\n ,C1.xpd_setreminder\n ,C1.ts_personnelchange\n ,CASE\n    WHEN ISNULL(CAST(C1.donotfax AS VARCHAR(50)), '') <> ISNULL(CAST(C2.donotfax AS VARCHAR(50)), '') THEN CAST(C2.donotfax AS VARCHAR(50))\n    ELSE CAST(C1.donotfax AS VARCHAR(50))\n  END AS donotfax\n ,C1.isprivate\n ,CASE\n    WHEN ISNULL(CAST(C1.donotphone AS VARCHAR(50)), '') <> ISNULL(CAST(C2.donotphone AS VARCHAR(50)), '') THEN CAST(C2.donotphone AS VARCHAR(50))\n    ELSE CAST(C1.donotphone AS VARCHAR(50))\n  END AS donotphone\n ,C1.xpd_rpo\n ,C1.ts_trackcompany\n ,CASE\n    WHEN ISNULL(CAST(C1.donotemail AS VARCHAR(50)), '') <> ISNULL(CAST(C2.donotemail AS VARCHAR(50)), '') THEN CAST(C2.donotemail AS VARCHAR(50))\n    ELSE CAST(C1.donotemail AS VARCHAR(50))\n  END AS donotemail\n ,C1.parentaccountid\n ,C1.parentaccountid_entitytype\n ,C1.ts_recommendedby\n ,C1.ts_recommendedby_entitytype\n ,C1.ts_countryofeconomicoriginforthecapital\n ,C1.ts_countryofeconomicoriginforthecapital_entitytype\n ,C1.xpd_reminderto\n ,C1.xpd_reminderto_entitytype\n ,C1.preferredserviceid\n ,C1.preferredserviceid_entitytype\n ,C1.msdyn_segmentid\n ,C1.msdyn_segmentid_entitytype\n ,C1.owningbusinessunit\n ,C1.owningbusinessunit_entitytype\n ,C1.createdbyexternalparty\n ,C1.createdbyexternalparty_entitytype\n ,C1.ts_validatedby\n ,C1.ts_validatedby_entitytype\n ,C1.modifiedonbehalfby\n ,C1.modifiedonbehalfby_entitytype\n ,C1.transactioncurrencyid\n ,C1.transactioncurrencyid_entitytype\n ,C1.ts_primarymperelationshipmanager\n ,C1.ts_primarymperelationshipmanager_entitytype\n ,C1.modifiedbyexternalparty\n ,C1.modifiedbyexternalparty_entitytype\n ,C1.ts_headofficeid\n ,C1.ts_headofficeid_entitytype\n ,C1.ts_address1country\n ,C1.ts_address1country_entitytype\n ,C1.ts_address1usstate\n ,C1.ts_address1usstate_entitytype\n ,C1.msdyn_salesaccelerationinsightid\n ,C1.msdyn_salesaccelerationinsightid_entitytype\n ,C1.slaid\n ,C1.slaid_entitytype\n ,C1.originatingleadid\n ,C1.originatingleadid_entitytype\n ,C1.masterid\n ,C1.masterid_entitytype\n ,C1.ts_originationlead1\n ,C1.ts_originationlead1_entitytype\n ,C1.defaultpricelevelid\n ,C1.defaultpricelevelid_entitytype\n ,C1.owninguser\n ,C1.owninguser_entitytype\n ,C1.ts_originationlead2\n ,C1.ts_originationlead2_entitytype\n ,C1.slainvokedid\n ,C1.slainvokedid_entitytype\n ,C1.mpe_coinvestquestionnaireid\n ,C1.mpe_coinvestquestionnaireid_entitytype\n ,C1.ts_hub\n ,C1.ts_hub_entitytype\n ,C1.owningteam\n ,C1.owningteam_entitytype\n ,C1.ts_currentauditor\n ,C1.ts_currentauditor_entitytype\n ,C1.primarycontactid\n ,C1.primarycontactid_entitytype\n ,C1.modifiedby\n ,C1.modifiedby_entitytype\n ,C1.preferredsystemuserid\n ,C1.preferredsystemuserid_entitytype\n ,C1.preferredequipmentid\n ,C1.preferredequipmentid_entitytype\n ,C1.xpd_fund\n ,C1.xpd_fund_entitytype\n ,C1.createdonbehalfby\n ,C1.createdonbehalfby_entitytype\n ,C1.createdby\n ,C1.createdby_entitytype\n ,C1.territoryid\n ,C1.territoryid_entitytype\n ,C1.ownerid\n ,C1.ownerid_entitytype\n ,C1.xpd_totalinstitutionalcommitments_base\n ,C1.ts_minimumticketsize_base\n ,C1.xpd_totalinstitutionalcommitments\n ,C1.aging30\n ,C1.creditlimit\n ,C1.creditlimit_base\n ,C1.ts_totalcommitments_base\n ,C1.aging60\n ,C1.ts_transfersin_base\n ,C1.aging90\n ,C1.ts_maximumticketsize\n ,C1.ts_totalaum_base\n ,C1.marketcap_base\n ,C1.aging60_base\n ,C1.aging90_base\n ,C1.ts_transfersout\n ,C1.ts_maximumticketsize_base\n ,C1.ts_originalcommitments_base\n ,C1.revenue\n ,C1.ts_totalcommitments\n ,C1.ts_transfersout_base\n ,C1.ts_totalaum\n ,C1.ts_commitmentreductions_base\n ,C1.ts_commitmentreductions\n ,C1.marketcap\n ,C1.ts_originalcommitments\n ,C1.ts_minimumticketsize\n ,C1.revenue_base\n ,C1.openrevenue_base\n ,C1.aging30_base\n ,C1.openrevenue\n ,C1.ts_transfersin\n ,C1.ts_othernotes\n ,C1.ts_transfersin_date\n ,C1.msdyn_salesaccelerationinsightidname\n ,C1.address1_county\n ,C1.openrevenue_date\n ,C1.ts_recommendedbyname\n ,C1.ts_relationshipinteractioncomments\n ,C1.ts_originationlead2yominame\n ,C1.parentaccountidname\n ,C1.xpd_roletypes_text\n ,C1.address1_addressid\n ,C1.importsequencenumber\n ,C1.address1_longitude\n ,C1.ts_countryofeconomicoriginforthecapitalname\n ,C1.entityimageid\n ,C1.telephone2\n ,C1.ts_lastoriginationmeeting\n ,C1.address2_utcoffset\n ,C1.address1_upszone\n ,C1.ts_originalcommitments_state\n ,C1.ts_typicalcost\n ,C1.xpd_recommendingportfoliocompaniesrecommended\n ,C1.accountnumber\n ,C1.ts_currentauditoryominame\n ,C1.ts_originalcommitments_date\n ,C1.lastonholdtime\n ,C1.ts_sectorscoveredbyfirm\n ,C1.address1_telephone1\n ,C1.address1_telephone2\n ,C1.address1_telephone3\n ,C1.address2_upszone\n ,C1.opendeals_state\n ,C1.xpd_functionuse_text\n ,C1.slainvokedidname\n ,C1.address2_longitude\n ,C1.defaultpricelevelidname\n ,C1.stockexchange\n ,C1.mpe_liveofferingscount_date\n ,C1.xpd_relationshipcomments\n ,C1.originatingleadidname\n ,C1.slaname\n ,C1.ts_currentauditorname\n ,C1.xpd_remindertoyominame\n ,C1.ts_address1usstatename\n ,C1.ts_tempcompanytype\n ,C1.versionnumber\n ,C1.address1_latitude\n ,C1.ts_formername\n ,C1.yominame\n ,C1.createdbyyominame\n ,C1.ts_cityofvisit\n ,C1.address2_telephone1\n ,C1.ts_globalgeographiescoveredids\n ,C1.preferredserviceidname\n ,C1.address2_city\n ,C1.ts_mpeapproachstrategy\n ,C1.address2_line2\n ,C1.ts_lastdatestatuschanged\n ,C1.li_companyid\n ,C1.transactioncurrencyidname\n ,C1.entityimage_url\n ,C1.xpd_relationshipstatuschangeddate\n ,C1.createdonbehalfbyname\n ,C1.mpe_liveofferingscount_state\n ,C1.xpd_numberofcoinvestinvestments_date\n ,C1.ts_validateddate\n ,C1.owneridname\n ,C1.xpd_generalcomments\n ,C1.ts_companylegalname\n ,C1.description\n ,C1.ts_validatedbyname\n ,C1.originatingleadidyominame\n ,C1.opendeals\n ,C1.xpd_numberofopportunitiesshown_state\n ,C1.address2_postalcode\n ,C1.websiteurl\n ,C1.xpd_fundname\n ,C1.address1_utcoffset\n ,C1.exchangerate\n ,C1.mpe_flowlastrundate\n ,C1.fax\n ,C1.address1_line3\n ,C1.ts_monthssincelastmeeting\n ,C1.ts_hubname\n ,C1.address2_line1\n ,C1.ts_capiqticket\n ,C1.address2_stateorprovince\n ,C1.address2_name\n ,C1.ts_transfersout_state\n ,C1.xpd_numberofopportunitiesshown\n ,C1.primarytwitterid\n ,C1.mpe_coinvestquestionnaireidname\n ,C1.xpd_numberofopportunitiesshown_date\n ,C1.xpd_preferentialterms\n ,C1.address1_primarycontactname\n ,C1.territoryidname\n ,C1.ts_processstatus\n ,C1.address1_name\n ,C1.address2_telephone2\n ,C1.address2_telephone3\n ,C1.xpd_recruitmentareateam_text\n ,C1.ftpsiteurl\n ,C1.address1_postalcode\n ,C1.ts_companynumber\n ,C1.createdon\n ,C1.mpe_liveofferingscount\n ,C1.traversedpath\n ,C1.address1_stateorprovince\n ,C1.ts_transfersin_state\n ,C1.address2_addressid\n ,C1.ts_monthlyreviewmeetingname\n ,C1.primarysatoriid\n ,C1.telephone3\n ,C1.openrevenue_state\n ,C1.ts_usesprovidedids\n ,C1.ts_originationcomments\n ,C1.lastusedincampaign\n ,C1.primarycontactidname\n ,C1.ts_originationlead1name\n ,C1.ts_headofficeidname\n ,C1.msdyn_segmentidname\n ,C1.ts_montagucomments\n ,C1.address2_fax\n ,C1.createdbyname\n ,C1.xpd_numberofcoinvestinvestments\n ,C1.ts_capitaliqlink\n ,C1.ts_primarymperelationshipmanagername\n ,C1.mpe_relationshipstatus_text\n ,C1.xpd_datereminderwasset\n ,C1.xpd_numberofcoinvestinvestments_state\n ,C1.address1_postofficebox\n ,C1.address1_city\n ,C1.teamsfollowed\n ,C1.ts_originationlead2name\n ,C1.timezoneruleversionnumber\n ,C1.modifiedonbehalfbyyominame\n ,C1.entityimage_timestamp\n ,C1.tickersymbol\n ,C1.ts_theirprogrammecomments\n ,C1.xpd_companyuse_text\n ,C1.modifiedbyname\n ,C1.owneridtype\n ,C1.sic\n ,C1.sharesoutstanding\n ,C1.opendeals_date\n ,C1.address2_postofficebox\n ,C1.emailaddress3\n ,C1.emailaddress2\n ,C1.emailaddress1\n ,C1.ts_globalgeographiescoveredbyfirm\n ,C1.ts_recommendationoffirmupdated\n ,C1.ts_lastmet\n ,C1.ts_reminderdatesetto\n ,C1.ts_commitmentreductions_state\n ,C1.owningbusinessunitname\n ,C1.onholdtime\n ,C1.ts_alias\n ,C1.createdonbehalfbyyominame\n ,C1.ts_transfersout_date\n ,C1.ts_address1countryname\n ,C1.preferredsystemuseridyominame\n ,C1.createdbyexternalpartyname\n ,C1.mpe_documentsetid\n ,C1.telephone1\n ,C1.ts_legacycompanytypes\n ,C1.ts_validatedbyyominame\n ,C1.address1_composite\n ,C1.ts_investorgroupgatekeeperid\n ,C1.primarycontactidyominame\n ,C1.address2_country\n ,C1.xpd_recommendationcomments\n ,C1.owneridyominame\n ,C1.createdbyexternalpartyyominame\n ,C1.ts_originationlead1yominame\n ,C1.ts_usesprovidedbyfirm\n ,C1.xpd_recommendingportco\n ,C1.address1_country\n ,C1.ts_commitmentreductions_date\n ,C1.name\n ,C1.modifiedbyexternalpartyyominame\n ,C1.xpd_remindertoname\n ,C1.stageid\n ,C1.modifiedonbehalfbyname\n ,C1.masteraccountidname\n ,C1.timespentbymeonemailandmeetings\n ,C1.address2_latitude\n ,C1.overriddencreatedon\n ,C1.parentaccountidyominame\n ,C1.ts_specificareaofexpertisecomments\n ,C1.preferredsystemuseridname\n ,C1.utcconversiontimezonecode\n ,C1.address2_county\n ,C1.address1_line1\n ,C1.address2_primarycontactname\n ,C1.address1_line2\n ,C1.xpd_reasonaction\n ,C1.ts_primarymperelationshipmanageryominame\n ,C1.processid\n ,C1.ts_sectorscoveredids\n ,C1.ts_recommendedbyyominame\n ,C1.modifiedbyexternalpartyname\n ,C1.ts_relevantsituations\n ,C1.accountid\n ,C1.modifiedon\n ,C1.preferredequipmentidname\n ,C1.modifiedbyyominame\n ,C1.ts_dealstageofmostrecentopportunity\n ,C1.address2_composite\n ,C1.masteraccountidyominame\n ,C1.numberofemployees\n ,C1.address1_fax\n ,C1.address2_line3\nFROM (SELECT\n    C1.Id\n   ,C1.SinkCreatedOn\n   ,C1.SinkModifiedOn\n   ,C1.statecode\n   ,C1.statuscode\n   ,C1.ts_primarysecondaryfocus\n   ,C1.customertypecode\n   ,C1.address1_addresstypecode\n   ,C1.accountclassificationcode\n   ,C1.ts_easeofworking\n   ,C1.ts_ukrow\n   ,C1.preferredappointmenttimecode\n   ,C1.ts_address1addresstype\n   ,C1.xpd_relationshipstatus\n   ,C1.ts_relationship\n   ,C1.xpd_remindermonths\n   ,C1.ts_importance\n   ,C1.address2_freighttermscode\n   ,C1.ts_irrvsmomperformancemeasure\n   ,C1.ts_introducertype\n   ,C1.accountcategorycode\n   ,C1.paymenttermscode\n   ,C1.preferredappointmentdaycode\n   ,C1.businesstypecode\n   ,C1.industrycode\n   ,C1.ts_sizeoffirm\n   ,C1.ts_interaction\n   ,C1.address1_shippingmethodcode\n   ,C1.ts_portfoliocompanystatus\n   ,C1.customersizecode\n   ,C1.xpd_previousinvestorstatus\n   ,C1.ts_recommendationoffirm\n   ,C1.preferredcontactmethodcode\n   ,C1.accountratingcode\n   ,C1.ts_investorstatus\n   ,C1.ts_capabilitiesoffirm\n   ,C1.mpe_flowlastrunoutcome\n   ,C1.address2_addresstypecode\n   ,C1.address2_shippingmethodcode\n   ,C1.ts_nextoriginationmeetingarranged\n   ,C1.ownershipcode\n   ,C1.territorycode\n   ,C1.ts_investortype\n   ,C1.shippingmethodcode\n   ,C1.ts_investorregion\n   ,C1.address1_freighttermscode\n   ,C1.xpd_function\n   ,C1.ts_quickcaptureuses\n   ,C1.xpd_montagulevel\n   ,C1.ts_permanentinterim\n   ,C1.ts_quickcapturesectors\n   ,C1.ts_roletypes\n   ,C1.ts_companytype\n   ,C1.xpd_level\n   ,C1.ts_indicativeclientbase\n   ,C1.xpd_specialisms\n   ,C1.ts_vendorsummary\n   ,C1.ts_producttype\n   ,C1.ts_montaguoffice\n   ,C1.ts_quickcapturegeography\n   ,C1.xpd_roletypes\n   ,C1.mpe_livedeal\n   ,C1.donotbulkpostalmail\n   ,C1.donotpostalmail\n   ,C1.msdyn_gdproptout\n   ,C1.ts_organisationalchange\n   ,C1.xpd_publictoprivatetracker\n   ,C1.ts_auditor\n   ,C1.donotsendmm\n   ,C1.donotbulkemail\n   ,C1.followemail\n   ,C1.creditonhold\n   ,C1.marketingonly\n   ,C1.participatesinworkflow\n   ,C1.merged\n   ,C1.ts_validated\n   ,C1.xpd_sharepointlocationcreated\n   ,C1.xpd_setreminder\n   ,C1.ts_personnelchange\n   ,C1.donotfax\n   ,C1.isprivate\n   ,C1.donotphone\n   ,C1.xpd_rpo\n   ,C1.ts_trackcompany\n   ,C1.donotemail\n   ,C1.parentaccountid\n   ,C1.parentaccountid_entitytype\n   ,C1.ts_recommendedby\n   ,C1.ts_recommendedby_entitytype\n   ,C1.ts_countryofeconomicoriginforthecapital\n   ,C1.ts_countryofeconomicoriginforthecapital_entitytype\n   ,C1.xpd_reminderto\n   ,C1.xpd_reminderto_entitytype\n   ,C1.preferredserviceid\n   ,C1.preferredserviceid_entitytype\n   ,C1.msdyn_segmentid\n   ,C1.msdyn_segmentid_entitytype\n   ,C1.owningbusinessunit\n   ,C1.owningbusinessunit_entitytype\n   ,C1.createdbyexternalparty\n   ,C1.createdbyexternalparty_entitytype\n   ,C1.ts_validatedby\n   ,C1.ts_validatedby_entitytype\n   ,C1.modifiedonbehalfby\n   ,C1.modifiedonbehalfby_entitytype\n   ,C1.transactioncurrencyid\n   ,C1.transactioncurrencyid_entitytype\n   ,C1.ts_primarymperelationshipmanager\n   ,C1.ts_primarymperelationshipmanager_entitytype\n   ,C1.modifiedbyexternalparty\n   ,C1.modifiedbyexternalparty_entitytype\n   ,C1.ts_headofficeid\n   ,C1.ts_headofficeid_entitytype\n   ,C1.ts_address1country\n   ,C1.ts_address1country_entitytype\n   ,C1.ts_address1usstate\n   ,C1.ts_address1usstate_entitytype\n   ,C1.msdyn_salesaccelerationinsightid\n   ,C1.msdyn_salesaccelerationinsightid_entitytype\n   ,C1.slaid\n   ,C1.slaid_entitytype\n   ,C1.originatingleadid\n   ,C1.originatingleadid_entitytype\n   ,C1.masterid\n   ,C1.masterid_entitytype\n   ,C1.ts_originationlead1\n   ,C1.ts_originationlead1_entitytype\n   ,C1.defaultpricelevelid\n   ,C1.defaultpricelevelid_entitytype\n   ,C1.owninguser\n   ,C1.owninguser_entitytype\n   ,C1.ts_originationlead2\n   ,C1.ts_originationlead2_entitytype\n   ,C1.slainvokedid\n   ,C1.slainvokedid_entitytype\n   ,C1.mpe_coinvestquestionnaireid\n   ,C1.mpe_coinvestquestionnaireid_entitytype\n   ,C1.ts_hub\n   ,C1.ts_hub_entitytype\n   ,C1.owningteam\n   ,C1.owningteam_entitytype\n   ,C1.ts_currentauditor\n   ,C1.ts_currentauditor_entitytype\n   ,C1.primarycontactid\n   ,C1.primarycontactid_entitytype\n   ,C1.modifiedby\n   ,C1.modifiedby_entitytype\n   ,C1.preferredsystemuserid\n   ,C1.preferredsystemuserid_entitytype\n   ,C1.preferredequipmentid\n   ,C1.preferredequipmentid_entitytype\n   ,C1.xpd_fund\n   ,C1.xpd_fund_entitytype\n   ,C1.createdonbehalfby\n   ,C1.createdonbehalfby_entitytype\n   ,C1.createdby\n   ,C1.createdby_entitytype\n   ,C1.territoryid\n   ,C1.territoryid_entitytype\n   ,C1.ownerid\n   ,C1.ownerid_entitytype\n   ,C1.xpd_totalinstitutionalcommitments_base\n   ,C1.ts_minimumticketsize_base\n   ,C1.xpd_totalinstitutionalcommitments\n   ,C1.aging30\n   ,C1.creditlimit\n   ,C1.creditlimit_base\n   ,C1.ts_totalcommitments_base\n   ,C1.aging60\n   ,C1.ts_transfersin_base\n   ,C1.aging90\n   ,C1.ts_maximumticketsize\n   ,C1.ts_totalaum_base\n   ,C1.marketcap_base\n   ,C1.aging60_base\n   ,C1.aging90_base\n   ,C1.ts_transfersout\n   ,C1.ts_maximumticketsize_base\n   ,C1.ts_originalcommitments_base\n   ,C1.revenue\n   ,C1.ts_totalcommitments\n   ,C1.ts_transfersout_base\n   ,C1.ts_totalaum\n   ,C1.ts_commitmentreductions_base\n   ,C1.ts_commitmentreductions\n   ,C1.marketcap\n   ,C1.ts_originalcommitments\n   ,C1.ts_minimumticketsize\n   ,C1.revenue_base\n   ,C1.openrevenue_base\n   ,C1.aging30_base\n   ,C1.openrevenue\n   ,C1.ts_transfersin\n   ,C1.ts_othernotes\n   ,C1.ts_transfersin_date\n   ,C1.msdyn_salesaccelerationinsightidname\n   ,C1.address1_county\n   ,C1.openrevenue_date\n   ,C1.ts_recommendedbyname\n   ,C1.ts_relationshipinteractioncomments\n   ,C1.ts_originationlead2yominame\n   ,C1.parentaccountidname\n   ,C1.xpd_roletypes_text\n   ,C1.address1_addressid\n   ,C1.importsequencenumber\n   ,C1.address1_longitude\n   ,C1.ts_countryofeconomicoriginforthecapitalname\n   ,C1.entityimageid\n   ,C1.telephone2\n   ,C1.ts_lastoriginationmeeting\n   ,C1.address2_utcoffset\n   ,C1.address1_upszone\n   ,C1.ts_originalcommitments_state\n   ,C1.ts_typicalcost\n   ,C1.xpd_recommendingportfoliocompaniesrecommended\n   ,C1.accountnumber\n   ,C1.ts_currentauditoryominame\n   ,C1.ts_originalcommitments_date\n   ,C1.lastonholdtime\n   ,C1.ts_sectorscoveredbyfirm\n   ,C1.address1_telephone1\n   ,C1.address1_telephone2\n   ,C1.address1_telephone3\n   ,C1.address2_upszone\n   ,C1.opendeals_state\n   ,C1.xpd_functionuse_text\n   ,C1.slainvokedidname\n   ,C1.address2_longitude\n   ,C1.defaultpricelevelidname\n   ,C1.stockexchange\n   ,C1.mpe_liveofferingscount_date\n   ,C1.xpd_relationshipcomments\n   ,C1.originatingleadidname\n   ,C1.slaname\n   ,C1.ts_currentauditorname\n   ,C1.xpd_remindertoyominame\n   ,C1.ts_address1usstatename\n   ,C1.ts_tempcompanytype\n   ,C1.versionnumber\n   ,C1.address1_latitude\n   ,C1.ts_formername\n   ,C1.yominame\n   ,C1.createdbyyominame\n   ,C1.ts_cityofvisit\n   ,C1.address2_telephone1\n   ,C1.ts_globalgeographiescoveredids\n   ,C1.preferredserviceidname\n   ,C1.address2_city\n   ,C1.ts_mpeapproachstrategy\n   ,C1.address2_line2\n   ,C1.ts_lastdatestatuschanged\n   ,C1.li_companyid\n   ,C1.transactioncurrencyidname\n   ,C1.entityimage_url\n   ,C1.xpd_relationshipstatuschangeddate\n   ,C1.createdonbehalfbyname\n   ,C1.mpe_liveofferingscount_state\n   ,C1.xpd_numberofcoinvestinvestments_date\n   ,C1.ts_validateddate\n   ,C1.owneridname\n   ,C1.xpd_generalcomments\n   ,C1.ts_companylegalname\n   ,C1.description\n   ,C1.ts_validatedbyname\n   ,C1.originatingleadidyominame\n   ,C1.opendeals\n   ,C1.xpd_numberofopportunitiesshown_state\n   ,C1.address2_postalcode\n   ,C1.websiteurl\n   ,C1.xpd_fundname\n   ,C1.address1_utcoffset\n   ,C1.exchangerate\n   ,C1.mpe_flowlastrundate\n   ,C1.fax\n   ,C1.address1_line3\n   ,C1.ts_monthssincelastmeeting\n   ,C1.ts_hubname\n   ,C1.address2_line1\n   ,C1.ts_capiqticket\n   ,C1.address2_stateorprovince\n   ,C1.address2_name\n   ,C1.ts_transfersout_state\n   ,C1.xpd_numberofopportunitiesshown\n   ,C1.primarytwitterid\n   ,C1.mpe_coinvestquestionnaireidname\n   ,C1.xpd_numberofopportunitiesshown_date\n   ,C1.xpd_preferentialterms\n   ,C1.address1_primarycontactname\n   ,C1.territoryidname\n   ,C1.ts_processstatus\n   ,C1.address1_name\n   ,C1.address2_telephone2\n   ,C1.address2_telephone3\n   ,C1.xpd_recruitmentareateam_text\n   ,C1.ftpsiteurl\n   ,C1.address1_postalcode\n   ,C1.ts_companynumber\n   ,C1.createdon\n   ,C1.mpe_liveofferingscount\n   ,C1.traversedpath\n   ,C1.address1_stateorprovince\n   ,C1.ts_transfersin_state\n   ,C1.address2_addressid\n   ,C1.ts_monthlyreviewmeetingname\n   ,C1.primarysatoriid\n   ,C1.telephone3\n   ,C1.openrevenue_state\n   ,C1.ts_usesprovidedids\n   ,C1.ts_originationcomments\n   ,C1.lastusedincampaign\n   ,C1.primarycontactidname\n   ,C1.ts_originationlead1name\n   ,C1.ts_headofficeidname\n   ,C1.msdyn_segmentidname\n   ,C1.ts_montagucomments\n   ,C1.address2_fax\n   ,C1.createdbyname\n   ,C1.xpd_numberofcoinvestinvestments\n   ,C1.ts_capitaliqlink\n   ,C1.ts_primarymperelationshipmanagername\n   ,C1.mpe_relationshipstatus_text\n   ,C1.xpd_datereminderwasset\n   ,C1.xpd_numberofcoinvestinvestments_state\n   ,C1.address1_postofficebox\n   ,C1.address1_city\n   ,C1.teamsfollowed\n   ,C1.ts_originationlead2name\n   ,C1.timezoneruleversionnumber\n   ,C1.modifiedonbehalfbyyominame\n   ,C1.entityimage_timestamp\n   ,C1.tickersymbol\n   ,C1.ts_theirprogrammecomments\n   ,C1.xpd_companyuse_text\n   ,C1.modifiedbyname\n   ,C1.owneridtype\n   ,C1.sic\n   ,C1.sharesoutstanding\n   ,C1.opendeals_date\n   ,C1.address2_postofficebox\n   ,C1.emailaddress3\n   ,C1.emailaddress2\n   ,C1.emailaddress1\n   ,C1.ts_globalgeographiescoveredbyfirm\n   ,C1.ts_recommendationoffirmupdated\n   ,C1.ts_lastmet\n   ,C1.ts_reminderdatesetto\n   ,C1.ts_commitmentreductions_state\n   ,C1.owningbusinessunitname\n   ,C1.onholdtime\n   ,C1.ts_alias\n   ,C1.createdonbehalfbyyominame\n   ,C1.ts_transfersout_date\n   ,C1.ts_address1countryname\n   ,C1.preferredsystemuseridyominame\n   ,C1.createdbyexternalpartyname\n   ,C1.mpe_documentsetid\n   ,C1.telephone1\n   ,C1.ts_legacycompanytypes\n   ,C1.ts_validatedbyyominame\n   ,C1.address1_composite\n   ,C1.ts_investorgroupgatekeeperid\n   ,C1.primarycontactidyominame\n   ,C1.address2_country\n   ,C1.xpd_recommendationcomments\n   ,C1.owneridyominame\n   ,C1.createdbyexternalpartyyominame\n   ,C1.ts_originationlead1yominame\n   ,C1.ts_usesprovidedbyfirm\n   ,C1.xpd_recommendingportco\n   ,C1.address1_country\n   ,C1.ts_commitmentreductions_date\n   ,C1.name\n   ,C1.modifiedbyexternalpartyyominame\n   ,C1.xpd_remindertoname\n   ,C1.stageid\n   ,C1.modifiedonbehalfbyname\n   ,C1.masteraccountidname\n   ,C1.timespentbymeonemailandmeetings\n   ,C1.address2_latitude\n   ,C1.overriddencreatedon\n   ,C1.parentaccountidyominame\n   ,C1.ts_specificareaofexpertisecomments\n   ,C1.preferredsystemuseridname\n   ,C1.utcconversiontimezonecode\n   ,C1.address2_county\n   ,C1.address1_line1\n   ,C1.address2_primarycontactname\n   ,C1.address1_line2\n   ,C1.xpd_reasonaction\n   ,C1.ts_primarymperelationshipmanageryominame\n   ,C1.processid\n   ,C1.ts_sectorscoveredids\n   ,C1.ts_recommendedbyyominame\n   ,C1.modifiedbyexternalpartyname\n   ,C1.ts_relevantsituations\n   ,C1.accountid\n   ,C1.modifiedon\n   ,C1.preferredequipmentidname\n   ,C1.modifiedbyyominame\n   ,C1.ts_dealstageofmostrecentopportunity\n   ,C1.address2_composite\n   ,C1.masteraccountidyominame\n   ,C1.numberofemployees\n   ,C1.address1_fax\n   ,C1.address2_line3\n   ,ROW_NUMBER() OVER (ORDER BY C1.ts_primarysecondaryfocus) AS RowNum\n  FROM[dataverse_montagu_org5a2bcccf].[dbo].[account] C1) C1\nLEFT OUTER JOIN (SELECT\n    OptionsetMetadata.participationtypemask\n   ,OptionsetMetadata.instancetypecode\n   ,OptionsetMetadata.donotpostalmail\n   ,OptionsetMetadata.donotfax\n   ,OptionsetMetadata.donotphone\n   ,OptionsetMetadata.ispartydeleted\n   ,OptionsetMetadata.businesstypecode\n   ,OptionsetMetadata.industrycode\n   ,OptionsetMetadata.preferredappointmenttimecode\n   ,OptionsetMetadata.address2_freighttermscode\n   ,OptionsetMetadata.ts_introducertype\n   ,OptionsetMetadata.accountcategorycode\n   ,OptionsetMetadata.paymenttermscode\n   ,OptionsetMetadata.preferredappointmentdaycode\n   ,OptionsetMetadata.donotemail\n   ,OptionsetMetadata.ts_primarysecondaryfocus\n   ,OptionsetMetadata.customertypecode\n   ,OptionsetMetadata.address1_addresstypecode\n   ,OptionsetMetadata.accountclassificationcode\n   ,OptionsetMetadata.ts_ukrow\n   ,ROW_NUMBER() OVER (ORDER BY OptionsetMetadata.ts_primarysecondaryfocus) AS RowNum\n  FROM dbo.OptionsetMetadata) C2\n  ON C1.RowNum = C2.RowNum\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "ServerlessP1",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/workingOptionSetScriptFRI18thNov')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "--=================================================================================================\n-- DESCRIPTION\n--=================================================================================================\n--  The purpose of this script is to create a set of database views in a database within your Synapse Analytics Serverless SQL Pool that will \n--  translate numeric codes for Option Sets, Status and States into human-readable descriptions for tables exported using Synapse Link for Dataverse.\n--  See the following article for background: https://docs.microsoft.com/en-us/power-apps/maker/data-platform/azure-synapse-link-choice-labels\n--\n-- PREREQUISITES\n-- 1. You have configured Synapse Link for Dataverse to export to a Synapse Analytics Workspace\n-- 2. You have sufficient read access to the lake database created by Synapse Link for Dataverse\n-- 3. You have created an additional database in which views with enriched entities will be created\n-- 4. You have sufficient permissions to create database objects in your newly-created database\n--\n-- IMPORTANT: please execute this script in the context of the Lake Database corresponding to your Synapse Link for Dataverse!\nUSE [dataverse_montaguqa1_unq5a4857c03d0545c6b9ad616ca59a7] --Specify the name of the database corresponding to your Synapse Link for Dataverse\n\n--=================================================================================================\n--PROVIDE INPUT PARAMETERS:\n--=================================================================================================\nDECLARE\n\t@EnrichedViewDatabase sysname, --Specify the name of the database in which views with enriched entities will be created\n\t@EnrichedViewSchema sysname, --Specify the name of the database schema in which views with enriched entities will be created\n\t@EnrichedColumnSuffix varchar(50), \t--Specify the suffix for columns enriched with human-readable descriptions. For example, the suffix of \"label\" will change a statecode column in the base table to a statelabel column in the enriched view.\n\t@LanguageCode varchar(10), --Specify the language code for localized labels. For example, English - United States is 1033 (https://docs.microsoft.com/en-us/openspecs/office_standards/ms-oe376/6c085406-a698-4e12-9d4d-c3b0ee3dbc4a)\n\t@BaseTableSuffix varchar(50), --If applicable, specify the suffix in the names of the base tables or views (e.g., '_partitiond'). The default is an empty string.\n\t@PreviewOnly bit --Indicate whether to preview the SQL Script (without creating the views) = 1 ; Create views = 0;\n\nSET @EnrichedViewDatabase = 'TestDataverseEnriched'\nSET @EnrichedViewSchema = 'dbo'\nSET @EnrichedColumnSuffix = 'label'\nSET @LanguageCode = 1033\nSET @BaseTableSuffix = ''\nSET @PreviewOnly = 0 \n\n--=================================================================================================\n-- Do not edit the script below this point\n--=================================================================================================\n\n--Get column metadata from the Lake Database managed by Synapse Link for Dataverse\n--The column metadata will be stored as a JSON document in a scalar variable\n--This is needed as a workaround for the limitation of not allowing system objects to be used in distributed queries\nDECLARE @ColumnMetadata nvarchar(MAX), @ColumnMetadataSQL nvarchar(MAX)\n\n--Define the SQL statement to retrieve column metadata from the Lake Database managed by Synapse Link for Dataverse\n--Results will be stored as a JSON document in a variable\nSET @ColumnMetadataSQL = 'SET @ColumnMetadataOUT = (\nSELECT TABLE_SCHEMA, \n\tTABLE_NAME, \n\tCOLUMN_NAME, \n\tORDINAL_POSITION, \n\tDATA_TYPE\nFROM INFORMATION_SCHEMA.COLUMNS \nWHERE TABLE_SCHEMA = ''dbo''\n\tAND TABLE_NAME NOT IN (''OptionsetMetadata'', ''GlobalOptionsetMetadata'',''StateMetadata'',''StatusMetadata'', ''TargetMetadata'')\n\tAND TABLE_NAME LIKE ''%' + @BaseTableSuffix + '''\nFOR JSON AUTO)'\nDECLARE @ParmDefinition NVARCHAR(MAX);  \nSET @ParmDefinition = N'@ColumnMetadataOUT NVARCHAR(MAX) OUTPUT';  \nEXECUTE sp_executesql @ColumnMetadataSQL, @ParmDefinition, @ColumnMetadataOUT=@ColumnMetadata OUTPUT;  \n\n--Declare a variable to store a SQL statement for creating enriched views\nDECLARE @SQL nvarchar(MAX) = ''\n\n; WITH CM AS (\n--Parse column metadata variable and construct a table based on its content\nSELECT JSON_VALUE(CM.value, '$.TABLE_SCHEMA') AS TableSchema,\n\t JSON_VALUE(CM.value, '$.TABLE_NAME') AS TableName,\n\t LEFT(JSON_VALUE(CM.value, '$.TABLE_NAME'), LEN(JSON_VALUE(CM.value, '$.TABLE_NAME'))-LEN(@BaseTableSuffix)) AS EntityName,\n\t JSON_VALUE(CM.value, '$.COLUMN_NAME') AS ColumnName,\n\t CAST(JSON_VALUE(CM.value, '$.ORDINAL_POSITION') AS INT) AS OrdinalPosition,\n\t JSON_VALUE(CM.value, '$.DATA_TYPE') AS DataType\nFROM OPENJSON (@ColumnMetadata) AS CM\n)\n\n, OSM AS (\n--Get Option Set Metadata\nSELECT DISTINCT \n\tEntityName, \n\tOptionSetName, \n\tQUOTENAME(EntityName + '_' + OptionSetName) AS Alias\nFROM dbo.[OptionsetMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, GOSM AS (\n--Get Global Option Set Metadata\nSELECT DISTINCT \n\tOptionSetName, \n\tQUOTENAME('Global_' + OptionSetName) AS Alias\nFROM dbo.[GlobalOptionsetMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, StateM AS (\n--Get State Metadata\nSELECT DISTINCT \n\tEntityName, \n\tQUOTENAME(EntityName + '_State') AS Alias\nFROM dbo.[StateMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, StatusM AS (\n--Get Status Metadata\nSELECT DISTINCT \n\tEntityName,\n\tQUOTENAME(EntityName + '_Status') AS Alias\nFROM dbo.[StatusMetadata]\nWHERE LocalizedLabelLanguageCode = @LanguageCode\n)\n\n, SQLStatement AS (\n--Enumerate all lines in the source table and replace codes with labels where applicable\nSELECT CM.EntityName,\n\t--Before the first column of each table, construct a CREATE OR ALTER VIEW statement\n\tCASE WHEN CM.OrdinalPosition = 1\n\t\tTHEN 'CREATE OR ALTER VIEW ' + QUOTENAME(@EnrichedViewSchema) + '.' + CM.EntityName + '\n\t\tAS\n\t\tSELECT '\n\t\tELSE '\t,'\n\t\tEND\n\t--For each column, check if it needs to be replaced with a suitable localized label\n\t+ CASE \n\t\tWHEN OSM.OptionSetName IS NOT NULL THEN OSM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tWHEN GOSM.OptionSetName IS NOT NULL THEN GOSM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tWHEN StateM.EntityName IS NOT NULL THEN StateM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tWHEN StatusM.EntityName IS NOT NULL THEN StatusM.Alias + '.[LocalizedLabel] AS ' + REPLACE(QUOTENAME(CM.ColumnName), 'code]', @EnrichedColumnSuffix + ']')\n\t\tELSE '[Base].' + QUOTENAME(CM.ColumnName)\n\t\tEND AS [SQLLine],\n\tCM.OrdinalPosition\nFROM CM \n\tLEFT JOIN OSM\n\t\tON CM.EntityName = OSM.EntityName\n\t\tAND CM.ColumnName = OSM.OptionSetName\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\tLEFT JOIN GOSM\n\t\tON CM.ColumnName = GOSM.OptionSetName\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\tLEFT JOIN StateM\n\t\tON CM.EntityName = StateM.EntityName\n\t\tAND CM.ColumnName = 'statecode'\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\tLEFT JOIN StatusM\n\t\tON CM.EntityName = StatusM.EntityName\n\t\tAND CM.ColumnName = 'statuscode'\n\t\tAND CM.DataType LIKE '%int' --Only include columns with integer data type\n\nUNION ALL\n--Construct the first line of the FROM clause, referencing external tables created by Synapse Link for Dataverse\nSELECT DISTINCT\nCM.EntityName,\n'FROM ' + QUOTENAME(DB_NAME()) + '.' + QUOTENAME(CM.TableSchema) + '.' + QUOTENAME(CM.TableName) + ' AS Base' AS SQLLine,\n10000 AS OrdinalPosition\nFROM CM\n\nUNION ALL \n--Construct LEFT JOIN statements for each relevant OptionSetMetadata field\nSELECT DISTINCT OSM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[OptionSetMetadata] AS ' + OSM.Alias + ' \n\t\tON ' + OSM.Alias + '.EntityName = ''' + OSM.EntityName + ''' \n\t\tAND ' + OSM.Alias + '.OptionSetName = ''' +  OSM.OptionSetName + '''\n\t\tAND [Base].' + QUOTENAME(OSM.OptionSetName) + ' = ' + OSM.Alias + '.[Option]\n\t\tAND ' + OSM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n20000 AS OrdinalPosition\nFROM OSM\n\tJOIN CM\n\t\tON CM.EntityName = OSM.EntityName\n\t\tAND CM.ColumnName = OSM.OptionSetName\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL \n--Construct LEFT JOIN statements for each relevant GlobalOptionSetMetadata field\nSELECT DISTINCT CM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[GlobalOptionSetMetadata] AS ' + Alias + ' \n\t\tON ' + Alias + '.OptionSetName = ''' +  OptionSetName + '''\n\t\tAND [Base].' + QUOTENAME(OptionSetName) + ' = ' + Alias + '.[Option]\n\t\tAND ' + Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n30000 AS OrdinalPosition\nFROM GOSM\n\tJOIN CM\n\t\tON CM.ColumnName = GOSM.OptionSetName\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL \n--Construct LEFT JOIN statements for each relevant State Metadata field\nSELECT DISTINCT CM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[StateMetadata] AS ' + StateM.Alias + ' \n\t\tON ' + StateM.Alias + '.EntityName = ''' + StateM.EntityName + ''' \n\t\tAND [Base].statecode' + ' = ' + StateM.Alias + '.[State]\n\t\tAND ' + StateM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n40000 AS OrdinalPosition\nFROM StateM\n\tJOIN CM\n\t\tON CM.EntityName = StateM.EntityName\n\t\tAND CM.ColumnName = 'statecode'\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL\n--Construct LEFT JOIN statements for each relevant Status Metadata field\nSELECT DISTINCT CM.EntityName AS EntityName,\n'\tLEFT JOIN ' + QUOTENAME(DB_NAME()) + '.[dbo].[StatusMetadata] AS ' + StatusM.Alias + ' \n\t\tON ' + StatusM.Alias + '.EntityName = ''' + StatusM.EntityName + ''' \n\t\tAND [Base].statuscode' + ' = ' + StatusM.Alias + '.[Status]\n\t\tAND ' + StatusM.Alias + '.LocalizedLabelLanguageCode = ' + @LanguageCode + '' AS SQLLine,\n40000 AS OrdinalPosition\nFROM StatusM\n\tJOIN CM\n\t\tON CM.EntityName = StatusM.EntityName\n\t\tAND CM.ColumnName = 'statuscode'\nWHERE CM.DataType LIKE '%int' --Only capture columns with Integer Data Types\n\nUNION ALL\n--Add statement terminator\nSELECT DISTINCT\nEntityName,\n'; ' + CHAR(10) AS SQLLine,\n100000 AS OrdinalPosition\nFROM CM\n)\n\n--Construct individual statements to create views (1 view per row)\n--Since CREATE VIEW statement must be the first statement in a batch, assign each view definition to a variable \n--and use the EXEC(@variable) command to create view as part of its own, separate batch.\n, ViewDefinitions AS (\nSELECT 'DECLARE @' + EntityName + ' NVARCHAR(MAX) = ''\n\t' + REPLACE(STRING_AGG(CAST(SQLLine as varchar(MAX)), CHAR(10)) WITHIN GROUP (ORDER BY EntityName, OrdinalPosition, SQLLine), '''', '''''') + ''' ' + CHAR(10) + 'EXEC [' + @EnrichedViewDatabase + '].dbo.sp_executesql @' + EntityName + CHAR(10) AS ViewDefinition\nFROM SQLStatement\nGROUP BY EntityName\n)\n\n--Construct a comprehensive SQL statement to create all views\nSELECT @SQL = STRING_AGG(ViewDefinition, ';' + CHAR(10) + CHAR(10))\nFROM ViewDefinitions\n\n--Return a preview of the SQL Script to be generated or go ahead and create the views.\nIF @PreviewOnly = 1\nBEGIN\n\t--Return the final SQL statement\n\tSELECT '--================================================================================================='+ CHAR(10) +' ' + CHAR(10) AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '-- A preview of the script to generate enriched views is provided below.'  AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '-- No database objects have been created.' AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '-- Re-run this script with the @PreviewOnly parameter set to 0 to actually create the views.' AS [--SQL Statement]\n\tUNION ALL \n\tSELECT '--================================================================================================='+ CHAR(10) +' ' + CHAR(10) AS [--SQL Statement]\n\tUNION ALL \n\tSELECT VALUE AS [--SQL Statement] FROM STRING_SPLIT(@SQL, CHAR(10))\nEND\nELSE\nBEGIN\n\t--Execute the SQL statement\n\tPRINT 'Beginning view creation'\n\tEXEC sp_executesql @SQL\n\tPRINT 'Completed view creation'\nEND",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "dataverse_montaguqa1_unq5a4857c03d0545c6b9ad616ca59a7",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Notebook 1')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "prodsparksyn",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 1,
					"runAsWorkspaceSystemIdentity": false,
					"conf": {
						"spark.dynamicAllocation.enabled": "true",
						"spark.dynamicAllocation.minExecutors": "1",
						"spark.dynamicAllocation.maxExecutors": "4",
						"spark.autotune.trackingId": "98cee8dc-0756-4f18-9269-a6b8359c6b36"
					}
				},
				"metadata": {
					"saveOutput": true,
					"synapse_widget": {
						"version": "0.1"
					},
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "Synapse PySpark"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/5c1bc415-b561-4700-9cbe-71f1079bb536/resourceGroups/MontaguData/providers/Microsoft.Synapse/workspaces/prod-synapse-uks-001/bigDataPools/prodsparksyn",
						"name": "prodsparksyn",
						"type": "Spark",
						"endpoint": "https://prod-synapse-uks-001.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/prodsparksyn",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net",
							"authHeader": null
						},
						"sparkVersion": "3.1",
						"nodeCount": 10,
						"cores": 4,
						"memory": 28,
						"extraHeader": null
					},
					"sessionKeepAliveTimeout": 30
				},
				"cells": [
					{
						"cell_type": "code",
						"source": [
							"%%pyspark\n",
							"spark.sql(\"DROP DATABASE IF EXISTS default CASCADE\")"
						],
						"outputs": [],
						"execution_count": 1
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Notebook 2')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 2,
					"runAsWorkspaceSystemIdentity": false,
					"conf": {
						"spark.dynamicAllocation.enabled": "false",
						"spark.dynamicAllocation.minExecutors": "2",
						"spark.dynamicAllocation.maxExecutors": "2",
						"spark.autotune.trackingId": "b1e94daa-7f62-4f91-870b-100291d4a0be"
					}
				},
				"metadata": {
					"saveOutput": true,
					"synapse_widget": {
						"version": "0.1"
					},
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "python"
					},
					"language_info": {
						"name": "python"
					},
					"sessionKeepAliveTimeout": 30
				},
				"cells": [
					{
						"cell_type": "code",
						"metadata": {
							"microsoft": {
								"language": "python"
							}
						},
						"source": [
							"%%pyspark\n",
							"spark.sql(\"CREATE TABLE IF NOT EXISTS dataverse_montagu_org5a2bcccf.YourTableName USING Parquet LOCATION 'YourFilePath'\")"
						],
						"outputs": []
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/LakeDatabaseEnriched')]",
			"type": "Microsoft.Synapse/workspaces/databases",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"Ddls": [
					{
						"ActionType": "CREATE",
						"OldEntity": null,
						"NewEntity": {
							"Name": "LakeDatabaseEnriched",
							"EntityType": "DATABASE",
							"Origin": {
								"Type": "SPARK"
							},
							"Properties": {
								"IsSyMSCDMDatabase": true,
								"DerivedModelDBInfo": "{\"ModelDirectives\":{\"BaseModel\":{\"Name\":\"Banking\",\"Version\":\"0.1.0\"}}}",
								"x-ms-usageinfo": "AzureSynapseDatabaseTemplate"
							},
							"Source": {
								"Provider": "ADLS",
								"Location": "abfss://users@prodlakeaccuks01.dfs.core.windows.net/LakeDatabaseEnriched",
								"Properties": {
									"FormatType": "csv",
									"LinkedServiceName": "prod-synapse-uks-001-WorkspaceDefaultStorage"
								}
							},
							"PublishStatus": "PUBLISHED",
							"ObjectVersion": 2,
							"ObjectId": "60c5229e-a098-4c61-9de1-615b33e45cfb"
						},
						"Source": {
							"Type": "SPARK"
						}
					},
					{
						"ActionType": "CREATE",
						"OldEntity": null,
						"NewEntity": {
							"Name": "BusinessTravelType",
							"EntityType": "TABLE",
							"TableType": "EXTERNAL",
							"Namespace": {
								"SchemaName": null,
								"DatabaseName": "LakeDatabaseEnriched",
								"DatabaseId": null
							},
							"StorageDescriptor": {
								"Distribution": null,
								"Columns": [
									{
										"Name": "BusinessTravelTypeId",
										"Description": "The identifier of the business travel type.",
										"OriginDataTypeName": {
											"TypeName": "integer",
											"IsComplexType": false,
											"IsNullable": false,
											"Length": 0,
											"Precision": 0,
											"Scale": 0,
											"Properties": {
												"HIVE_TYPE_STRING": "integer"
											}
										},
										"BaseAttributeReference": {
											"Entity": "BusinessTravelType.cdm.json/BusinessTravelType",
											"Name": "BusinessTravelTypeId"
										}
									},
									{
										"Name": "BusinessTravelTypeName",
										"Description": "The name of the business travel type.",
										"OriginDataTypeName": {
											"TypeName": "string",
											"IsComplexType": false,
											"IsNullable": true,
											"Length": 128,
											"Precision": 0,
											"Scale": 0,
											"Properties": {
												"HIVE_TYPE_STRING": "string"
											}
										},
										"BaseAttributeReference": {
											"Entity": "BusinessTravelType.cdm.json/BusinessTravelType",
											"Name": "BusinessTravelTypeName"
										}
									},
									{
										"Name": "BusinessTravelTypeDescription",
										"Description": "The description of the business travel type.",
										"OriginDataTypeName": {
											"TypeName": "string",
											"IsComplexType": false,
											"IsNullable": true,
											"Length": 512,
											"Precision": 0,
											"Scale": 0,
											"Properties": {
												"HIVE_TYPE_STRING": "string"
											}
										},
										"BaseAttributeReference": {
											"Entity": "BusinessTravelType.cdm.json/BusinessTravelType",
											"Name": "BusinessTravelTypeDescription"
										}
									}
								],
								"ColumnSetEntityName": "9ab15509-fc16-4c4f-bd4c-49000271a7f8",
								"Format": {
									"InputFormat": "org.apache.hadoop.mapred.SequenceFileInputFormat",
									"OutputFormat": "org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat",
									"FormatType": "csv",
									"SerializeLib": "org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe",
									"Properties": {
										"path": "abfss://users@prodlakeaccuks01.dfs.core.windows.net/LakeDatabaseEnriched/BusinessTravelType",
										"delimiter": ",",
										"firstRowAsHeader": "false",
										"multiLine": "false",
										"serialization.format": "1",
										"escape": "\\",
										"quote": "\"",
										"FormatTypeSetToDatabaseDefault": true,
										"header": "false"
									}
								},
								"Source": {
									"Provider": "ADLS",
									"Location": "abfss://users@prodlakeaccuks01.dfs.core.windows.net/LakeDatabaseEnriched/BusinessTravelType",
									"Properties": {
										"LinkedServiceName": "prod-synapse-uks-001-WorkspaceDefaultStorage",
										"LocationSetToDatabaseDefault": true
									}
								},
								"Properties": {
									"textinputformat.record.delimiter": ",",
									"compression": "{\"type\":\"None\",\"level\":\"optimal\"}",
									"derivedModelAttributeInfo": "{\"attributeReferences\":{\"BusinessTravelTypeId\":{\"entity\":\"BusinessTravelType.cdm.json/BusinessTravelType\",\"name\":\"BusinessTravelTypeId\"},\"BusinessTravelTypeName\":{\"entity\":\"BusinessTravelType.cdm.json/BusinessTravelType\",\"name\":\"BusinessTravelTypeName\"},\"BusinessTravelTypeDescription\":{\"entity\":\"BusinessTravelType.cdm.json/BusinessTravelType\",\"name\":\"BusinessTravelTypeDescription\"}}}"
								},
								"Compressed": false,
								"SerDeInfo": null,
								"IsStoredAsSubdirectories": false
							},
							"Owner": null,
							"CreateTime": 0,
							"LastAccessTime": 0,
							"Retention": 0,
							"Temporary": false,
							"IsRewriteEnabled": false,
							"ViewOriginalText": null,
							"ViewExpandedText": null,
							"Origin": {
								"Type": "SPARK"
							},
							"OriginObjectId": null,
							"IsSharedEntity": false,
							"PublishStatus": "PUBLISHED",
							"Properties": {
								"DerivedModelEntityInfo": "{\"entityDirectives\":{\"baseEntityReference\":{\"name\":\"BusinessTravelType\",\"path\":\"BusinessTravelType.cdm.json/BusinessTravelType\"},\"description\":\"The type of business travel.\\n\\nEx:\\n\\n- Air travel\\n-  Rail travel\\n- Bus travel\\n- Automobile trave \\n- Other modes of travel.\",\"primaryKey\":[\"BusinessTravelTypeId\"],\"projectionInfo\":{\"attributes\":[{\"type\":\"Existing\",\"attributeReference\":{\"entity\":\"BusinessTravelType.cdm.json/BusinessTravelType\",\"name\":\"BusinessTravelTypeId\"},\"dataType\":\"integer\",\"description\":\"The identifier of the business travel type.\",\"isNullable\":false,\"name\":\"BusinessTravelTypeId\"},{\"type\":\"Existing\",\"attributeReference\":{\"entity\":\"BusinessTravelType.cdm.json/BusinessTravelType\",\"name\":\"BusinessTravelTypeName\"},\"dataType\":\"string\",\"dataTypeLength\":128,\"description\":\"The name of the business travel type.\",\"isNullable\":true,\"name\":\"BusinessTravelTypeName\"},{\"type\":\"Existing\",\"attributeReference\":{\"entity\":\"BusinessTravelType.cdm.json/BusinessTravelType\",\"name\":\"BusinessTravelTypeDescription\"},\"dataType\":\"string\",\"dataTypeLength\":512,\"description\":\"The description of the business travel type.\",\"isNullable\":true,\"name\":\"BusinessTravelTypeDescription\"}]}}}",
								"Description": "The type of business travel.\n\nEx:\n\n- Air travel\n-  Rail travel\n- Bus travel\n- Automobile trave \n- Other modes of travel.",
								"DisplayFolderInfo": "{\"name\":\"Emissions\",\"colorCode\":\"#0064C1\"}",
								"PrimaryKeys": "BusinessTravelTypeId",
								"spark.sql.sources.provider": "csv",
								"x-ms-usageinfo": "AzureSynapseDatabaseTemplate",
								"spark.sql.sources.schema.numParts": "1",
								"spark.sql.sources.schema.part.0": "{\"type\":\"struct\",\"fields\":[{\"name\":\"BusinessTravelTypeId\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}},{\"name\":\"BusinessTravelTypeName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"BusinessTravelTypeDescription\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}"
							},
							"ObjectVersion": 1,
							"ObjectId": "f0e85d62-bd0b-417f-a49e-caef16a32366",
							"Description": "The type of business travel.\n\nEx:\n\n- Air travel\n-  Rail travel\n- Bus travel\n- Automobile trave \n- Other modes of travel."
						},
						"Source": {
							"Type": "SPARK"
						}
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/prodsparksyn')]",
			"type": "Microsoft.Synapse/workspaces/bigDataPools",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"autoPause": {
					"enabled": true,
					"delayInMinutes": 15
				},
				"autoScale": {
					"enabled": true,
					"maxNodeCount": 10,
					"minNodeCount": 3
				},
				"nodeCount": 10,
				"nodeSize": "Small",
				"nodeSizeFamily": "MemoryOptimized",
				"sparkVersion": "3.1",
				"isComputeIsolationEnabled": false,
				"sessionLevelPackagesEnabled": true,
				"annotations": []
			},
			"dependsOn": [],
			"location": "uksouth"
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DedicatedSQLPool')]",
			"type": "Microsoft.Synapse/workspaces/sqlPools",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"collation": "SQL_Latin1_General_CP1_CI_AS",
				"maxSizeBytes": 263882790666240,
				"annotations": []
			},
			"dependsOn": [],
			"location": "uksouth"
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ReportsDW')]",
			"type": "Microsoft.Synapse/workspaces/sqlPools",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"collation": "SQL_Latin1_General_CP1_CI_AS",
				"maxSizeBytes": 263882790666240,
				"annotations": []
			},
			"dependsOn": [],
			"location": "uksouth"
		},
		{
			"name": "[concat(parameters('workspaceName'), '/default')]",
			"type": "Microsoft.Synapse/workspaces/managedVirtualNetworks",
			"apiVersion": "2019-06-01-preview",
			"properties": {},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/default/ADLSProdEndpoint')]",
			"type": "Microsoft.Synapse/workspaces/managedVirtualNetworks/managedPrivateEndpoints",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"privateLinkResourceId": "/subscriptions/5c1bc415-b561-4700-9cbe-71f1079bb536/resourceGroups/MontaguData/providers/Microsoft.Storage/storageAccounts/prodlakeaccuks02",
				"groupId": "dfs",
				"fqdns": [
					"prodlakeaccuks02.dfs.core.windows.net"
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/managedVirtualNetworks/default')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/default/AzureDataLakeStorageMEP4')]",
			"type": "Microsoft.Synapse/workspaces/managedVirtualNetworks/managedPrivateEndpoints",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"privateLinkResourceId": "/subscriptions/5c1bc415-b561-4700-9cbe-71f1079bb536/resourceGroups/MontaguData/providers/Microsoft.Storage/storageAccounts/prodlakeaccuks01",
				"groupId": "dfs",
				"fqdns": [
					"prodlakeaccuks01.dfs.core.windows.net"
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/managedVirtualNetworks/default')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/default/AzureSqlDatabaseMEP2')]",
			"type": "Microsoft.Synapse/workspaces/managedVirtualNetworks/managedPrivateEndpoints",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"privateLinkResourceId": "/subscriptions/5c1bc415-b561-4700-9cbe-71f1079bb536/resourceGroups/test-mrg-synapse-uks-01/providers/Microsoft.Sql/servers/test-ws-synapse-uks-01",
				"groupId": "sqlServer"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/managedVirtualNetworks/default')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/default/AzureSynapseAnalytics802MEP')]",
			"type": "Microsoft.Synapse/workspaces/managedVirtualNetworks/managedPrivateEndpoints",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"privateLinkResourceId": "/subscriptions/5c1bc415-b561-4700-9cbe-71f1079bb536/resourceGroups/MontaguData/providers/Microsoft.Synapse/workspaces/prod-synapse-uks-001",
				"groupId": "sqlOnDemand"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/managedVirtualNetworks/default')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/default/Purviewendpointstest')]",
			"type": "Microsoft.Synapse/workspaces/managedVirtualNetworks/managedPrivateEndpoints",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"privateLinkResourceId": "/subscriptions/5c1bc415-b561-4700-9cbe-71f1079bb536/resourceGroups/Montagu/providers/Microsoft.Purview/accounts/MontaguPurview",
				"groupId": "account",
				"fqdns": [
					"montagupurview.purview.azure.com"
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/managedVirtualNetworks/default')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/default/Purviewendpointstest_blob')]",
			"type": "Microsoft.Synapse/workspaces/managedVirtualNetworks/managedPrivateEndpoints",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"privateLinkResourceId": "/subscriptions/5c1bc415-b561-4700-9cbe-71f1079bb536/resourceGroups/managed-rg-MontaguPurview/providers/Microsoft.Storage/storageAccounts/scanuksouthrpqzvxo",
				"groupId": "blob",
				"fqdns": [
					"scanuksouthrpqzvxo.blob.core.windows.net"
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/managedVirtualNetworks/default')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/default/Purviewendpointstest_namespace')]",
			"type": "Microsoft.Synapse/workspaces/managedVirtualNetworks/managedPrivateEndpoints",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"privateLinkResourceId": "/subscriptions/5c1bc415-b561-4700-9cbe-71f1079bb536/resourceGroups/managed-rg-MontaguPurview/providers/Microsoft.EventHub/namespaces/Atlas-d26807bb-c695-4d5e-a987-2852e4651aee",
				"groupId": "namespace",
				"fqdns": [
					"Atlas-d26807bb-c695-4d5e-a987-2852e4651aee.servicebus.windows.net"
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/managedVirtualNetworks/default')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/default/Purviewendpointstest_queue')]",
			"type": "Microsoft.Synapse/workspaces/managedVirtualNetworks/managedPrivateEndpoints",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"privateLinkResourceId": "/subscriptions/5c1bc415-b561-4700-9cbe-71f1079bb536/resourceGroups/managed-rg-MontaguPurview/providers/Microsoft.Storage/storageAccounts/scanuksouthrpqzvxo",
				"groupId": "queue",
				"fqdns": [
					"scanuksouthrpqzvxo.queue.core.windows.net"
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/managedVirtualNetworks/default')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/default/synapse-ws-custstgacct--prod-synapse-uks-001-prodlakeaccuks01')]",
			"type": "Microsoft.Synapse/workspaces/managedVirtualNetworks/managedPrivateEndpoints",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"privateLinkResourceId": "/subscriptions/5c1bc415-b561-4700-9cbe-71f1079bb536/resourceGroups/MontaguData/providers/Microsoft.Storage/storageAccounts/prodlakeaccuks01",
				"groupId": "dfs",
				"fqdns": [
					"prodlakeaccuks01.dfs.core.windows.net"
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/managedVirtualNetworks/default')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/default/synapse-ws-custstgacct--test-ws-synapse-uks-01-testdatalakeuks01')]",
			"type": "Microsoft.Synapse/workspaces/managedVirtualNetworks/managedPrivateEndpoints",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"privateLinkResourceId": "/subscriptions/5c1bc415-b561-4700-9cbe-71f1079bb536/resourceGroups/test-rg-synapse-uks-01/providers/Microsoft.Storage/storageAccounts/testdatalakeuks01",
				"groupId": "dfs",
				"fqdns": [
					"testdatalakeuks01.dfs.core.windows.net"
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/managedVirtualNetworks/default')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/default/synapse-ws-sql--prod-synapse-uks-001')]",
			"type": "Microsoft.Synapse/workspaces/managedVirtualNetworks/managedPrivateEndpoints",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"privateLinkResourceId": "/subscriptions/5c1bc415-b561-4700-9cbe-71f1079bb536/resourceGroups/MontaguData/providers/Microsoft.Synapse/workspaces/prod-synapse-uks-001",
				"groupId": "sql",
				"fqdns": [
					"prod-synapse-uks-001.e52c8ab6-b121-4230-90fb-786ac6c216cb.sql.azuresynapse.net"
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/managedVirtualNetworks/default')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/default/synapse-ws-sql--test-ws-synapse-uks-01')]",
			"type": "Microsoft.Synapse/workspaces/managedVirtualNetworks/managedPrivateEndpoints",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"privateLinkResourceId": "/subscriptions/5c1bc415-b561-4700-9cbe-71f1079bb536/resourceGroups/test-rg-synapse-uks-01/providers/Microsoft.Synapse/workspaces/test-ws-synapse-uks-01",
				"groupId": "sql",
				"fqdns": [
					"test-ws-synapse-uks-01.ac774afe-0375-4efe-86ec-bb2fc2a14fbc.sql.azuresynapse.net"
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/managedVirtualNetworks/default')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/default/synapse-ws-sqlOnDemand--prod-synapse-uks-001')]",
			"type": "Microsoft.Synapse/workspaces/managedVirtualNetworks/managedPrivateEndpoints",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"privateLinkResourceId": "/subscriptions/5c1bc415-b561-4700-9cbe-71f1079bb536/resourceGroups/MontaguData/providers/Microsoft.Synapse/workspaces/prod-synapse-uks-001",
				"groupId": "sqlOnDemand",
				"fqdns": [
					"prod-synapse-uks-001-ondemand.e52c8ab6-b121-4230-90fb-786ac6c216cb.sql.azuresynapse.net"
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/managedVirtualNetworks/default')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/default/synapse-ws-sqlOnDemand--test-ws-synapse-uks-01')]",
			"type": "Microsoft.Synapse/workspaces/managedVirtualNetworks/managedPrivateEndpoints",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"privateLinkResourceId": "/subscriptions/5c1bc415-b561-4700-9cbe-71f1079bb536/resourceGroups/test-rg-synapse-uks-01/providers/Microsoft.Synapse/workspaces/test-ws-synapse-uks-01",
				"groupId": "sqlOnDemand",
				"fqdns": [
					"test-ws-synapse-uks-01-ondemand.ac774afe-0375-4efe-86ec-bb2fc2a14fbc.sql.azuresynapse.net"
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/managedVirtualNetworks/default')]"
			]
		}
	]
}